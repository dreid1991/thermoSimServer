(function(){function a(b,d,e){if(b===d)return 0!==b||1/b==1/d;if(null==b||null==d)return b===d;b._chain&&(b=b._wrapped);d._chain&&(d=d._wrapped);if(b.isEqual&&u.isFunction(b.isEqual))return b.isEqual(d);if(d.isEqual&&u.isFunction(d.isEqual))return d.isEqual(b);var f=m.call(b);if(f!=m.call(d))return!1;switch(f){case "[object String]":return b==""+d;case "[object Number]":return b!=+b?d!=+d:0==b?1/b==1/d:b==+d;case "[object Date]":case "[object Boolean]":return+b==+d;case "[object RegExp]":return b.source==
d.source&&b.global==d.global&&b.multiline==d.multiline&&b.ignoreCase==d.ignoreCase}if("object"!=typeof b||"object"!=typeof d)return!1;for(var h=e.length;h--;)if(e[h]==b)return!0;e.push(b);var h=0,k=!0;if("[object Array]"==f){if(h=b.length,k=h==d.length)for(;h--&&(k=h in b==h in d&&a(b[h],d[h],e)););}else{if("constructor"in b!="constructor"in d||b.constructor!=d.constructor)return!1;for(var l in b)if(u.has(b,l)&&(h++,!(k=u.has(d,l)&&a(b[l],d[l],e))))break;if(k){for(l in d)if(u.has(d,l)&&!h--)break;
k=!h}}e.pop();return k}var d=this,b=d._,e={},f=Array.prototype,k=Object.prototype,h=f.slice,l=f.unshift,m=k.toString,n=k.hasOwnProperty,p=f.forEach,r=f.map,s=f.reduce,v=f.reduceRight,t=f.filter,x=f.every,w=f.some,y=f.indexOf,z=f.lastIndexOf,k=Array.isArray,A=Object.keys,F=Function.prototype.bind,u=function(a){return new ga(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=u),exports._=u):d._=u;u.VERSION="1.3.3";var C=u.each=u.forEach=function(a,
b,d){if(null!=a)if(p&&a.forEach===p)a.forEach(b,d);else if(a.length===+a.length)for(var f=0,h=a.length;f<h&&!(f in a&&b.call(d,a[f],f,a)===e);f++);else for(f in a)if(u.has(a,f)&&b.call(d,a[f],f,a)===e)break};u.map=u.collect=function(a,b,d){var e=[];if(null==a)return e;if(r&&a.map===r)return a.map(b,d);C(a,function(a,f,h){e[e.length]=b.call(d,a,f,h)});a.length===+a.length&&(e.length=a.length);return e};u.reduce=u.foldl=u.inject=function(a,b,d,e){var f=2<arguments.length;null==a&&(a=[]);if(s&&a.reduce===
s)return e&&(b=u.bind(b,e)),f?a.reduce(b,d):a.reduce(b);C(a,function(a,h,k){f?d=b.call(e,d,a,h,k):(d=a,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return d};u.reduceRight=u.foldr=function(a,b,d,e){var f=2<arguments.length;null==a&&(a=[]);if(v&&a.reduceRight===v)return e&&(b=u.bind(b,e)),f?a.reduceRight(b,d):a.reduceRight(b);var h=u.toArray(a).reverse();e&&!f&&(b=u.bind(b,e));return f?u.reduce(h,b,d,e):u.reduce(h,b)};u.find=u.detect=function(a,b,d){var e;B(a,function(a,
f,h){if(b.call(d,a,f,h))return e=a,!0});return e};u.filter=u.select=function(a,b,d){var e=[];if(null==a)return e;if(t&&a.filter===t)return a.filter(b,d);C(a,function(a,f,h){b.call(d,a,f,h)&&(e[e.length]=a)});return e};u.reject=function(a,b,d){var e=[];if(null==a)return e;C(a,function(a,f,h){b.call(d,a,f,h)||(e[e.length]=a)});return e};u.every=u.all=function(a,b,d){var f=!0;if(null==a)return f;if(x&&a.every===x)return a.every(b,d);C(a,function(a,h,k){if(!(f=f&&b.call(d,a,h,k)))return e});return!!f};
var B=u.some=u.any=function(a,b,d){b||(b=u.identity);var f=!1;if(null==a)return f;if(w&&a.some===w)return a.some(b,d);C(a,function(a,h,k){if(f||(f=b.call(d,a,h,k)))return e});return!!f};u.include=u.contains=function(a,b){return null==a?!1:y&&a.indexOf===y?-1!=a.indexOf(b):B(a,function(a){return a===b})};u.invoke=function(a,b){var d=h.call(arguments,2);return u.map(a,function(a){return(u.isFunction(b)?b||a:a[b]).apply(a,d)})};u.pluck=function(a,b){return u.map(a,function(a){return a[b]})};u.max=function(a,
b,d){if(!b&&u.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&u.isEmpty(a))return-Infinity;var e={computed:-Infinity};C(a,function(a,f,h){f=b?b.call(d,a,f,h):a;f>=e.computed&&(e={value:a,computed:f})});return e.value};u.min=function(a,b,d){if(!b&&u.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&u.isEmpty(a))return Infinity;var e={computed:Infinity};C(a,function(a,f,h){f=b?b.call(d,a,f,h):a;f<e.computed&&(e={value:a,computed:f})});return e.value};u.shuffle=function(a){var b=
[],d;C(a,function(a,e){d=Math.floor(Math.random()*(e+1));b[e]=b[d];b[d]=a});return b};u.sortBy=function(a,b,d){var e=u.isFunction(b)?b:function(a){return a[b]};return u.pluck(u.map(a,function(a,b,f){return{value:a,criteria:e.call(d,a,b,f)}}).sort(function(a,b){var d=a.criteria,e=b.criteria;return void 0===d?1:void 0===e?-1:d<e?-1:d>e?1:0}),"value")};u.groupBy=function(a,b){var d={},e=u.isFunction(b)?b:function(a){return a[b]};C(a,function(a,b){var f=e(a,b);(d[f]||(d[f]=[])).push(a)});return d};u.sortedIndex=
function(a,b,d){d||(d=u.identity);for(var e=0,f=a.length;e<f;){var h=e+f>>1;d(a[h])<d(b)?e=h+1:f=h}return e};u.toArray=function(a){return!a?[]:u.isArray(a)||u.isArguments(a)?h.call(a):a.toArray&&u.isFunction(a.toArray)?a.toArray():u.values(a)};u.size=function(a){return u.isArray(a)?a.length:u.keys(a).length};u.first=u.head=u.take=function(a,b,d){return null!=b&&!d?h.call(a,0,b):a[0]};u.initial=function(a,b,d){return h.call(a,0,a.length-(null==b||d?1:b))};u.last=function(a,b,d){return null!=b&&!d?
h.call(a,Math.max(a.length-b,0)):a[a.length-1]};u.rest=u.tail=function(a,b,d){return h.call(a,null==b||d?1:b)};u.compact=function(a){return u.filter(a,function(a){return!!a})};u.flatten=function(a,b){return u.reduce(a,function(a,d){if(u.isArray(d))return a.concat(b?d:u.flatten(d));a[a.length]=d;return a},[])};u.without=function(a){return u.difference(a,h.call(arguments,1))};u.uniq=u.unique=function(a,b,d){d=d?u.map(a,d):a;var e=[];3>a.length&&(b=!0);u.reduce(d,function(d,f,h){if(b?u.last(d)!==f||
!d.length:!u.include(d,f))d.push(f),e.push(a[h]);return d},[]);return e};u.union=function(){return u.uniq(u.flatten(arguments,!0))};u.intersection=u.intersect=function(a){var b=h.call(arguments,1);return u.filter(u.uniq(a),function(a){return u.every(b,function(b){return 0<=u.indexOf(b,a)})})};u.difference=function(a){var b=u.flatten(h.call(arguments,1),!0);return u.filter(a,function(a){return!u.include(b,a)})};u.zip=function(){for(var a=h.call(arguments),b=u.max(u.pluck(a,"length")),d=Array(b),e=
0;e<b;e++)d[e]=u.pluck(a,""+e);return d};u.indexOf=function(a,b,d){if(null==a)return-1;var e;if(d)return d=u.sortedIndex(a,b),a[d]===b?d:-1;if(y&&a.indexOf===y)return a.indexOf(b);d=0;for(e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1};u.lastIndexOf=function(a,b){if(null==a)return-1;if(z&&a.lastIndexOf===z)return a.lastIndexOf(b);for(var d=a.length;d--;)if(d in a&&a[d]===b)return d;return-1};u.range=function(a,b,d){1>=arguments.length&&(b=a||0,a=0);d=arguments[2]||1;for(var e=Math.max(Math.ceil((b-
a)/d),0),f=0,h=Array(e);f<e;)h[f++]=a,a+=d;return h};var W=function(){};u.bind=function(a,b){var d,e;if(a.bind===F&&F)return F.apply(a,h.call(arguments,1));if(!u.isFunction(a))throw new TypeError;e=h.call(arguments,2);return d=function(){if(!(this instanceof d))return a.apply(b,e.concat(h.call(arguments)));W.prototype=a.prototype;var f=new W,k=a.apply(f,e.concat(h.call(arguments)));return Object(k)===k?k:f}};u.bindAll=function(a){var b=h.call(arguments,1);0==b.length&&(b=u.functions(a));C(b,function(b){a[b]=
u.bind(a[b],a)});return a};u.memoize=function(a,b){var d={};b||(b=u.identity);return function(){var e=b.apply(this,arguments);return u.has(d,e)?d[e]:d[e]=a.apply(this,arguments)}};u.delay=function(a,b){var d=h.call(arguments,2);return setTimeout(function(){return a.apply(null,d)},b)};u.defer=function(a){return u.delay.apply(u,[a,1].concat(h.call(arguments,1)))};u.throttle=function(a,b){var d,e,f,h,k,l,m=u.debounce(function(){k=h=!1},b);return function(){d=this;e=arguments;f||(f=setTimeout(function(){f=
null;k&&a.apply(d,e);m()},b));h?k=!0:l=a.apply(d,e);m();h=!0;return l}};u.debounce=function(a,b,d){var e;return function(){var f=this,h=arguments;d&&!e&&a.apply(f,h);clearTimeout(e);e=setTimeout(function(){e=null;d||a.apply(f,h)},b)}};u.once=function(a){var b=!1,d;return function(){if(b)return d;b=!0;return d=a.apply(this,arguments)}};u.wrap=function(a,b){return function(){var d=[a].concat(h.call(arguments,0));return b.apply(this,d)}};u.compose=function(){var a=arguments;return function(){for(var b=
arguments,d=a.length-1;0<=d;d--)b=[a[d].apply(this,b)];return b[0]}};u.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};u.keys=A||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],d;for(d in a)u.has(a,d)&&(b[b.length]=d);return b};u.values=function(a){return u.map(a,u.identity)};u.functions=u.methods=function(a){var b=[],d;for(d in a)u.isFunction(a[d])&&b.push(d);return b.sort()};u.extend=function(a){C(h.call(arguments,1),function(b){for(var d in b)a[d]=
b[d]});return a};u.pick=function(a){var b={};C(u.flatten(h.call(arguments,1)),function(d){d in a&&(b[d]=a[d])});return b};u.defaults=function(a){C(h.call(arguments,1),function(b){for(var d in b)null==a[d]&&(a[d]=b[d])});return a};u.clone=function(a){return!u.isObject(a)?a:u.isArray(a)?a.slice():u.extend({},a)};u.tap=function(a,b){b(a);return a};u.isEqual=function(b,d){return a(b,d,[])};u.isEmpty=function(a){if(null==a)return!0;if(u.isArray(a)||u.isString(a))return 0===a.length;for(var b in a)if(u.has(a,
b))return!1;return!0};u.isElement=function(a){return!!(a&&1==a.nodeType)};u.isArray=k||function(a){return"[object Array]"==m.call(a)};u.isObject=function(a){return a===Object(a)};u.isArguments=function(a){return"[object Arguments]"==m.call(a)};u.isArguments(arguments)||(u.isArguments=function(a){return!(!a||!u.has(a,"callee"))});u.isFunction=function(a){return"[object Function]"==m.call(a)};u.isString=function(a){return"[object String]"==m.call(a)};u.isNumber=function(a){return"[object Number]"==
m.call(a)};u.isFinite=function(a){return u.isNumber(a)&&isFinite(a)};u.isNaN=function(a){return a!==a};u.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==m.call(a)};u.isDate=function(a){return"[object Date]"==m.call(a)};u.isRegExp=function(a){return"[object RegExp]"==m.call(a)};u.isNull=function(a){return null===a};u.isUndefined=function(a){return void 0===a};u.has=function(a,b){return n.call(a,b)};u.noConflict=function(){d._=b;return this};u.identity=function(a){return a};u.times=
function(a,b,d){for(var e=0;e<a;e++)b.call(d,e)};u.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};u.result=function(a,b){if(null==a)return null;var d=a[b];return u.isFunction(d)?d.call(a):d};u.mixin=function(a){C(u.functions(a),function(b){J(b,u[b]=a[b])})};var E=0;u.uniqueId=function(a){var b=E++;return a?a+b:b};u.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,
escape:/<%-([\s\S]+?)%>/g};var M=/.^/,Y={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},ba;for(ba in Y)Y[Y[ba]]=ba;var L=/\\|'|\r|\n|\t|\u2028|\u2029/g,ca=/\\(\\|'|r|n|t|u2028|u2029)/g,aa=function(a){return a.replace(ca,function(a,b){return Y[b]})};u.template=function(a,b,d){d=u.defaults(d||{},u.templateSettings);a="__p+='"+a.replace(L,function(a){return"\\"+Y[a]}).replace(d.escape||M,function(a,b){return"'+\n_.escape("+aa(b)+")+\n'"}).replace(d.interpolate||M,function(a,b){return"'+\n("+
aa(b)+")+\n'"}).replace(d.evaluate||M,function(a,b){return"';\n"+aa(b)+"\n;__p+='"})+"';\n";d.variable||(a="with(obj||{}){\n"+a+"}\n");a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n";var e=new Function(d.variable||"obj","_",a);if(b)return e(b,u);b=function(a){return e.call(this,a,u)};b.source="function("+(d.variable||"obj")+"){\n"+a+"}";return b};u.chain=function(a){return u(a).chain()};var ga=function(a){this._wrapped=a};u.prototype=ga.prototype;
var T=function(a,b){return b?u(a).chain():a},J=function(a,b){ga.prototype[a]=function(){var a=h.call(arguments);l.call(a,this._wrapped);return T(b.apply(u,a),this._chain)}};u.mixin(u);C("pop push reverse shift sort splice unshift".split(" "),function(a){var b=f[a];ga.prototype[a]=function(){var d=this._wrapped;b.apply(d,arguments);var e=d.length;("shift"==a||"splice"==a)&&0===e&&delete d[0];return T(d,this._chain)}});C(["concat","join","slice"],function(a){var b=f[a];ga.prototype[a]=function(){return T(b.apply(this._wrapped,
arguments),this._chain)}});ga.prototype.chain=function(){this._chain=!0;return this};ga.prototype.value=function(){return this._wrapped}}).call(this);(function(a,d){function b(a){var b=a.length,d=q.type(a);return q.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===d||"function"!==d&&(0===b||"number"==typeof b&&0<b&&b-1 in a)}function e(a){var b=Ra[a]={};return q.each(a.match(ka)||[],function(a,d){b[d]=!0}),b}function f(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});this.expando=q.expando+Math.random()}function k(a,b,e){var f;if(e===d&&1===a.nodeType)if(f="data-"+b.replace(nb,"-$1").toLowerCase(),e=a.getAttribute(f),"string"==typeof e){try{e=
"true"===e?!0:"false"===e?!1:"null"===e?null:+e+""===e?+e:ob.test(e)?JSON.parse(e):e}catch(h){}ea.set(a,b,e)}else e=d;return e}function h(){return!0}function l(){return!1}function m(){try{return H.activeElement}catch(a){}}function n(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function p(a,b,d){if(q.isFunction(b))return q.grep(a,function(a,e){return!!b.call(a,e,a)!==d});if(b.nodeType)return q.grep(a,function(a){return a===b!==d});if("string"==typeof b){if(pb.test(b))return q.filter(b,a,d);b=q.filter(b,
a)}return q.grep(a,function(a){return 0<=xa.call(b,a)!==d})}function r(a,b){return q.nodeName(a,"table")&&q.nodeName(1===b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function s(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function v(a){var b=qb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function t(a,b){for(var d=a.length,e=0;d>e;e++)I.set(a[e],"globalEval",!b||I.get(b[e],"globalEval"))}
function x(a,b){var d,e,f,h,k,l;if(1===b.nodeType){if(I.hasData(a)&&(d=I.access(a),e=q.extend({},d),l=d.events,I.set(b,e),l))for(f in delete e.handle,e.events={},l){d=0;for(e=l[f].length;e>d;d++)q.event.add(b,f,l[f][d])}ea.hasData(a)&&(h=ea.access(a),k=q.extend({},h),ea.set(b,k))}}function w(a,b){var e=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return b===d||b&&q.nodeName(a,b)?q.merge([a],e):e}function y(a,b){if(b in a)return b;for(var d=
b.charAt(0).toUpperCase()+b.slice(1),e=b,f=Ta.length;f--;)if(b=Ta[f]+d,b in a)return b;return e}function z(a,b){return a=b||a,"none"===q.css(a,"display")||!q.contains(a.ownerDocument,a)}function A(a,b){for(var d,e,f,h=[],k=0,l=a.length;l>k;k++)e=a[k],e.style&&(h[k]=I.get(e,"olddisplay"),d=e.style.display,b?(h[k]||"none"!==d||(e.style.display=""),""===e.style.display&&z(e)&&(h[k]=I.access(e,"olddisplay",B(e.nodeName)))):h[k]||(f=z(e),(d&&"none"!==d||!f)&&I.set(e,"olddisplay",f?d:q.css(e,"display"))));
for(k=0;l>k;k++)e=a[k],e.style&&(b&&"none"!==e.style.display&&""!==e.style.display||(e.style.display=b?h[k]||"":"none"));return a}function F(a,b,d){return(a=rb.exec(b))?Math.max(0,a[1]-(d||0))+(a[2]||"px"):b}function u(a,b,d,e,f){b=d===(e?"border":"content")?4:"width"===b?1:0;for(var h=0;4>b;b+=2)"margin"===d&&(h+=q.css(a,d+ra[b],!0,f)),e?("content"===d&&(h-=q.css(a,"padding"+ra[b],!0,f)),"margin"!==d&&(h-=q.css(a,"border"+ra[b]+"Width",!0,f))):(h+=q.css(a,"padding"+ra[b],!0,f),"padding"!==d&&(h+=
q.css(a,"border"+ra[b]+"Width",!0,f)));return h}function C(b,d,e){var f=!0,h="width"===d?b.offsetWidth:b.offsetHeight,k=a.getComputedStyle(b,null),l=q.support.boxSizing&&"border-box"===q.css(b,"boxSizing",!1,k);if(0>=h||null==h){if(h=sa(b,d,k),(0>h||null==h)&&(h=b.style[d]),Ja.test(h))return h;f=l&&(q.support.boxSizingReliable||h===b.style[d]);h=parseFloat(h)||0}return h+u(b,d,e||(l?"border":"content"),f,k)+"px"}function B(a){var b=H,d=Ua[a];return d||(d=W(a,b),"none"!==d&&d||(ta=(ta||q("<iframe frameborder='0' width='0' height='0'/>").css("cssText",
"display:block !important")).appendTo(b.documentElement),b=(ta[0].contentWindow||ta[0].contentDocument).document,b.write("<!doctype html><html><body>"),b.close(),d=W(a,b),ta.detach()),Ua[a]=d),d}function W(a,b){var d=q(b.createElement(a)).appendTo(b.body),e=q.css(d[0],"display");return d.remove(),e}function E(a,b,d,e){var f;if(q.isArray(b))q.each(b,function(b,f){d||sb.test(a)?e(a,f):E(a+"["+("object"==typeof f?b:"")+"]",f,d,e)});else if(d||"object"!==q.type(b))e(a,b);else for(f in b)E(a+"["+f+"]",
b[f],d,e)}function M(a){return function(b,d){"string"!=typeof b&&(d=b,b="*");var e,f=0,h=b.toLowerCase().match(ka)||[];if(q.isFunction(d))for(;e=h[f++];)"+"===e[0]?(e=e.slice(1)||"*",(a[e]=a[e]||[]).unshift(d)):(a[e]=a[e]||[]).push(d)}}function Y(a,b,e,f){function h(m){var n;return k[m]=!0,q.each(a[m]||[],function(a,m){var G=m(b,e,f);return"string"!=typeof G||l||k[G]?l?!(n=G):d:(b.dataTypes.unshift(G),h(G),!1)}),n}var k={},l=a===Ka;return h(b.dataTypes[0])||!k["*"]&&h("*")}function ba(a,b){var e,
f,h=q.ajaxSettings.flatOptions||{};for(e in b)b[e]!==d&&((h[e]?a:f||(f={}))[e]=b[e]);return f&&q.extend(!0,a,f),a}function L(){return setTimeout(function(){ua=d}),ua=q.now()}function ca(a,b){q.each(b,function(b,d){for(var e=(na[b]||[]).concat(na["*"]),f=0,h=e.length;h>f&&!e[f].call(a,b,d);f++);})}function aa(a,b,d){var e,f=0,h=Fa.length,k=q.Deferred().always(function(){delete l.elem}),l=function(){if(e)return!1;for(var b=ua||L(),b=Math.max(0,m.startTime+m.duration-b),d=1-(b/m.duration||0),f=0,h=m.tweens.length;h>
f;f++)m.tweens[f].run(d);return k.notifyWith(a,[m,d,b]),1>d&&h?b:(k.resolveWith(a,[m]),!1)},m=k.promise({elem:a,props:q.extend({},b),opts:q.extend(!0,{specialEasing:{}},d),originalProperties:b,originalOptions:d,startTime:ua||L(),duration:d.duration,tweens:[],createTween:function(b,d){var e=q.Tween(a,m.opts,b,d,m.opts.specialEasing[b]||m.opts.easing);return m.tweens.push(e),e},stop:function(b){var d=0,f=b?m.tweens.length:0;if(e)return this;for(e=!0;f>d;d++)m.tweens[d].run(1);return b?k.resolveWith(a,
[m,b]):k.rejectWith(a,[m,b]),this}});d=m.props;for(ga(d,m.opts.specialEasing);h>f;f++)if(b=Fa[f].call(m,a,d,m.opts))return b;return ca(m,d),q.isFunction(m.opts.start)&&m.opts.start.call(a,m),q.fx.timer(q.extend(l,{elem:a,anim:m,queue:m.opts.queue})),m.progress(m.opts.progress).done(m.opts.done,m.opts.complete).fail(m.opts.fail).always(m.opts.always)}function ga(a,b){var d,e,f,h,k;for(d in a)if(e=q.camelCase(d),f=b[e],h=a[d],q.isArray(h)&&(f=h[1],h=a[d]=h[0]),d!==e&&(a[e]=h,delete a[d]),k=q.cssHooks[e],
k&&"expand"in k)for(d in h=k.expand(h),delete a[e],h)d in a||(a[d]=h[d],b[d]=f);else b[e]=f}function T(a,b,d,e,f){return new T.prototype.init(a,b,d,e,f)}function J(a,b){var d,e={height:a},f=0;for(b=b?1:0;4>f;f+=2-b)d=ra[f],e["margin"+d]=e["padding"+d]=a;return b&&(e.opacity=e.width=a),e}var U,K,X=typeof d,Q=a.location,H=a.document,la=H.documentElement,pa=a.jQuery,ia=a.$,ma={},Ga=[],Va=Ga.concat,La=Ga.push,va=Ga.slice,xa=Ga.indexOf,tb=ma.toString,Ma=ma.hasOwnProperty,ub="2.0.0".trim,q=function(a,b){return new q.fn.init(a,
b,U)},Ha=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ka=/\S+/g,vb=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,Wa=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,wb=/^-ms-/,xb=/-([\da-z])/gi,yb=function(a,b){return b.toUpperCase()},wa=function(){H.removeEventListener("DOMContentLoaded",wa,!1);a.removeEventListener("load",wa,!1);q.ready()};q.fn=q.prototype={jquery:"2.0.0",constructor:q,init:function(a,b,e){var f,h;if(!a)return this;if("string"==typeof a){if(f="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?[null,a,
null]:vb.exec(a),!f||!f[1]&&b)return!b||b.jquery?(b||e).find(a):this.constructor(b).find(a);if(f[1]){if(b=b instanceof q?b[0]:b,q.merge(this,q.parseHTML(f[1],b&&b.nodeType?b.ownerDocument||b:H,!0)),Wa.test(f[1])&&q.isPlainObject(b))for(f in b)q.isFunction(this[f])?this[f](b[f]):this.attr(f,b[f]);return this}return h=H.getElementById(f[2]),h&&h.parentNode&&(this.length=1,this[0]=h),this.context=H,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):q.isFunction(a)?e.ready(a):
(a.selector!==d&&(this.selector=a.selector,this.context=a.context),q.makeArray(a,this))},selector:"",length:0,toArray:function(){return va.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a){a=q.merge(this.constructor(),a);return a.prevObject=this,a.context=this.context,a},each:function(a,b){return q.each(this,a,b)},ready:function(a){return q.ready.promise().done(a),this},slice:function(){return this.pushStack(va.apply(this,arguments))},
first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length;a=+a+(0>a?b:0);return this.pushStack(0<=a&&b>a?[this[a]]:[])},map:function(a){return this.pushStack(q.map(this,function(b,d){return a.call(b,d,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:La,sort:[].sort,splice:[].splice};q.fn.init.prototype=q.fn;q.extend=q.fn.extend=function(){var a,b,e,f,h,k,l=arguments[0]||{},m=1,n=arguments.length,p=!1;"boolean"==typeof l&&(p=
l,l=arguments[1]||{},m=2);"object"==typeof l||q.isFunction(l)||(l={});for(n===m&&(l=this,--m);n>m;m++)if(null!=(a=arguments[m]))for(b in a)e=l[b],f=a[b],l!==f&&(p&&f&&(q.isPlainObject(f)||(h=q.isArray(f)))?(h?(h=!1,k=e&&q.isArray(e)?e:[]):k=e&&q.isPlainObject(e)?e:{},l[b]=q.extend(p,k,f)):f!==d&&(l[b]=f));return l};q.extend({expando:"jQuery"+("2.0.0"+Math.random()).replace(/\D/g,""),noConflict:function(b){return a.$===q&&(a.$=ia),b&&a.jQuery===q&&(a.jQuery=pa),q},isReady:!1,readyWait:1,holdReady:function(a){a?
q.readyWait++:q.ready(!0)},ready:function(a){(!0===a?--q.readyWait:q.isReady)||(q.isReady=!0,!0!==a&&0<--q.readyWait||(K.resolveWith(H,[q]),q.fn.trigger&&q(H).trigger("ready").off("ready")))},isFunction:function(a){return"function"===q.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?ma[tb.call(a)]||"object":typeof a},isPlainObject:function(a){if("object"!==
q.type(a)||a.nodeType||q.isWindow(a))return!1;try{if(a.constructor&&!Ma.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}return!0},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw Error(a);},parseHTML:function(a,b,d){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(d=b,b=!1);b=b||H;var e=Wa.exec(a);d=!d&&[];return e?[b.createElement(e[1])]:(e=q.buildFragment([a],b,d),d&&q(d).remove(),q.merge([],e.childNodes))},parseJSON:JSON.parse,
parseXML:function(a){var b,e;if(!a||"string"!=typeof a)return null;try{e=new DOMParser,b=e.parseFromString(a,"text/xml")}catch(f){b=d}return(!b||b.getElementsByTagName("parsererror").length)&&q.error("Invalid XML: "+a),b},noop:function(){},globalEval:function(a){var b,d=eval;(a=q.trim(a))&&(1===a.indexOf("use strict")?(b=H.createElement("script"),b.text=a,H.head.appendChild(b).parentNode.removeChild(b)):d(a))},camelCase:function(a){return a.replace(wb,"ms-").replace(xb,yb)},nodeName:function(a,b){return a.nodeName&&
a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,d,e){var f,h=0,k=a.length,l=b(a);if(e)if(l)for(;k>h&&!(f=d.apply(a[h],e),!1===f);h++);else for(h in a){if(f=d.apply(a[h],e),!1===f)break}else if(l)for(;k>h&&!(f=d.call(a[h],h,a[h]),!1===f);h++);else for(h in a)if(f=d.call(a[h],h,a[h]),!1===f)break;return a},trim:function(a){return null==a?"":ub.call(a)},makeArray:function(a,d){var e=d||[];return null!=a&&(b(Object(a))?q.merge(e,"string"==typeof a?[a]:a):La.call(e,a)),e},inArray:function(a,
b,d){return null==b?-1:xa.call(b,a,d)},merge:function(a,b){var e=b.length,f=a.length,h=0;if("number"==typeof e)for(;e>h;h++)a[f++]=b[h];else for(;b[h]!==d;)a[f++]=b[h++];return a.length=f,a},grep:function(a,b,d){var e,f=[],h=0,k=a.length;for(d=!!d;k>h;h++)e=!!b(a[h],h),d!==e&&f.push(a[h]);return f},map:function(a,d,e){var f,h=0,k=a.length,l=[];if(b(a))for(;k>h;h++)f=d(a[h],h,e),null!=f&&(l[l.length]=f);else for(h in a)f=d(a[h],h,e),null!=f&&(l[l.length]=f);return Va.apply([],l)},guid:1,proxy:function(a,
b){var e,f,h;return"string"==typeof b&&(e=a[b],b=a,a=e),q.isFunction(a)?(f=va.call(arguments,2),h=function(){return a.apply(b||this,f.concat(va.call(arguments)))},h.guid=a.guid=a.guid||q.guid++,h):d},access:function(a,b,e,f,h,k,l){var m=0,n=a.length,p=null==e;if("object"===q.type(e))for(m in h=!0,e)q.access(a,b,m,e[m],!0,k,l);else if(f!==d&&(h=!0,q.isFunction(f)||(l=!0),p&&(l?(b.call(a,f),b=null):(p=b,b=function(a,b,d){return p.call(q(a),d)})),b))for(;n>m;m++)b(a[m],e,l?f:f.call(a[m],m,b(a[m],e)));
return h?a:p?b.call(a):n?b(a[0],e):k},now:Date.now,swap:function(a,b,d,e){var f,h={};for(f in b)h[f]=a.style[f],a.style[f]=b[f];d=d.apply(a,e||[]);for(f in b)a.style[f]=h[f];return d}});q.ready.promise=function(b){return K||(K=q.Deferred(),"complete"===H.readyState?setTimeout(q.ready):(H.addEventListener("DOMContentLoaded",wa,!1),a.addEventListener("load",wa,!1))),K.promise(b)};q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){ma["[object "+b+"]"]=b.toLowerCase()});
U=q(H);(function(a,b){function d(a){return Ia.test(a+"")}function e(){var a,b=[];return a=function(d,e){return b.push(d+=" ")>E.cacheLength&&delete a[b.shift()],a[d]=e}}function f(a){return a[fa]=!0,a}function h(a){var b=L.createElement("div");try{return!!a(b)}catch(d){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}}function k(a,b,d,e){var f,h,l,m,n;if((b?b.ownerDocument||b:X)!==L&&I(b),b=b||L,d=d||[],!a||"string"!=typeof a)return d;if(1!==(m=b.nodeType)&&9!==m)return[];if(ca&&!e){if(f=
Ja.exec(a))if(l=f[1])if(9===m){if(h=b.getElementById(l),!h||!h.parentNode)return d;if(h.id===l)return d.push(h),d}else{if(b.ownerDocument&&(h=b.ownerDocument.getElementById(l))&&T(b,h)&&h.id===l)return d.push(h),d}else{if(f[2])return ya.apply(d,b.getElementsByTagName(a)),d;if((l=f[3])&&da.getElementsByClassName&&b.getElementsByClassName)return ya.apply(d,b.getElementsByClassName(l)),d}if(da.qsa&&(!K||!K.test(a))){if(h=f=fa,l=b,n=9===m&&a,1===m&&"object"!==b.nodeName.toLowerCase()){m=v(a);(f=b.getAttribute("id"))?
h=f.replace(Ma,"\\$&"):b.setAttribute("id",h);h="[id='"+h+"'] ";for(l=m.length;l--;)m[l]=h+t(m[l]);l=xa.test(a)&&b.parentNode||b;n=m.join(",")}if(n)try{return ya.apply(d,l.querySelectorAll(n)),d}catch(G){}finally{f||b.removeAttribute("id")}}}var p;a:{a=a.replace(na,"$1");var q,Z;h=v(a);if(!e&&1===h.length){if(p=h[0]=h[0].slice(0),2<p.length&&"ID"===(q=p[0]).type&&9===b.nodeType&&ca&&E.relative[p[1].type]){if(b=(E.find.ID(q.matches[0].replace(za,Aa),b)||[])[0],!b){p=d;break a}a=a.slice(p.shift().value.length)}for(m=
wa.needsContext.test(a)?0:p.length;m--&&!(q=p[m],E.relative[f=q.type]);)if((Z=E.find[f])&&(e=Z(q.matches[0].replace(za,Aa),xa.test(p[0].type)&&b.parentNode||b))){if(p.splice(m,1),a=e.length&&t(p),!a){p=(ya.apply(d,e),d);break a}break}}p=(Y(a,h)(e,b,!ca,d,xa.test(a)),d)}return p}function l(a,b){var d=b&&a,e=d&&(~b.sourceIndex||ma)-(~a.sourceIndex||ma);if(e)return e;if(d)for(;d=d.nextSibling;)if(d===b)return-1;return a?1:-1}function m(a,d,e){var f;return e?b:(f=a.getAttributeNode(d))&&f.specified?f.value:
!0===a[d]?d.toLowerCase():null}function n(a,d,e){return e?b:a.getAttribute(d,"type"===d.toLowerCase()?1:2)}function p(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function r(a){return function(b){var d=b.nodeName.toLowerCase();return("input"===d||"button"===d)&&b.type===a}}function s(a){return f(function(b){return b=+b,f(function(d,e){for(var f,h=a([],d.length,b),k=h.length;k--;)d[f=h[k]]&&(d[f]=!(e[f]=d[f]))})})}function v(a,b){var d,e,f,h,l,m,n;if(l=ja[a+" "])return b?
0:l.slice(0);l=a;m=[];for(n=E.preFilter;l;){(!d||(e=Ca.exec(l)))&&(e&&(l=l.slice(e[0].length)||l),m.push(f=[]));d=!1;(e=Da.exec(l))&&(d=e.shift(),f.push({value:d,type:e[0].replace(na," ")}),l=l.slice(d.length));for(h in E.filter)!(e=wa[h].exec(l))||n[h]&&!(e=n[h](e))||(d=e.shift(),f.push({value:d,type:h,matches:e}),l=l.slice(d.length));if(!d)break}return b?l.length:l?k.error(a):ja(a,m).slice(0)}function t(a){for(var b=0,d=a.length,e="";d>b;b++)e+=a[b].value;return e}function u(a,b,d){var e=b.dir,
f=d&&"parentNode"===e,h=ga++;return b.first?function(b,d,h){for(;b=b[e];)if(1===b.nodeType||f)return a(b,d,h)}:function(b,d,k){var l,m,n,G=aa+" "+h;if(k)for(;b=b[e];){if((1===b.nodeType||f)&&a(b,d,k))return!0}else for(;b=b[e];)if(1===b.nodeType||f)if(n=b[fa]||(b[fa]={}),(m=n[e])&&m[0]===G){if(!0===(l=m[1])||l===C)return!0===l}else if(m=n[e]=[G],m[1]=a(b,d,k)||C,!0===m[1])return!0}}function y(a){return 1<a.length?function(b,d,e){for(var f=a.length;f--;)if(!a[f](b,d,e))return!1;return!0}:a[0]}function x(a,
b,d,e,f){for(var h,k=[],l=0,m=a.length,n=null!=b;m>l;l++)(h=a[l])&&(!d||d(h,e,f))&&(k.push(h),n&&b.push(l));return k}function w(a,b,d,e,h,l){return e&&!e[fa]&&(e=w(e)),h&&!h[fa]&&(h=w(h,l)),f(function(f,l,m,n){var G,p,q=[],Z=[],r=l.length,O;if(!(O=f)){O=b||"*";for(var s=m.nodeType?[m]:m,v=[],Ea=0,t=s.length;t>Ea;Ea++)k(O,s[Ea],v);O=v}O=!a||!f&&b?O:x(O,q,a,m,n);s=d?h||(f?a:r||e)?[]:l:O;if(d&&d(O,s,m,n),e){G=x(s,Z);e(G,[],m,n);for(m=G.length;m--;)(p=G[m])&&(s[Z[m]]=!(O[Z[m]]=p))}if(f){if(h||a){if(h){G=
[];for(m=s.length;m--;)(p=s[m])&&G.push(O[m]=p);h(null,s=[],G,n)}for(m=s.length;m--;)(p=s[m])&&-1<(G=h?Ba.call(f,p):q[m])&&(f[G]=!(l[G]=p))}}else s=x(s===l?s.splice(r,s.length):s),h?h(null,l,s,n):ya.apply(l,s)})}function z(a){var b,d,e,f=a.length,h=E.relative[a[0].type];d=h||E.relative[" "];for(var k=h?1:0,l=u(function(a){return a===b},d,!0),m=u(function(a){return-1<Ba.call(b,a)},d,!0),n=[function(a,d,e){return!h&&(e||d!==ba)||((b=d).nodeType?l(a,d,e):m(a,d,e))}];f>k;k++)if(d=E.relative[a[k].type])n=
[u(y(n),d)];else{if(d=E.filter[a[k].type].apply(null,a[k].matches),d[fa]){for(e=++k;f>e&&!E.relative[a[e].type];e++);return w(1<k&&y(n),1<k&&t(a.slice(0,k-1)).replace(na,"$1"),d,e>k&&z(a.slice(k,e)),f>e&&z(a=a.slice(e)),f>e&&t(a))}n.push(d)}return y(n)}function A(a,b){var d=0,e=0<b.length,h=0<a.length,l=function(f,l,m,n,G){var p,q,Z=[],r=0,O="0",s=f&&[],v=null!=G,Ea=ba,t=f||h&&E.find.TAG("*",G&&l.parentNode||l),Sa=aa+=null==Ea?1:Math.random()||0.1;for(v&&(ba=l!==L&&l,C=d);null!=(G=t[O]);O++){if(h&&
G){for(p=0;q=a[p++];)if(q(G,l,m)){n.push(G);break}v&&(aa=Sa,C=++d)}e&&((G=!q&&G)&&r--,f&&s.push(G))}if(r+=O,e&&O!==r){for(p=0;q=b[p++];)q(s,Z,l,m);if(f){if(0<r)for(;O--;)s[O]||Z[O]||(Z[O]=ra.call(n));Z=x(Z)}ya.apply(n,Z);v&&!f&&0<Z.length&&1<r+b.length&&k.uniqueSort(n)}return v&&(aa=Sa,ba=Ea),s};return e?f(l):l}function F(){}var B,C,E,M,W,Y,ba,H,I,L,J,ca,K,Q,U,T,fa="sizzle"+-new Date,X=a.document,da={},aa=0,ga=0,ea=e(),ja=e(),pa=e(),la=!1,ka=function(){return 0},ia=typeof b,ma=-2147483648,ha=[],ra=
ha.pop,va=ha.push,ya=ha.push,oa=ha.slice,Ba=ha.indexOf||function(a){for(var b=0,d=this.length;d>b;b++)if(this[b]===a)return b;return-1},sa="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),ua="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+sa+")|)|)[\\x20\\t\\r\\n\\f]*\\]",ta=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ua.replace(3,8)+")*)|.*)\\)|)",
na=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,Ca=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Da=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,xa=/[\x20\t\r\n\f]*[+~]/,Fa=/=[\x20\t\r\n\f]*([^\]'"]*)[\x20\t\r\n\f]*\]/g,Ga=RegExp(ta),Ha=RegExp("^"+sa+"$"),wa={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+ua),PSEUDO:RegExp("^"+ta),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)",
"i"),"boolean":RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Ia=/^[^{]+\{\s*\[native \w/,Ja=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Ka=/^(?:input|select|textarea|button)$/i,La=/^h\d$/i,Ma=/'|\\/g,za=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,Aa=
function(a,b){var d="0x"+b-65536;return d!==d?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(55296|d>>10,56320|1023&d)};try{ya.apply(ha=oa.call(X.childNodes),X.childNodes),ha[X.childNodes.length].nodeType}catch(Na){ya={apply:ha.length?function(a,b){va.apply(a,oa.call(b))}:function(a,b){for(var d=a.length,e=0;a[d++]=b[e++];);a.length=d-1}}}W=k.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1};I=k.setDocument=function(a){var e=a?a.ownerDocument||a:X;
return e!==L&&9===e.nodeType&&e.documentElement?(L=e,J=e.documentElement,ca=!W(e),da.getElementsByTagName=h(function(a){return a.appendChild(e.createComment("")),!a.getElementsByTagName("*").length}),da.attributes=h(function(a){return a.className="i",!a.getAttribute("className")}),da.getElementsByClassName=h(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),da.sortDetached=h(function(a){return 1&a.compareDocumentPosition(L.createElement("div"))}),
da.getById=h(function(a){return J.appendChild(a).id=fa,!e.getElementsByName||!e.getElementsByName(fa).length}),da.getById?(E.find.ID=function(a,b){if(typeof b.getElementById!==ia&&ca){var d=b.getElementById(a);return d&&d.parentNode?[d]:[]}},E.filter.ID=function(a){var b=a.replace(za,Aa);return function(a){return a.getAttribute("id")===b}}):(E.find.ID=function(a,d){if(typeof d.getElementById!==ia&&ca){var e=d.getElementById(a);return e?e.id===a||typeof e.getAttributeNode!==ia&&e.getAttributeNode("id").value===
a?[e]:b:[]}},E.filter.ID=function(a){var b=a.replace(za,Aa);return function(a){return(a=typeof a.getAttributeNode!==ia&&a.getAttributeNode("id"))&&a.value===b}}),E.find.TAG=da.getElementsByTagName?function(a,d){return typeof d.getElementsByTagName!==ia?d.getElementsByTagName(a):b}:function(a,b){var d,e=[],f=0,h=b.getElementsByTagName(a);if("*"===a){for(;d=h[f++];)1===d.nodeType&&e.push(d);return e}return h},E.find.CLASS=da.getElementsByClassName&&function(a,d){return typeof d.getElementsByClassName!==
ia&&ca?d.getElementsByClassName(a):b},Q=[],K=[],(da.qsa=d(e.querySelectorAll))&&(h(function(a){a.innerHTML="<select><option selected=''></option></select>";a.querySelectorAll("[selected]").length||K.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");a.querySelectorAll(":checked").length||K.push(":checked")}),h(function(a){var b=L.createElement("input");b.setAttribute("type","hidden");a.appendChild(b).setAttribute("t",
"");a.querySelectorAll("[t^='']").length&&K.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");a.querySelectorAll(":enabled").length||K.push(":enabled",":disabled");a.querySelectorAll("*,:x");K.push(",.*:")})),(da.matchesSelector=d(U=J.webkitMatchesSelector||J.mozMatchesSelector||J.oMatchesSelector||J.msMatchesSelector))&&h(function(a){da.disconnectedMatch=U.call(a,"div");U.call(a,"[s!='']:x");Q.push("!=",ta)}),K=K.length&&RegExp(K.join("|")),Q=Q.length&&RegExp(Q.join("|")),T=d(J.contains)||J.compareDocumentPosition?
function(a,b){var d=9===a.nodeType?a.documentElement:a,e=b&&b.parentNode;return a===e||!(!e||1!==e.nodeType||!(d.contains?d.contains(e):a.compareDocumentPosition&&16&a.compareDocumentPosition(e)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},ka=J.compareDocumentPosition?function(a,b){if(a===b)return la=!0,0;var d=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b);return d?1&d||!da.sortDetached&&b.compareDocumentPosition(a)===d?a===e||T(X,a)?
-1:b===e||T(X,b)?1:H?Ba.call(H,a)-Ba.call(H,b):0:4&d?-1:1:a.compareDocumentPosition?-1:1}:function(a,b){var d,f=0;d=a.parentNode;var h=b.parentNode,k=[a],m=[b];if(a===b)return la=!0,0;if(!d||!h)return a===e?-1:b===e?1:d?-1:h?1:H?Ba.call(H,a)-Ba.call(H,b):0;if(d===h)return l(a,b);for(d=a;d=d.parentNode;)k.unshift(d);for(d=b;d=d.parentNode;)m.unshift(d);for(;k[f]===m[f];)f++;return f?l(k[f],m[f]):k[f]===X?-1:m[f]===X?1:0},L):L};k.matches=function(a,b){return k(a,null,null,b)};k.matchesSelector=function(a,
b){if((a.ownerDocument||a)!==L&&I(a),b=b.replace(Fa,"='$1']"),!(!da.matchesSelector||!ca||Q&&Q.test(b)||K&&K.test(b)))try{var d=U.call(a,b);if(d||da.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return 0<k(b,L,null,[a]).length};k.contains=function(a,b){return(a.ownerDocument||a)!==L&&I(a),T(a,b)};k.attr=function(a,d){(a.ownerDocument||a)!==L&&I(a);var e=E.attrHandle[d.toLowerCase()],e=e&&e(a,d,!ca);return e===b?da.attributes||!ca?a.getAttribute(d):(e=a.getAttributeNode(d))&&
e.specified?e.value:null:e};k.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};k.uniqueSort=function(a){var b,d=[],e=0,f=0;if(la=!da.detectDuplicates,H=!da.sortStable&&a.slice(0),a.sort(ka),la){for(;b=a[f++];)b===a[f]&&(e=d.push(f));for(;e--;)a.splice(d[e],1)}return a};M=k.getText=function(a){var b,d="",e=0;if(b=a.nodeType)if(1===b||9===b||11===b){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)d+=M(a)}else{if(3===b||4===b)return a.nodeValue}else for(;b=
a[e];e++)d+=M(b);return d};E=k.selectors={cacheLength:50,createPseudo:f,match:wa,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(za,Aa),a[3]=(a[4]||a[5]||"").replace(za,Aa),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||k.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*
("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&k.error(a[0]),a},PSEUDO:function(a){var b,d=!a[5]&&a[2];return wa.CHILD.test(a[0])?null:(a[4]?a[2]=a[4]:d&&Ga.test(d)&&(b=v(d,!0))&&(b=d.indexOf(")",d.length-b)-d.length)&&(a[0]=a[0].slice(0,b),a[2]=d.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(za,Aa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=ea[a+" "];return b||
(b=RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))&&ea(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==ia&&a.getAttribute("class")||"")})},ATTR:function(a,b,d){return function(e){e=k.attr(e,a);return null==e?"!="===b:b?(e+="","="===b?e===d:"!="===b?e!==d:"^="===b?d&&0===e.indexOf(d):"*="===b?d&&-1<e.indexOf(d):"$="===b?d&&e.slice(-d.length)===d:"~="===b?-1<(" "+e+" ").indexOf(d):"|="===b?e===d||e.slice(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,
b,d,e,f){var h="nth"!==a.slice(0,3),k="last"!==a.slice(-4),l="of-type"===b;return 1===e&&0===f?function(a){return!!a.parentNode}:function(b,d,m){var n,G,p,q,Z;d=h!==k?"nextSibling":"previousSibling";var r=b.parentNode,O=l&&b.nodeName.toLowerCase();m=!m&&!l;if(r){if(h){for(;d;){for(G=b;G=G[d];)if(l?G.nodeName.toLowerCase()===O:1===G.nodeType)return!1;Z=d="only"===a&&!Z&&"nextSibling"}return!0}if(Z=[k?r.firstChild:r.lastChild],k&&m){m=r[fa]||(r[fa]={});n=m[a]||[];q=n[0]===aa&&n[1];p=n[0]===aa&&n[2];
for(G=q&&r.childNodes[q];G=++q&&G&&G[d]||(p=q=0)||Z.pop();)if(1===G.nodeType&&++p&&G===b){m[a]=[aa,q,p];break}}else if(m&&(n=(b[fa]||(b[fa]={}))[a])&&n[0]===aa)p=n[1];else for(;(G=++q&&G&&G[d]||(p=q=0)||Z.pop())&&(!(l?G.nodeName.toLowerCase()===O:1===G.nodeType)||!++p||!(m&&((G[fa]||(G[fa]={}))[a]=[aa,p]),G===b)););return p-=f,p===e||0===p%e&&0<=p/e}}},PSEUDO:function(a,b){var d,e=E.pseudos[a]||E.setFilters[a.toLowerCase()]||k.error("unsupported pseudo: "+a);return e[fa]?e(b):1<e.length?(d=[a,a,"",
b],E.setFilters.hasOwnProperty(a.toLowerCase())?f(function(a,d){for(var f,h=e(a,b),k=h.length;k--;)f=Ba.call(a,h[k]),a[f]=!(d[f]=h[k])}):function(a){return e(a,0,d)}):e}},pseudos:{not:f(function(a){var b=[],d=[],e=Y(a.replace(na,"$1"));return e[fa]?f(function(a,b,d,f){var h;d=e(a,null,f,[]);for(f=a.length;f--;)(h=d[f])&&(a[f]=!(b[f]=h))}):function(a,f,h){return b[0]=a,e(b,null,h,d),!d.pop()}}),has:f(function(a){return function(b){return 0<k(a,b).length}}),contains:f(function(a){return function(b){return-1<
(b.textContent||b.innerText||M(b)).indexOf(a)}}),lang:f(function(a){return Ha.test(a||"")||k.error("unsupported lang: "+a),a=a.replace(za,Aa).toLowerCase(),function(b){var d;do if(d=ca?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return d=d.toLowerCase(),d===a||0===d.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var d=a.location&&a.location.hash;return d&&d.slice(1)===b.id},root:function(a){return a===J},focus:function(a){return a===L.activeElement&&
(!L.hasFocus||L.hasFocus())&&!(!a.type&&!a.href&&!~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if("@"<a.nodeName||3===a.nodeType||4===a.nodeType)return!1;return!0},parent:function(a){return!E.pseudos.empty(a)},
header:function(a){return La.test(a.nodeName)},input:function(a){return Ka.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||b.toLowerCase()===a.type)},first:s(function(){return[0]}),last:s(function(a,b){return[b-1]}),eq:s(function(a,b,d){return[0>d?d+b:d]}),even:s(function(a,b){for(var d=0;b>d;d+=2)a.push(d);return a}),
odd:s(function(a,b){for(var d=1;b>d;d+=2)a.push(d);return a}),lt:s(function(a,b,d){for(b=0>d?d+b:d;0<=--b;)a.push(b);return a}),gt:s(function(a,b,d){for(d=0>d?d+b:d;b>++d;)a.push(d);return a})}};for(B in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})E.pseudos[B]=p(B);for(B in{submit:!0,reset:!0})E.pseudos[B]=r(B);Y=k.compile=function(a,b){var d,e=[],f=[],h=pa[a+" "];if(!h){b||(b=v(a));for(d=b.length;d--;)h=z(b[d]),h[fa]?e.push(h):f.push(h);h=pa(a,A(f,e))}return h};E.pseudos.nth=E.pseudos.eq;
F.prototype=E.filters=E.pseudos;E.setFilters=new F;da.sortStable=fa.split("").sort(ka).join("")===fa;I();[0,0].sort(ka);da.detectDuplicates=la;h(function(a){if(a.innerHTML="<a href='#'></a>","#"!==a.firstChild.getAttribute("href")){a=["type","href","height","width"];for(var b=a.length;b--;)E.attrHandle[a[b]]=n}});h(function(a){if(null!=a.getAttribute("disabled")){a="checked selected async autofocus autoplay controls defer disabled hidden ismap loop multiple open readonly required scoped".split(" ");
for(var b=a.length;b--;)E.attrHandle[a[b]]=m}});q.find=k;q.expr=k.selectors;q.expr[":"]=q.expr.pseudos;q.unique=k.uniqueSort;q.text=k.getText;q.isXMLDoc=k.isXML;q.contains=k.contains})(a);var Ra={};q.Callbacks=function(a){a="string"==typeof a?Ra[a]||e(a):q.extend({},a);var b,f,h,k,l,m,n=[],p=!a.once&&[],r=function(d){b=a.memory&&d;f=!0;m=k||0;k=0;l=n.length;for(h=!0;n&&l>m;m++)if(!1===n[m].apply(d[0],d[1])&&a.stopOnFalse){b=!1;break}h=!1;n&&(p?p.length&&r(p.shift()):b?n=[]:s.disable())},s={add:function(){if(n){var d=
n.length;(function zb(b){q.each(b,function(b,d){var e=q.type(d);"function"===e?a.unique&&s.has(d)||n.push(d):d&&d.length&&"string"!==e&&zb(d)})})(arguments);h?l=n.length:b&&(k=d,r(b))}return this},remove:function(){return n&&q.each(arguments,function(a,b){for(var d;-1<(d=q.inArray(b,n,d));)n.splice(d,1),h&&(l>=d&&l--,m>=d&&m--)}),this},has:function(a){return a?-1<q.inArray(a,n):!(!n||!n.length)},empty:function(){return n=[],l=0,this},disable:function(){return n=p=b=d,this},disabled:function(){return!n},
lock:function(){return p=d,b||s.disable(),this},locked:function(){return!p},fireWith:function(a,b){return b=b||[],b=[a,b.slice?b.slice():b],!n||f&&!p||(h?p.push(b):r(b)),this},fire:function(){return s.fireWith(this,arguments),this},fired:function(){return!!f}};return s};q.extend({Deferred:function(a){var b=[["resolve","done",q.Callbacks("once memory"),"resolved"],["reject","fail",q.Callbacks("once memory"),"rejected"],["notify","progress",q.Callbacks("memory")]],d="pending",e={state:function(){return d},
always:function(){return f.done(arguments).fail(arguments),this},then:function(){var a=arguments;return q.Deferred(function(d){q.each(b,function(b,h){var k=h[0],l=q.isFunction(a[b])&&a[b];f[h[1]](function(){var a=l&&l.apply(this,arguments);a&&q.isFunction(a.promise)?a.promise().done(d.resolve).fail(d.reject).progress(d.notify):d[k+"With"](this===e?d.promise():this,l?[a]:arguments)})});a=null}).promise()},promise:function(a){return null!=a?q.extend(a,e):e}},f={};return e.pipe=e.then,q.each(b,function(a,
h){var k=h[2],l=h[3];e[h[1]]=k.add;l&&k.add(function(){d=l},b[1^a][2].disable,b[2][2].lock);f[h[0]]=function(){return f[h[0]+"With"](this===f?e:this,arguments),this};f[h[0]+"With"]=k.fireWith}),e.promise(f),a&&a.call(f,f),f},when:function(a){var b=0,d=va.call(arguments),e=d.length,f=1!==e||a&&q.isFunction(a.promise)?e:0,h=1===f?a:q.Deferred(),k=function(a,b,d){return function(e){b[a]=this;d[a]=1<arguments.length?va.call(arguments):e;d===l?h.notifyWith(b,d):--f||h.resolveWith(b,d)}},l,m,n;if(1<e){l=
Array(e);m=Array(e);for(n=Array(e);e>b;b++)d[b]&&q.isFunction(d[b].promise)?d[b].promise().done(k(b,n,d)).fail(h.reject).progress(k(b,m,l)):--f}return f||h.resolveWith(n,d),h.promise()}});q.support=function(b){var d=H.createElement("input"),e=H.createDocumentFragment(),f=H.createElement("div"),h=H.createElement("select"),k=h.appendChild(H.createElement("option"));return d.type?(d.type="checkbox",b.checkOn=""!==d.value,b.optSelected=k.selected,b.reliableMarginRight=!0,b.boxSizingReliable=!0,b.pixelPosition=
!1,d.checked=!0,b.noCloneChecked=d.cloneNode(!0).checked,h.disabled=!0,b.optDisabled=!k.disabled,d=H.createElement("input"),d.value="t",d.type="radio",b.radioValue="t"===d.value,d.setAttribute("checked","t"),d.setAttribute("name","t"),e.appendChild(d),b.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,b.focusinBubbles="onfocusin"in a,f.style.backgroundClip="content-box",f.cloneNode(!0).style.backgroundClip="",b.clearCloneStyle="content-box"===f.style.backgroundClip,q(function(){var d,e,
h=H.getElementsByTagName("body")[0];h&&(d=H.createElement("div"),d.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",h.appendChild(d).appendChild(f),f.innerHTML="",f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",q.swap(h,null!=h.style.zoom?{zoom:1}:{},function(){b.boxSizing=4===f.offsetWidth}),a.getComputedStyle&&(b.pixelPosition=
"1%"!==(a.getComputedStyle(f,null)||{}).top,b.boxSizingReliable="4px"===(a.getComputedStyle(f,null)||{width:"4px"}).width,e=f.appendChild(H.createElement("div")),e.style.cssText=f.style.cssText="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",e.style.marginRight=e.style.width="0",f.style.width="1px",b.reliableMarginRight=!parseFloat((a.getComputedStyle(e,null)||{}).marginRight)),h.removeChild(d))}),b):b}({});var ea,I,ob=
/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,nb=/([A-Z])/g;f.uid=1;f.accepts=function(a){return a.nodeType?1===a.nodeType||9===a.nodeType:!0};f.prototype={key:function(a){if(!f.accepts(a))return 0;var b={},d=a[this.expando];if(!d){d=f.uid++;try{b[this.expando]={value:d},Object.defineProperties(a,b)}catch(e){b[this.expando]=d,q.extend(a,b)}}return this.cache[d]||(this.cache[d]={}),d},set:function(a,b,d){var e;a=this.key(a);var f=this.cache[a];if("string"==typeof b)f[b]=d;else if(q.isEmptyObject(f))this.cache[a]=
b;else for(e in b)f[e]=b[e]},get:function(a,b){var e=this.cache[this.key(a)];return b===d?e:e[b]},access:function(a,b,e){return b===d||b&&"string"==typeof b&&e===d?this.get(a,b):(this.set(a,b,e),e!==d?e:b)},remove:function(a,b){var e,f;e=this.key(a);var h=this.cache[e];if(b===d)this.cache[e]={};else{q.isArray(b)?f=b.concat(b.map(q.camelCase)):b in h?f=[b]:(f=q.camelCase(b),f=f in h?[f]:f.match(ka)||[]);for(e=f.length;e--;)delete h[f[e]]}},hasData:function(a){return!q.isEmptyObject(this.cache[a[this.expando]]||
{})},discard:function(a){delete this.cache[this.key(a)]}};ea=new f;I=new f;q.extend({acceptData:f.accepts,hasData:function(a){return ea.hasData(a)||I.hasData(a)},data:function(a,b,d){return ea.access(a,b,d)},removeData:function(a,b){ea.remove(a,b)},_data:function(a,b,d){return I.access(a,b,d)},_removeData:function(a,b){I.remove(a,b)}});q.fn.extend({data:function(a,b){var e,f,h=this[0],l=0,m=null;if(a===d){if(this.length&&(m=ea.get(h),1===h.nodeType&&!I.get(h,"hasDataAttrs"))){for(e=h.attributes;e.length>
l;l++)f=e[l].name,0===f.indexOf("data-")&&(f=q.camelCase(f.substring(5)),k(h,f,m[f]));I.set(h,"hasDataAttrs",!0)}return m}return"object"==typeof a?this.each(function(){ea.set(this,a)}):q.access(this,function(b){var e,f=q.camelCase(a);if(h&&b===d){if((e=ea.get(h,a),e!==d)||(e=ea.get(h,f),e!==d)||(e=k(h,f,d),e!==d))return e}else this.each(function(){var e=ea.get(this,f);ea.set(this,f,b);-1!==a.indexOf("-")&&e!==d&&ea.set(this,a,b)})},null,b,1<arguments.length,null,!0)},removeData:function(a){return this.each(function(){ea.remove(this,
a)})}});q.extend({queue:function(a,b,e){var f;return a?(b=(b||"fx")+"queue",f=I.get(a,b),e&&(!f||q.isArray(e)?f=I.access(a,b,q.makeArray(e)):f.push(e)),f||[]):d},dequeue:function(a,b){b=b||"fx";var d=q.queue(a,b),e=d.length,f=d.shift(),h=q._queueHooks(a,b),k=function(){q.dequeue(a,b)};"inprogress"===f&&(f=d.shift(),e--);(h.cur=f)&&("fx"===b&&d.unshift("inprogress"),delete h.stop,f.call(a,k,h));!e&&h&&h.empty.fire()},_queueHooks:function(a,b){var d=b+"queueHooks";return I.get(a,d)||I.access(a,d,{empty:q.Callbacks("once memory").add(function(){I.remove(a,
[b+"queue",d])})})}});q.fn.extend({queue:function(a,b){var e=2;return"string"!=typeof a&&(b=a,a="fx",e--),e>arguments.length?q.queue(this[0],a):b===d?this:this.each(function(){var d=q.queue(this,a,b);q._queueHooks(this,a);"fx"===a&&"inprogress"!==d[0]&&q.dequeue(this,a)})},dequeue:function(a){return this.each(function(){q.dequeue(this,a)})},delay:function(a,b){return a=q.fx?q.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,d){var e=setTimeout(b,a);d.stop=function(){clearTimeout(e)}})},clearQueue:function(a){return this.queue(a||
"fx",[])},promise:function(a,b){var e,f=1,h=q.Deferred(),k=this,l=this.length,m=function(){--f||h.resolveWith(k,[k])};"string"!=typeof a&&(b=a,a=d);for(a=a||"fx";l--;)(e=I.get(k[l],a+"queueHooks"))&&e.empty&&(f++,e.empty.add(m));return m(),h.promise(b)}});var Xa,Na=/[\t\r\n]/g,Ab=/\r/g,Bb=/^(?:input|select|textarea|button)$/i;q.fn.extend({attr:function(a,b){return q.access(this,q.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){q.removeAttr(this,a)})},prop:function(a,
b){return q.access(this,q.prop,a,b,1<arguments.length)},removeProp:function(a){return this.each(function(){delete this[q.propFix[a]||a]})},addClass:function(a){var b,d,e,f,h,k=0,l=this.length;b="string"==typeof a&&a;if(q.isFunction(a))return this.each(function(b){q(this).addClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(ka)||[];l>k;k++)if(d=this[k],e=1===d.nodeType&&(d.className?(" "+d.className+" ").replace(Na," "):" ")){for(h=0;f=b[h++];)0>e.indexOf(" "+f+" ")&&(e+=f+" ");d.className=
q.trim(e)}return this},removeClass:function(a){var b,d,e,f,h,k=0,l=this.length;b=0===arguments.length||"string"==typeof a&&a;if(q.isFunction(a))return this.each(function(b){q(this).removeClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(ka)||[];l>k;k++)if(d=this[k],e=1===d.nodeType&&(d.className?(" "+d.className+" ").replace(Na," "):"")){for(h=0;f=b[h++];)for(;0<=e.indexOf(" "+f+" ");)e=e.replace(" "+f+" "," ");d.className=a?q.trim(e):""}return this},toggleClass:function(a,b){var d=
typeof a,e="boolean"==typeof b;return q.isFunction(a)?this.each(function(d){q(this).toggleClass(a.call(this,d,this.className,b),b)}):this.each(function(){if("string"===d)for(var f,h=0,k=q(this),l=b,m=a.match(ka)||[];f=m[h++];)l=e?l:!k.hasClass(f),k[l?"addClass":"removeClass"](f);else(d===X||"boolean"===d)&&(this.className&&I.set(this,"__className__",this.className),this.className=this.className||!1===a?"":I.get(this,"__className__")||"")})},hasClass:function(a){a=" "+a+" ";for(var b=0,d=this.length;d>
b;b++)if(1===this[b].nodeType&&0<=(" "+this[b].className+" ").replace(Na," ").indexOf(a))return!0;return!1},val:function(a){var b,e,f,h=this[0];if(arguments.length)return f=q.isFunction(a),this.each(function(e){var h,k=q(this);1===this.nodeType&&(h=f?a.call(this,e,k.val()):a,null==h?h="":"number"==typeof h?h+="":q.isArray(h)&&(h=q.map(h,function(a){return null==a?"":a+""})),b=q.valHooks[this.type]||q.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&b.set(this,h,"value")!==d||(this.value=h))});
if(h)return b=q.valHooks[h.type]||q.valHooks[h.nodeName.toLowerCase()],b&&"get"in b&&(e=b.get(h,"value"))!==d?e:(e=h.value,"string"==typeof e?e.replace(Ab,""):null==e?"":e)}});q.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){for(var b,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,h=f?null:[],k=f?e+1:d.length,l=0>e?k:f?e:0;k>l;l++)if(b=d[l],!(!b.selected&&l!==e||(q.support.optDisabled?b.disabled:null!==
b.getAttribute("disabled"))||b.parentNode.disabled&&q.nodeName(b.parentNode,"optgroup"))){if(a=q(b).val(),f)return a;h.push(a)}return h},set:function(a,b){for(var d,e,f=a.options,h=q.makeArray(b),k=f.length;k--;)e=f[k],(e.selected=0<=q.inArray(q(e).val(),h))&&(d=!0);return d||(a.selectedIndex=-1),h}}},attr:function(a,b,e){var f,h,k=a.nodeType;if(a&&3!==k&&8!==k&&2!==k)return typeof a.getAttribute===X?q.prop(a,b,e):(1===k&&q.isXMLDoc(a)||(b=b.toLowerCase(),f=q.attrHooks[b]||(q.expr.match.boolean.test(b)?
Xa:void 0)),e===d?f&&"get"in f&&null!==(h=f.get(a,b))?h:(h=q.find.attr(a,b),null==h?d:h):null!==e?f&&"set"in f&&(h=f.set(a,e,b))!==d?h:(a.setAttribute(b,e+""),e):(q.removeAttr(a,b),d))},removeAttr:function(a,b){var d,e,f=0,h=b&&b.match(ka);if(h&&1===a.nodeType)for(;d=h[f++];)e=q.propFix[d]||d,q.expr.match.boolean.test(d)&&(a[e]=!1),a.removeAttribute(d)},attrHooks:{type:{set:function(a,b){if(!q.support.radioValue&&"radio"===b&&q.nodeName(a,"input")){var d=a.value;return a.setAttribute("type",b),d&&
(a.value=d),b}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,e){var f,h,k,l=a.nodeType;if(a&&3!==l&&8!==l&&2!==l)return k=1!==l||!q.isXMLDoc(a),k&&(b=q.propFix[b]||b,h=q.propHooks[b]),e!==d?h&&"set"in h&&(f=h.set(a,e,b))!==d?f:a[b]=e:h&&"get"in h&&null!==(f=h.get(a,b))?f:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||Bb.test(a.nodeName)||a.href?a.tabIndex:-1}}}});Xa={set:function(a,b,d){return!1===b?q.removeAttr(a,d):a.setAttribute(d,d),d}};q.each(q.expr.match.boolean.source.match(/\w+/g),
function(a,b){var e=q.expr.attrHandle[b]||q.find.attr;q.expr.attrHandle[b]=function(a,b,f){var h=q.expr.attrHandle[b];a=f?d:(q.expr.attrHandle[b]=d)!=e(a,b,f)?b.toLowerCase():null;return q.expr.attrHandle[b]=h,a}});q.support.optSelected||(q.propHooks.selected={get:function(a){a=a.parentNode;return a&&a.parentNode&&a.parentNode.selectedIndex,null}});q.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){q.propFix[this.toLowerCase()]=
this});q.each(["radio","checkbox"],function(){q.valHooks[this]={set:function(a,b){return q.isArray(b)?a.checked=0<=q.inArray(q(a).val(),b):d}};q.support.checkOn||(q.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var Cb=/^key/,Db=/^(?:mouse|contextmenu)|click/,Ya=/^(?:focusinfocus|focusoutblur)$/,Za=/^([^.]*)(?:\.(.+)|)$/;q.event={global:{},add:function(a,b,e,f,h){var k,l,m,n,p,r,s,v,t,u;if(p=I.get(a)){e.handler&&(k=e,e=k.handler,h=k.selector);e.guid||(e.guid=
q.guid++);(n=p.events)||(n=p.events={});(l=p.handle)||(l=p.handle=function(a){return typeof q===X||a&&q.event.triggered===a.type?d:q.event.dispatch.apply(l.elem,arguments)},l.elem=a);b=(b||"").match(ka)||[""];for(p=b.length;p--;)m=Za.exec(b[p])||[],t=u=m[1],m=(m[2]||"").split(".").sort(),t&&(s=q.event.special[t]||{},t=(h?s.delegateType:s.bindType)||t,s=q.event.special[t]||{},r=q.extend({type:t,origType:u,data:f,handler:e,guid:e.guid,selector:h,needsContext:h&&q.expr.match.needsContext.test(h),namespace:m.join(".")},
k),(v=n[t])||(v=n[t]=[],v.delegateCount=0,s.setup&&!1!==s.setup.call(a,f,m,l)||a.addEventListener&&a.addEventListener(t,l,!1)),s.add&&(s.add.call(a,r),r.handler.guid||(r.handler.guid=e.guid)),h?v.splice(v.delegateCount++,0,r):v.push(r),q.event.global[t]=!0);a=null}},remove:function(a,b,d,e,f){var h,k,l,m,n,p,r,s,v,t,u,y=I.hasData(a)&&I.get(a);if(y&&(m=y.events)){b=(b||"").match(ka)||[""];for(n=b.length;n--;)if(l=Za.exec(b[n])||[],v=u=l[1],t=(l[2]||"").split(".").sort(),v){r=q.event.special[v]||{};
v=(e?r.delegateType:r.bindType)||v;s=m[v]||[];l=l[2]&&RegExp("(^|\\.)"+t.join("\\.(?:.*\\.|)")+"(\\.|$)");for(k=h=s.length;h--;)p=s[h],!f&&u!==p.origType||d&&d.guid!==p.guid||l&&!l.test(p.namespace)||e&&e!==p.selector&&("**"!==e||!p.selector)||(s.splice(h,1),p.selector&&s.delegateCount--,r.remove&&r.remove.call(a,p));k&&!s.length&&(r.teardown&&!1!==r.teardown.call(a,t,y.handle)||q.removeEvent(a,v,y.handle),delete m[v])}else for(v in m)q.event.remove(a,v+b[n],d,e,!0);q.isEmptyObject(m)&&(delete y.handle,
I.remove(a,"events"))}},trigger:function(b,e,f,h){var k,l,m,n,p,r,s,v=[f||H],t=Ma.call(b,"type")?b.type:b;k=Ma.call(b,"namespace")?b.namespace.split("."):[];if(l=m=f=f||H,3!==f.nodeType&&8!==f.nodeType&&!Ya.test(t+q.event.triggered)&&(0<=t.indexOf(".")&&(k=t.split("."),t=k.shift(),k.sort()),p=0>t.indexOf(":")&&"on"+t,b=b[q.expando]?b:new q.Event(t,"object"==typeof b&&b),b.isTrigger=h?2:3,b.namespace=k.join("."),b.namespace_re=b.namespace?RegExp("(^|\\.)"+k.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=
d,b.target||(b.target=f),e=null==e?[b]:q.makeArray(e,[b]),s=q.event.special[t]||{},h||!s.trigger||!1!==s.trigger.apply(f,e))){if(!h&&!s.noBubble&&!q.isWindow(f)){n=s.delegateType||t;for(Ya.test(n+t)||(l=l.parentNode);l;l=l.parentNode)v.push(l),m=l;m===(f.ownerDocument||H)&&v.push(m.defaultView||m.parentWindow||a)}for(k=0;(l=v[k++])&&!b.isPropagationStopped();)b.type=1<k?n:s.bindType||t,(r=(I.get(l,"events")||{})[b.type]&&I.get(l,"handle"))&&r.apply(l,e),(r=p&&l[p])&&q.acceptData(l)&&r.apply&&!1===
r.apply(l,e)&&b.preventDefault();return b.type=t,h||b.isDefaultPrevented()||s._default&&!1!==s._default.apply(v.pop(),e)||!q.acceptData(f)||p&&q.isFunction(f[t])&&!q.isWindow(f)&&(m=f[p],m&&(f[p]=null),q.event.triggered=t,f[t](),q.event.triggered=d,m&&(f[p]=m)),b.result}},dispatch:function(a){a=q.event.fix(a);var b,e,f,h,k,l=[],m=va.call(arguments);b=(I.get(this,"events")||{})[a.type]||[];var n=q.event.special[a.type]||{};if(m[0]=a,a.delegateTarget=this,!n.preDispatch||!1!==n.preDispatch.call(this,
a)){l=q.event.handlers.call(this,a,b);for(b=0;(h=l[b++])&&!a.isPropagationStopped();){a.currentTarget=h.elem;for(e=0;(k=h.handlers[e++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(k.namespace))&&(a.handleObj=k,a.data=k.data,f=((q.event.special[k.origType]||{}).handle||k.handler).apply(h.elem,m),f!==d&&!1===(a.result=f)&&(a.preventDefault(),a.stopPropagation()))}return n.postDispatch&&n.postDispatch.call(this,a),a.result}},handlers:function(a,b){var e,f,h,k,l=[],m=b.delegateCount,
n=a.target;if(m&&n.nodeType&&(!a.button||"click"!==a.type))for(;n!==this;n=n.parentNode||this)if(!0!==n.disabled||"click"!==a.type){f=[];for(e=0;m>e;e++)k=b[e],h=k.selector+" ",f[h]===d&&(f[h]=k.needsContext?0<=q(h,this).index(n):q.find(h,this,null,[n]).length),f[h]&&f.push(k);f.length&&l.push({elem:n,handlers:f})}return b.length>m&&l.push({elem:this,handlers:b.slice(m)}),l},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var e,f,h,k=b.button;return null==a.pageX&&null!=b.clientX&&(e=a.target.ownerDocument||H,f=e.documentElement,h=e.body,a.pageX=b.clientX+(f&&f.scrollLeft||h&&h.scrollLeft||0)-(f&&f.clientLeft||h&&h.clientLeft||
0),a.pageY=b.clientY+(f&&f.scrollTop||h&&h.scrollTop||0)-(f&&f.clientTop||h&&h.clientTop||0)),a.which||k===d||(a.which=1&k?1:2&k?3:4&k?2:0),a}},fix:function(a){if(a[q.expando])return a;var b,d,e;b=a.type;var f=a,h=this.fixHooks[b];h||(this.fixHooks[b]=h=Db.test(b)?this.mouseHooks:Cb.test(b)?this.keyHooks:{});e=h.props?this.props.concat(h.props):this.props;a=new q.Event(f);for(b=e.length;b--;)d=e[b],a[d]=f[d];return 3===a.target.nodeType&&(a.target=a.target.parentNode),h.filter?h.filter(a,f):a},special:{load:{noBubble:!0},
focus:{trigger:function(){return this!==m()&&this.focus?(this.focus(),!1):d},delegateType:"focusin"},blur:{trigger:function(){return this===m()&&this.blur?(this.blur(),!1):d},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&q.nodeName(this,"input")?(this.click(),!1):d},_default:function(a){return q.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){a.result!==d&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,d,e){a=q.extend(new q.Event,
d,{type:a,isSimulated:!0,originalEvent:{}});e?q.event.trigger(a,null,b):q.event.dispatch.call(b,a);a.isDefaultPrevented()&&d.preventDefault()}};q.removeEvent=function(a,b,d){a.removeEventListener&&a.removeEventListener(b,d,!1)};q.Event=function(a,b){return this instanceof q.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.getPreventDefault&&a.getPreventDefault()?h:l):this.type=a,b&&q.extend(this,b),this.timeStamp=a&&a.timeStamp||q.now(),this[q.expando]=
!0,d):new q.Event(a,b)};q.Event.prototype={isDefaultPrevented:l,isPropagationStopped:l,isImmediatePropagationStopped:l,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=h;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=h;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=h;this.stopPropagation()}};q.each({mouseenter:"mouseover",mouseleave:"mouseout"},
function(a,b){q.event.special[a]={delegateType:b,bindType:b,handle:function(a){var d,e=a.relatedTarget,f=a.handleObj;return(!e||e!==this&&!q.contains(this,e))&&(a.type=f.origType,d=f.handler.apply(this,arguments),a.type=b),d}}});q.support.focusinBubbles||q.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){q.event.simulate(b,a.target,q.event.fix(a),!0)};q.event.special[b]={setup:function(){0===d++&&H.addEventListener(a,e,!0)},teardown:function(){0===--d&&H.removeEventListener(a,
e,!0)}}});q.fn.extend({on:function(a,b,e,f,h){var k,m;if("object"==typeof a){"string"!=typeof b&&(e=e||b,b=d);for(m in a)this.on(m,b,e,a[m],h);return this}if(null==e&&null==f?(f=b,e=b=d):null==f&&("string"==typeof b?(f=e,e=d):(f=e,e=b,b=d)),!1===f)f=l;else if(!f)return this;return 1===h&&(k=f,f=function(a){return q().off(a),k.apply(this,arguments)},f.guid=k.guid||(k.guid=q.guid++)),this.each(function(){q.event.add(this,a,f,e,b)})},one:function(a,b,d,e){return this.on(a,b,d,e,1)},off:function(a,b,
e){var f,h;if(a&&a.preventDefault&&a.handleObj)return f=a.handleObj,q(a.delegateTarget).off(f.namespace?f.origType+"."+f.namespace:f.origType,f.selector,f.handler),this;if("object"==typeof a){for(h in a)this.off(h,b,a[h]);return this}return(!1===b||"function"==typeof b)&&(e=b,b=d),!1===e&&(e=l),this.each(function(){q.event.remove(this,a,e,b)})},trigger:function(a,b){return this.each(function(){q.event.trigger(a,b,this)})},triggerHandler:function(a,b){var e=this[0];return e?q.event.trigger(a,b,e,!0):
d}});var pb=/^.[^:#\[\.,]*$/,$a=q.expr.match.needsContext,Eb={children:!0,contents:!0,next:!0,prev:!0};q.fn.extend({find:function(a){var b,d,e,f=this.length;if("string"!=typeof a)return b=this,this.pushStack(q(a).filter(function(){for(e=0;f>e;e++)if(q.contains(b[e],this))return!0}));d=[];for(e=0;f>e;e++)q.find(a,this[e],d);return d=this.pushStack(1<f?q.unique(d):d),d.selector=(this.selector?this.selector+" ":"")+a,d},has:function(a){var b=q(a,this),d=b.length;return this.filter(function(){for(var a=
0;d>a;a++)if(q.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(p(this,a||[],!0))},filter:function(a){return this.pushStack(p(this,a||[],!1))},is:function(a){return!!a&&("string"==typeof a?$a.test(a)?0<=q(a,this.context).index(this[0]):0<q.filter(a,this).length:0<this.filter(a).length)},closest:function(a,b){for(var d,e=0,f=this.length,h=[],k=$a.test(a)||"string"!=typeof a?q(a,b||this.context):0;f>e;e++)for(d=this[e];d&&d!==b;d=d.parentNode)if(11>d.nodeType&&(k?-1<k.index(d):
1===d.nodeType&&q.find.matchesSelector(d,a))){h.push(d);break}return this.pushStack(1<h.length?q.unique(h):h)},index:function(a){return a?"string"==typeof a?xa.call(q(a),this[0]):xa.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){var d="string"==typeof a?q(a,b):q.makeArray(a&&a.nodeType?[a]:a),d=q.merge(this.get(),d);return this.pushStack(q.unique(d))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});
q.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return q.dir(a,"parentNode")},parentsUntil:function(a,b,d){return q.dir(a,"parentNode",d)},next:function(a){return n(a,"nextSibling")},prev:function(a){return n(a,"previousSibling")},nextAll:function(a){return q.dir(a,"nextSibling")},prevAll:function(a){return q.dir(a,"previousSibling")},nextUntil:function(a,b,d){return q.dir(a,"nextSibling",d)},prevUntil:function(a,b,d){return q.dir(a,"previousSibling",
d)},siblings:function(a){return q.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return q.sibling(a.firstChild)},contents:function(a){return q.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:q.merge([],a.childNodes)}},function(a,b){q.fn[a]=function(d,e){var f=q.map(this,b,d);return"Until"!==a.slice(-5)&&(e=d),e&&"string"==typeof e&&(f=q.filter(e,f)),1<this.length&&(Eb[a]||q.unique(f),"p"===a[0]&&f.reverse()),this.pushStack(f)}});q.extend({filter:function(a,b,d){var e=
b[0];return d&&(a=":not("+a+")"),1===b.length&&1===e.nodeType?q.find.matchesSelector(e,a)?[e]:[]:q.find.matches(a,q.grep(b,function(a){return 1===a.nodeType}))},dir:function(a,b,e){for(var f=[],h=e!==d;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(h&&q(a).is(e))break;f.push(a)}return f},sibling:function(a,b){for(var d=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&d.push(a);return d}});var ab=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bb=/<([\w:]+)/,Fb=/<|&#?\w+;/,Gb=
/<(?:script|style|link)/i,cb=/^(?:checkbox|radio)$/i,Hb=/checked\s*(?:[^=]|=\s*.checked.)/i,db=/^$|\/(?:java|ecma)script/i,qb=/^true\/(.*)/,Ib=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ja={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ja.optgroup=ja.option;ja.tbody=ja.tfoot=ja.colgroup=ja.caption=ja.col=ja.thead;ja.th=ja.td;q.fn.extend({text:function(a){return q.access(this,
function(a){return a===d?q.text(this):this.empty().append((this[0]&&this[0].ownerDocument||H).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&r(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=r(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,
function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var d,e=a?q.filter(a,this):this,f=0;null!=(d=e[f]);f++)b||1!==d.nodeType||q.cleanData(w(d)),d.parentNode&&(b&&q.contains(d.ownerDocument,d)&&t(w(d,"script")),d.parentNode.removeChild(d));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(q.cleanData(w(a,
!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return q.clone(this,a,b)})},html:function(a){return q.access(this,function(a){var b=this[0]||{},e=0,f=this.length;if(a===d&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Gb.test(a)&&!ja[(bb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(ab,"<$1></$2>");try{for(;f>e;e++)b=this[e]||{},1===b.nodeType&&(q.cleanData(w(b,!1)),b.innerHTML=a);b=0}catch(h){}}b&&this.empty().append(a)},
null,a,arguments.length)},replaceWith:function(){var a=q.map(this,function(a){return[a.nextSibling,a.parentNode]}),b=0;return this.domManip(arguments,function(d){var e=a[b++],f=a[b++];f&&(q(this).remove(),f.insertBefore(d,e))},!0),b?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b,d){a=Va.apply([],a);var e,f,h,k,l=0,m=this.length,n=this,p=m-1,r=a[0],t=q.isFunction(r);if(t||!(1>=m||"string"!=typeof r||q.support.checkClone)&&Hb.test(r))return this.each(function(e){var f=
n.eq(e);t&&(a[0]=r.call(this,e,f.html()));f.domManip(a,b,d)});if(m&&(e=q.buildFragment(a,this[0].ownerDocument,!1,!d&&this),f=e.firstChild,1===e.childNodes.length&&(e=f),f)){f=q.map(w(e,"script"),s);for(h=f.length;m>l;l++)k=e,l!==p&&(k=q.clone(k,!0,!0),h&&q.merge(f,w(k,"script"))),b.call(this[l],k,l);if(h){e=f[f.length-1].ownerDocument;q.map(f,v);for(l=0;h>l;l++)k=f[l],db.test(k.type||"")&&!I.access(k,"globalEval")&&q.contains(e,k)&&(k.src?q._evalUrl(k.src):q.globalEval(k.textContent.replace(Ib,"")))}}return this}});
q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){q.fn[a]=function(a){for(var d=[],e=q(a),f=e.length-1,h=0;f>=h;h++)a=h===f?this:this.clone(!0),q(e[h])[b](a),La.apply(d,a.get());return this.pushStack(d)}});q.extend({clone:function(a,b,d){var e,f,h,k,l=a.cloneNode(!0),m=q.contains(a.ownerDocument,a);if(!q.support.noCloneChecked&&!(1!==a.nodeType&&11!==a.nodeType||q.isXMLDoc(a))){k=w(l);h=w(a);e=0;for(f=h.length;f>e;e++){var n=
h[e],p=k[e],r=p.nodeName.toLowerCase();"input"===r&&cb.test(n.type)?p.checked=n.checked:("input"===r||"textarea"===r)&&(p.defaultValue=n.defaultValue)}}if(b)if(d){h=h||w(a);k=k||w(l);e=0;for(f=h.length;f>e;e++)x(h[e],k[e])}else x(a,l);return k=w(l,"script"),0<k.length&&t(k,!m&&w(a,"script")),l},buildFragment:function(a,b,d,e){for(var f,h,k,l,m=0,n=a.length,p=b.createDocumentFragment(),r=[];n>m;m++)if(f=a[m],f||0===f)if("object"===q.type(f))q.merge(r,f.nodeType?[f]:f);else if(Fb.test(f)){h=h||p.appendChild(b.createElement("div"));
k=(bb.exec(f)||["",""])[1].toLowerCase();k=ja[k]||ja._default;h.innerHTML=k[1]+f.replace(ab,"<$1></$2>")+k[2];for(k=k[0];k--;)h=h.firstChild;q.merge(r,h.childNodes);h=p.firstChild;h.textContent=""}else r.push(b.createTextNode(f));p.textContent="";for(m=0;f=r[m++];)if((!e||-1===q.inArray(f,e))&&(l=q.contains(f.ownerDocument,f),h=w(p.appendChild(f),"script"),l&&t(h),d))for(k=0;f=h[k++];)db.test(f.type||"")&&d.push(f);return p},cleanData:function(a){for(var b,d,e,f=a.length,h=0,k=q.event.special;f>h;h++){if(d=
a[h],q.acceptData(d)&&(b=I.access(d)))for(e in b.events)k[e]?q.event.remove(d,e):q.removeEvent(d,e,b.handle);ea.discard(d);I.discard(d)}},_evalUrl:function(a){return q.ajax({url:a,type:"GET",dataType:"text",async:!1,global:!1,success:q.globalEval})}});q.fn.extend({wrapAll:function(a){var b;return q.isFunction(a)?this.each(function(b){q(this).wrapAll(a.call(this,b))}):(this[0]&&(b=q(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=
a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return q.isFunction(a)?this.each(function(b){q(this).wrapInner(a.call(this,b))}):this.each(function(){var b=q(this),d=b.contents();d.length?d.wrapAll(a):b.append(a)})},wrap:function(a){var b=q.isFunction(a);return this.each(function(d){q(this).wrapAll(b?a.call(this,d):a)})},unwrap:function(){return this.parent().each(function(){q.nodeName(this,"body")||q(this).replaceWith(this.childNodes)}).end()}});var sa,ta,Jb=/^(none|table(?!-c[ea]).+)/,
eb=/^margin/,rb=RegExp("^("+Ha+")(.*)$","i"),Ja=RegExp("^("+Ha+")(?!px)[a-z%]+$","i"),Kb=RegExp("^([+-])=("+Ha+")","i"),Ua={BODY:"block"},Lb={position:"absolute",visibility:"hidden",display:"block"},fb={letterSpacing:0,fontWeight:400},ra=["Top","Right","Bottom","Left"],Ta=["Webkit","O","Moz","ms"];q.fn.extend({css:function(b,e){return q.access(this,function(b,e,f){var h,k={},l=0;if(q.isArray(e)){f=a.getComputedStyle(b,null);for(h=e.length;h>l;l++)k[e[l]]=q.css(b,e[l],!1,f);return k}return f!==d?q.style(b,
e,f):q.css(b,e)},b,e,1<arguments.length)},show:function(){return A(this,!0)},hide:function(){return A(this)},toggle:function(a){var b="boolean"==typeof a;return this.each(function(){(b?a:z(this))?q(this).show():q(this).hide()})}});q.extend({cssHooks:{opacity:{get:function(a,b){if(b){var d=sa(a,"opacity");return""===d?"1":d}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,e,f){if(a&&
3!==a.nodeType&&8!==a.nodeType&&a.style){var h,k,l,m=q.camelCase(b),n=a.style;return b=q.cssProps[m]||(q.cssProps[m]=y(n,m)),l=q.cssHooks[b]||q.cssHooks[m],e===d?l&&"get"in l&&(h=l.get(a,!1,f))!==d?h:n[b]:(k=typeof e,"string"===k&&(h=Kb.exec(e))&&(e=(h[1]+1)*h[2]+parseFloat(q.css(a,b)),k="number"),null==e||"number"===k&&isNaN(e)||("number"!==k||q.cssNumber[m]||(e+="px"),q.support.clearCloneStyle||""!==e||0!==b.indexOf("background")||(n[b]="inherit"),l&&"set"in l&&(e=l.set(a,e,f))===d||(n[b]=e)),d)}},
css:function(a,b,e,f){var h,k,l,m=q.camelCase(b);return b=q.cssProps[m]||(q.cssProps[m]=y(a.style,m)),l=q.cssHooks[b]||q.cssHooks[m],l&&"get"in l&&(h=l.get(a,!0,e)),h===d&&(h=sa(a,b,f)),"normal"===h&&b in fb&&(h=fb[b]),""===e||e?(k=parseFloat(h),!0===e||q.isNumeric(k)?k||0:h):h}});sa=function(b,e,f){var h,k,l,m=(f=f||a.getComputedStyle(b,null))?f.getPropertyValue(e)||f[e]:d,n=b.style;return f&&(""!==m||q.contains(b.ownerDocument,b)||(m=q.style(b,e)),Ja.test(m)&&eb.test(e)&&(h=n.width,k=n.minWidth,
l=n.maxWidth,n.minWidth=n.maxWidth=n.width=m,m=f.width,n.width=h,n.minWidth=k,n.maxWidth=l)),m};q.each(["height","width"],function(b,e){q.cssHooks[e]={get:function(a,b,f){return b?0===a.offsetWidth&&Jb.test(q.css(a,"display"))?q.swap(a,Lb,function(){return C(a,e,f)}):C(a,e,f):d},set:function(b,d,f){var h=f&&a.getComputedStyle(b,null);return F(b,d,f?u(b,e,f,q.support.boxSizing&&"border-box"===q.css(b,"boxSizing",!1,h),h):0)}}});q(function(){q.support.reliableMarginRight||(q.cssHooks.marginRight={get:function(a,
b){return b?q.swap(a,{display:"inline-block"},sa,[a,"marginRight"]):d}});!q.support.pixelPosition&&q.fn.position&&q.each(["top","left"],function(a,b){q.cssHooks[b]={get:function(a,e){return e?(e=sa(a,b),Ja.test(e)?q(a).position()[b]+"px":e):d}}})});q.expr&&q.expr.filters&&(q.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight},q.expr.filters.visible=function(a){return!q.expr.filters.hidden(a)});q.each({margin:"",padding:"",border:"Width"},function(a,b){q.cssHooks[a+b]={expand:function(d){var e=
0,f={};for(d="string"==typeof d?d.split(" "):[d];4>e;e++)f[a+ra[e]+b]=d[e]||d[e-2]||d[0];return f}};eb.test(a)||(q.cssHooks[a+b].set=F)});var Mb=/%20/g,sb=/\[\]$/,gb=/\r?\n/g,Nb=/^(?:submit|button|image|reset|file)$/i,Ob=/^(?:input|select|textarea|keygen)/i;q.fn.extend({serialize:function(){return q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=q.prop(this,"elements");return a?q.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!q(this).is(":disabled")&&
Ob.test(this.nodeName)&&!Nb.test(a)&&(this.checked||!cb.test(a))}).map(function(a,b){var d=q(this).val();return null==d?null:q.isArray(d)?q.map(d,function(a){return{name:b.name,value:a.replace(gb,"\r\n")}}):{name:b.name,value:d.replace(gb,"\r\n")}}).get()}});q.param=function(a,b){var e,f=[],h=function(a,b){b=q.isFunction(b)?b():null==b?"":b;f[f.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(b===d&&(b=q.ajaxSettings&&q.ajaxSettings.traditional),q.isArray(a)||a.jquery&&!q.isPlainObject(a))q.each(a,
function(){h(this.name,this.value)});else for(e in a)E(e,a[e],b,h);return f.join("&").replace(Mb,"+")};q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){q.fn[b]=function(a,d){return 0<arguments.length?this.on(b,null,a,d):this.trigger(b)}});q.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},
bind:function(a,b,d){return this.on(a,null,b,d)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,d,e){return this.on(b,a,d,e)},undelegate:function(a,b,d){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",d)}});var oa,ha,Oa=q.now(),Pa=/\?/,Pb=/#.*$/,hb=/([?&])_=[^&]*/,Qb=/^(.*?):[ \t]*([^\r\n]*)$/gm,Rb=/^(?:GET|HEAD)$/,Sb=/^\/\//,ib=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,jb=q.fn.load,kb={},Ka={},lb="*/".concat("*");try{ha=Q.href}catch(Yb){ha=H.createElement("a"),
ha.href="",ha=ha.href}oa=ib.exec(ha.toLowerCase())||[];q.fn.load=function(a,b,e){if("string"!=typeof a&&jb)return jb.apply(this,arguments);var f,h,k,l=this,m=a.indexOf(" ");return 0<=m&&(f=a.slice(m),a=a.slice(0,m)),q.isFunction(b)?(e=b,b=d):b&&"object"==typeof b&&(h="POST"),0<l.length&&q.ajax({url:a,type:h,dataType:"html",data:b}).done(function(a){k=arguments;l.html(f?q("<div>").append(q.parseHTML(a)).find(f):a)}).complete(e&&function(a,b){l.each(e,k||[a.responseText,b,a])}),this};q.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),
function(a,b){q.fn[b]=function(a){return this.on(b,a)}});q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ha,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(oa[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":lb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",
text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":q.parseJSON,"text xml":q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?ba(ba(a,q.ajaxSettings),b):ba(q.ajaxSettings,a)},ajaxPrefilter:M(kb),ajaxTransport:M(Ka),ajax:function(a,b){function e(a,b,l,n){var r,G,w,z,F=b;if(2!==A){A=2;m&&clearTimeout(m);f=d;k=n||"";B.readyState=0<a?4:0;n=200<=a&&300>a||304===a;if(l){w=s;for(var Z=B,E,C,O,M,W=w.contents,qa=w.dataTypes;"*"===qa[0];)qa.shift(),
E===d&&(E=w.mimeType||Z.getResponseHeader("Content-Type"));if(E)for(C in W)if(W[C]&&W[C].test(E)){qa.unshift(C);break}if(qa[0]in l)O=qa[0];else{for(C in l){if(!qa[0]||w.converters[C+" "+qa[0]]){O=C;break}M||(M=C)}O=O||M}w=O?(O!==qa[0]&&qa.unshift(O),l[O]):d}var Y;a:{l=s;E=w;C=B;O=n;var L,H,ba;w={};Z=l.dataTypes.slice();if(Z[1])for(L in l.converters)w[L.toLowerCase()]=l.converters[L];for(M=Z.shift();M;)if(l.responseFields[M]&&(C[l.responseFields[M]]=E),!ba&&O&&l.dataFilter&&(E=l.dataFilter(E,l.dataType)),
ba=M,M=Z.shift())if("*"===M)M=ba;else if("*"!==ba&&ba!==M){if(L=w[ba+" "+M]||w["* "+M],!L)for(Y in w)if(H=Y.split(" "),H[1]===M&&(L=w[ba+" "+H[0]]||w["* "+H[0]])){!0===L?L=w[Y]:!0!==w[Y]&&(M=H[0],Z.unshift(H[1]));break}if(!0!==L)if(L&&l["throws"])E=L(E);else try{E=L(E)}catch(I){Y={state:"parsererror",error:L?I:"No conversion from "+ba+" to "+M};break a}}Y={state:"success",data:E}}w=Y;n?(s.ifModified&&(z=B.getResponseHeader("Last-Modified"),z&&(q.lastModified[h]=z),z=B.getResponseHeader("etag"),z&&
(q.etag[h]=z)),204===a?F="nocontent":304===a?F="notmodified":(F=w.state,r=w.data,G=w.error,n=!G)):(G=F,(a||!F)&&(F="error",0>a&&(a=0)));B.status=a;B.statusText=(b||F)+"";n?u.resolveWith(v,[r,F,B]):u.rejectWith(v,[B,F,G]);B.statusCode(x);x=d;p&&t.trigger(n?"ajaxSuccess":"ajaxError",[B,s,n?r:G]);y.fireWith(v,[B,F]);p&&(t.trigger("ajaxComplete",[B,s]),--q.active||q.event.trigger("ajaxStop"))}}"object"==typeof a&&(b=a,a=d);b=b||{};var f,h,k,l,m,n,p,r,s=q.ajaxSetup({},b),v=s.context||s,t=s.context&&(v.nodeType||
v.jquery)?q(v):q.event,u=q.Deferred(),y=q.Callbacks("once memory"),x=s.statusCode||{},w={},z={},A=0,F="canceled",B={readyState:0,getResponseHeader:function(a){var b;if(2===A){if(!l)for(l={};b=Qb.exec(k);)l[b[1].toLowerCase()]=b[2];b=l[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===A?k:null},setRequestHeader:function(a,b){var d=a.toLowerCase();return A||(a=z[d]=z[d]||a,w[a]=b),this},overrideMimeType:function(a){return A||(s.mimeType=a),this},statusCode:function(a){var b;
if(a)if(2>A)for(b in a)x[b]=[x[b],a[b]];else B.always(a[B.status]);return this},abort:function(a){a=a||F;return f&&f.abort(a),e(0,a),this}};if(u.promise(B).complete=y.add,B.success=B.done,B.error=B.fail,s.url=((a||s.url||ha)+"").replace(Pb,"").replace(Sb,oa[1]+"//"),s.type=b.method||b.type||s.method||s.type,s.dataTypes=q.trim(s.dataType||"*").toLowerCase().match(ka)||[""],null==s.crossDomain&&(n=ib.exec(s.url.toLowerCase()),s.crossDomain=!(!n||n[1]===oa[1]&&n[2]===oa[2]&&(n[3]||("http:"===n[1]?"80":
"443"))===(oa[3]||("http:"===oa[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=q.param(s.data,s.traditional)),Y(kb,s,b,B),2===A)return B;(p=s.global)&&0===q.active++&&q.event.trigger("ajaxStart");s.type=s.type.toUpperCase();s.hasContent=!Rb.test(s.type);h=s.url;s.hasContent||(s.data&&(h=s.url+=(Pa.test(h)?"&":"?")+s.data,delete s.data),!1===s.cache&&(s.url=hb.test(h)?h.replace(hb,"$1_="+Oa++):h+(Pa.test(h)?"&":"?")+"_="+Oa++));s.ifModified&&(q.lastModified[h]&&B.setRequestHeader("If-Modified-Since",
q.lastModified[h]),q.etag[h]&&B.setRequestHeader("If-None-Match",q.etag[h]));(s.data&&s.hasContent&&!1!==s.contentType||b.contentType)&&B.setRequestHeader("Content-Type",s.contentType);B.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+lb+"; q=0.01":""):s.accepts["*"]);for(r in s.headers)B.setRequestHeader(r,s.headers[r]);if(s.beforeSend&&(!1===s.beforeSend.call(v,B,s)||2===A))return B.abort();F="abort";for(r in{success:1,error:1,
complete:1})B[r](s[r]);if(f=Y(Ka,s,b,B)){B.readyState=1;p&&t.trigger("ajaxSend",[B,s]);s.async&&0<s.timeout&&(m=setTimeout(function(){B.abort("timeout")},s.timeout));try{A=1,f.send(w,e)}catch(E){if(!(2>A))throw E;e(-1,E)}}else e(-1,"No Transport");return B},getJSON:function(a,b,d){return q.get(a,b,d,"json")},getScript:function(a,b){return q.get(a,d,b,"script")}});q.each(["get","post"],function(a,b){q[b]=function(a,e,f,h){return q.isFunction(e)&&(h=h||f,f=e,e=d),q.ajax({url:a,type:b,dataType:h,data:e,
success:f})}});q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return q.globalEval(a),a}}});q.ajaxPrefilter("script",function(a){a.cache===d&&(a.cache=!1);a.crossDomain&&(a.type="GET")});q.ajaxTransport("script",function(a){if(a.crossDomain){var b,d;return{send:function(e,f){b=q("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",
d=function(a){b.remove();d=null;a&&f("error"===a.type?404:200,a.type)});H.head.appendChild(b[0])},abort:function(){d&&d()}}}});var mb=[],Qa=/(=)\?(?=&|$)|\?\?/;q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=mb.pop()||q.expando+"_"+Oa++;return this[a]=!0,a}});q.ajaxPrefilter("json jsonp",function(b,e,f){var h,k,l,m=!1!==b.jsonp&&(Qa.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qa.test(b.data)&&"data");return m||"jsonp"===
b.dataTypes[0]?(h=b.jsonpCallback=q.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,m?b[m]=b[m].replace(Qa,"$1"+h):!1!==b.jsonp&&(b.url+=(Pa.test(b.url)?"&":"?")+b.jsonp+"="+h),b.converters["script json"]=function(){return l||q.error(h+" was not called"),l[0]},b.dataTypes[0]="json",k=a[h],a[h]=function(){l=arguments},f.always(function(){a[h]=k;b[h]&&(b.jsonpCallback=e.jsonpCallback,mb.push(h));l&&q.isFunction(k)&&k(l[0]);l=k=d}),"script"):d});q.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};
var Ca=q.ajaxSettings.xhr(),Tb={0:200,1223:204},Ub=0,Da={};a.ActiveXObject&&q(a).on("unload",function(){for(var a in Da)Da[a]();Da=d});q.support.cors=!!Ca&&"withCredentials"in Ca;q.support.ajax=Ca=!!Ca;q.ajaxTransport(function(a){var b;return q.support.cors||Ca&&!a.crossDomain?{send:function(e,f){var h,k,l=a.xhr();if(l.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(h in a.xhrFields)l[h]=a.xhrFields[h];a.mimeType&&l.overrideMimeType&&l.overrideMimeType(a.mimeType);a.crossDomain||
e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(h in e)l.setRequestHeader(h,e[h]);b=function(a){return function(){b&&(delete Da[k],b=l.onload=l.onerror=null,"abort"===a?l.abort():"error"===a?f(l.status||404,l.statusText):f(Tb[l.status]||l.status,l.statusText,"string"==typeof l.responseText?{text:l.responseText}:d,l.getAllResponseHeaders()))}};l.onload=b();l.onerror=b("error");b=Da[k=Ub++]=b("abort");l.send(a.hasContent&&a.data||null)},abort:function(){b&&b()}}:d});var ua,Ia,Vb=
/^(?:toggle|show|hide)$/,Wb=RegExp("^(?:([+-])=|)("+Ha+")([a-z%]*)$","i"),Xb=/queueHooks$/,Fa=[function(a,b,e){var f,h,k,l,m,n,p=this,r=a.style,s={},v=[],t=a.nodeType&&z(a);e.queue||(m=q._queueHooks(a,"fx"),null==m.unqueued&&(m.unqueued=0,n=m.empty.fire,m.empty.fire=function(){m.unqueued||n()}),m.unqueued++,p.always(function(){p.always(function(){m.unqueued--;q.queue(a,"fx").length||m.empty.fire()})}));1===a.nodeType&&("height"in b||"width"in b)&&(e.overflow=[r.overflow,r.overflowX,r.overflowY],"inline"===
q.css(a,"display")&&"none"===q.css(a,"float")&&(r.display="inline-block"));e.overflow&&(r.overflow="hidden",p.always(function(){r.overflow=e.overflow[0];r.overflowX=e.overflow[1];r.overflowY=e.overflow[2]}));l=I.get(a,"fxshow");for(f in b)if(k=b[f],Vb.exec(k)){if(delete b[f],h=h||"toggle"===k,k===(t?"hide":"show")){if("show"!==k||l===d||l[f]===d)continue;t=!0}v.push(f)}if(b=v.length){l=I.get(a,"fxshow")||I.access(a,"fxshow",{});"hidden"in l&&(t=l.hidden);h&&(l.hidden=!t);t?q(a).show():p.done(function(){q(a).hide()});
p.done(function(){var b;I.remove(a,"fxshow");for(b in s)q.style(a,b,s[b])});for(f=0;b>f;f++)h=v[f],k=p.createTween(h,t?l[h]:0),s[h]=l[h]||q.style(a,h),h in l||(l[h]=k.start,t&&(k.end=k.start,k.start="width"===h||"height"===h?1:0))}}],na={"*":[function(a,b){var d,e,f=this.createTween(a,b),h=Wb.exec(b),k=f.cur(),l=+k||0,m=1,n=20;if(h){if(d=+h[2],e=h[3]||(q.cssNumber[a]?"":"px"),"px"!==e&&l){l=q.css(f.elem,a,!0)||d||1;do m=m||".5",l/=m,q.style(f.elem,a,l+e);while(m!==(m=f.cur()/k)&&1!==m&&--n)}f.unit=
e;f.start=l;f.end=h[1]?l+(h[1]+1)*d:d}return f}]};q.Animation=q.extend(aa,{tweener:function(a,b){q.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var d,e=0,f=a.length;f>e;e++)d=a[e],na[d]=na[d]||[],na[d].unshift(b)},prefilter:function(a,b){b?Fa.unshift(a):Fa.push(a)}});q.Tween=T;T.prototype={constructor:T,init:function(a,b,d,e,f,h){this.elem=a;this.prop=d;this.easing=f||"swing";this.options=b;this.start=this.now=this.cur();this.end=e;this.unit=h||(q.cssNumber[d]?"":"px")},cur:function(){var a=T.propHooks[this.prop];
return a&&a.get?a.get(this):T.propHooks._default.get(this)},run:function(a){var b,d=T.propHooks[this.prop];return this.pos=b=this.options.duration?q.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),d&&d.set?d.set(this):T.propHooks._default.set(this),this}};T.prototype.init.prototype=T.prototype;T.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||
a.elem.style&&null!=a.elem.style[a.prop]?(b=q.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){q.fx.step[a.prop]?q.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[q.cssProps[a.prop]]||q.cssHooks[a.prop])?q.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}};T.propHooks.scrollTop=T.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}};q.each(["toggle","show","hide"],function(a,b){var d=q.fn[b];q.fn[b]=function(a,e,f){return null==
a||"boolean"==typeof a?d.apply(this,arguments):this.animate(J(b,!0),a,e,f)}});q.fn.extend({fadeTo:function(a,b,d,e){return this.filter(z).css("opacity",0).show().end().animate({opacity:b},a,d,e)},animate:function(a,b,d,e){var f=q.isEmptyObject(a),h=q.speed(b,d,e),k=function(){var b=aa(this,q.extend({},a),h);k.finish=function(){b.stop(!0)};(f||I.get(this,"finish"))&&b.stop(!0)};return k.finish=k,f||!1===h.queue?this.each(k):this.queue(h.queue,k)},stop:function(a,b,e){var f=function(a){var b=a.stop;
delete a.stop;b(e)};return"string"!=typeof a&&(e=b,b=a,a=d),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,d=null!=a&&a+"queueHooks",h=q.timers,k=I.get(this);if(d)k[d]&&k[d].stop&&f(k[d]);else for(d in k)k[d]&&k[d].stop&&Xb.test(d)&&f(k[d]);for(d=h.length;d--;)h[d].elem!==this||null!=a&&h[d].queue!==a||(h[d].anim.stop(e),b=!1,h.splice(d,1));(b||!e)&&q.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,d=I.get(this),e=d[a+"queue"];b=d[a+"queueHooks"];
var f=q.timers,h=e?e.length:0;d.finish=!0;q.queue(this,a,[]);b&&b.cur&&b.cur.finish&&b.cur.finish.call(this);for(b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;h>b;b++)e[b]&&e[b].finish&&e[b].finish.call(this);delete d.finish})}});q.each({slideDown:J("show"),slideUp:J("hide"),slideToggle:J("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){q.fn[a]=function(a,d,e){return this.animate(b,a,d,e)}});q.speed=
function(a,b,d){var e=a&&"object"==typeof a?q.extend({},a):{complete:d||!d&&b||q.isFunction(a)&&a,duration:a,easing:d&&b||b&&!q.isFunction(b)&&b};return e.duration=q.fx.off?0:"number"==typeof e.duration?e.duration:e.duration in q.fx.speeds?q.fx.speeds[e.duration]:q.fx.speeds._default,(null==e.queue||!0===e.queue)&&(e.queue="fx"),e.old=e.complete,e.complete=function(){q.isFunction(e.old)&&e.old.call(this);e.queue&&q.dequeue(this,e.queue)},e};q.easing={linear:function(a){return a},swing:function(a){return 0.5-
Math.cos(a*Math.PI)/2}};q.timers=[];q.fx=T.prototype.init;q.fx.tick=function(){var a,b=q.timers,e=0;for(ua=q.now();b.length>e;e++)a=b[e],a()||b[e]!==a||b.splice(e--,1);b.length||q.fx.stop();ua=d};q.fx.timer=function(a){a()&&q.timers.push(a)&&q.fx.start()};q.fx.interval=13;q.fx.start=function(){Ia||(Ia=setInterval(q.fx.tick,q.fx.interval))};q.fx.stop=function(){clearInterval(Ia);Ia=null};q.fx.speeds={slow:600,fast:200,_default:400};q.fx.step={};q.expr&&q.expr.filters&&(q.expr.filters.animated=function(a){return q.grep(q.timers,
function(b){return a===b.elem}).length});q.fn.offset=function(a){if(arguments.length)return a===d?this:this.each(function(b){q.offset.setOffset(this,a,b)});var b,e,f=this[0],h={top:0,left:0},k=f&&f.ownerDocument;if(k)return b=k.documentElement,q.contains(b,f)?(typeof f.getBoundingClientRect!==X&&(h=f.getBoundingClientRect()),e=q.isWindow(k)?k:9===k.nodeType&&k.defaultView,{top:h.top+e.pageYOffset-b.clientTop,left:h.left+e.pageXOffset-b.clientLeft}):h};q.offset={setOffset:function(a,b,d){var e,f,h,
k,l,m,n=q.css(a,"position"),p=q(a),r={};"static"===n&&(a.style.position="relative");l=p.offset();h=q.css(a,"top");m=q.css(a,"left");("absolute"===n||"fixed"===n)&&-1<(h+m).indexOf("auto")?(e=p.position(),k=e.top,f=e.left):(k=parseFloat(h)||0,f=parseFloat(m)||0);q.isFunction(b)&&(b=b.call(a,d,l));null!=b.top&&(r.top=b.top-l.top+k);null!=b.left&&(r.left=b.left-l.left+f);"using"in b?b.using.call(a,r):p.css(r)}};q.fn.extend({position:function(){if(this[0]){var a,b,d=this[0],e={top:0,left:0};return"fixed"===
q.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),q.nodeName(a[0],"html")||(e=a.offset()),e.top+=q.css(a[0],"borderTopWidth",!0),e.left+=q.css(a[0],"borderLeftWidth",!0)),{top:b.top-e.top-q.css(d,"marginTop",!0),left:b.left-e.left-q.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||la;a&&!q.nodeName(a,"html")&&"static"===q.css(a,"position");)a=a.offsetParent;return a||la})}});q.each({scrollLeft:"pageXOffset",
scrollTop:"pageYOffset"},function(b,e){var f="pageYOffset"===e;q.fn[b]=function(h){return q.access(this,function(b,h,k){var l=q.isWindow(b)?b:9===b.nodeType&&b.defaultView;return k===d?l?l[e]:b[h]:(l?l.scrollTo(f?a.pageXOffset:k,f?k:a.pageYOffset):b[h]=k,d)},b,h,arguments.length,null)}});q.each({Height:"height",Width:"width"},function(a,b){q.each({padding:"inner"+a,content:b,"":"outer"+a},function(e,f){q.fn[f]=function(f,h){var k=arguments.length&&(e||"boolean"!=typeof f),l=e||(!0===f||!0===h?"margin":
"border");return q.access(this,function(b,e,f){var h;return q.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(h=b.documentElement,Math.max(b.body["scroll"+a],h["scroll"+a],b.body["offset"+a],h["offset"+a],h["client"+a])):f===d?q.css(b,e,l):q.style(b,e,f,l)},b,k?f:d,k,null)}})});q.fn.size=function(){return this.length};q.fn.andSelf=q.fn.addBack;"object"==typeof module&&"object"==typeof module.exports?module.exports=q:"function"==typeof define&&define.amd&&define("jquery",[],function(){return q});
"object"==typeof a&&"object"==typeof a.document&&(a.jQuery=a.$=q)})(window);(function(a,d){function b(b,d){var f,k,p,r=b.nodeName.toLowerCase();return"area"===r?(f=b.parentNode,k=f.name,!b.href||!k||"map"!==f.nodeName.toLowerCase()?!1:(p=a("img[usemap=#"+k+"]")[0],!!p&&e(p))):(/input|select|textarea|button|object/.test(r)?!b.disabled:"a"===r?b.href||d:d)&&e(b)}function e(b){return a.expr.filters.visible(b)&&!a(b).parents().andSelf().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var f=0,k=/^ui-id-\d+$/;a.ui=a.ui||{};a.ui.version||(a.extend(a.ui,{version:"1.9.2",
keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({_focus:a.fn.focus,focus:function(b,d){return"number"==typeof b?this.each(function(){var e=this;setTimeout(function(){a(e).focus();d&&d.call(e)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return a.ui.ie&&
/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(b){if(b!==
d)return this.css("zIndex",b);if(this.length){b=a(this[0]);for(var e;b.length&&b[0]!==document;){e=b.css("position");if("absolute"===e||"relative"===e||"fixed"===e)if(e=parseInt(b.css("zIndex"),10),!isNaN(e)&&0!==e)return e;b=b.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++f)})},removeUniqueId:function(){return this.each(function(){k.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(d){return!!a.data(d,
b)}}):function(b,d,e){return!!a.data(b,e[3])},focusable:function(d){return b(d,!isNaN(a.attr(d,"tabindex")))},tabbable:function(d){var e=a.attr(d,"tabindex"),f=isNaN(e);return(f||0<=e)&&b(d,!f)}}),a(function(){var b=document.body,d=b.appendChild(d=document.createElement("div"));d.offsetHeight;a.extend(d.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=100===d.offsetHeight;a.support.selectstart="onselectstart"in d;b.removeChild(d).style.display="none"}),a("<a>").outerWidth(1).jquery||
a.each(["Width","Height"],function(b,e){function f(b,d,e,h){return a.each(k,function(){d-=parseFloat(a.css(b,"padding"+this))||0;e&&(d-=parseFloat(a.css(b,"border"+this+"Width"))||0);h&&(d-=parseFloat(a.css(b,"margin"+this))||0)}),d}var k="Width"===e?["Left","Right"]:["Top","Bottom"],p=e.toLowerCase(),r={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+e]=function(b){return b===d?r["inner"+e].call(this):this.each(function(){a(this).css(p,
f(this,b)+"px")})};a.fn["outer"+e]=function(b,d){return"number"!=typeof b?r["outer"+e].call(this,b):this.each(function(){a(this).css(p,f(this,b,!0,d)+"px")})}}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(d){return arguments.length?b.call(this,a.camelCase(d)):b.call(this)}}(a.fn.removeData)),function(){var b=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];a.ui.ie=b.length?!0:!1;a.ui.ie6=6===parseFloat(b[1],10)}(),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?
"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,d,e){var f;b=a.ui[b].prototype;for(f in e)b.plugins[f]=b.plugins[f]||[],b.plugins[f].push([d,e[f]])},call:function(a,b,d){var e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(b=0;b<e.length;b++)a.options[e[b][0]]&&e[b][1].apply(a.element,d)}},contains:a.contains,hasScroll:function(b,
d){if("hidden"===a(b).css("overflow"))return!1;var e=d&&"left"===d?"scrollLeft":"scrollTop";return 0<b[e]?!0:(b[e]=1,b[e]=0,!1)},isOverAxis:function(a,b,d){return a>b&&a<b+d},isOver:function(b,d,e,f,k,r){return a.ui.isOverAxis(b,e,k)&&a.ui.isOverAxis(d,f,r)}}))})(jQuery);
(function(a,d){var b=0,e=Array.prototype.slice,f=a.cleanData;a.cleanData=function(b){for(var d=0,e;null!=(e=b[d]);d++)try{a(e).triggerHandler("remove")}catch(m){}f(b)};a.widget=function(b,d,e){var f,n,p,r,s=b.split(".")[0];b=b.split(".")[1];f=s+"-"+b;e||(e=d,d=a.Widget);a.expr[":"][f.toLowerCase()]=function(b){return!!a.data(b,f)};a[s]=a[s]||{};n=a[s][b];p=a[s][b]=function(a,b){if(!this._createWidget)return new p(a,b);arguments.length&&this._createWidget(a,b)};a.extend(p,n,{version:e.version,_proto:a.extend({},
e),_childConstructors:[]});r=new d;r.options=a.widget.extend({},r.options);a.each(e,function(b,f){a.isFunction(f)&&(e[b]=function(){var a=function(){return d.prototype[b].apply(this,arguments)},e=function(a){return d.prototype[b].apply(this,a)};return function(){var b=this._super,d=this._superApply,h;return this._super=a,this._superApply=e,h=f.apply(this,arguments),this._super=b,this._superApply=d,h}}())});p.prototype=a.widget.extend(r,{widgetEventPrefix:n?r.widgetEventPrefix:b},e,{constructor:p,
namespace:s,widgetName:b,widgetBaseClass:f,widgetFullName:f});n?(a.each(n._childConstructors,function(b,d){var e=d.prototype;a.widget(e.namespace+"."+e.widgetName,p,d._proto)}),delete n._childConstructors):d._childConstructors.push(p);a.widget.bridge(b,p)};a.widget.extend=function(b){for(var f=e.call(arguments,1),l=0,m=f.length,n,p;l<m;l++)for(n in f[l])p=f[l][n],f[l].hasOwnProperty(n)&&p!==d&&(a.isPlainObject(p)?b[n]=a.isPlainObject(b[n])?a.widget.extend({},b[n],p):a.widget.extend({},p):b[n]=p);
return b};a.widget.bridge=function(b,f){var l=f.prototype.widgetFullName||b;a.fn[b]=function(m){var n="string"==typeof m,p=e.call(arguments,1),r=this;return m=!n&&p.length?a.widget.extend.apply(null,[m].concat(p)):m,n?this.each(function(){var e,f=a.data(this,l);if(!f)return a.error("cannot call methods on "+b+" prior to initialization; attempted to call method '"+m+"'");if(!a.isFunction(f[m])||"_"===m.charAt(0))return a.error("no such method '"+m+"' for "+b+" widget instance");e=f[m].apply(f,p);if(e!==
f&&e!==d)return r=e&&e.jquery?r.pushStack(e.get()):e,!1}):this.each(function(){var b=a.data(this,l);b?b.option(m||{})._init():a.data(this,l,new f(m,this))}),r}};a.Widget=function(){};a.Widget._childConstructors=[];a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(d,e){e=a(e||this.defaultElement||this)[0];this.element=a(e);this.uuid=b++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=a.widget.extend({},
this.options,this._getCreateOptions(),d);this.bindings=a();this.hoverable=a();this.focusable=a();e!==this&&(a.data(e,this.widgetName,this),a.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===e&&this.destroy()}}),this.document=a(e.style?e.ownerDocument:e.document||e),this.window=a(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,
_create:a.noop,_init:a.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},
option:function(b,e){var f=b,m,n,p;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof b)if(f={},m=b.split("."),b=m.shift(),m.length){n=f[b]=a.widget.extend({},this.options[b]);for(p=0;p<m.length-1;p++)n[m[p]]=n[m[p]]||{},n=n[m[p]];b=m.pop();if(e===d)return n[b]===d?null:n[b];n[b]=e}else{if(e===d)return this.options[b]===d?null:this.options[b];f[b]=e}return this._setOptions(f),this},_setOptions:function(a){for(var b in a)this._setOption(b,a[b]);return this},_setOption:function(a,
b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,d,e){var f,n=this;"boolean"!=typeof b&&(e=d,d=b,b=!1);e?(d=f=a(d),this.bindings=this.bindings.add(d)):(e=d,d=this.element,f=
this.widget());a.each(e,function(e,l){function s(){if(b||!(!0===n.options.disabled||a(this).hasClass("ui-state-disabled")))return("string"==typeof l?n[l]:l).apply(n,arguments)}"string"!=typeof l&&(s.guid=l.guid=l.guid||s.guid||a.guid++);var v=e.match(/^(\w+)\s*(.*)$/),t=v[1]+n.eventNamespace;(v=v[2])?f.delegate(v,t,s):d.bind(t,s)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;a.unbind(b).undelegate(b)},_delay:function(a,b){var d=this;return setTimeout(function(){return("string"==
typeof a?d[a]:a).apply(d,arguments)},b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b);this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b);this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,d,e){var f,
n=this.options[b];e=e||{};d=a.Event(d);d.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();d.target=this.element[0];if(b=d.originalEvent)for(f in b)f in d||(d[f]=b[f]);return this.element.trigger(d,e),!(a.isFunction(n)&&!1===n.apply(this.element[0],[d].concat(e))||d.isDefaultPrevented())}};a.each({show:"fadeIn",hide:"fadeOut"},function(b,d){a.Widget.prototype["_"+b]=function(e,f,n){"string"==typeof f&&(f={effect:f});var p,r=f?!0===f||"number"==typeof f?d:f.effect||d:b;f=f||
{};"number"==typeof f&&(f={duration:f});p=!a.isEmptyObject(f);f.complete=n;f.delay&&e.delay(f.delay);p&&a.effects&&(a.effects.effect[r]||!1!==a.uiBackCompat&&a.effects[r])?e[b](f):r!==b&&e[r]?e[r](f.duration,f.easing,n):e.queue(function(d){a(this)[b]();n&&n.call(e[0]);d()})}});!1!==a.uiBackCompat&&(a.Widget.prototype._getCreateOptions=function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]})})(jQuery);
(function(a,d){var b=!1;a(document).mouseup(function(a){b=!1});a.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(d){if(!0===a.data(d.target,b.widgetName+".preventClickEvent"))return a.removeData(d.target,b.widgetName+".preventClickEvent"),d.stopImmediatePropagation(),!1});this.started=
!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(d){if(!b){this._mouseStarted&&this._mouseUp(d);this._mouseDownEvent=d;var f=this,k=1===d.which,h="string"==typeof this.options.cancel&&d.target.nodeName?a(d.target).closest(this.options.cancel).length:!1;if(!k||h||!this._mouseCapture(d))return!0;(this.mouseDelayMet=
!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){f.mouseDelayMet=!0},this.options.delay));return this._mouseDistanceMet(d)&&this._mouseDelayMet(d)&&(this._mouseStarted=!1!==this._mouseStart(d),!this._mouseStarted)?(d.preventDefault(),!0):(!0===a.data(d.target,this.widgetName+".preventClickEvent")&&a.removeData(d.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return f._mouseMove(a)},this._mouseUpDelegate=function(a){return f._mouseUp(a)},a(document).bind("mousemove."+
this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),d.preventDefault(),b=!0,!0)}},_mouseMove:function(b){return!a.ui.ie||9<=document.documentMode||b.button?this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,b),this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted):this._mouseUp(b)},_mouseUp:function(b){return a(document).unbind("mousemove."+
this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(a){return this.mouseDelayMet},_mouseStart:function(a){},
_mouseDrag:function(a){},_mouseStop:function(a){},_mouseCapture:function(a){return!0}})})(jQuery);
(function(a,d){function b(a,b,d){return[parseInt(a[0],10)*(r.test(a[0])?b/100:1),parseInt(a[1],10)*(r.test(a[1])?d/100:1)]}a.ui=a.ui||{};var e,f=Math.max,k=Math.abs,h=Math.round,l=/left|center|right/,m=/top|center|bottom/,n=/[\+\-]\d+%?/,p=/^\w+/,r=/%$/,s=a.fn.position;a.position={scrollbarWidth:function(){if(e!==d)return e;var b,f,h=a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),k=h.children()[0];return a("body").append(h),
b=k.offsetWidth,h.css("overflow","scroll"),f=k.offsetWidth,b===f&&(f=h[0].clientWidth),h.remove(),e=b-f},getScrollInfo:function(b){var d=b.isWindow?"":b.element.css("overflow-x"),e=b.isWindow?"":b.element.css("overflow-y"),e="scroll"===e||"auto"===e&&b.height<b.element[0].scrollHeight;return{width:"scroll"===d||"auto"===d&&b.width<b.element[0].scrollWidth?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){b=a(b||window);var d=a.isWindow(b[0]);return{element:b,
isWindow:d,offset:b.offset()||{left:0,top:0},scrollLeft:b.scrollLeft(),scrollTop:b.scrollTop(),width:d?b.width():b.outerWidth(),height:d?b.height():b.outerHeight()}}};a.fn.position=function(d){if(!d||!d.of)return s.apply(this,arguments);d=a.extend({},d);var e,r,w,y,z,A=a(d.of),F=a.position.getWithinInfo(d.within),u=a.position.getScrollInfo(F),C=A[0],B=(d.collision||"flip").split(" "),W={};return 9===C.nodeType?(r=A.width(),w=A.height(),y={top:0,left:0}):a.isWindow(C)?(r=A.width(),w=A.height(),y={top:A.scrollTop(),
left:A.scrollLeft()}):C.preventDefault?(d.at="left top",r=w=0,y={top:C.pageY,left:C.pageX}):(r=A.outerWidth(),w=A.outerHeight(),y=A.offset()),z=a.extend({},y),a.each(["my","at"],function(){var a=(d[this]||"").split(" "),b,e;1===a.length&&(a=l.test(a[0])?a.concat(["center"]):m.test(a[0])?["center"].concat(a):["center","center"]);a[0]=l.test(a[0])?a[0]:"center";a[1]=m.test(a[1])?a[1]:"center";b=n.exec(a[0]);e=n.exec(a[1]);W[this]=[b?b[0]:0,e?e[0]:0];d[this]=[p.exec(a[0])[0],p.exec(a[1])[0]]}),1===B.length&&
(B[1]=B[0]),"right"===d.at[0]?z.left+=r:"center"===d.at[0]&&(z.left+=r/2),"bottom"===d.at[1]?z.top+=w:"center"===d.at[1]&&(z.top+=w/2),e=b(W.at,r,w),z.left+=e[0],z.top+=e[1],this.each(function(){var l,m,n=a(this),p=n.outerWidth(),s=n.outerHeight(),C=parseInt(a.css(this,"marginLeft"),10)||0,aa=parseInt(a.css(this,"marginTop"),10)||0,ga=p+C+(parseInt(a.css(this,"marginRight"),10)||0)+u.width,T=s+aa+(parseInt(a.css(this,"marginBottom"),10)||0)+u.height,J=a.extend({},z),U=b(W.my,n.outerWidth(),n.outerHeight());
"right"===d.my[0]?J.left-=p:"center"===d.my[0]&&(J.left-=p/2);"bottom"===d.my[1]?J.top-=s:"center"===d.my[1]&&(J.top-=s/2);J.left+=U[0];J.top+=U[1];a.support.offsetFractions||(J.left=h(J.left),J.top=h(J.top));l={marginLeft:C,marginTop:aa};a.each(["left","top"],function(b,f){a.ui.position[B[b]]&&a.ui.position[B[b]][f](J,{targetWidth:r,targetHeight:w,elemWidth:p,elemHeight:s,collisionPosition:l,collisionWidth:ga,collisionHeight:T,offset:[e[0]+U[0],e[1]+U[1]],my:d.my,at:d.at,within:F,elem:n})});a.fn.bgiframe&&
n.bgiframe();d.using&&(m=function(a){var b=y.left-J.left,e=b+r-p,h=y.top-J.top,l=h+w-s,m={target:{element:A,left:y.left,top:y.top,width:r,height:w},element:{element:n,left:J.left,top:J.top,width:p,height:s},horizontal:0>e?"left":0<b?"right":"center",vertical:0>l?"top":0<h?"bottom":"middle"};r<p&&k(b+e)<r&&(m.horizontal="center");w<s&&k(h+l)<w&&(m.vertical="middle");f(k(b),k(e))>f(k(h),k(l))?m.important="horizontal":m.important="vertical";d.using.call(this,a,m)});n.offset(a.extend(J,{using:m}))})};
a.ui.position={fit:{left:function(a,b){var d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,d=d.width,h=a.left-b.collisionPosition.marginLeft,k=e-h,l=h+b.collisionWidth-d-e,m;b.collisionWidth>d?0<k&&0>=l?(m=a.left+k+b.collisionWidth-d-e,a.left+=k-m):0<l&&0>=k?a.left=e:k>l?a.left=e+d-b.collisionWidth:a.left=e:0<k?a.left+=k:0<l?a.left-=l:a.left=f(a.left-h,a.left)},top:function(a,b){var d=b.within,d=d.isWindow?d.scrollTop:d.offset.top,e=b.within.height,h=a.top-b.collisionPosition.marginTop,k=d-h,l=
h+b.collisionHeight-e-d,m;b.collisionHeight>e?0<k&&0>=l?(m=a.top+k+b.collisionHeight-e-d,a.top+=k-m):0<l&&0>=k?a.top=d:k>l?a.top=d+e-b.collisionHeight:a.top=d:0<k?a.top+=k:0<l?a.top-=l:a.top=f(a.top-h,a.top)}},flip:{left:function(a,b){var d=b.within,e=d.offset.left+d.scrollLeft,f=d.width,h=d.isWindow?d.scrollLeft:d.offset.left,l=a.left-b.collisionPosition.marginLeft,d=l-h,m=l+b.collisionWidth-f-h,l="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===
b.at[0]?-b.targetWidth:0,p=-2*b.offset[0];if(0>d){if(e=a.left+l+n+p+b.collisionWidth-f-e,0>e||e<k(d))a.left+=l+n+p}else if(0<m&&(e=a.left-b.collisionPosition.marginLeft+l+n+p-h,0<e||k(e)<m))a.left+=l+n+p},top:function(a,b){var d=b.within,e=d.offset.top+d.scrollTop,f=d.height,d=d.isWindow?d.scrollTop:d.offset.top,h=a.top-b.collisionPosition.marginTop,l=h-d,h=h+b.collisionHeight-f-d,m="top"===b.my[1]?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,n="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?
-b.targetHeight:0,p=-2*b.offset[1],r,s;0>l?(s=a.top+m+n+p+b.collisionHeight-f-e,a.top+m+n+p>l&&(0>s||s<k(l))&&(a.top+=m+n+p)):0<h&&(r=a.top-b.collisionPosition.marginTop+m+n+p-d,a.top+m+n+p>h&&(0<r||k(r)<h)&&(a.top+=m+n+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments);a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments);a.ui.position.fit.top.apply(this,arguments)}}};(function(){var b,d,e,f,h=document.getElementsByTagName("body")[0];
e=document.createElement("div");b=document.createElement(h?"div":"body");d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};h&&a.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in d)b.style[f]=d[f];b.appendChild(e);d=h||document.documentElement;d.insertBefore(b,d.firstChild);e.style.cssText="position: absolute; left: 10.7432222px;";e=a(e).offset().left;a.support.offsetFractions=10<e&&11>e;b.innerHTML="";d.removeChild(b)})();!1!==a.uiBackCompat&&function(a){var b=
a.fn.position;a.fn.position=function(e){if(!e||!e.offset)return b.call(this,e);var f=e.offset.split(" "),h=e.at.split(" ");return 1===f.length&&(f[1]=f[0]),/^\d/.test(f[0])&&(f[0]="+"+f[0]),/^\d/.test(f[1])&&(f[1]="+"+f[1]),1===h.length&&(/left|center|right/.test(h[0])?h[1]="center":(h[1]=h[0],h[0]="center")),b.call(this,a.extend(e,{at:h[0]+f[0]+" "+h[1]+f[1],offset:d}))}}(jQuery)})(jQuery);
(function(a,d){a.widget("ui.draggable",a.ui.mouse,{version:"1.9.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&
(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(b){var d=this.options;return this.helper||d.disabled||a(b.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(b),this.handle?(a(!0===d.iframeFix?
"iframe":d.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var d=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),
this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,
d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt),d.containment&&this._setContainment(),!1===this._trigger("start",b)?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,d){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");if(!d){var f=this._uiHash();if(!1===this._trigger("drag",b,f))return this._mouseUp({}),
!1;this.position=f.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";return a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var d=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b));this.dropped&&(d=this.dropped,this.dropped=!1);for(var f=this.element[0],k=!1;f&&(f=f.parentNode);)f==document&&(k=!0);
if(!k&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!d||"valid"==this.options.revert&&d||!0===this.options.revert||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)){var h=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==h._trigger("stop",b)&&h._clear()})}else!1!==this._trigger("stop",b)&&this._clear();return!1},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),
a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){var d=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;return a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(d=!0)}),d},_createHelper:function(b){var d=this.options;b=a.isFunction(d.helper)?a(d.helper.apply(this.element[0],
[b])):"clone"==d.helper?this.element.clone().removeAttr("id"):this.element;return b.parents("body").length||b.appendTo("parent"==d.appendTo?this.element[0].parentNode:d.appendTo),b[0]!=this.element[0]&&!/(fixed|absolute)/.test(b.css("position"))&&b.css("position","absolute"),b},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" "));a.isArray(b)&&(b={left:+b[0],top:+b[1]||0});"left"in b&&(this.offset.click.left=b.left+this.margins.left);"right"in b&&(this.offset.click.left=this.helperProportions.width-
b.right+this.margins.left);"top"in b&&(this.offset.click.top=b.top+this.margins.top);"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==
document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||
0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"==b.containment&&
(b.containment=this.helper[0].parentNode);if("document"==b.containment||"window"==b.containment)this.containment=["document"==b.containment?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==b.containment?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==b.containment?0:a(window).scrollLeft())+a("document"==b.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==b.containment?0:a(window).scrollTop())+
(a("document"==b.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var b=a(b.containment),d=b[0];if(d){b.offset();var f="hidden"!=a(d).css("overflow");this.containment=[(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0),(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||
0),(f?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(f?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=b}}else b.containment.constructor==Array&&(this.containment=
b.containment)},_convertPositionTo:function(b,d){d||(d=this.position);var f="absolute"==b?1:-1,k="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(k[0].tagName);return{top:d.top+this.offset.relative.top*f+this.offset.parent.top*f-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():h?0:k.scrollTop())*f,left:d.left+this.offset.relative.left*f+this.offset.parent.left*f-("fixed"==
this.cssPosition?-this.scrollParent.scrollLeft():h?0:k.scrollLeft())*f}},_generatePosition:function(b){var d=this.options,f="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,k=/(html|body)/i.test(f[0].tagName),h=b.pageX,l=b.pageY;if(this.originalPosition){var m;this.containment&&(this.relative_container?(m=this.relative_container.offset(),m=[this.containment[0]+m.left,this.containment[1]+m.top,this.containment[2]+
m.left,this.containment[3]+m.top]):m=this.containment,b.pageX-this.offset.click.left<m[0]&&(h=m[0]+this.offset.click.left),b.pageY-this.offset.click.top<m[1]&&(l=m[1]+this.offset.click.top),b.pageX-this.offset.click.left>m[2]&&(h=m[2]+this.offset.click.left),b.pageY-this.offset.click.top>m[3]&&(l=m[3]+this.offset.click.top));d.grid&&(l=d.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/d.grid[1])*d.grid[1]:this.originalPageY,l=m?l-this.offset.click.top<m[1]||l-this.offset.click.top>m[3]?
l-this.offset.click.top<m[1]?l+d.grid[1]:l-d.grid[1]:l:l,h=d.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/d.grid[0])*d.grid[0]:this.originalPageX,h=m?h-this.offset.click.left<m[0]||h-this.offset.click.left>m[2]?h-this.offset.click.left<m[0]?h+d.grid[0]:h-d.grid[0]:h:h)}return{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():k?0:f.scrollTop()),left:h-this.offset.click.left-this.offset.relative.left-
this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():k?0:f.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(b,d,f){return f=f||this._uiHash(),a.ui.plugin.call(this,b,[d,f]),"drag"==b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,d,f)},plugins:{},
_uiHash:function(a){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.ui.plugin.add("draggable","connectToSortable",{start:function(b,d){var f=a(this).data("draggable"),k=f.options,h=a.extend({},d,{item:f.element});f.sortables=[];a(k.connectToSortable).each(function(){var d=a.data(this,"sortable");d&&!d.options.disabled&&(f.sortables.push({instance:d,shouldRevert:d.options.revert}),d.refreshPositions(),d._trigger("activate",b,h))})},
stop:function(b,d){var f=a(this).data("draggable"),k=a.extend({},d,{item:f.element});a.each(f.sortables,function(){this.instance.isOver?(this.instance.isOver=0,f.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"==f.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",
b,k))})},drag:function(b,d){var f=a(this).data("draggable"),k=this;a.each(f.sortables,function(h){var l=!1,m=this;this.instance.positionAbs=f.positionAbs;this.instance.helperProportions=f.helperProportions;this.instance.offset.click=f.offset.click;this.instance._intersectsWith(this.instance.containerCache)&&(l=!0,a.each(f.sortables,function(){return this.instance.positionAbs=f.positionAbs,this.instance.helperProportions=f.helperProportions,this.instance.offset.click=f.offset.click,this!=m&&this.instance._intersectsWith(this.instance.containerCache)&&
a.ui.contains(m.instance.element[0],this.instance.element[0])&&(l=!1),l}));l?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(k).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return d.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=f.offset.click.top,
this.instance.offset.click.left=f.offset.click.left,this.instance.offset.parent.left-=f.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=f.offset.parent.top-this.instance.offset.parent.top,f._trigger("toSortable",b),f.dropped=this.instance.element,f.currentItem=f.element,this.instance.fromOutside=f),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=
!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),f._trigger("fromSortable",b),f.dropped=!1)})}});a.ui.plugin.add("draggable","cursor",{start:function(b,d){var f=a("body"),k=a(this).data("draggable").options;f.css("cursor")&&(k._cursor=f.css("cursor"));f.css("cursor",k.cursor)},stop:function(b,
d){var f=a(this).data("draggable").options;f._cursor&&a("body").css("cursor",f._cursor)}});a.ui.plugin.add("draggable","opacity",{start:function(b,d){var f=a(d.helper),k=a(this).data("draggable").options;f.css("opacity")&&(k._opacity=f.css("opacity"));f.css("opacity",k.opacity)},stop:function(b,d){var f=a(this).data("draggable").options;f._opacity&&a(d.helper).css("opacity",f._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(b,d){var f=a(this).data("draggable");f.scrollParent[0]!=
document&&"HTML"!=f.scrollParent[0].tagName&&(f.overflowOffset=f.scrollParent.offset())},drag:function(b,d){var f=a(this).data("draggable"),k=f.options,h=!1;if(f.scrollParent[0]!=document&&"HTML"!=f.scrollParent[0].tagName){if(!k.axis||"x"!=k.axis)f.overflowOffset.top+f.scrollParent[0].offsetHeight-b.pageY<k.scrollSensitivity?f.scrollParent[0].scrollTop=h=f.scrollParent[0].scrollTop+k.scrollSpeed:b.pageY-f.overflowOffset.top<k.scrollSensitivity&&(f.scrollParent[0].scrollTop=h=f.scrollParent[0].scrollTop-
k.scrollSpeed);if(!k.axis||"y"!=k.axis)f.overflowOffset.left+f.scrollParent[0].offsetWidth-b.pageX<k.scrollSensitivity?f.scrollParent[0].scrollLeft=h=f.scrollParent[0].scrollLeft+k.scrollSpeed:b.pageX-f.overflowOffset.left<k.scrollSensitivity&&(f.scrollParent[0].scrollLeft=h=f.scrollParent[0].scrollLeft-k.scrollSpeed)}else{if(!k.axis||"x"!=k.axis)b.pageY-a(document).scrollTop()<k.scrollSensitivity?h=a(document).scrollTop(a(document).scrollTop()-k.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<
k.scrollSensitivity&&(h=a(document).scrollTop(a(document).scrollTop()+k.scrollSpeed));if(!k.axis||"y"!=k.axis)b.pageX-a(document).scrollLeft()<k.scrollSensitivity?h=a(document).scrollLeft(a(document).scrollLeft()-k.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<k.scrollSensitivity&&(h=a(document).scrollLeft(a(document).scrollLeft()+k.scrollSpeed))}!1!==h&&a.ui.ddmanager&&!k.dropBehaviour&&a.ui.ddmanager.prepareOffsets(f,b)}});a.ui.plugin.add("draggable","snap",{start:function(b,
d){var f=a(this).data("draggable"),k=f.options;f.snapElements=[];a(k.snap.constructor!=String?k.snap.items||":data(draggable)":k.snap).each(function(){var b=a(this),d=b.offset();this!=f.element[0]&&f.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:d.top,left:d.left})})},drag:function(b,d){for(var f=a(this).data("draggable"),k=f.options,h=k.snapTolerance,l=d.offset.left,m=l+f.helperProportions.width,n=d.offset.top,p=n+f.helperProportions.height,r=f.snapElements.length-
1;0<=r;r--){var s=f.snapElements[r].left,v=s+f.snapElements[r].width,t=f.snapElements[r].top,x=t+f.snapElements[r].height;if(s-h<l&&l<v+h&&t-h<n&&n<x+h||s-h<l&&l<v+h&&t-h<p&&p<x+h||s-h<m&&m<v+h&&t-h<n&&n<x+h||s-h<m&&m<v+h&&t-h<p&&p<x+h){if("inner"!=k.snapMode){var w=Math.abs(t-p)<=h,y=Math.abs(x-n)<=h,z=Math.abs(s-m)<=h,A=Math.abs(v-l)<=h;w&&(d.position.top=f._convertPositionTo("relative",{top:t-f.helperProportions.height,left:0}).top-f.margins.top);y&&(d.position.top=f._convertPositionTo("relative",
{top:x,left:0}).top-f.margins.top);z&&(d.position.left=f._convertPositionTo("relative",{top:0,left:s-f.helperProportions.width}).left-f.margins.left);A&&(d.position.left=f._convertPositionTo("relative",{top:0,left:v}).left-f.margins.left)}var F=w||y||z||A;"outer"!=k.snapMode&&(w=Math.abs(t-n)<=h,y=Math.abs(x-p)<=h,z=Math.abs(s-l)<=h,A=Math.abs(v-m)<=h,w&&(d.position.top=f._convertPositionTo("relative",{top:t,left:0}).top-f.margins.top),y&&(d.position.top=f._convertPositionTo("relative",{top:x-f.helperProportions.height,
left:0}).top-f.margins.top),z&&(d.position.left=f._convertPositionTo("relative",{top:0,left:s}).left-f.margins.left),A&&(d.position.left=f._convertPositionTo("relative",{top:0,left:v-f.helperProportions.width}).left-f.margins.left));!f.snapElements[r].snapping&&(w||y||z||A||F)&&f.options.snap.snap&&f.options.snap.snap.call(f.element,b,a.extend(f._uiHash(),{snapItem:f.snapElements[r].item}));f.snapElements[r].snapping=w||y||z||A||F}else f.snapElements[r].snapping&&f.options.snap.release&&f.options.snap.release.call(f.element,
b,a.extend(f._uiHash(),{snapItem:f.snapElements[r].item})),f.snapElements[r].snapping=!1}}});a.ui.plugin.add("draggable","stack",{start:function(b,d){var f=a(this).data("draggable").options,f=a.makeArray(a(f.stack)).sort(function(b,d){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(d).css("zIndex"),10)||0)});if(f.length){var k=parseInt(f[0].style.zIndex)||0;a(f).each(function(a){this.style.zIndex=k+a});this[0].style.zIndex=k+f.length}}});a.ui.plugin.add("draggable","zIndex",{start:function(b,
d){var f=a(d.helper),k=a(this).data("draggable").options;f.css("zIndex")&&(k._zIndex=f.css("zIndex"));f.css("zIndex",k.zIndex)},stop:function(b,d){var f=a(this).data("draggable").options;f._zIndex&&a(d.helper).css("zIndex",f._zIndex)}})})(jQuery);
(function(a,d){a.widget("ui.droppable",{version:"1.9.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var b=this.options,d=b.accept;this.isover=0;this.isout=1;this.accept=a.isFunction(d)?d:function(a){return a.is(d)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[];a.ui.ddmanager.droppables[b.scope].push(this);
b.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var b=a.ui.ddmanager.droppables[this.options.scope],d=0;d<b.length;d++)b[d]==this&&b.splice(d,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(b,d){"accept"==b&&(this.accept=a.isFunction(d)?d:function(a){return a.is(d)});a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var d=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass);
d&&this._trigger("activate",b,this.ui(d))},_deactivate:function(b){var d=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);d&&this._trigger("deactivate",b,this.ui(d))},_over:function(b){var d=a.ui.ddmanager.current;if(d&&(d.currentItem||d.element)[0]!=this.element[0])this.accept.call(this.element[0],d.currentItem||d.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(d)))},_out:function(b){var d=
a.ui.ddmanager.current;if(d&&(d.currentItem||d.element)[0]!=this.element[0])this.accept.call(this.element[0],d.currentItem||d.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(d)))},_drop:function(b,d){var f=d||a.ui.ddmanager.current;if(!f||(f.currentItem||f.element)[0]==this.element[0])return!1;var k=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"droppable");if(b.options.greedy&&
!b.options.disabled&&b.options.scope==f.options.scope&&b.accept.call(b.element[0],f.currentItem||f.element)&&a.ui.intersect(f,a.extend(b,{offset:b.element.offset()}),b.options.tolerance))return k=!0,!1}),k?!1:this.accept.call(this.element[0],f.currentItem||f.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(f)),this.element):!1},ui:function(a){return{draggable:a.currentItem||
a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}});a.ui.intersect=function(b,d,f){if(!d.offset)return!1;var k=(b.positionAbs||b.position.absolute).left,h=k+b.helperProportions.width,l=(b.positionAbs||b.position.absolute).top,m=l+b.helperProportions.height,n=d.offset.left,p=n+d.proportions.width,r=d.offset.top,s=r+d.proportions.height;switch(f){case "fit":return n<=k&&h<=p&&r<=l&&m<=s;case "intersect":return n<k+b.helperProportions.width/2&&h-b.helperProportions.width/2<p&&r<l+
b.helperProportions.height/2&&m-b.helperProportions.height/2<s;case "pointer":return a.ui.isOver((b.positionAbs||b.position.absolute).top+(b.clickOffset||b.offset.click).top,(b.positionAbs||b.position.absolute).left+(b.clickOffset||b.offset.click).left,r,n,d.proportions.height,d.proportions.width);case "touch":return(l>=r&&l<=s||m>=r&&m<=s||l<r&&m>s)&&(k>=n&&k<=p||h>=n&&h<=p||k<n&&h>p);default:return!1}};a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,d){var f=a.ui.ddmanager.droppables[b.options.scope]||
[],k=d?d.type:null,h=(b.currentItem||b.element).find(":data(droppable)").andSelf(),l=0;a:for(;l<f.length;l++)if(!(f[l].options.disabled||b&&!f[l].accept.call(f[l].element[0],b.currentItem||b.element))){for(var m=0;m<h.length;m++)if(h[m]==f[l].element[0]){f[l].proportions.height=0;continue a}f[l].visible="none"!=f[l].element.css("display");f[l].visible&&("mousedown"==k&&f[l]._activate.call(f[l],d),f[l].offset=f[l].element.offset(),f[l].proportions={width:f[l].element[0].offsetWidth,height:f[l].element[0].offsetHeight})}},
drop:function(b,d){var f=!1;return a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(f=this._drop.call(this,d)||f),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,d)))}),f},dragStart:function(b,d){b.element.parentsUntil("body").bind("scroll.droppable",function(){b.options.refreshPositions||
a.ui.ddmanager.prepareOffsets(b,d)})},drag:function(b,d){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,d);a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var f=a.ui.intersect(b,this,this.options.tolerance);if(f=!f&&1==this.isover?"isout":f&&0==this.isover?"isover":null){var k;if(this.options.greedy){var h=this.options.scope,l=this.element.parents(":data(droppable)").filter(function(){return a.data(this,"droppable").options.scope===
h});l.length&&(k=a.data(l[0],"droppable"),k.greedyChild="isover"==f?1:0)}k&&"isover"==f&&(k.isover=0,k.isout=1,k._out.call(k,d));this[f]=1;this["isout"==f?"isover":"isout"]=0;this["isover"==f?"_over":"_out"].call(this,d);k&&"isout"==f&&(k.isout=0,k.isover=1,k._over.call(k,d))}}})},dragStop:function(b,d){b.element.parentsUntil("body").unbind("scroll.droppable");b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,d)}}})(jQuery);
(function(a,d){a.widget("ui.resizable",a.ui.mouse,{version:"1.9.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1E3},_create:function(){var b=this,d=this.options;this.element.addClass("ui-resizable");a.extend(this,{_aspectRatio:!!d.aspectRatio,aspectRatio:d.aspectRatio,originalElement:this.element,
_proportionallyResizeElements:[],_helper:d.helper||d.ghost||d.animate?d.helper||"ui-resizable-helper":null});this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(a('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),
this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",
zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize());this.handles=d.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var e=this.handles.split(",");
this.handles={};for(var l=0;l<e.length;l++){var m=a.trim(e[l]),n=a('<div class="ui-resizable-handle ui-resizable-'+m+'"></div>');n.css({zIndex:d.zIndex});"se"==m&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[m]=".ui-resizable-"+m;this.element.append(n)}}this._renderAxis=function(b){b=b||this.element;for(var d in this.handles){this.handles[d].constructor==String&&(this.handles[d]=a(this.handles[d],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var e=
a(this.handles[d],this.element),f=0,f=/sw|ne|nw|se|n|s/.test(d)?e.outerHeight():e.outerWidth(),e=["padding",/ne|nw|n/.test(d)?"Top":/se|sw|s/.test(d)?"Bottom":/^e$/.test(d)?"Right":"Left"].join("");b.css(e,f);this._proportionallyResize()}a(this.handles[d])}};this._renderAxis(this.element);this._handles=a(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!b.resizing){if(this.className)var a=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=
a&&a[1]?a[1]:"se"}});d.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").mouseenter(function(){d.disabled||(a(this).removeClass("ui-resizable-autohide"),b._handles.show())}).mouseleave(function(){d.disabled||b.resizing||(a(this).addClass("ui-resizable-autohide"),b._handles.hide())}));this._mouseInit()},_destroy:function(){this._mouseDestroy();var b=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};
if(this.elementIsWrapper){b(this.element);var d=this.element;this.originalElement.css({position:d.css("position"),width:d.outerWidth(),height:d.outerHeight(),top:d.css("top"),left:d.css("left")}).insertAfter(d);d.remove()}return this.originalElement.css("resize",this.originalResizeStyle),b(this.originalElement),this},_mouseCapture:function(b){var d=!1,e;for(e in this.handles)a(this.handles[e])[0]==b.target&&(d=!0);return!this.options.disabled&&d},_mouseStart:function(d){var e=this.options,h=this.element.position(),
l=this.element;this.resizing=!0;this.documentScroll={top:a(document).scrollTop(),left:a(document).scrollLeft()};(l.is(".ui-draggable")||/absolute/.test(l.css("position")))&&l.css({position:"absolute",top:h.top,left:h.left});this._renderProxy();var h=b(this.helper.css("left")),m=b(this.helper.css("top"));e.containment&&(h+=a(e.containment).scrollLeft()||0,m+=a(e.containment).scrollTop()||0);this.offset=this.helper.offset();this.position={left:h,top:m};this.size=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:
{width:l.width(),height:l.height()};this.originalSize=this._helper?{width:l.outerWidth(),height:l.outerHeight()}:{width:l.width(),height:l.height()};this.originalPosition={left:h,top:m};this.sizeDiff={width:l.outerWidth()-l.width(),height:l.outerHeight()-l.height()};this.originalMousePosition={left:d.pageX,top:d.pageY};this.aspectRatio="number"==typeof e.aspectRatio?e.aspectRatio:this.originalSize.width/this.originalSize.height||1;e=a(".ui-resizable-"+this.axis).css("cursor");return a("body").css("cursor",
"auto"==e?this.axis+"-resize":e),l.addClass("ui-resizable-resizing"),this._propagate("start",d),!0},_mouseDrag:function(a){var b=this.helper,d=this.originalMousePosition,e=this._change[this.axis];if(!e)return!1;d=e.apply(this,[a,a.pageX-d.left||0,a.pageY-d.top||0]);this._updateVirtualBoundaries(a.shiftKey);if(this._aspectRatio||a.shiftKey)d=this._updateRatio(d,a);return d=this._respectSize(d,a),this._propagate("resize",a),b.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+
"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(d),this._trigger("resize",a,this.ui()),!1},_mouseStop:function(b){this.resizing=!1;var d=this.options;if(this._helper){var e=this._proportionallyResizeElements,l=e.length&&/textarea/i.test(e[0].nodeName),e=l&&a.ui.hasScroll(e[0],"left")?0:this.sizeDiff.height,l=l?0:this.sizeDiff.width,l={width:this.helper.width()-l,height:this.helper.height()-e},e=parseInt(this.element.css("left"),
10)+(this.position.left-this.originalPosition.left)||null,m=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null;d.animate||this.element.css(a.extend(l,{top:m,left:e}));this.helper.height(this.size.height);this.helper.width(this.size.width);this._helper&&!d.animate&&this._proportionallyResize()}return a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(a){var b=
this.options,d,l,m,b={minWidth:e(b.minWidth)?b.minWidth:0,maxWidth:e(b.maxWidth)?b.maxWidth:Infinity,minHeight:e(b.minHeight)?b.minHeight:0,maxHeight:e(b.maxHeight)?b.maxHeight:Infinity};if(this._aspectRatio||a)a=b.minHeight*this.aspectRatio,l=b.minWidth/this.aspectRatio,d=b.maxHeight*this.aspectRatio,m=b.maxWidth/this.aspectRatio,a>b.minWidth&&(b.minWidth=a),l>b.minHeight&&(b.minHeight=l),d<b.maxWidth&&(b.maxWidth=d),m<b.maxHeight&&(b.maxHeight=m);this._vBoundaries=b},_updateCache:function(a){this.offset=
this.helper.offset();e(a.left)&&(this.position.left=a.left);e(a.top)&&(this.position.top=a.top);e(a.height)&&(this.size.height=a.height);e(a.width)&&(this.size.width=a.width)},_updateRatio:function(a,b){var d=this.position,l=this.size,m=this.axis;return e(a.height)?a.width=a.height*this.aspectRatio:e(a.width)&&(a.height=a.width/this.aspectRatio),"sw"==m&&(a.left=d.left+(l.width-a.width),a.top=null),"nw"==m&&(a.top=d.top+(l.height-a.height),a.left=d.left+(l.width-a.width)),a},_respectSize:function(a,
b){var d=this._vBoundaries,l=this.axis,m=e(a.width)&&d.maxWidth&&d.maxWidth<a.width,n=e(a.height)&&d.maxHeight&&d.maxHeight<a.height,p=e(a.width)&&d.minWidth&&d.minWidth>a.width,r=e(a.height)&&d.minHeight&&d.minHeight>a.height;p&&(a.width=d.minWidth);r&&(a.height=d.minHeight);m&&(a.width=d.maxWidth);n&&(a.height=d.maxHeight);var s=this.originalPosition.left+this.originalSize.width,v=this.position.top+this.size.height,t=/sw|nw|w/.test(l),l=/nw|ne|n/.test(l);p&&t&&(a.left=s-d.minWidth);m&&t&&(a.left=
s-d.maxWidth);r&&l&&(a.top=v-d.minHeight);n&&l&&(a.top=v-d.maxHeight);d=!a.width&&!a.height;return d&&!a.left&&a.top?a.top=null:d&&!a.top&&a.left&&(a.left=null),a},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var b=this.helper||this.element,d=0;d<this._proportionallyResizeElements.length;d++){var e=this._proportionallyResizeElements[d];if(!this.borderDif){var l=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],
m=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];this.borderDif=a.map(l,function(a,b){var d=parseInt(a,10)||0,e=parseInt(m[b],10)||0;return d+e})}e.css({height:b.height()-this.borderDif[0]-this.borderDif[2]||0,width:b.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var b=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||a('<div style="overflow:hidden;"></div>');var d=a.ui.ie6?1:0,e=a.ui.ie6?
2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+e,height:this.element.outerHeight()+e,position:"absolute",left:this.elementOffset.left-d+"px",top:this.elementOffset.top-d+"px",zIndex:++b.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(a,b,d){return{width:this.originalSize.width+b}},w:function(a,b,d){return{left:this.originalPosition.left+b,width:this.originalSize.width-b}},n:function(a,b,d){return{top:this.originalPosition.top+
d,height:this.originalSize.height-d}},s:function(a,b,d){return{height:this.originalSize.height+d}},se:function(b,d,e){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,d,e]))},sw:function(b,d,e){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,d,e]))},ne:function(b,d,e){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,d,e]))},nw:function(b,d,e){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,
[b,d,e]))}},_propagate:function(b,d){a.ui.plugin.call(this,b,[d,this.ui()]);"resize"!=b&&this._trigger(b,d,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});a.ui.plugin.add("resizable","alsoResize",{start:function(b,d){var e=a(this).data("resizable").options,l=function(b){a(b).each(function(){var b=a(this);b.data("resizable-alsoresize",
{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})};"object"==typeof e.alsoResize&&!e.alsoResize.parentNode?e.alsoResize.length?(e.alsoResize=e.alsoResize[0],l(e.alsoResize)):a.each(e.alsoResize,function(a){l(a)}):l(e.alsoResize)},resize:function(b,d){var e=a(this).data("resizable"),l=e.options,m=e.originalSize,n=e.originalPosition,p={height:e.size.height-m.height||0,width:e.size.width-m.width||0,top:e.position.top-n.top||
0,left:e.position.left-n.left||0},r=function(b,e){a(b).each(function(){var b=a(this),f=a(this).data("resizable-alsoresize"),h={},l=e&&e.length?e:b.parents(d.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(l,function(a,b){var d=(f[b]||0)+(p[b]||0);d&&0<=d&&(h[b]=d||null)});b.css(h)})};"object"==typeof l.alsoResize&&!l.alsoResize.nodeType?a.each(l.alsoResize,function(a,b){r(a,b)}):r(l.alsoResize)},stop:function(b,d){a(this).removeData("resizable-alsoresize")}});
a.ui.plugin.add("resizable","animate",{stop:function(b,d){var e=a(this).data("resizable"),l=e.options,m=e._proportionallyResizeElements,n=m.length&&/textarea/i.test(m[0].nodeName),p=n&&a.ui.hasScroll(m[0],"left")?0:e.sizeDiff.height,n={width:e.size.width-(n?0:e.sizeDiff.width),height:e.size.height-p},p=parseInt(e.element.css("left"),10)+(e.position.left-e.originalPosition.left)||null,r=parseInt(e.element.css("top"),10)+(e.position.top-e.originalPosition.top)||null;e.element.animate(a.extend(n,r&&
p?{top:r,left:p}:{}),{duration:l.animateDuration,easing:l.animateEasing,step:function(){var d={width:parseInt(e.element.css("width"),10),height:parseInt(e.element.css("height"),10),top:parseInt(e.element.css("top"),10),left:parseInt(e.element.css("left"),10)};m&&m.length&&a(m[0]).css({width:d.width,height:d.height});e._updateCache(d);e._propagate("resize",b)}})}});a.ui.plugin.add("resizable","containment",{start:function(d,e){var h=a(this).data("resizable"),l=h.element,m=h.options.containment;if(l=
m instanceof a?m.get(0):/parent/.test(m)?l.parent().get(0):m)if(h.containerElement=a(l),/document/.test(m)||m==document)h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight};else{var n=a(l),p=[];a(["Top","Right","Left","Bottom"]).each(function(a,d){p[a]=b(n.css("padding"+d))});h.containerOffset=n.offset();h.containerPosition=n.position();h.containerSize=
{height:n.innerHeight()-p[3],width:n.innerWidth()-p[1]};var m=h.containerOffset,r=h.containerSize.height,s=h.containerSize.width,s=a.ui.hasScroll(l,"left")?l.scrollWidth:s,r=a.ui.hasScroll(l)?l.scrollHeight:r;h.parentData={element:l,left:m.left,top:m.top,width:s,height:r}}},resize:function(b,d){var e=a(this).data("resizable"),l=e.options,m=e.containerOffset,n=e.position,p=e._aspectRatio||b.shiftKey,r={top:0,left:0},s=e.containerElement;s[0]!=document&&/static/.test(s.css("position"))&&(r=m);n.left<
(e._helper?m.left:0)&&(e.size.width+=e._helper?e.position.left-m.left:e.position.left-r.left,p&&(e.size.height=e.size.width/e.aspectRatio),e.position.left=l.helper?m.left:0);n.top<(e._helper?m.top:0)&&(e.size.height+=e._helper?e.position.top-m.top:e.position.top,p&&(e.size.width=e.size.height*e.aspectRatio),e.position.top=e._helper?m.top:0);e.offset.left=e.parentData.left+e.position.left;e.offset.top=e.parentData.top+e.position.top;l=Math.abs(e.offset.left-r.left+e.sizeDiff.width);m=Math.abs((e._helper?
e.offset.top-r.top:e.offset.top-m.top)+e.sizeDiff.height);r=e.containerElement.get(0)==e.element.parent().get(0);n=/relative|absolute/.test(e.containerElement.css("position"));r&&n&&(l-=e.parentData.left);l+e.size.width>=e.parentData.width&&(e.size.width=e.parentData.width-l,p&&(e.size.height=e.size.width/e.aspectRatio));m+e.size.height>=e.parentData.height&&(e.size.height=e.parentData.height-m,p&&(e.size.width=e.size.height*e.aspectRatio))},stop:function(b,d){var e=a(this).data("resizable"),l=e.options,
m=e.containerOffset,n=e.containerPosition,p=e.containerElement,r=a(e.helper),s=r.offset(),v=r.outerWidth()-e.sizeDiff.width,r=r.outerHeight()-e.sizeDiff.height;e._helper&&!l.animate&&/relative/.test(p.css("position"))&&a(this).css({left:s.left-n.left-m.left,width:v,height:r});e._helper&&!l.animate&&/static/.test(p.css("position"))&&a(this).css({left:s.left-n.left-m.left,width:v,height:r})}});a.ui.plugin.add("resizable","ghost",{start:function(b,d){var e=a(this).data("resizable"),l=e.options,m=e.size;
e.ghost=e.originalElement.clone();e.ghost.css({opacity:0.25,display:"block",position:"relative",height:m.height,width:m.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof l.ghost?l.ghost:"");e.ghost.appendTo(e.helper)},resize:function(b,d){var e=a(this).data("resizable");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(b,d){var e=a(this).data("resizable");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}});
a.ui.plugin.add("resizable","grid",{resize:function(b,d){var e=a(this).data("resizable"),l=e.options,m=e.size,n=e.originalSize,p=e.originalPosition,r=e.axis;l.grid="number"==typeof l.grid?[l.grid,l.grid]:l.grid;var s=Math.round((m.width-n.width)/(l.grid[0]||1))*(l.grid[0]||1),l=Math.round((m.height-n.height)/(l.grid[1]||1))*(l.grid[1]||1);/^(se|s|e)$/.test(r)?(e.size.width=n.width+s,e.size.height=n.height+l):/^(ne)$/.test(r)?(e.size.width=n.width+s,e.size.height=n.height+l,e.position.top=p.top-l):
/^(sw)$/.test(r)?(e.size.width=n.width+s,e.size.height=n.height+l,e.position.left=p.left-s):(e.size.width=n.width+s,e.size.height=n.height+l,e.position.top=p.top-l,e.position.left=p.left-s)}});var b=function(a){return parseInt(a,10)||0},e=function(a){return!isNaN(parseInt(a,10))}})(jQuery);
(function(a,d){a.widget("ui.selectable",a.ui.mouse,{version:"1.9.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var b=this;this.element.addClass("ui-selectable");this.dragged=!1;var d;this.refresh=function(){d=a(b.options.filter,b.element[0]);d.addClass("ui-selectee");d.each(function(){var b=a(this),d=b.offset();a.data(this,"selectable-item",{element:this,$element:b,left:d.left,top:d.top,right:d.left+b.outerWidth(),bottom:d.top+b.outerHeight(),
startselected:!1,selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})};this.refresh();this.selectees=d.addClass("ui-selectee");this._mouseInit();this.helper=a("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");this._mouseDestroy()},_mouseStart:function(b){var d=this;this.opos=[b.pageX,
b.pageY];if(!this.options.disabled){var f=this.options;this.selectees=a(f.filter,this.element[0]);this._trigger("start",b);a(f.appendTo).append(this.helper);this.helper.css({left:b.clientX,top:b.clientY,width:0,height:0});f.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var f=a.data(this,"selectable-item");f.startselected=!0;!b.metaKey&&!b.ctrlKey&&(f.$element.removeClass("ui-selected"),f.selected=!1,f.$element.addClass("ui-unselecting"),f.unselecting=!0,d._trigger("unselecting",
b,{unselecting:f.element}))});a(b.target).parents().andSelf().each(function(){var f=a.data(this,"selectable-item");if(f){var h=!b.metaKey&&!b.ctrlKey||!f.$element.hasClass("ui-selected");return f.$element.removeClass(h?"ui-unselecting":"ui-selected").addClass(h?"ui-selecting":"ui-unselecting"),f.unselecting=!h,f.selecting=h,f.selected=h,h?d._trigger("selecting",b,{selecting:f.element}):d._trigger("unselecting",b,{unselecting:f.element}),!1}})}},_mouseDrag:function(b){var d=this;this.dragged=!0;if(!this.options.disabled){var f=
this.options,k=this.opos[0],h=this.opos[1],l=b.pageX,m=b.pageY;if(k>l)var n=l,l=k,k=n;h>m&&(n=m,m=h,h=n);return this.helper.css({left:k,top:h,width:l-k,height:m-h}),this.selectees.each(function(){var n=a.data(this,"selectable-item");if(n&&n.element!=d.element[0]){var r=!1;"touch"==f.tolerance?r=!(n.left>l||n.right<k||n.top>m||n.bottom<h):"fit"==f.tolerance&&(r=n.left>k&&n.right<l&&n.top>h&&n.bottom<m);r?(n.selected&&(n.$element.removeClass("ui-selected"),n.selected=!1),n.unselecting&&(n.$element.removeClass("ui-unselecting"),
n.unselecting=!1),n.selecting||(n.$element.addClass("ui-selecting"),n.selecting=!0,d._trigger("selecting",b,{selecting:n.element}))):(n.selecting&&((b.metaKey||b.ctrlKey)&&n.startselected?(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.$element.addClass("ui-selected"),n.selected=!0):(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.startselected&&(n.$element.addClass("ui-unselecting"),n.unselecting=!0),d._trigger("unselecting",b,{unselecting:n.element}))),n.selected&&!b.metaKey&&!b.ctrlKey&&
!n.startselected&&(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,d._trigger("unselecting",b,{unselecting:n.element})))}}),!1}},_mouseStop:function(b){var d=this;this.dragged=!1;return a(".ui-unselecting",this.element[0]).each(function(){var f=a.data(this,"selectable-item");f.$element.removeClass("ui-unselecting");f.unselecting=!1;f.startselected=!1;d._trigger("unselected",b,{unselected:f.element})}),a(".ui-selecting",this.element[0]).each(function(){var f=
a.data(this,"selectable-item");f.$element.removeClass("ui-selecting").addClass("ui-selected");f.selecting=!1;f.selected=!0;f.startselected=!0;d._trigger("selected",b,{selected:f.element})}),this._trigger("stop",b),this.helper.remove(),!1}})})(jQuery);
(function(a,d){a.widget("ui.sortable",a.ui.mouse,{version:"1.9.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){var a=this.options;this.containerCache={};this.element.addClass("ui-sortable");
this.refresh();this.floating=this.items.length?"x"===a.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1;this.offset=this.element.offset();this._mouseInit();this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var a=this.items.length-1;0<=a;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,d){"disabled"===b?(this.options[b]=
d,this.widget().toggleClass("ui-sortable-disabled",!!d)):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,d){var f=this;if(this.reverting||this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(b);var k=null;a(b.target).parents().each(function(){if(a.data(this,f.widgetName+"-item")==f)return k=a(this),!1});a.data(b.target,f.widgetName+"-item")==f&&(k=a(b.target));if(!k)return!1;if(this.options.handle&&!d){var h=!1;a(this.options.handle,k).find("*").andSelf().each(function(){this==
b.target&&(h=!0)});if(!h)return!1}return this.currentItem=k,this._removeCurrentsFromItems(),!0},_mouseStart:function(b,d,f){d=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(b);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:b.pageX-this.offset.left,
top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(b);this.originalPageX=b.pageX;this.originalPageY=b.pageY;d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();
d.containment&&this._setContainment();d.cursor&&(a("body").css("cursor")&&(this._storedCursor=a("body").css("cursor")),a("body").css("cursor",d.cursor));d.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",d.opacity));d.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",d.zIndex));this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset());
this._trigger("start",b,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!f)for(f=this.containers.length-1;0<=f;f--)this.containers[f]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");
this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var d=this.options,f=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?this.scrollParent[0].scrollTop=f=this.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-this.overflowOffset.top<d.scrollSensitivity&&(this.scrollParent[0].scrollTop=f=this.scrollParent[0].scrollTop-d.scrollSpeed),this.overflowOffset.left+
this.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?this.scrollParent[0].scrollLeft=f=this.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-this.overflowOffset.left<d.scrollSensitivity&&(this.scrollParent[0].scrollLeft=f=this.scrollParent[0].scrollLeft-d.scrollSpeed)):(b.pageY-a(document).scrollTop()<d.scrollSensitivity?f=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(f=a(document).scrollTop(a(document).scrollTop()+
d.scrollSpeed)),b.pageX-a(document).scrollLeft()<d.scrollSensitivity?f=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(f=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)));!1!==f&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";
if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";for(d=this.items.length-1;0<=d;d--){var f=this.items[d],k=f.item[0],h=this._intersectsWithPointer(f);if(h&&f.instance===this.currentContainer&&k!=this.currentItem[0]&&this.placeholder[1==h?"next":"prev"]()[0]!=k&&!a.contains(this.placeholder[0],k)&&("semi-dynamic"==this.options.type?!a.contains(this.element[0],k):1)){this.direction=1==h?"down":"up";if("pointer"!=this.options.tolerance&&!this._intersectsWithSides(f))break;
this._rearrange(b,f);this._trigger("change",b,this._uiHash());break}}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,d){if(b){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var f=this,k=this.placeholder.offset();this.reverting=!0;a(this.helper).animate({left:k.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==
document.body?0:this.offsetParent[0].scrollLeft),top:k.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){f._clear(b)})}else this._clear(b,d);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;0<=b;b--)this.containers[b]._trigger("deactivate",
null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):
a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var d=this._getItemsAsjQuery(b&&b.connected),f=[];return b=b||{},a(d).each(function(){var d=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[-=_](.+)/);d&&f.push((b.key||d[1]+"[]")+"="+(b.key&&b.expression?d[1]:d[2]))}),!f.length&&b.key&&f.push(b.key+"="),f.join("&")},toArray:function(b){var d=this._getItemsAsjQuery(b&&b.connected),f=[];return b=b||{},d.each(function(){f.push(a(b.item||this).attr(b.attribute||
"id")||"")}),f},_intersectsWith:function(a){var d=this.positionAbs.left,f=d+this.helperProportions.width,k=this.positionAbs.top,h=k+this.helperProportions.height,l=a.left,m=l+a.width,n=a.top,p=n+a.height,r=this.offset.click.top,s=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?k+r>n&&k+r<p&&d+s>l&&d+s<m:l<d+this.helperProportions.width/
2&&f-this.helperProportions.width/2<m&&n<k+this.helperProportions.height/2&&h-this.helperProportions.height/2<p},_intersectsWithPointer:function(b){var d="x"===this.options.axis||a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height);b="y"===this.options.axis||a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width);d=d&&b;b=this._getDragVerticalDirection();var f=this._getDragHorizontalDirection();return d?this.floating?f&&"right"==f||"down"==b?2:1:b&&("down"==
b?2:1):!1},_intersectsWithSides:function(b){var d=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/2,b.height);b=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width);var f=this._getDragVerticalDirection(),k=this._getDragHorizontalDirection();return this.floating&&k?"right"==k&&b||"left"==k&&!b:f&&("down"==f&&d||"up"==f&&!d)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!=a&&(0<a?"down":"up")},
_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!=a&&(0<a?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var d=[],f=[],k=this._connectWith();if(k&&b)for(b=k.length-1;0<=b;b--)for(var h=a(k[b]),l=h.length-1;0<=l;l--){var m=a.data(h[l],this.widgetName);m&&
m!=this&&!m.options.disabled&&f.push([a.isFunction(m.options.items)?m.options.items.call(m.element):a(m.options.items,m.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),m])}f.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(b=f.length-1;0<=b;b--)f[b][0].each(function(){d.push(this)});return a(d)},_removeCurrentsFromItems:function(){var b=
this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var d=0;d<b.length;d++)if(b[d]==a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[];this.containers=[this];var d=this.items,f=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],k=this._connectWith();if(k&&this.ready)for(var h=k.length-1;0<=h;h--)for(var l=a(k[h]),m=l.length-1;0<=m;m--){var n=
a.data(l[m],this.widgetName);n&&n!=this&&!n.options.disabled&&(f.push([a.isFunction(n.options.items)?n.options.items.call(n.element[0],b,{item:this.currentItem}):a(n.options.items,n.element),n]),this.containers.push(n))}for(h=f.length-1;0<=h;h--){b=f[h][1];k=f[h][0];m=0;for(l=k.length;m<l;m++)n=a(k[m]),n.data(this.widgetName+"-item",b),d.push({item:n,instance:b,width:0,height:0,left:0,top:0})}},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());
for(var d=this.items.length-1;0<=d;d--){var f=this.items[d];if(!(f.instance!=this.currentContainer&&this.currentContainer&&f.item[0]!=this.currentItem[0])){var k=this.options.toleranceElement?a(this.options.toleranceElement,f.item):f.item;b||(f.width=k.outerWidth(),f.height=k.outerHeight());k=k.offset();f.left=k.left;f.top=k.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(d=this.containers.length-1;0<=d;d--)k=this.containers[d].element.offset(),
this.containers[d].containerCache.left=k.left,this.containers[d].containerCache.top=k.top,this.containers[d].containerCache.width=this.containers[d].element.outerWidth(),this.containers[d].containerCache.height=this.containers[d].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var d=b.options;if(!d.placeholder||d.placeholder.constructor==String){var f=d.placeholder;d.placeholder={element:function(){var d=a(document.createElement(b.currentItem[0].nodeName)).addClass(f||
b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return f||(d.style.visibility="hidden"),d},update:function(a,h){if(!f||d.forcePlaceholderSize)h.height()||h.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),h.width()||h.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10))}}}b.placeholder=a(d.placeholder.element.call(b.element,
b.currentItem));b.currentItem.after(b.placeholder);d.placeholder.update(b,b.placeholder)},_contactContainers:function(b){for(var d=null,f=null,k=this.containers.length-1;0<=k;k--)if(!a.contains(this.currentItem[0],this.containers[k].element[0]))if(this._intersectsWith(this.containers[k].containerCache)){if(!d||!a.contains(this.containers[k].element[0],d.element[0]))d=this.containers[k],f=k}else this.containers[k].containerCache.over&&(this.containers[k]._trigger("out",b,this._uiHash(this)),this.containers[k].containerCache.over=
0);if(d)if(1===this.containers.length)this.containers[f]._trigger("over",b,this._uiHash(this)),this.containers[f].containerCache.over=1;else{for(var d=1E4,k=null,h=this.containers[f].floating?"left":"top",l=this.containers[f].floating?"width":"height",m=this.positionAbs[h]+this.offset.click[h],n=this.items.length-1;0<=n;n--)if(a.contains(this.containers[f].element[0],this.items[n].item[0])&&this.items[n].item[0]!=this.currentItem[0]){var p=this.items[n].item.offset()[h],r=!1;Math.abs(p-m)>Math.abs(p+
this.items[n][l]-m)&&(r=!0,p+=this.items[n][l]);Math.abs(p-m)<d&&(d=Math.abs(p-m),k=this.items[n],this.direction=r?"up":"down")}if(k||this.options.dropOnEmpty)this.currentContainer=this.containers[f],k?this._rearrange(b,k,null,!0):this._rearrange(b,null,this.containers[f].element,!0),this._trigger("change",b,this._uiHash()),this.containers[f]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[f]._trigger("over",b,this._uiHash(this)),
this.containers[f].containerCache.over=1}},_createHelper:function(b){var d=this.options;b=a.isFunction(d.helper)?a(d.helper.apply(this.element[0],[b,this.currentItem])):"clone"==d.helper?this.currentItem.clone():this.currentItem;return b.parents("body").length||a("parent"!=d.appendTo?d.appendTo:this.currentItem[0].parentNode)[0].appendChild(b[0]),b[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),
top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(""==b[0].style.width||d.forceHelperSize)&&b.width(this.currentItem.width()),(""==b[0].style.height||d.forceHelperSize)&&b.height(this.currentItem.height()),b},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" "));a.isArray(b)&&(b={left:+b[0],top:+b[1]||0});"left"in b&&(this.offset.click.left=b.left+this.margins.left);"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left);"top"in
b&&(this.offset.click.top=b.top+this.margins.top);"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&
"html"==this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,
left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"==b.containment&&(b.containment=this.helper[0].parentNode);if("document"==b.containment||"window"==b.containment)this.containment=[0-this.offset.relative.left-this.offset.parent.left,
0-this.offset.relative.top-this.offset.parent.top,a("document"==b.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"==b.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var d=a(b.containment)[0],b=a(b.containment).offset(),f="hidden"!=a(d).css("overflow");this.containment=[b.left+(parseInt(a(d).css("borderLeftWidth"),10)||
0)+(parseInt(a(d).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0)-this.margins.top,b.left+(f?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(f?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),
10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,d){d||(d=this.position);var f="absolute"==b?1:-1,k="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(k[0].tagName);return{top:d.top+this.offset.relative.top*f+this.offset.parent.top*f-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():h?0:k.scrollTop())*f,left:d.left+this.offset.relative.left*
f+this.offset.parent.left*f-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():h?0:k.scrollLeft())*f}},_generatePosition:function(b){var d=this.options,f="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,k=/(html|body)/i.test(f[0].tagName);"relative"==this.cssPosition&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());
var h=b.pageX,l=b.pageY;this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(h=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(l=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(h=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(l=this.containment[3]+this.offset.click.top)),d.grid&&(l=this.originalPageY+Math.round((l-
this.originalPageY)/d.grid[1])*d.grid[1],l=this.containment?l-this.offset.click.top<this.containment[1]||l-this.offset.click.top>this.containment[3]?l-this.offset.click.top<this.containment[1]?l+d.grid[1]:l-d.grid[1]:l:l,h=this.originalPageX+Math.round((h-this.originalPageX)/d.grid[0])*d.grid[0],h=this.containment?h-this.offset.click.left<this.containment[0]||h-this.offset.click.left>this.containment[2]?h-this.offset.click.left<this.containment[0]?h+d.grid[0]:h-d.grid[0]:h:h));return{top:l-this.offset.click.top-
this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():k?0:f.scrollTop()),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():k?0:f.scrollLeft())}},_rearrange:function(a,d,f,k){f?f[0].appendChild(this.placeholder[0]):d.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?d.item[0]:d.item[0].nextSibling);var h=this.counter=this.counter?++this.counter:
1;this._delay(function(){h==this.counter&&this.refreshPositions(!k)})},_clear:function(b,d){this.reverting=!1;var f=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var k in this._storedCSS)if("auto"==this._storedCSS[k]||"static"==this._storedCSS[k])this._storedCSS[k]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&
!d&&f.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))});(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!d&&f.push(function(a){this._trigger("update",a,this._uiHash())});this!==this.currentContainer&&(d||(f.push(function(a){this._trigger("remove",a,this._uiHash())}),f.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),
f.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer))));for(k=this.containers.length-1;0<=k;k--)d||f.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[k])),this.containers[k].containerCache.over&&(f.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[k])),this.containers[k].containerCache.over=0);this._storedCursor&&a("body").css("cursor",
this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!d){this._trigger("beforeStop",b,this._uiHash());for(k=0;k<f.length;k++)f[k].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!1}d||this._trigger("beforeStop",b,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!d){for(k=0;k<f.length;k++)f[k].call(this,b);this._trigger("stop",b,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){!1===a.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(b){var d=b||this;return{helper:d.helper,placeholder:d.placeholder||a([]),position:d.position,originalPosition:d.originalPosition,offset:d.positionAbs,item:d.currentItem,sender:b?b.element:null}}})})(jQuery);
(function(a,d){var b=0,e={},f={};e.height=e.paddingTop=e.paddingBottom=e.borderTopWidth=e.borderBottomWidth="hide";f.height=f.paddingTop=f.paddingBottom=f.borderTopWidth=f.borderBottomWidth="show";a.widget("ui.accordion",{version:"1.9.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var d=this.accordionId=
"ui-accordion-"+(this.element.attr("id")||++b),e=this.options;this.prevShow=this.prevHide=a();this.element.addClass("ui-accordion ui-widget ui-helper-reset");this.headers=this.element.find(e.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");this._hoverable(this.headers);this._focusable(this.headers);this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide();!e.collapsible&&(!1===e.active||null==e.active)&&(e.active=
0);0>e.active&&(e.active+=this.headers.length);this.active=this._findActive(e.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top");this.active.next().addClass("ui-accordion-content-active").show();this._createIcons();this.refresh();this.element.attr("role","tablist");this.headers.attr("role","tab").each(function(b){var e=a(this),f=e.attr("id"),h=e.next(),r=h.attr("id");f||(f=d+"-header-"+b,e.attr("id",f));r||(r=d+"-panel-"+b,h.attr("id",r));e.attr("aria-controls",
r);h.attr("aria-labelledby",f)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide();this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0);this._on(this.headers,{keydown:"_keydown"});this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._setupEvents(e.event)},
_getCreateEventData:function(){return{header:this.active,content:this.active.length?this.active.next():a()}},_createIcons:function(){var b=this.options.icons;b&&(a("<span>").addClass("ui-accordion-header-icon ui-icon "+b.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(b.header).addClass(b.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},
_destroy:function(){var a;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")});this._destroyIcons();a=this.headers.next().css("display",
"").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")});"content"!==this.options.heightStyle&&a.css("height","")},_setOption:function(a,b){"active"===a?this._activate(b):("event"===a&&(this.options.event&&this._off(this.headers,this.options.event),
this._setupEvents(b)),this._super(a,b),"collapsible"===a&&!b&&!1===this.options.active&&this._activate(0),"icons"===a&&(this._destroyIcons(),b&&this._createIcons()),"disabled"===a&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!b))},_keydown:function(b){if(!b.altKey&&!b.ctrlKey){var d=a.ui.keyCode,e=this.headers.length,f=this.headers.index(b.target),n=!1;switch(b.keyCode){case d.RIGHT:case d.DOWN:n=this.headers[(f+1)%e];break;case d.LEFT:case d.UP:n=this.headers[(f-1+e)%e];
break;case d.SPACE:case d.ENTER:this._eventHandler(b);break;case d.HOME:n=this.headers[0];break;case d.END:n=this.headers[e-1]}n&&(a(b.target).attr("tabIndex",-1),a(n).attr("tabIndex",0),n.focus(),b.preventDefault())}},_panelKeyDown:function(b){b.keyCode===a.ui.keyCode.UP&&b.ctrlKey&&a(b.currentTarget).prev().focus()},refresh:function(){var b,d,e=this.options.heightStyle,f=this.element.parent();"fill"===e?(a.support.minHeight||(d=f.css("overflow"),f.css("overflow","hidden")),b=f.height(),this.element.siblings(":visible").each(function(){var d=
a(this),e=d.css("position");"absolute"===e||"fixed"===e||(b-=d.outerHeight(!0))}),d&&f.css("overflow",d),this.headers.each(function(){b-=a(this).outerHeight(!0)}),this.headers.next().each(function(){a(this).height(Math.max(0,b-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===e&&(b=0,this.headers.next().each(function(){b=Math.max(b,a(this).css("height","").height())}).height(b))},_activate:function(b){b=this._findActive(b)[0];b!==this.active[0]&&(b=b||this.active[0],this._eventHandler({target:b,
currentTarget:b,preventDefault:a.noop}))},_findActive:function(b){return"number"==typeof b?this.headers.eq(b):a()},_setupEvents:function(b){var d={};b&&(a.each(b.split(" "),function(a,b){d[b]="_eventHandler"}),this._on(this.headers,d))},_eventHandler:function(b){var d=this.options,e=this.active,f=a(b.currentTarget),n=f[0]===e[0],p=n&&d.collapsible,r=p?a():f.next(),s=e.next(),r={oldHeader:e,oldPanel:s,newHeader:p?a():f,newPanel:r};b.preventDefault();n&&!d.collapsible||!1===this._trigger("beforeActivate",
b,r)||(d.active=p?!1:this.headers.index(f),this.active=n?a():f,this._toggle(r),e.removeClass("ui-accordion-header-active ui-state-active"),d.icons&&e.children(".ui-accordion-header-icon").removeClass(d.icons.activeHeader).addClass(d.icons.header),n||(f.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),d.icons&&f.children(".ui-accordion-header-icon").removeClass(d.icons.header).addClass(d.icons.activeHeader),f.next().addClass("ui-accordion-content-active")))},
_toggle:function(b){var d=b.newPanel,e=this.prevShow.length?this.prevShow:b.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0);this.prevShow=d;this.prevHide=e;this.options.animate?this._animate(d,e,b):(e.hide(),d.show(),this._toggleComplete(b));e.attr({"aria-expanded":"false","aria-hidden":"true"});e.prev().attr("aria-selected","false");d.length&&e.length?e.prev().attr("tabIndex",-1):d.length&&this.headers.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1);d.attr({"aria-expanded":"true",
"aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(a,b,d){var m,n,p,r=this,s=0,v=a.length&&(!b.length||a.index()<b.index()),t=this.options.animate||{},v=v&&t.down||t,x=function(){r._toggleComplete(d)};"number"==typeof v&&(p=v);"string"==typeof v&&(n=v);n=n||v.easing||t.easing;p=p||v.duration||t.duration;if(!b.length)return a.animate(f,p,n,x);if(!a.length)return b.animate(e,p,n,x);m=a.show().outerHeight();b.animate(e,{duration:p,easing:n,step:function(a,b){b.now=
Math.round(a)}});a.hide().animate(f,{duration:p,easing:n,complete:x,step:function(a,d){d.now=Math.round(a);"height"!==d.prop?s+=d.now:"content"!==r.options.heightStyle&&(d.now=Math.round(m-b.outerHeight()-s),s=0)}})},_toggleComplete:function(a){var b=a.oldPanel;b.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");b.length&&(b.parent()[0].className=b.parent()[0].className);this._trigger("activate",null,a)}});!1!==a.uiBackCompat&&(function(a,b){a.extend(b.options,
{navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var d=b._create;b._create=function(){if(this.options.navigation){var b=this,e=this.element.find(this.options.header),f=e.next(),h=e.add(f).find("a").filter(this.options.navigationFilter)[0];h&&e.add(f).each(function(d){if(a.contains(this,h))return b.options.active=Math.floor(d/2),!1})}d.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(a,b){a.extend(b.options,{heightStyle:null,autoHeight:!0,
clearStyle:!1,fillSpace:!1});var d=b._create,e=b._setOption;a.extend(b,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle();d.call(this)},_setOption:function(a){if("autoHeight"===a||"clearStyle"===a||"fillSpace"===a)this.options.heightStyle=this._mergeHeightStyle();e.apply(this,arguments)},_mergeHeightStyle:function(){var a=this.options;if(a.fillSpace)return"fill";if(a.clearStyle)return"content";if(a.autoHeight)return"auto"}})}(jQuery,jQuery.ui.accordion.prototype),
function(a,b){a.extend(b.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var d=b._createIcons;b._createIcons=function(){this.options.icons&&(this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected);d.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(a,b){b.activate=b._activate;var d=b._findActive;b._findActive=function(a){return-1===a&&(a=!1),a&&"number"!=typeof a&&(a=this.headers.index(this.headers.filter(a)),-1===a&&(a=
!1)),d.call(this,a)}}(jQuery,jQuery.ui.accordion.prototype),jQuery.ui.accordion.prototype.resize=jQuery.ui.accordion.prototype.refresh,function(a,b){a.extend(b.options,{change:null,changestart:null});var d=b._trigger;b._trigger=function(a,b,e){var f=d.apply(this,arguments);return f?("beforeActivate"===a?f=d.call(this,"changestart",b,{oldHeader:e.oldHeader,oldContent:e.oldPanel,newHeader:e.newHeader,newContent:e.newPanel}):"activate"===a&&(f=d.call(this,"change",b,{oldHeader:e.oldHeader,oldContent:e.oldPanel,
newHeader:e.newHeader,newContent:e.newPanel})),f):!1}}(jQuery,jQuery.ui.accordion.prototype),function(a,b){a.extend(b.options,{animate:null,animated:"slide"});var d=b._create;b._create=function(){var a=this.options;null===a.animate&&(a.animated?"slide"===a.animated?a.animate=300:"bounceslide"===a.animated?a.animate={duration:200,down:{easing:"easeOutBounce",duration:1E3}}:a.animate=a.animated:a.animate=!1);d.call(this)}}(jQuery,jQuery.ui.accordion.prototype))})(jQuery);
(function(a,d){var b=0;a.widget("ui.autocomplete",{version:"1.9.2",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var b,d,k;this.isMultiLine=this._isMultiLine();this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"];this.isNewMenu=!0;this.element.addClass("ui-autocomplete-input").attr("autocomplete",
"off");this._on(this.element,{keydown:function(h){if(this.element.prop("readOnly"))d=k=b=!0;else{d=k=b=!1;var l=a.ui.keyCode;switch(h.keyCode){case l.PAGE_UP:b=!0;this._move("previousPage",h);break;case l.PAGE_DOWN:b=!0;this._move("nextPage",h);break;case l.UP:b=!0;this._keyEvent("previous",h);break;case l.DOWN:b=!0;this._keyEvent("next",h);break;case l.ENTER:case l.NUMPAD_ENTER:this.menu.active&&(b=!0,h.preventDefault(),this.menu.select(h));break;case l.TAB:this.menu.active&&this.menu.select(h);
break;case l.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(h),h.preventDefault());break;default:d=!0,this._searchTimeout(h)}}},keypress:function(h){if(b)b=!1,h.preventDefault();else if(!d){var l=a.ui.keyCode;switch(h.keyCode){case l.PAGE_UP:this._move("previousPage",h);break;case l.PAGE_DOWN:this._move("nextPage",h);break;case l.UP:this._keyEvent("previous",h);break;case l.DOWN:this._keyEvent("next",h)}}},input:function(a){k?(k=!1,a.preventDefault()):this._searchTimeout(a)},
focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(a){this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(a),this._change(a))}});this._initSource();this.menu=a("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:a(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu");this._on(this.menu.element,{mousedown:function(b){b.preventDefault();this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur});
var d=this.menu.element[0];a(b.target).closest(".ui-menu-item").length||this._delay(function(){var b=this;this.document.one("mousedown",function(e){e.target!==b.element[0]&&e.target!==d&&!a.contains(d,e.target)&&b.close()})})},menufocus:function(b,d){if(this.isNewMenu&&(this.isNewMenu=!1,b.originalEvent&&/^mouse/.test(b.originalEvent.type))){this.menu.blur();this.document.one("mousemove",function(){a(b.target).trigger(b.originalEvent)});return}var e=d.item.data("ui-autocomplete-item")||d.item.data("item.autocomplete");
!1!==this._trigger("focus",b,{item:e})?b.originalEvent&&/^key/.test(b.originalEvent.type)&&this._value(e.value):this.liveRegion.text(e.value)},menuselect:function(a,b){var d=b.item.data("ui-autocomplete-item")||b.item.data("item.autocomplete"),e=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=e,this._delay(function(){this.previous=e;this.selectedItem=d}));!1!==this._trigger("select",a,{item:d})&&this._value(d.value);this.term=this._value();this.close(a);
this.selectedItem=d}});this.liveRegion=a("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element);a.fn.bgiframe&&this.menu.element.bgiframe();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},_setOption:function(a,b){this._super(a,
b);"source"===a&&this._initSource();"appendTo"===a&&this.menu.element.appendTo(this.document.find(b||"body")[0]);"disabled"===a&&b&&this.xhr&&this.xhr.abort()},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var b,d,k=this;a.isArray(this.options.source)?(b=this.options.source,this.source=function(d,f){f(a.ui.autocomplete.filter(b,d.term))}):"string"==typeof this.options.source?(d=this.options.source,
this.source=function(b,e){k.xhr&&k.xhr.abort();k.xhr=a.ajax({url:d,data:b,dataType:"json",success:function(a){e(a)},error:function(){e([])}})}):this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching);this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,a))},this.options.delay)},search:function(a,b){a=null!=a?a:this._value();this.term=this._value();if(a.length<this.options.minLength)return this.close(b);if(!1!==this._trigger("search",
b))return this._search(a)},_search:function(a){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=!1;this.source({term:a},this._response())},_response:function(){var a=this,d=++b;return function(k){d===b&&a.__response(k);a.pending--;a.pending||a.element.removeClass("ui-autocomplete-loading")}},__response:function(a){a&&(a=this._normalize(a));this._trigger("response",null,{content:a});!this.options.disabled&&a&&a.length&&!this.cancelSearch?(this._suggest(a),this._trigger("open")):
this._close()},close:function(a){this.cancelSearch=!0;this._close(a)},_close:function(a){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",a))},_change:function(a){this.previous!==this._value()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return"string"==typeof b?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})},
_suggest:function(b){var d=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(d,b);this.menu.refresh();d.show();this._resizeMenu();d.position(a.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,d){var k=this;a.each(d,function(a,d){k._renderItemData(b,d)})},_renderItemData:function(a,b){return this._renderItem(a,
b).data("ui-autocomplete-item",b)},_renderItem:function(b,d){return a("<li>").append(a("<a>").text(d.label)).appendTo(b)},_move:function(a,b){if(this.menu.element.is(":visible"))if(this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a))this._value(this.term),this.menu.blur();else this.menu[a](b);else this.search(null,b)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(a,b){if(!this.isMultiLine||
this.menu.element.is(":visible"))this._move(a,b),b.preventDefault()}});a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(b,d){var k=RegExp(a.ui.autocomplete.escapeRegex(d),"i");return a.grep(b,function(a){return k.test(a.label||a.value||a)})}});a.widget("ui.autocomplete",a.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(a){return a+(1<a?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},
__response:function(a){var b;this._superApply(arguments);!this.options.disabled&&!this.cancelSearch&&(a&&a.length?b=this.options.messages.results(a.length):b=this.options.messages.noResults,this.liveRegion.text(b))}})})(jQuery);
(function(a,d){var b,e,f,k,h=function(){var b=a(this).find(":ui-button");setTimeout(function(){b.button("refresh")},1)},l=function(b){var d=b.name,e=b.form,f=a([]);return d&&(e?f=a(e).find("[name='"+d+"']"):f=a("[name='"+d+"']",b.ownerDocument).filter(function(){return!this.form})),f};a.widget("ui.button",{version:"1.9.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+
this.eventNamespace,h);"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled);this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var d=this,n=this.options,p="checkbox"===this.type||"radio"===this.type,r=p?"":"ui-state-active";null===n.label&&(n.label="input"===this.type?this.buttonElement.val():this.buttonElement.html());this._hoverable(this.buttonElement);this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role",
"button").bind("mouseenter"+this.eventNamespace,function(){n.disabled||this===b&&a(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){n.disabled||a(this).removeClass(r)}).bind("click"+this.eventNamespace,function(a){n.disabled&&(a.preventDefault(),a.stopImmediatePropagation())});this.element.bind("focus"+this.eventNamespace,function(){d.buttonElement.addClass("ui-state-focus")}).bind("blur"+this.eventNamespace,function(){d.buttonElement.removeClass("ui-state-focus")});
p&&(this.element.bind("change"+this.eventNamespace,function(){k||d.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(a){n.disabled||(k=!1,e=a.pageX,f=a.pageY)}).bind("mouseup"+this.eventNamespace,function(a){if(!n.disabled&&(e!==a.pageX||f!==a.pageY))k=!0}));"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(n.disabled||k)return!1;a(this).toggleClass("ui-state-active");d.buttonElement.attr("aria-pressed",d.element[0].checked)}):"radio"===
this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(n.disabled||k)return!1;a(this).addClass("ui-state-active");d.buttonElement.attr("aria-pressed","true");var b=d.element[0];l(b).not(b).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(n.disabled)return!1;a(this).addClass("ui-state-active");b=this;d.document.one("mouseup",function(){b=null})}).bind("mouseup"+
this.eventNamespace,function(){if(n.disabled)return!1;a(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(b){if(n.disabled)return!1;(b.keyCode===a.ui.keyCode.SPACE||b.keyCode===a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace,function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()}));this._setOption("disabled",n.disabled);
this._resetButton()},_determineButtonType:function(){var a,b,d;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button";"checkbox"===this.type||"radio"===this.type?(a=this.element.parents().last(),b="label[for='"+this.element.attr("id")+"']",this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||
(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible"),d=this.element.is(":checked"),d&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",d)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());
this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){this._super(a,b);"disabled"===a?b?this.element.prop("disabled",!0):this.element.prop("disabled",!1):this._resetButton()},refresh:function(){var b=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");b!==this.options.disabled&&this._setOption("disabled",b);"radio"===this.type?l(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed",
"true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)this.options.label&&this.element.val(this.options.label);else{var b=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
d=a("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),e=this.options.icons,f=e.primary&&e.secondary,h=[];e.primary||e.secondary?(this.options.text&&h.push("ui-button-text-icon"+(f?"s":e.primary?"-primary":"-secondary")),e.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+e.primary+"'></span>"),e.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+e.secondary+"'></span>"),this.options.text||(h.push(f?"ui-button-icons-only":
"ui-button-icon-only"),this.hasTitle||b.attr("title",a.trim(d)))):h.push("ui-button-text-only");b.addClass(h.join(" "))}}});a.widget("ui.buttonset",{version:"1.9.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){"disabled"===a&&this.buttons.button("option",a,b);this._super(a,b)},refresh:function(){var b=
"rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(b?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})})(jQuery);
(function(a,d){function b(){this.debug=!1;this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._inDialog=this._datepickerShowing=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass=
"ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),
weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,
beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};a.extend(this._defaults,this.regional[""]);this.dpDiv=e(a('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function e(b){return b.delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a",
"mouseout",function(){a(this).removeClass("ui-state-hover");-1!=this.className.indexOf("ui-datepicker-prev")&&a(this).removeClass("ui-datepicker-prev-hover");-1!=this.className.indexOf("ui-datepicker-next")&&a(this).removeClass("ui-datepicker-next-hover")}).delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseover",function(){a.datepicker._isDisabledDatepicker(h.inline?b.parent()[0]:h.input[0])||(a(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),
a(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&a(this).addClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&a(this).addClass("ui-datepicker-next-hover"))})}function f(b,e){a.extend(b,e);for(var f in e)if(null==e[f]||e[f]==d)b[f]=e[f];return b}a.extend(a.ui,{datepicker:{version:"1.9.2"}});var k=(new Date).getTime(),h;a.extend(b.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",
arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){return f(this._defaults,a||{}),this},_attachDatepicker:function(b,d){var e=null,f;for(f in this._defaults){var h=b.getAttribute("date:"+f);if(h){e=e||{};try{e[f]=eval(h)}catch(k){e[f]=h}}}f=b.nodeName.toLowerCase();h="div"==f||"span"==f;b.id||(this.uuid+=1,b.id="dp"+this.uuid);var v=this._newInst(a(b),h);v.settings=a.extend({},d||{},e||{});"input"==f?this._connectDatepicker(b,v):h&&this._inlineDatepicker(b,v)},_newInst:function(b,
d){return{id:b[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:b,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:d,dpDiv:d?e(a('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(b,d){var e=a(b);d.append=a([]);d.trigger=a([]);e.hasClass(this.markerClassName)||(this._attachments(e,d),e.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",
function(a,b,e){d.settings[b]=e}).bind("getData.datepicker",function(a,b){return this._get(d,b)}),this._autoSize(d),a.data(b,"datepicker",d),d.settings.disabled&&this._disableDatepicker(b))},_attachments:function(b,d){var e=this._get(d,"appendText"),f=this._get(d,"isRTL");d.append&&d.append.remove();e&&(d.append=a('<span class="'+this._appendClass+'">'+e+"</span>"),b[f?"before":"after"](d.append));b.unbind("focus",this._showDatepicker);d.trigger&&d.trigger.remove();e=this._get(d,"showOn");("focus"==
e||"both"==e)&&b.focus(this._showDatepicker);if("button"==e||"both"==e){var e=this._get(d,"buttonText"),h=this._get(d,"buttonImage");d.trigger=a(this._get(d,"buttonImageOnly")?a("<img/>").addClass(this._triggerClass).attr({src:h,alt:e,title:e}):a('<button type="button"></button>').addClass(this._triggerClass).html(""==h?e:a("<img/>").attr({src:h,alt:e,title:e})));b[f?"before":"after"](d.trigger);d.trigger.click(function(){return a.datepicker._datepickerShowing&&a.datepicker._lastInput==b[0]?a.datepicker._hideDatepicker():
a.datepicker._datepickerShowing&&a.datepicker._lastInput!=b[0]?(a.datepicker._hideDatepicker(),a.datepicker._showDatepicker(b[0])):a.datepicker._showDatepicker(b[0]),!1})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),d=this._get(a,"dateFormat");if(d.match(/[DM]/)){var e=function(a){for(var b=0,d=0,e=0;e<a.length;e++)a[e].length>b&&(b=a[e].length,d=e);return d};b.setMonth(e(this._get(a,d.match(/MM/)?"monthNames":"monthNamesShort")));b.setDate(e(this._get(a,
d.match(/DD/)?"dayNames":"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(b,d){var e=a(b);e.hasClass(this.markerClassName)||(e.addClass(this.markerClassName).append(d.dpDiv).bind("setData.datepicker",function(a,b,e){d.settings[b]=e}).bind("getData.datepicker",function(a,b){return this._get(d,b)}),a.data(b,"datepicker",d),this._setDate(d,this._getDefaultDate(d),!0),this._updateDatepicker(d),this._updateAlternate(d),d.settings.disabled&&
this._disableDatepicker(b),d.dpDiv.css("display","block"))},_dialogDatepicker:function(b,d,e,h,k){b=this._dialogInst;b||(this.uuid+=1,this._dialogInput=a('<input type="text" id="dp'+this.uuid+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),a("body").append(this._dialogInput),b=this._dialogInst=this._newInst(this._dialogInput,!1),b.settings={},a.data(this._dialogInput[0],"datepicker",b));f(b.settings,h||{});d=d&&d.constructor==Date?this._formatDate(b,
d):d;this._dialogInput.val(d);this._pos=k?k.length?k:[k.pageX,k.pageY]:null;this._pos||(this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]);return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),b.settings.onSelect=e,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),
a.blockUI&&a.blockUI(this.dpDiv),a.data(this._dialogInput[0],"datepicker",b),this},_destroyDatepicker:function(b){var d=a(b),e=a.data(b,"datepicker");if(d.hasClass(this.markerClassName)){var f=b.nodeName.toLowerCase();a.removeData(b,"datepicker");"input"==f?(e.append.remove(),e.trigger.remove(),d.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==f||"span"==f)&&d.removeClass(this.markerClassName).empty()}},
_enableDatepicker:function(b){var d=a(b),e=a.data(b,"datepicker");if(d.hasClass(this.markerClassName)){var f=b.nodeName.toLowerCase();if("input"==f)b.disabled=!1,e.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==f||"span"==f)d=d.children("."+this._inlineClass),d.children().removeClass("ui-state-disabled"),d.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=a.map(this._disabledInputs,
function(a){return a==b?null:a})}},_disableDatepicker:function(b){var d=a(b),e=a.data(b,"datepicker");if(d.hasClass(this.markerClassName)){var f=b.nodeName.toLowerCase();if("input"==f)b.disabled=!0,e.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==f||"span"==f)d=d.children("."+this._inlineClass),d.children().addClass("ui-state-disabled"),d.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",
!0);this._disabledInputs=a.map(this._disabledInputs,function(a){return a==b?null:a});this._disabledInputs[this._disabledInputs.length]=b}},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return!0;return!1},_getInst:function(b){try{return a.data(b,"datepicker")}catch(d){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(b,e,h){var k=this._getInst(b);if(2==arguments.length&&"string"==typeof e)return"defaults"==
e?a.extend({},a.datepicker._defaults):k?"all"==e?a.extend({},k.settings):this._get(k,e):null;var r=e||{};"string"==typeof e&&(r={},r[e]=h);if(k){this._curInst==k&&this._hideDatepicker();var s=this._getDateDatepicker(b,!0),v=this._getMinMaxDate(k,"min"),t=this._getMinMaxDate(k,"max");f(k.settings,r);null!==v&&r.dateFormat!==d&&r.minDate===d&&(k.settings.minDate=this._formatDate(k,v));null!==t&&r.dateFormat!==d&&r.maxDate===d&&(k.settings.maxDate=this._formatDate(k,t));this._attachments(a(b),k);this._autoSize(k);
this._setDate(k,s);this._updateAlternate(k);this._updateDatepicker(k)}},_changeDatepicker:function(a,b,d){this._optionDatepicker(a,b,d)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){var d=this._getInst(a);d&&(this._setDate(d,b),this._updateDatepicker(d),this._updateAlternate(d))},_getDateDatepicker:function(a,b){var d=this._getInst(a);return d&&!d.inline&&this._setDateFromField(d,b),d?this._getDate(d):null},_doKeyDown:function(b){var d=
a.datepicker._getInst(b.target),e=!0,f=d.dpDiv.is(".ui-datepicker-rtl");d._keyEvent=!0;if(a.datepicker._datepickerShowing)switch(b.keyCode){case 9:a.datepicker._hideDatepicker();e=!1;break;case 13:return e=a("td."+a.datepicker._dayOverClass+":not(."+a.datepicker._currentClass+")",d.dpDiv),e[0]&&a.datepicker._selectDay(b.target,d.selectedMonth,d.selectedYear,e[0]),(b=a.datepicker._get(d,"onSelect"))?(e=a.datepicker._formatDate(d),b.apply(d.input?d.input[0]:null,[e,d])):a.datepicker._hideDatepicker(),
!1;case 27:a.datepicker._hideDatepicker();break;case 33:a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(d,"stepBigMonths"):-a.datepicker._get(d,"stepMonths"),"M");break;case 34:a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(d,"stepBigMonths"):+a.datepicker._get(d,"stepMonths"),"M");break;case 35:(b.ctrlKey||b.metaKey)&&a.datepicker._clearDate(b.target);e=b.ctrlKey||b.metaKey;break;case 36:(b.ctrlKey||b.metaKey)&&a.datepicker._gotoToday(b.target);e=b.ctrlKey||b.metaKey;
break;case 37:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,f?1:-1,"D");e=b.ctrlKey||b.metaKey;b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(d,"stepBigMonths"):-a.datepicker._get(d,"stepMonths"),"M");break;case 38:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,-7,"D");e=b.ctrlKey||b.metaKey;break;case 39:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,f?-1:1,"D");e=b.ctrlKey||b.metaKey;b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,
b.ctrlKey?+a.datepicker._get(d,"stepBigMonths"):+a.datepicker._get(d,"stepMonths"),"M");break;case 40:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,7,"D");e=b.ctrlKey||b.metaKey;break;default:e=!1}else 36==b.keyCode&&b.ctrlKey?a.datepicker._showDatepicker(this):e=!1;e&&(b.preventDefault(),b.stopPropagation())},_doKeyPress:function(b){var e=a.datepicker._getInst(b.target);if(a.datepicker._get(e,"constrainInput")){var e=a.datepicker._possibleChars(a.datepicker._get(e,"dateFormat")),f=String.fromCharCode(b.charCode==
d?b.keyCode:b.charCode);return b.ctrlKey||b.metaKey||" ">f||!e||-1<e.indexOf(f)}},_doKeyUp:function(b){b=a.datepicker._getInst(b.target);if(b.input.val()!=b.lastVal)try{a.datepicker.parseDate(a.datepicker._get(b,"dateFormat"),b.input?b.input.val():null,a.datepicker._getFormatConfig(b))&&(a.datepicker._setDateFromField(b),a.datepicker._updateAlternate(b),a.datepicker._updateDatepicker(b))}catch(d){a.datepicker.log(d)}return!0},_showDatepicker:function(b){b=b.target||b;"input"!=b.nodeName.toLowerCase()&&
(b=a("input",b.parentNode)[0]);if(!(a.datepicker._isDisabledDatepicker(b)||a.datepicker._lastInput==b)){var d=a.datepicker._getInst(b);a.datepicker._curInst&&a.datepicker._curInst!=d&&(a.datepicker._curInst.dpDiv.stop(!0,!0),d&&a.datepicker._datepickerShowing&&a.datepicker._hideDatepicker(a.datepicker._curInst.input[0]));var e=a.datepicker._get(d,"beforeShow"),e=e?e.apply(b,[b,d]):{};if(!1!==e){f(d.settings,e);d.lastVal=null;a.datepicker._lastInput=b;a.datepicker._setDateFromField(d);a.datepicker._inDialog&&
(b.value="");a.datepicker._pos||(a.datepicker._pos=a.datepicker._findPos(b),a.datepicker._pos[1]+=b.offsetHeight);var h=!1;a(b).parents().each(function(){return h|="fixed"==a(this).css("position"),!h});e={left:a.datepicker._pos[0],top:a.datepicker._pos[1]};a.datepicker._pos=null;d.dpDiv.empty();d.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});a.datepicker._updateDatepicker(d);e=a.datepicker._checkOffset(d,e,h);d.dpDiv.css({position:a.datepicker._inDialog&&a.blockUI?"static":h?"fixed":
"absolute",display:"none",left:e.left+"px",top:e.top+"px"});if(!d.inline){var e=a.datepicker._get(d,"showAnim"),k=a.datepicker._get(d,"duration"),s=function(){var b=d.dpDiv.find("iframe.ui-datepicker-cover");if(b.length){var e=a.datepicker._getBorders(d.dpDiv);b.css({left:-e[0],top:-e[1],width:d.dpDiv.outerWidth(),height:d.dpDiv.outerHeight()})}};d.dpDiv.zIndex(a(b).zIndex()+1);a.datepicker._datepickerShowing=!0;a.effects&&(a.effects.effect[e]||a.effects[e])?d.dpDiv.show(e,a.datepicker._get(d,"showOptions"),
k,s):d.dpDiv[e||"show"](e?k:null,s);(!e||!k)&&s();d.input.is(":visible")&&!d.input.is(":disabled")&&d.input.focus();a.datepicker._curInst=d}}}},_updateDatepicker:function(b){this.maxRows=4;var d=a.datepicker._getBorders(b.dpDiv);h=b;b.dpDiv.empty().append(this._generateHTML(b));this._attachHandlers(b);var e=b.dpDiv.find("iframe.ui-datepicker-cover");!e.length||e.css({left:-d[0],top:-d[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()});b.dpDiv.find("."+this._dayOverClass+" a").mouseover();
d=this._getNumberOfMonths(b);e=d[1];b.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");1<e&&b.dpDiv.addClass("ui-datepicker-multi-"+e).css("width",17*e+"em");b.dpDiv[(1!=d[0]||1!=d[1]?"add":"remove")+"Class"]("ui-datepicker-multi");b.dpDiv[(this._get(b,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");b==a.datepicker._curInst&&a.datepicker._datepickerShowing&&b.input&&b.input.is(":visible")&&!b.input.is(":disabled")&&b.input[0]!=document.activeElement&&
b.input.focus();if(b.yearshtml){var f=b.yearshtml;setTimeout(function(){f===b.yearshtml&&b.yearshtml&&b.dpDiv.find("select.ui-datepicker-year:first").replaceWith(b.yearshtml);f=b.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(b,d,e){var f=b.dpDiv.outerWidth(),h=b.dpDiv.outerHeight(),k=b.input?b.input.outerWidth():0,v=b.input?b.input.outerHeight():
0,t=document.documentElement.clientWidth+(e?0:a(document).scrollLeft()),x=document.documentElement.clientHeight+(e?0:a(document).scrollTop());return d.left-=this._get(b,"isRTL")?f-k:0,d.left-=e&&d.left==b.input.offset().left?a(document).scrollLeft():0,d.top-=e&&d.top==b.input.offset().top+v?a(document).scrollTop():0,d.left-=Math.min(d.left,d.left+f>t&&t>f?Math.abs(d.left+f-t):0),d.top-=Math.min(d.top,d.top+h>x&&x>h?Math.abs(h+v):0),d},_findPos:function(b){for(var d=this._getInst(b),d=this._get(d,
"isRTL");b&&("hidden"==b.type||1!=b.nodeType||a.expr.filters.hidden(b));)b=b[d?"previousSibling":"nextSibling"];b=a(b).offset();return[b.left,b.top]},_hideDatepicker:function(b){var d=this._curInst;if(d&&!(b&&d!=a.data(b,"datepicker"))&&this._datepickerShowing){b=this._get(d,"showAnim");var e=this._get(d,"duration"),f=function(){a.datepicker._tidyDialog(d)};a.effects&&(a.effects.effect[b]||a.effects[b])?d.dpDiv.hide(b,a.datepicker._get(d,"showOptions"),e,f):d.dpDiv["slideDown"==b?"slideUp":"fadeIn"==
b?"fadeOut":"hide"](b?e:null,f);b||f();this._datepickerShowing=!1;(b=this._get(d,"onClose"))&&b.apply(d.input?d.input[0]:null,[d.input?d.input.val():"",d]);this._lastInput=null;this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),a.blockUI&&(a.unblockUI(),a("body").append(this.dpDiv)));this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(b){if(a.datepicker._curInst){b=a(b.target);
var d=a.datepicker._getInst(b[0]);(b[0].id!=a.datepicker._mainDivId&&0==b.parents("#"+a.datepicker._mainDivId).length&&!b.hasClass(a.datepicker.markerClassName)&&!b.closest("."+a.datepicker._triggerClass).length&&a.datepicker._datepickerShowing&&(!a.datepicker._inDialog||!a.blockUI)||b.hasClass(a.datepicker.markerClassName)&&a.datepicker._curInst!=d)&&a.datepicker._hideDatepicker()}},_adjustDate:function(b,d,e){b=a(b);var f=this._getInst(b[0]);this._isDisabledDatepicker(b[0])||(this._adjustInstDate(f,
d+("M"==e?this._get(f,"showCurrentAtPos"):0),e),this._updateDatepicker(f))},_gotoToday:function(b){b=a(b);var d=this._getInst(b[0]);if(this._get(d,"gotoCurrent")&&d.currentDay)d.selectedDay=d.currentDay,d.drawMonth=d.selectedMonth=d.currentMonth,d.drawYear=d.selectedYear=d.currentYear;else{var e=new Date;d.selectedDay=e.getDate();d.drawMonth=d.selectedMonth=e.getMonth();d.drawYear=d.selectedYear=e.getFullYear()}this._notifyChange(d);this._adjustDate(b)},_selectMonthYear:function(b,d,e){b=a(b);var f=
this._getInst(b[0]);f["selected"+("M"==e?"Month":"Year")]=f["draw"+("M"==e?"Month":"Year")]=parseInt(d.options[d.selectedIndex].value,10);this._notifyChange(f);this._adjustDate(b)},_selectDay:function(b,d,e,f){var h=a(b);!a(f).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(h[0])&&(h=this._getInst(h[0]),h.selectedDay=h.currentDay=a("a",f).html(),h.selectedMonth=h.currentMonth=d,h.selectedYear=h.currentYear=e,this._selectDate(b,this._formatDate(h,h.currentDay,h.currentMonth,h.currentYear)))},
_clearDate:function(b){b=a(b);this._getInst(b[0]);this._selectDate(b,"")},_selectDate:function(b,d){var e=a(b),e=this._getInst(e[0]);d=null!=d?d:this._formatDate(e);e.input&&e.input.val(d);this._updateAlternate(e);var f=this._get(e,"onSelect");f?f.apply(e.input?e.input[0]:null,[d,e]):e.input&&e.input.trigger("change");e.inline?this._updateDatepicker(e):(this._hideDatepicker(),this._lastInput=e.input[0],"object"!=typeof e.input[0]&&e.input.focus(),this._lastInput=null)},_updateAlternate:function(b){var d=
this._get(b,"altField");if(d){var e=this._get(b,"altFormat")||this._get(b,"dateFormat"),f=this._getDate(b),h=this.formatDate(e,f,this._getFormatConfig(b));a(d).each(function(){a(this).val(h)})}},noWeekends:function(a){a=a.getDay();return[0<a&&6>a,""]},iso8601Week:function(a){a=new Date(a.getTime());a.setDate(a.getDate()+4-(a.getDay()||7));var b=a.getTime();return a.setMonth(0),a.setDate(1),Math.floor(Math.round((b-a)/864E5)/7)+1},parseDate:function(b,d,e){if(null==b||null==d)throw"Invalid arguments";
d="object"==typeof d?d.toString():d+"";if(""==d)return null;for(var f=(e?e.shortYearCutoff:null)||this._defaults.shortYearCutoff,f="string"!=typeof f?f:(new Date).getFullYear()%100+parseInt(f,10),h=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,k=(e?e.dayNames:null)||this._defaults.dayNames,v=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,t=(e?e.monthNames:null)||this._defaults.monthNames,x=e=-1,w=-1,y=-1,z=!1,A=function(a){a=W+1<b.length&&b.charAt(W+1)==a;return a&&W++,a},F=function(a){var b=
A(a);a=RegExp("^\\d{1,"+("@"==a?14:"!"==a?20:"y"==a&&b?4:"o"==a?3:2)+"}");a=d.substring(B).match(a);if(!a)throw"Missing number at position "+B;return B+=a[0].length,parseInt(a[0],10)},u=function(b,e,f){b=a.map(A(b)?f:e,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)});var h=-1;a.each(b,function(a,b){var e=b[1];if(d.substr(B,e.length).toLowerCase()==e.toLowerCase())return h=b[0],B+=e.length,!1});if(-1!=h)return h+1;throw"Unknown name at position "+B;},C=function(){if(d.charAt(B)!=
b.charAt(W))throw"Unexpected literal at position "+B;B++},B=0,W=0;W<b.length;W++)if(z)"'"==b.charAt(W)&&!A("'")?z=!1:C();else switch(b.charAt(W)){case "d":w=F("d");break;case "D":u("D",h,k);break;case "o":y=F("o");break;case "m":x=F("m");break;case "M":x=u("M",v,t);break;case "y":e=F("y");break;case "@":var E=new Date(F("@"));e=E.getFullYear();x=E.getMonth()+1;w=E.getDate();break;case "!":E=new Date((F("!")-this._ticksTo1970)/1E4);e=E.getFullYear();x=E.getMonth()+1;w=E.getDate();break;case "'":A("'")?
C():z=!0;break;default:C()}if(B<d.length&&(h=d.substr(B),!/^\s+/.test(h)))throw"Extra/unparsed characters found in date: "+h;-1==e?e=(new Date).getFullYear():100>e&&(e+=(new Date).getFullYear()-(new Date).getFullYear()%100+(e<=f?0:-100));if(-1<y){x=1;w=y;do{f=this._getDaysInMonth(e,x-1);if(w<=f)break;x++;w-=f}while(1)}E=this._daylightSavingAdjust(new Date(e,x-1,w));if(E.getFullYear()!=e||E.getMonth()+1!=x||E.getDate()!=w)throw"Invalid date";return E},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",
RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864E9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(a,b,d){if(!b)return"";var e=(d?d.dayNamesShort:null)||this._defaults.dayNamesShort,f=(d?d.dayNames:null)||this._defaults.dayNames,h=(d?d.monthNamesShort:null)||this._defaults.monthNamesShort;d=(d?d.monthNames:null)||this._defaults.monthNames;var k=
function(b){b=z+1<a.length&&a.charAt(z+1)==b;return b&&z++,b},t=function(a,b,d){b=""+b;if(k(a))for(;b.length<d;)b="0"+b;return b},x=function(a,b,d,e){return k(a)?e[b]:d[b]},w="",y=!1;if(b)for(var z=0;z<a.length;z++)if(y)"'"==a.charAt(z)&&!k("'")?y=!1:w+=a.charAt(z);else switch(a.charAt(z)){case "d":w+=t("d",b.getDate(),2);break;case "D":w+=x("D",b.getDay(),e,f);break;case "o":w+=t("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-(new Date(b.getFullYear(),0,0)).getTime())/
864E5),3);break;case "m":w+=t("m",b.getMonth()+1,2);break;case "M":w+=x("M",b.getMonth(),h,d);break;case "y":w+=k("y")?b.getFullYear():(10>b.getYear()%100?"0":"")+b.getYear()%100;break;case "@":w+=b.getTime();break;case "!":w+=1E4*b.getTime()+this._ticksTo1970;break;case "'":k("'")?w+="'":y=!0;break;default:w+=a.charAt(z)}return w},_possibleChars:function(a){for(var b="",d=!1,e=function(b){b=f+1<a.length&&a.charAt(f+1)==b;return b&&f++,b},f=0;f<a.length;f++)if(d)"'"==a.charAt(f)&&!e("'")?d=!1:b+=
a.charAt(f);else switch(a.charAt(f)){case "d":case "m":case "y":case "@":b+="0123456789";break;case "D":case "M":return null;case "'":e("'")?b+="'":d=!0;break;default:b+=a.charAt(f)}return b},_get:function(a,b){return a.settings[b]!==d?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var d=this._get(a,"dateFormat"),e=a.lastVal=a.input?a.input.val():null,f,h;f=h=this._getDefaultDate(a);var k=this._getFormatConfig(a);try{f=this.parseDate(d,e,k)||h}catch(t){this.log(t),
e=b?"":e}a.selectedDay=f.getDate();a.drawMonth=a.selectedMonth=f.getMonth();a.drawYear=a.selectedYear=f.getFullYear();a.currentDay=e?f.getDate():0;a.currentMonth=e?f.getMonth():0;a.currentYear=e?f.getFullYear():0;this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(b,d,e){var f=function(a){var b=new Date;return b.setDate(b.getDate()+a),b},h=function(d){try{return a.datepicker.parseDate(a.datepicker._get(b,
"dateFormat"),d,a.datepicker._getFormatConfig(b))}catch(e){}for(var f=(d.toLowerCase().match(/^c/)?a.datepicker._getDate(b):null)||new Date,h=f.getFullYear(),k=f.getMonth(),f=f.getDate(),m=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,n=m.exec(d);n;){switch(n[2]||"d"){case "d":case "D":f+=parseInt(n[1],10);break;case "w":case "W":f+=7*parseInt(n[1],10);break;case "m":case "M":k+=parseInt(n[1],10);f=Math.min(f,a.datepicker._getDaysInMonth(h,k));break;case "y":case "Y":h+=parseInt(n[1],10),f=Math.min(f,a.datepicker._getDaysInMonth(h,
k))}n=m.exec(d)}return new Date(h,k,f)};d=null==d||""===d?e:"string"==typeof d?h(d):"number"==typeof d?isNaN(d)?e:f(d):new Date(d.getTime());return d=d&&"Invalid Date"==d.toString()?e:d,d&&(d.setHours(0),d.setMinutes(0),d.setSeconds(0),d.setMilliseconds(0)),this._daylightSavingAdjust(d)},_daylightSavingAdjust:function(a){return a?(a.setHours(12<a.getHours()?a.getHours()+2:0),a):null},_setDate:function(a,b,d){var e=!b,f=a.selectedMonth,h=a.selectedYear;b=this._restrictMinMax(a,this._determineDate(a,
b,new Date));a.selectedDay=a.currentDay=b.getDate();a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth();a.drawYear=a.selectedYear=a.currentYear=b.getFullYear();(f!=a.selectedMonth||h!=a.selectedYear)&&!d&&this._notifyChange(a);this._adjustInstDate(a);a.input&&a.input.val(e?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&""==a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay))},_attachHandlers:function(b){var d=this._get(b,
"stepMonths"),e="#"+b.id.replace(/\\\\/g,"\\");b.dpDiv.find("[data-handler]").map(function(){a(this).bind(this.getAttribute("data-event"),{prev:function(){window["DP_jQuery_"+k].datepicker._adjustDate(e,-d,"M")},next:function(){window["DP_jQuery_"+k].datepicker._adjustDate(e,+d,"M")},hide:function(){window["DP_jQuery_"+k].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+k].datepicker._gotoToday(e)},selectDay:function(){return window["DP_jQuery_"+k].datepicker._selectDay(e,+this.getAttribute("data-month"),
+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+k].datepicker._selectMonthYear(e,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+k].datepicker._selectMonthYear(e,this,"Y"),!1}}[this.getAttribute("data-handler")])})},_generateHTML:function(b){var d=new Date,d=this._daylightSavingAdjust(new Date(d.getFullYear(),d.getMonth(),d.getDate())),e=this._get(b,"isRTL"),f=this._get(b,"showButtonPanel"),h=this._get(b,"hideIfNoPrevNext"),k=this._get(b,
"navigationAsDateFormat"),v=this._getNumberOfMonths(b),t=this._get(b,"showCurrentAtPos"),x=this._get(b,"stepMonths"),w=1!=v[0]||1!=v[1],y=this._daylightSavingAdjust(b.currentDay?new Date(b.currentYear,b.currentMonth,b.currentDay):new Date(9999,9,9)),z=this._getMinMaxDate(b,"min"),A=this._getMinMaxDate(b,"max"),t=b.drawMonth-t,F=b.drawYear;0>t&&(t+=12,F--);if(A)for(var u=this._daylightSavingAdjust(new Date(A.getFullYear(),A.getMonth()-v[0]*v[1]+1,A.getDate())),u=z&&u<z?z:u;this._daylightSavingAdjust(new Date(F,
t,1))>u;)t--,0>t&&(t=11,F--);b.drawMonth=t;b.drawYear=F;var u=this._get(b,"prevText"),u=k?this.formatDate(u,this._daylightSavingAdjust(new Date(F,t-x,1)),this._getFormatConfig(b)):u,u=this._canAdjustMonth(b,-1,F,t)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+u+'"><span class="ui-icon ui-icon-circle-triangle-'+(e?"e":"w")+'">'+u+"</span></a>":h?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+u+'"><span class="ui-icon ui-icon-circle-triangle-'+
(e?"e":"w")+'">'+u+"</span></a>",C=this._get(b,"nextText"),C=k?this.formatDate(C,this._daylightSavingAdjust(new Date(F,t+x,1)),this._getFormatConfig(b)):C,h=this._canAdjustMonth(b,1,F,t)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+C+'"><span class="ui-icon ui-icon-circle-triangle-'+(e?"w":"e")+'">'+C+"</span></a>":h?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+C+'"><span class="ui-icon ui-icon-circle-triangle-'+(e?"w":
"e")+'">'+C+"</span></a>",x=this._get(b,"currentText"),C=this._get(b,"gotoCurrent")&&b.currentDay?y:d,x=k?this.formatDate(x,C,this._getFormatConfig(b)):x,k=b.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(b,"closeText")+"</button>",f=f?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(e?k:"")+(this._isInRange(b,C)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+
x+"</button>":"")+(e?"":k)+"</div>":"",k=parseInt(this._get(b,"firstDay"),10),k=isNaN(k)?0:k,x=this._get(b,"showWeek"),C=this._get(b,"dayNames");this._get(b,"dayNamesShort");var B=this._get(b,"dayNamesMin"),W=this._get(b,"monthNames"),E=this._get(b,"monthNamesShort"),M=this._get(b,"beforeShowDay"),Y=this._get(b,"showOtherMonths"),ba=this._get(b,"selectOtherMonths");this._get(b,"calculateWeek");for(var L=this._getDefaultDate(b),ca="",aa=0;aa<v[0];aa++){var ga="";this.maxRows=4;for(var T=0;T<v[1];T++){var J=
this._daylightSavingAdjust(new Date(F,t,b.selectedDay)),U=" ui-corner-all",K="";if(w){K+='<div class="ui-datepicker-group';if(1<v[1])switch(T){case 0:K+=" ui-datepicker-group-first";U=" ui-corner-"+(e?"right":"left");break;case v[1]-1:K+=" ui-datepicker-group-last";U=" ui-corner-"+(e?"left":"right");break;default:K+=" ui-datepicker-group-middle",U=""}K+='">'}for(var K=K+('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+U+'">'+(/all|left/.test(U)&&0==aa?e?h:u:"")+(/all|right/.test(U)&&
0==aa?e?u:h:"")+this._generateMonthYearHeader(b,t,F,z,A,0<aa||0<T,W,E)+'</div><table class="ui-datepicker-calendar"><thead><tr>'),X=x?'<th class="ui-datepicker-week-col">'+this._get(b,"weekHeader")+"</th>":"",U=0;7>U;U++)var Q=(U+k)%7,X=X+("<th"+(5<=(U+k+6)%7?' class="ui-datepicker-week-end"':"")+'><span title="'+C[Q]+'">'+B[Q]+"</span></th>");K+=X+"</tr></thead><tbody>";X=this._getDaysInMonth(F,t);F==b.selectedYear&&t==b.selectedMonth&&(b.selectedDay=Math.min(b.selectedDay,X));U=(this._getFirstDayOfMonth(F,
t)-k+7)%7;X=Math.ceil((U+X)/7);this.maxRows=X=w?this.maxRows>X?this.maxRows:X:X;for(var Q=this._daylightSavingAdjust(new Date(F,t,1-U)),H=0;H<X;H++){for(var K=K+"<tr>",la=x?'<td class="ui-datepicker-week-col">'+this._get(b,"calculateWeek")(Q)+"</td>":"",U=0;7>U;U++){var pa=M?M.apply(b.input?b.input[0]:null,[Q]):[!0,""],ia=Q.getMonth()!=t,ma=ia&&!ba||!pa[0]||z&&Q<z||A&&Q>A,la=la+('<td class="'+(5<=(U+k+6)%7?" ui-datepicker-week-end":"")+(ia?" ui-datepicker-other-month":"")+(Q.getTime()==J.getTime()&&
t==b.selectedMonth&&b._keyEvent||L.getTime()==Q.getTime()&&L.getTime()==J.getTime()?" "+this._dayOverClass:"")+(ma?" "+this._unselectableClass+" ui-state-disabled":"")+(ia&&!Y?"":" "+pa[1]+(Q.getTime()==y.getTime()?" "+this._currentClass:"")+(Q.getTime()==d.getTime()?" ui-datepicker-today":""))+'"'+((!ia||Y)&&pa[2]?' title="'+pa[2]+'"':"")+(ma?"":' data-handler="selectDay" data-event="click" data-month="'+Q.getMonth()+'" data-year="'+Q.getFullYear()+'"')+">"+(ia&&!Y?"&#xa0;":ma?'<span class="ui-state-default">'+
Q.getDate()+"</span>":'<a class="ui-state-default'+(Q.getTime()==d.getTime()?" ui-state-highlight":"")+(Q.getTime()==y.getTime()?" ui-state-active":"")+(ia?" ui-priority-secondary":"")+'" href="#">'+Q.getDate()+"</a>")+"</td>");Q.setDate(Q.getDate()+1);Q=this._daylightSavingAdjust(Q)}K+=la+"</tr>"}t++;11<t&&(t=0,F++);K+="</tbody></table>"+(w?"</div>"+(0<v[0]&&T==v[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");ga+=K}ca+=ga}return ca+=f+(a.ui.ie6&&!b.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':
""),b._keyEvent=!1,ca},_generateMonthYearHeader:function(a,b,d,e,f,h,k,t){var x=this._get(a,"changeMonth"),w=this._get(a,"changeYear"),y=this._get(a,"showMonthAfterYear"),z='<div class="ui-datepicker-title">',A="";if(h||!x)A+='<span class="ui-datepicker-month">'+k[b]+"</span>";else{k=e&&e.getFullYear()==d;for(var F=f&&f.getFullYear()==d,A=A+'<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">',u=0;12>u;u++)(!k||u>=e.getMonth())&&(!F||u<=f.getMonth())&&(A+='<option value="'+
u+'"'+(u==b?' selected="selected"':"")+">"+t[u]+"</option>");A+="</select>"}y||(z+=A+(h||!x||!w?"&#xa0;":""));if(!a.yearshtml)if(a.yearshtml="",h||!w)z+='<span class="ui-datepicker-year">'+d+"</span>";else{t=this._get(a,"yearRange").split(":");var C=(new Date).getFullYear();k=function(a){a=a.match(/c[+-].*/)?d+parseInt(a.substring(1),10):a.match(/[+-].*/)?C+parseInt(a,10):parseInt(a,10);return isNaN(a)?C:a};b=k(t[0]);t=Math.max(b,k(t[1]||""));b=e?Math.max(b,e.getFullYear()):b;t=f?Math.min(t,f.getFullYear()):
t;for(a.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';b<=t;b++)a.yearshtml+='<option value="'+b+'"'+(b==d?' selected="selected"':"")+">"+b+"</option>";a.yearshtml+="</select>";z+=a.yearshtml;a.yearshtml=null}return z+=this._get(a,"yearSuffix"),y&&(z+=(h||!x||!w?"&#xa0;":"")+A),z+="</div>",z},_adjustInstDate:function(a,b,d){var e=a.drawYear+("Y"==d?b:0),f=a.drawMonth+("M"==d?b:0);b=Math.min(a.selectedDay,this._getDaysInMonth(e,f))+("D"==d?b:0);e=this._restrictMinMax(a,
this._daylightSavingAdjust(new Date(e,f,b)));a.selectedDay=e.getDate();a.drawMonth=a.selectedMonth=e.getMonth();a.drawYear=a.selectedYear=e.getFullYear();("M"==d||"Y"==d)&&this._notifyChange(a)},_restrictMinMax:function(a,b){var d=this._getMinMaxDate(a,"min"),e=this._getMinMaxDate(a,"max"),d=d&&b<d?d:b;return d=e&&d>e?e:d,d},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){a=this._get(a,
"numberOfMonths");return null==a?[1,1]:"number"==typeof a?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,d,e){var f=this._getNumberOfMonths(a);d=this._daylightSavingAdjust(new Date(d,e+(0>b?b:f[0]*f[1]),1));return 0>b&&d.setDate(this._getDaysInMonth(d.getFullYear(),
d.getMonth())),this._isInRange(a,d)},_isInRange:function(a,b){var d=this._getMinMaxDate(a,"min"),e=this._getMinMaxDate(a,"max");return(!d||b.getTime()>=d.getTime())&&(!e||b.getTime()<=e.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");return b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,
"monthNames")}},_formatDate:function(a,b,d,e){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);b=b?"object"==typeof b?b:this._daylightSavingAdjust(new Date(e,d,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}});a.fn.datepicker=function(b){if(!this.length)return this;a.datepicker.initialized||(a(document).mousedown(a.datepicker._checkExternalClick).find(document.body).append(a.datepicker.dpDiv),
a.datepicker.initialized=!0);var d=Array.prototype.slice.call(arguments,1);return"string"!=typeof b||"isDisabled"!=b&&"getDate"!=b&&"widget"!=b?"option"==b&&2==arguments.length&&"string"==typeof arguments[1]?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(d)):this.each(function(){"string"==typeof b?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this].concat(d)):a.datepicker._attachDatepicker(this,b)}):a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(d))};
a.datepicker=new b;a.datepicker.initialized=!1;a.datepicker.uuid=(new Date).getTime();a.datepicker.version="1.9.2";window["DP_jQuery_"+k]=a})(jQuery);
(function(a,d){var b={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},e={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};a.widget("ui.dialog",{version:"1.9.2",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(b){var d=a(this).css(b).offset().top;0>d&&a(this).css("top",
b.top-d)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");"string"!=typeof this.originalTitle&&(this.originalTitle="");this.oldPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.options.title=this.options.title||this.originalTitle;var b=this,d=this.options,e=d.title||"&#160;",l,m,n,p;l=(this.uiDialog=a("<div>")).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+
d.dialogClass).css({display:"none",outline:0,zIndex:d.zIndex}).attr("tabIndex",-1).keydown(function(e){d.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===a.ui.keyCode.ESCAPE&&(b.close(e),e.preventDefault())}).mousedown(function(a){b.moveToTop(!1,a)}).appendTo("body");this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(l);m=(this.uiDialogTitlebar=a("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").bind("mousedown",
function(){l.focus()}).prependTo(l);n=a("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(a){a.preventDefault();b.close(a)}).appendTo(m);(this.uiDialogTitlebarCloseText=a("<span>")).addClass("ui-icon ui-icon-closethick").text(d.closeText).appendTo(n);e=a("<span>").uniqueId().addClass("ui-dialog-title").html(e).prependTo(m);p=(this.uiDialogButtonPane=a("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");(this.uiButtonSet=
a("<div>")).addClass("ui-dialog-buttonset").appendTo(p);l.attr({role:"dialog","aria-labelledby":e.attr("id")});m.find("*").add(m).disableSelection();this._hoverable(n);this._focusable(n);d.draggable&&a.fn.draggable&&this._makeDraggable();d.resizable&&a.fn.resizable&&this._makeResizable();this._createButtons(d.buttons);this._isOpen=!1;a.fn.bgiframe&&l.bgiframe();this._on(l,{keydown:function(b){if(d.modal&&b.keyCode===a.ui.keyCode.TAB){var e=a(":tabbable",l),f=e.filter(":first"),e=e.filter(":last");
if(b.target===e[0]&&!b.shiftKey)return f.focus(1),!1;if(b.target===f[0]&&b.shiftKey)return e.focus(1),!1}}})},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){var a,b=this.oldPosition;this.overlay&&this.overlay.destroy();this.uiDialog.hide();this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");this.uiDialog.remove();this.originalTitle&&this.element.attr("title",this.originalTitle);a=b.parent.children().eq(b.index);a.length&&a[0]!==this.element[0]?
a.before(this.element):b.parent.append(this.element)},widget:function(){return this.uiDialog},close:function(b){var d=this,e,l;if(this._isOpen&&!1!==this._trigger("beforeClose",b))return this._isOpen=!1,this.overlay&&this.overlay.destroy(),this.options.hide?this._hide(this.uiDialog,this.options.hide,function(){d._trigger("close",b)}):(this.uiDialog.hide(),this._trigger("close",b)),a.ui.dialog.overlay.resize(),this.options.modal&&(e=0,a(".ui-dialog").each(function(){this!==d.uiDialog[0]&&(l=a(this).css("z-index"),
isNaN(l)||(e=Math.max(e,l)))}),a.ui.dialog.maxZ=e),this},isOpen:function(){return this._isOpen},moveToTop:function(b,d){var e=this.options,l;return e.modal&&!b||!e.stack&&!e.modal?this._trigger("focus",d):(e.zIndex>a.ui.dialog.maxZ&&(a.ui.dialog.maxZ=e.zIndex),this.overlay&&(a.ui.dialog.maxZ+=1,a.ui.dialog.overlay.maxZ=a.ui.dialog.maxZ,this.overlay.$el.css("z-index",a.ui.dialog.overlay.maxZ)),l={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()},a.ui.dialog.maxZ+=1,this.uiDialog.css("z-index",
a.ui.dialog.maxZ),this.element.attr(l),this._trigger("focus",d),this)},open:function(){if(!this._isOpen){var b,d=this.options,e=this.uiDialog;return this._size(),this._position(d.position),e.show(d.show),this.overlay=d.modal?new a.ui.dialog.overlay(this):null,this.moveToTop(!0),b=this.element.find(":tabbable"),b.length||(b=this.uiDialogButtonPane.find(":tabbable"),b.length||(b=e)),b.eq(0).focus(),this._isOpen=!0,this._trigger("open"),this}},_createButtons:function(b){var d=this,e=!1;this.uiDialogButtonPane.remove();
this.uiButtonSet.empty();"object"==typeof b&&null!==b&&a.each(b,function(){return!(e=!0)});e?(a.each(b,function(b,e){var f,h;e=a.isFunction(e)?{click:e,text:b}:e;e=a.extend({type:"button"},e);h=e.click;e.click=function(){h.apply(d.element[0],arguments)};f=a("<button></button>",e).appendTo(d.uiButtonSet);a.fn.button&&f.button()}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)):this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function b(a){return{position:a.position,
offset:a.offset}}var d=this,e=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(e,h){a(this).addClass("ui-dialog-dragging");d._trigger("dragStart",e,b(h))},drag:function(a,e){d._trigger("drag",a,b(e))},stop:function(l,m){e.position=[m.position.left-d.document.scrollLeft(),m.position.top-d.document.scrollTop()];a(this).removeClass("ui-dialog-dragging");d._trigger("dragStop",l,b(m));a.ui.dialog.overlay.resize()}})},
_makeResizable:function(b){function e(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}b=b===d?this.options.resizable:b;var h=this,l=this.options,m=this.uiDialog.css("position");b="string"==typeof b?b:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:l.maxWidth,maxHeight:l.maxHeight,minWidth:l.minWidth,minHeight:this._minHeight(),handles:b,start:function(b,d){a(this).addClass("ui-dialog-resizing");
h._trigger("resizeStart",b,e(d))},resize:function(a,b){h._trigger("resize",a,e(b))},stop:function(b,d){a(this).removeClass("ui-dialog-resizing");l.height=a(this).height();l.width=a(this).width();h._trigger("resizeStop",b,e(d));a.ui.dialog.overlay.resize()}}).css("position",m).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(b){var d=[],e=[0,0],l;if(b){if("string"==
typeof b||"object"==typeof b&&"0"in b)d=b.split?b.split(" "):[b[0],b[1]],1===d.length&&(d[1]=d[0]),a.each(["left","top"],function(a,b){+d[a]===d[a]&&(e[a]=d[a],d[a]=b)}),b={my:d[0]+(0>e[0]?e[0]:"+"+e[0])+" "+d[1]+(0>e[1]?e[1]:"+"+e[1]),at:d.join(" ")};b=a.extend({},a.ui.dialog.prototype.options.position,b)}else b=a.ui.dialog.prototype.options.position;(l=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.position(b);l||this.uiDialog.hide()},_setOptions:function(d){var k=this,h={},l=
!1;a.each(d,function(a,d){k._setOption(a,d);a in b&&(l=!0);a in e&&(h[a]=d)});l&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",h)},_setOption:function(b,d){var e,l=this.uiDialog;switch(b){case "buttons":this._createButtons(d);break;case "closeText":this.uiDialogTitlebarCloseText.text(""+d);break;case "dialogClass":l.removeClass(this.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+d);break;case "disabled":d?l.addClass("ui-dialog-disabled"):
l.removeClass("ui-dialog-disabled");break;case "draggable":(e=l.is(":data(draggable)"))&&!d&&l.draggable("destroy");!e&&d&&this._makeDraggable();break;case "position":this._position(d);break;case "resizable":(e=l.is(":data(resizable)"))&&!d&&l.resizable("destroy");e&&"string"==typeof d&&l.resizable("option","handles",d);!e&&!1!==d&&this._makeResizable(d);break;case "title":a(".ui-dialog-title",this.uiDialogTitlebar).html(""+(d||"&#160;"))}this._super(b,d)},_size:function(){var b,d,e,l=this.options,
m=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});l.minWidth>l.width&&(l.width=l.minWidth);b=this.uiDialog.css({height:"auto",width:l.width}).outerHeight();d=Math.max(0,l.minHeight-b);"auto"===l.height?a.support.minHeight?this.element.css({minHeight:d,height:"auto"}):(this.uiDialog.show(),e=this.element.css("height","auto").height(),m||this.uiDialog.hide(),this.element.height(Math.max(e,d))):this.element.height(Math.max(l.height-b,0));this.uiDialog.is(":data(resizable)")&&
this.uiDialog.resizable("option","minHeight",this._minHeight())}});a.extend(a.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");return a||(this.uuid+=1,a=this.uuid),"ui-dialog-title-"+a},overlay:function(b){this.$el=a.ui.dialog.overlay.create(b)}});a.extend(a.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:a.map("focus mousedown mouseup keydown keypress click".split(" "),function(a){return a+".dialog-overlay"}).join(" "),create:function(b){0===this.instances.length&&(setTimeout(function(){a.ui.dialog.overlay.instances.length&&
a(document).bind(a.ui.dialog.overlay.events,function(b){if(a(b.target).zIndex()<a.ui.dialog.overlay.maxZ)return!1})},1),a(window).bind("resize.dialog-overlay",a.ui.dialog.overlay.resize));var d=this.oldInstances.pop()||a("<div>").addClass("ui-widget-overlay");return a(document).bind("keydown.dialog-overlay",function(e){var l=a.ui.dialog.overlay.instances;0!==l.length&&l[l.length-1]===d&&b.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===a.ui.keyCode.ESCAPE&&(b.close(e),e.preventDefault())}),
d.appendTo(document.body).css({width:this.width(),height:this.height()}),a.fn.bgiframe&&d.bgiframe(),this.instances.push(d),d},destroy:function(b){var d=a.inArray(b,this.instances),e=0;-1!==d&&this.oldInstances.push(this.instances.splice(d,1)[0]);0===this.instances.length&&a([document,window]).unbind(".dialog-overlay");b.height(0).width(0).remove();a.each(this.instances,function(){e=Math.max(e,this.css("z-index"))});this.maxZ=e},height:function(){var b,d;return a.ui.ie?(b=Math.max(document.documentElement.scrollHeight,
document.body.scrollHeight),d=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),b<d?a(window).height()+"px":b+"px"):a(document).height()+"px"},width:function(){var b,d;return a.ui.ie?(b=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),d=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),b<d?a(window).width()+"px":b+"px"):a(document).width()+"px"},resize:function(){var b=a([]);a.each(a.ui.dialog.overlay.instances,function(){b=b.add(this)});
b.css({width:0,height:0}).css({width:a.ui.dialog.overlay.width(),height:a.ui.dialog.overlay.height()})}});a.extend(a.ui.dialog.overlay.prototype,{destroy:function(){a.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
(function(a,d){var b=!1;a.widget("ui.menu",{version:"1.9.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,
a.proxy(function(a){this.options.disabled&&a.preventDefault()},this));this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true");this._on({"mousedown .ui-menu-item > a":function(a){a.preventDefault()},"click .ui-state-disabled > a":function(a){a.preventDefault()},"click .ui-menu-item:has(a)":function(d){var f=a(d.target).closest(".ui-menu-item");!b&&f.not(".ui-state-disabled").length&&(b=!0,this.select(d),f.has(".ui-menu").length?this.expand(d):this.element.is(":focus")||
(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(b){var d=a(b.currentTarget);d.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(b,d)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,b){var d=this.active||this.element.children(".ui-menu-item").eq(0);b||this.focus(a,d)},blur:function(b){this._delay(function(){a.contains(this.element[0],
this.document[0].activeElement)||this.collapseAll(b)})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(d){a(d.target).closest(".ui-menu").length||this.collapseAll(d);b=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();
this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var b=a(this);b.data("ui-menu-submenu-carat")&&b.remove()});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(b){function d(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,
"\\$&")}var k,h,l,m,n=!0;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(b);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(b);break;case a.ui.keyCode.HOME:this._move("first","first",b);break;case a.ui.keyCode.END:this._move("last","last",b);break;case a.ui.keyCode.UP:this.previous(b);break;case a.ui.keyCode.DOWN:this.next(b);break;case a.ui.keyCode.LEFT:this.collapse(b);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(b);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(b);
break;case a.ui.keyCode.ESCAPE:this.collapse(b);break;default:n=!1,k=this.previousFilter||"",h=String.fromCharCode(b.keyCode),l=!1,clearTimeout(this.filterTimer),h===k?l=!0:h=k+h,m=RegExp("^"+d(h),"i"),k=this.activeMenu.children(".ui-menu-item").filter(function(){return m.test(a(this).children("a").text())}),k=l&&-1!==k.index(this.active.next())?this.active.nextAll(".ui-menu-item"):k,k.length||(h=String.fromCharCode(b.keyCode),m=RegExp("^"+d(h),"i"),k=this.activeMenu.children(".ui-menu-item").filter(function(){return m.test(a(this).children("a").text())})),
k.length?(this.focus(b,k),1<k.length?(this.previousFilter=h,this.filterTimer=this._delay(function(){delete this.previousFilter},1E3)):delete this.previousFilter):delete this.previousFilter}n&&b.preventDefault()},_activate:function(a){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(a):this.select(a))},refresh:function(){var b,d=this.options.icons.submenu;b=this.element.find(this.options.menus);b.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,
"aria-hidden":"true","aria-expanded":"false"}).each(function(){var b=a(this),e=b.prev("a"),l=a("<span>").addClass("ui-menu-icon ui-icon "+d).data("ui-menu-submenu-carat",!0);e.attr("aria-haspopup","true").prepend(l);b.attr("aria-labelledby",e.attr("id"))});b=b.add(this.element);b.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()});b.children(":not(.ui-menu-item)").each(function(){var b=
a(this);/[^\-\u2014\u2013\s]/.test(b.text())||b.addClass("ui-widget-content ui-menu-divider")});b.children(".ui-state-disabled").attr("aria-disabled","true");this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(a,b){var d;this.blur(a,a&&"focus"===a.type);this._scrollIntoView(b);this.active=b.first();d=this.active.children("a").addClass("ui-state-focus");this.options.role&&this.element.attr("aria-activedescendant",
d.attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay);d=b.children(".ui-menu");d.length&&/^mouse/.test(a.type)&&this._startOpening(d);this.activeMenu=b.parent();this._trigger("focus",a,{item:b})},_scrollIntoView:function(b){var d,k,h,l,m,n;this._hasScroll()&&(d=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||0,k=parseFloat(a.css(this.activeMenu[0],
"paddingTop"))||0,h=b.offset().top-this.activeMenu.offset().top-d-k,l=this.activeMenu.scrollTop(),m=this.activeMenu.height(),n=b.height(),0>h?this.activeMenu.scrollTop(l+h):h+n>m&&this.activeMenu.scrollTop(l+h-m+n))},blur:function(a,b){b||clearTimeout(this.timer);this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer);"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close();
this._open(a)},this.delay))},_open:function(b){var d=a.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(b.parents(".ui-menu")).hide().attr("aria-hidden","true");b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(d)},collapseAll:function(b,d){clearTimeout(this.timer);this.timer=this._delay(function(){var k=d?this.element:a(b&&b.target).closest(this.element.find(".ui-menu"));k.length||(k=this.element);this._close(k);this.blur(b);
this.activeMenu=k},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element);a.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(a){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(a,b))},expand:function(a){var b=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();
b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(a,b)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,d){var h;this.active&&("first"===a||"last"===a?h=this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):h=this.active[a+
"All"](".ui-menu-item").eq(0));if(!h||!h.length||!this.active)h=this.activeMenu.children(".ui-menu-item")[b]();this.focus(d,h)},nextPage:function(b){var d,k,h;this.active?this.isLastItem()||(this._hasScroll()?(k=this.active.offset().top,h=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return d=a(this),0>d.offset().top-k-h}),this.focus(b,d)):this.focus(b,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())):this.next(b)},previousPage:function(b){var d,
k,h;this.active?this.isFirstItem()||(this._hasScroll()?(k=this.active.offset().top,h=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return d=a(this),0<d.offset().top-k+h}),this.focus(b,d)):this.focus(b,this.activeMenu.children(".ui-menu-item").first())):this.next(b)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(b){this.active=this.active||a(b.target).closest(".ui-menu-item");var d={item:this.active};this.active.has(".ui-menu").length||
this.collapseAll(b,!0);this._trigger("select",b,d)}})})(jQuery);
(function(a,d){a.widget("ui.progressbar",{version:"1.9.2",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");
this.valueDiv.remove()},value:function(a){return a===d?this._value():(this._setOption("value",a),this)},_setOption:function(a,d){"value"===a&&(this.options.value=d,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete"));this._super(a,d)},_value:function(){var a=this.options.value;return"number"!=typeof a&&(a=0),Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var a=this.value(),d=this._percentage();
this.oldValue!==a&&(this.oldValue=a,this._trigger("change"));this.valueDiv.toggle(a>this.min).toggleClass("ui-corner-right",a===this.options.max).width(d.toFixed(0)+"%");this.element.attr("aria-valuenow",a)}})})(jQuery);
(function(a,d){a.widget("ui.slider",a.ui.mouse,{version:"1.9.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var b,d,f=this.options,k=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),h=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+
" ui-widget ui-widget-content ui-corner-all"+(f.disabled?" ui-slider-disabled ui-disabled":""));this.range=a([]);f.range&&(!0===f.range&&(f.values||(f.values=[this._valueMin(),this._valueMin()]),f.values.length&&2!==f.values.length&&(f.values=[f.values[0],f.values[0]])),this.range=a("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===f.range||"max"===f.range?" ui-slider-range-"+f.range:"")));d=f.values&&f.values.length||1;for(b=k.length;b<d;b++)h.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=k.add(a(h.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).mouseenter(function(){f.disabled||a(this).addClass("ui-state-hover")}).mouseleave(function(){a(this).removeClass("ui-state-hover")}).focus(function(){f.disabled?a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")});
this.handles.each(function(b){a(this).data("ui-slider-handle-index",b)});this._on(this.handles,{keydown:function(b){var d,e,f,h=a(b.target).data("ui-slider-handle-index");switch(b.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(b.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(b.target).addClass("ui-state-active"),d=this._start(b,h),!1===
d))return}d=this.options.step;this.options.values&&this.options.values.length?e=f=this.values(h):e=f=this.value();switch(b.keyCode){case a.ui.keyCode.HOME:f=this._valueMin();break;case a.ui.keyCode.END:f=this._valueMax();break;case a.ui.keyCode.PAGE_UP:f=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:f=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(e===this._valueMax())return;f=this._trimAlignValue(e+
d);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(e===this._valueMin())return;f=this._trimAlignValue(e-d)}this._slide(b,h,f)},keyup:function(b){var d=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,d),this._change(b,d),a(b.target).removeClass("ui-state-active"))}});this._refreshValue();this._animateOff=!1},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all");
this._mouseDestroy()},_mouseCapture:function(b){var d,f,k,h,l,m,n,p,r=this,s=this.options;return s.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),d={x:b.pageX,y:b.pageY},f=this._normValueFromMouse(d),k=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var d=Math.abs(f-r.values(b));k>d&&(k=d,h=a(this),l=b)}),!0===s.range&&this.values(1)===s.min&&(l+=1,h=a(this.handles[l])),m=this._start(b,l),
!1===m?!1:(this._mouseSliding=!0,this._handleIndex=l,h.addClass("ui-state-active").focus(),n=h.offset(),p=!a(b.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=p?{left:0,top:0}:{left:b.pageX-n.left-h.width()/2,top:b.pageY-n.top-h.height()/2-(parseInt(h.css("borderTopWidth"),10)||0)-(parseInt(h.css("borderBottomWidth"),10)||0)+(parseInt(h.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,l,f),this._animateOff=!0,!0))},_mouseStart:function(){return!0},
_mouseDrag:function(a){var d=this._normValueFromMouse({x:a.pageX,y:a.pageY});return this._slide(a,this._handleIndex,d),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var d,
f,k,h,l;return"horizontal"===this.orientation?(d=this.elementSize.width,f=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(d=this.elementSize.height,f=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),k=f/d,1<k&&(k=1),0>k&&(k=0),"vertical"===this.orientation&&(k=1-k),h=this._valueMax()-this._valueMin(),l=this._valueMin()+k*h,this._trimAlignValue(l)},_start:function(a,d){var f={handle:this.handles[d],value:this.value()};return this.options.values&&this.options.values.length&&
(f.value=this.values(d),f.values=this.values()),this._trigger("start",a,f)},_slide:function(a,d,f){var k,h,l;this.options.values&&this.options.values.length?(k=this.values(d?0:1),2===this.options.values.length&&!0===this.options.range&&(0===d&&f>k||1===d&&f<k)&&(f=k),f!==this.values(d)&&(h=this.values(),h[d]=f,l=this._trigger("slide",a,{handle:this.handles[d],value:f,values:h}),this.values(d?0:1),!1!==l&&this.values(d,f,!0))):f!==this.value()&&(l=this._trigger("slide",a,{handle:this.handles[d],value:f}),
!1!==l&&this.value(f))},_stop:function(a,d){var f={handle:this.handles[d],value:this.value()};this.options.values&&this.options.values.length&&(f.value=this.values(d),f.values=this.values());this._trigger("stop",a,f)},_change:function(a,d){if(!this._keySliding&&!this._mouseSliding){var f={handle:this.handles[d],value:this.value()};this.options.values&&this.options.values.length&&(f.value=this.values(d),f.values=this.values());this._trigger("change",a,f)}},value:function(a){if(arguments.length)this.options.value=
this._trimAlignValue(a),this._refreshValue(),this._change(null,0);else return this._value()},values:function(b,d){var f,k,h;if(1<arguments.length)this.options.values[b]=this._trimAlignValue(d),this._refreshValue(),this._change(null,b);else{if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();f=this.options.values;k=arguments[0];for(h=0;h<f.length;h+=1)f[h]=this._trimAlignValue(k[h]),this._change(null,
h);this._refreshValue()}},_setOption:function(b,d){var f,k=0;a.isArray(this.options.values)&&(k=this.options.values.length);a.Widget.prototype._setOption.apply(this,arguments);switch(b){case "disabled":d?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(f=0;f<k;f+=1)this._change(null,f);this._animateOff=!1;break;case "min":case "max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a),a},_values:function(a){var d,f;if(arguments.length)return d=this.options.values[a],
d=this._trimAlignValue(d),d;d=this.options.values.slice();for(f=0;f<d.length;f+=1)d[f]=this._trimAlignValue(d[f]);return d},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var d=0<this.options.step?this.options.step:1,f=(a-this._valueMin())%d;a-=f;return 2*Math.abs(f)>=d&&(a+=0<f?d:-d),parseFloat(a.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b,
d,f,k,h,l=this.options.range,m=this.options,n=this,p=this._animateOff?!1:m.animate,r={};this.options.values&&this.options.values.length?this.handles.each(function(f){d=100*((n.values(f)-n._valueMin())/(n._valueMax()-n._valueMin()));r["horizontal"===n.orientation?"left":"bottom"]=d+"%";a(this).stop(1,1)[p?"animate":"css"](r,m.animate);!0===n.options.range&&("horizontal"===n.orientation?(0===f&&n.range.stop(1,1)[p?"animate":"css"]({left:d+"%"},m.animate),1===f&&n.range[p?"animate":"css"]({width:d-b+
"%"},{queue:!1,duration:m.animate})):(0===f&&n.range.stop(1,1)[p?"animate":"css"]({bottom:d+"%"},m.animate),1===f&&n.range[p?"animate":"css"]({height:d-b+"%"},{queue:!1,duration:m.animate})));b=d}):(f=this.value(),k=this._valueMin(),h=this._valueMax(),d=h!==k?100*((f-k)/(h-k)):0,r["horizontal"===this.orientation?"left":"bottom"]=d+"%",this.handle.stop(1,1)[p?"animate":"css"](r,m.animate),"min"===l&&"horizontal"===this.orientation&&this.range.stop(1,1)[p?"animate":"css"]({width:d+"%"},m.animate),"max"===
l&&"horizontal"===this.orientation&&this.range[p?"animate":"css"]({width:100-d+"%"},{queue:!1,duration:m.animate}),"min"===l&&"vertical"===this.orientation&&this.range.stop(1,1)[p?"animate":"css"]({height:d+"%"},m.animate),"max"===l&&"vertical"===this.orientation&&this.range[p?"animate":"css"]({height:100-d+"%"},{queue:!1,duration:m.animate}))}})})(jQuery);
(function(a){function d(a){return function(){var d=this.element.val();a.apply(this,arguments);this._refresh();d!==this.element.val()&&this._trigger("change")}}a.widget("ui.spinner",{version:"1.9.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);
this._setOption("min",this.options.min);this._setOption("step",this.options.step);this._value(this.element.val(),!0);this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var b={},d=this.element;return a.each(["min","max","step"],function(a,k){var h=d.attr(k);void 0!==h&&h.length&&(b[k]=h)}),b},_events:{keydown:function(a){this._start(a)&&this._keydown(a)&&a.preventDefault()},keyup:"_stop",
focus:function(){this.previous=this.element.val()},blur:function(a){this.cancelBlur?delete this.cancelBlur:(this._refresh(),this.previous!==this.element.val()&&this._trigger("change",a))},mousewheel:function(a,d){if(d){if(!this.spinning&&!this._start(a))return!1;this._spin((0<d?1:-1)*this.options.step,a);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(a)},100);a.preventDefault()}},"mousedown .ui-spinner-button":function(b){function d(){this.element[0]===
this.document[0].activeElement||(this.element.focus(),this.previous=f,this._delay(function(){this.previous=f}))}var f;f=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();b.preventDefault();d.call(this);this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur;d.call(this)});!1!==this._start(b)&&this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(b){if(a(b.currentTarget).hasClass("ui-state-active")){if(!1===
this._start(b))return!1;this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b)}},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var a=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton");this.buttons=a.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");this.buttons.height()>Math.ceil(0.5*a.height())&&0<a.height()&&
a.height(a.height());this.options.disabled&&this.disable()},_keydown:function(b){var d=this.options,f=a.ui.keyCode;switch(b.keyCode){case f.UP:return this._repeat(null,1,b),!0;case f.DOWN:return this._repeat(null,-1,b),!0;case f.PAGE_UP:return this._repeat(null,d.page,b),!0;case f.PAGE_DOWN:return this._repeat(null,-d.page,b),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+
this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(a){return!this.spinning&&!1===this._trigger("start",a)?!1:(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(a,d,f){a=a||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,d,f)},a);this._spin(d*this.options.step,f)},_spin:function(a,d){var f=this.value()||0;this.counter||
(this.counter=1);f=this._adjustValue(f+a*this._increment(this.counter));if(!this.spinning||!1!==this._trigger("spin",d,{value:f}))this._value(f),this.counter++},_increment:function(b){var d=this.options.incremental;return d?a.isFunction(d)?d(b):Math.floor(b*b*b/5E4-b*b/500+17*b/200+1):1},_precision:function(){var a=this._precisionOf(this.options.step);return null!==this.options.min&&(a=Math.max(a,this._precisionOf(this.options.min))),a},_precisionOf:function(a){a=a.toString();var d=a.indexOf(".");
return-1===d?0:a.length-d-1},_adjustValue:function(a){var d,f,k=this.options;return d=null!==k.min?k.min:0,f=a-d,f=Math.round(f/k.step)*k.step,a=d+f,a=parseFloat(a.toFixed(this._precision())),null!==k.max&&a>k.max?k.max:null!==k.min&&a<k.min?k.min:a},_stop:function(a){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",a))},_setOption:function(a,d){if("culture"===a||"numberFormat"===a){var f=this._parse(this.element.val());
this.options[a]=d;this.element.val(this._format(f))}else("max"===a||"min"===a||"step"===a)&&"string"==typeof d&&(d=this._parse(d)),this._super(a,d),"disabled"===a&&(d?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:d(function(a){this._super(a);this._value(this.element.val())}),_parse:function(a){return"string"==typeof a&&""!==a&&(a=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(a,10,
this.options.culture):+a),""===a||isNaN(a)?null:a},_format:function(a){return""===a?"":window.Globalize&&this.options.numberFormat?Globalize.format(a,this.options.numberFormat,this.options.culture):a},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(a,d){var f;""!==a&&(f=this._parse(a),null!==f&&(d||(f=this._adjustValue(f)),a=this._format(f)));this.element.val(a);this._refresh()},
_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.uiSpinner.replaceWith(this.element)},stepUp:d(function(a){this._stepUp(a)}),_stepUp:function(a){this._spin((a||1)*this.options.step)},stepDown:d(function(a){this._stepDown(a)}),_stepDown:function(a){this._spin((a||1)*-this.options.step)},pageUp:d(function(a){this._stepUp((a||1)*this.options.page)}),
pageDown:d(function(a){this._stepDown((a||1)*this.options.page)}),value:function(a){if(!arguments.length)return this._parse(this.element.val());d(this._value).call(this,a)},widget:function(){return this.uiSpinner}})})(jQuery);
(function(a,d){function b(a){return 1<a.hash.length&&a.href.replace(f,"")===location.href.replace(f,"").replace(/\s/g,"%20")}var e=0,f=/#.*$/;a.widget("ui.tabs",{version:"1.9.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var b=this,d=this.options,e=d.active,f=location.hash.substring(1);this.running=!1;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",
d.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(b){a(this).is(".ui-state-disabled")&&b.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){a(this).closest("li").is(".ui-state-disabled")&&this.blur()});this._processTabs();if(null===e&&(f&&this.tabs.each(function(b,d){if(a(d).attr("aria-controls")===f)return e=b,!1}),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null===e||-1===e))e=this.tabs.length?0:!1;!1!==
e&&(e=this.tabs.index(this.tabs.eq(e)),-1===e&&(e=d.collapsible?!1:0));d.active=e;!d.collapsible&&!1===d.active&&this.anchors.length&&(d.active=0);a.isArray(d.disabled)&&(d.disabled=a.unique(d.disabled.concat(a.map(this.tabs.filter(".ui-state-disabled"),function(a){return b.tabs.index(a)}))).sort());!1!==this.options.active&&this.anchors.length?this.active=this._findActive(this.options.active):this.active=a();this._refresh();this.active.length&&this.load(d.active)},_getCreateEventData:function(){return{tab:this.active,
panel:this.active.length?this._getPanelForTab(this.active):a()}},_tabKeydown:function(b){var d=a(this.document[0].activeElement).closest("li"),e=this.tabs.index(d),f=!0;if(!this._handlePageNav(b)){switch(b.keyCode){case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:e++;break;case a.ui.keyCode.UP:case a.ui.keyCode.LEFT:f=!1;e--;break;case a.ui.keyCode.END:e=this.anchors.length-1;break;case a.ui.keyCode.HOME:e=0;break;case a.ui.keyCode.SPACE:b.preventDefault();clearTimeout(this.activating);this._activate(e);
return;case a.ui.keyCode.ENTER:b.preventDefault();clearTimeout(this.activating);this._activate(e===this.options.active?!1:e);return;default:return}b.preventDefault();clearTimeout(this.activating);e=this._focusNextTab(e,f);b.ctrlKey||(d.attr("aria-selected","false"),this.tabs.eq(e).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",e)},this.delay))}},_panelKeydown:function(b){this._handlePageNav(b)||b.ctrlKey&&b.keyCode===a.ui.keyCode.UP&&(b.preventDefault(),this.active.focus())},
_handlePageNav:function(b){if(b.altKey&&b.keyCode===a.ui.keyCode.PAGE_UP)return this._activate(this._focusNextTab(this.options.active-1,!1)),!0;if(b.altKey&&b.keyCode===a.ui.keyCode.PAGE_DOWN)return this._activate(this._focusNextTab(this.options.active+1,!0)),!0},_findNextTab:function(b,d){for(var e=this.tabs.length-1;-1!==a.inArray((b>e&&(b=0),0>b&&(b=e),b),this.options.disabled);)b=d?b+1:b-1;return b},_focusNextTab:function(a,b){return a=this._findNextTab(a,b),this.tabs.eq(a).focus(),a},_setOption:function(a,
b){"active"===a?this._activate(b):"disabled"===a?this._setupDisabled(b):(this._super(a,b),"collapsible"===a&&(this.element.toggleClass("ui-tabs-collapsible",b),!b&&!1===this.options.active&&this._activate(0)),"event"===a&&this._setupEvents(b),"heightStyle"===a&&this._setupHeightStyle(b))},_tabId:function(a){return a.attr("aria-controls")||"ui-tabs-"+ ++e},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var b=this.options,d=this.tablist.children(":has(a[href])");
b.disabled=a.map(d.filter(".ui-state-disabled"),function(a){return d.index(a)});this._processTabs();!1===b.active||!this.anchors.length?(b.active=!1,this.active=a()):this.active.length&&!a.contains(this.tablist[0],this.active[0])?this.tabs.length===b.disabled.length?(b.active=!1,this.active=a()):this._activate(this._findNextTab(Math.max(0,b.active-1),!1)):b.active=this.tabs.index(this.active);this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);
this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"});this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var d=
this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist");this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return a("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=a();this.anchors.each(function(e,f){var m,n,p,r=a(f).uniqueId().attr("id"),s=a(f).closest("li"),
v=s.attr("aria-controls");b(f)?(m=f.hash,n=d.element.find(d._sanitizeSelector(m))):(p=d._tabId(s),m="#"+p,n=d.element.find(m),n.length||(n=d._createPanel(p),n.insertAfter(d.panels[e-1]||d.tablist)),n.attr("aria-live","polite"));n.length&&(d.panels=d.panels.add(n));v&&s.data("ui-tabs-aria-controls",v);s.attr({"aria-controls":m.substring(1),"aria-labelledby":r});n.attr("aria-labelledby",r)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},
_createPanel:function(b){return a("<div>").attr("id",b).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(b){a.isArray(b)&&(b.length?b.length===this.anchors.length&&(b=!0):b=!1);for(var d=0,e;e=this.tabs[d];d++)!0===b||-1!==a.inArray(d,b)?a(e).addClass("ui-state-disabled").attr("aria-disabled","true"):a(e).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=b},_setupEvents:function(b){var d={click:function(a){a.preventDefault()}};
b&&a.each(b.split(" "),function(a,b){d[b]="_eventHandler"});this._off(this.anchors.add(this.tabs).add(this.panels));this._on(this.anchors,d);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(b){var d,e,f=this.element.parent();"fill"===b?(a.support.minHeight||(e=f.css("overflow"),f.css("overflow","hidden")),d=f.height(),this.element.siblings(":visible").each(function(){var b=
a(this),e=b.css("position");"absolute"===e||"fixed"===e||(d-=b.outerHeight(!0))}),e&&f.css("overflow",e),this.element.children().not(this.panels).each(function(){d-=a(this).outerHeight(!0)}),this.panels.each(function(){a(this).height(Math.max(0,d-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===b&&(d=0,this.panels.each(function(){d=Math.max(d,a(this).height("").height())}).height(d))},_eventHandler:function(b){var d=this.options,e=this.active,f=a(b.currentTarget).closest("li"),
n=f[0]===e[0],p=n&&d.collapsible,r=p?a():this._getPanelForTab(f),s=e.length?this._getPanelForTab(e):a(),e={oldTab:e,oldPanel:s,newTab:p?a():f,newPanel:r};b.preventDefault();if(!f.hasClass("ui-state-disabled")&&!f.hasClass("ui-tabs-loading")&&!this.running&&!(n&&!d.collapsible||!1===this._trigger("beforeActivate",b,e)))d.active=p?!1:this.tabs.index(f),this.active=n?a():f,this.xhr&&this.xhr.abort(),!s.length&&!r.length&&a.error("jQuery UI Tabs: Mismatching fragment identifier."),r.length&&this.load(this.tabs.index(f),
b),this._toggle(b,e)},_toggle:function(b,d){function e(){n.running=!1;n._trigger("activate",b,d)}function f(){d.newTab.closest("li").addClass("ui-tabs-active ui-state-active");p.length&&n.options.show?n._show(p,n.options.show,e):(p.show(),e())}var n=this,p=d.newPanel,r=d.oldPanel;this.running=!0;r.length&&this.options.hide?this._hide(r,this.options.hide,function(){d.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");f()}):(d.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),
r.hide(),f());r.attr({"aria-expanded":"false","aria-hidden":"true"});d.oldTab.attr("aria-selected","false");p.length&&r.length?d.oldTab.attr("tabIndex",-1):p.length&&this.tabs.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1);p.attr({"aria-expanded":"true","aria-hidden":"false"});d.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(b){b=this._findActive(b);b[0]!==this.active[0]&&(b.length||(b=this.active),b=b.find(".ui-tabs-anchor")[0],this._eventHandler({target:b,
currentTarget:b,preventDefault:a.noop}))},_findActive:function(b){return!1===b?a():this.tabs.eq(b)},_getIndex:function(a){return"string"==typeof a&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']"))),a},_destroy:function(){this.xhr&&this.xhr.abort();this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeData("href.tabs").removeData("load.tabs").removeUniqueId();
this.tabs.add(this.panels).each(function(){a.data(this,"ui-tabs-destroy")?a(this).remove():a(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")});this.tabs.each(function(){var b=a(this),d=b.data("ui-tabs-aria-controls");
d?b.attr("aria-controls",d):b.removeAttr("aria-controls")});this.panels.show();"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(b){var e=this.options.disabled;!1!==e&&(b===d?e=!1:(b=this._getIndex(b),a.isArray(e)?e=a.map(e,function(a){return a!==b?a:null}):e=a.map(this.tabs,function(a,d){return d!==b?d:null})),this._setupDisabled(e))},disable:function(b){var e=this.options.disabled;if(!0!==e){if(b===d)e=!0;else{b=this._getIndex(b);if(-1!==a.inArray(b,e))return;a.isArray(e)?
e=a.merge([b],e).sort():e=[b]}this._setupDisabled(e)}},load:function(d,e){d=this._getIndex(d);var f=this,m=this.tabs.eq(d),n=m.find(".ui-tabs-anchor"),p=this._getPanelForTab(m),r={tab:m,panel:p};b(n[0])||(this.xhr=a.ajax(this._ajaxSettings(n,e,r)))&&"canceled"!==this.xhr.statusText&&(m.addClass("ui-tabs-loading"),p.attr("aria-busy","true"),this.xhr.success(function(a){setTimeout(function(){p.html(a);f._trigger("load",e,r)},1)}).complete(function(a,b){setTimeout(function(){"abort"===b&&f.panels.stop(!1,
!0);m.removeClass("ui-tabs-loading");p.removeAttr("aria-busy");a===f.xhr&&delete f.xhr},1)}))},_ajaxSettings:function(b,d,e){var f=this;return{url:b.attr("href"),beforeSend:function(b,k){return f._trigger("beforeLoad",d,a.extend({jqXHR:b,ajaxSettings:k},e))}}},_getPanelForTab:function(b){b=a(b).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+b))}});!1!==a.uiBackCompat&&(a.ui.tabs.prototype._ui=function(a,b){return{tab:a,panel:b,index:this.anchors.index(a)}},a.widget("ui.tabs",
a.ui.tabs,{url:function(a,b){this.anchors.eq(a).attr("href",b)}}),a.widget("ui.tabs",a.ui.tabs,{options:{ajaxOptions:null,cache:!1},_create:function(){this._super();var b=this;this._on({tabsbeforeload:function(d,e){a.data(e.tab[0],"cache.tabs")?d.preventDefault():e.jqXHR.success(function(){b.options.cache&&a.data(e.tab[0],"cache.tabs",!0)})}})},_ajaxSettings:function(b,d,e){var f=this.options.ajaxOptions;return a.extend({},f,{error:function(a,b){try{f.error(a,b,e.tab.closest("li").index(),e.tab[0])}catch(d){}}},
this._superApply(arguments))},_setOption:function(a,b){"cache"===a&&!1===b&&this.anchors.removeData("cache.tabs");this._super(a,b)},_destroy:function(){this.anchors.removeData("cache.tabs");this._super()},url:function(a){this.anchors.eq(a).removeData("cache.tabs");this._superApply(arguments)}}),a.widget("ui.tabs",a.ui.tabs,{abort:function(){this.xhr&&this.xhr.abort()}}),a.widget("ui.tabs",a.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super();this._on({tabsbeforeload:function(a,
b){if(a.target===this.element[0]&&this.options.spinner){var d=b.tab.find("span"),e=d.html();d.html(this.options.spinner);b.jqXHR.complete(function(){d.html(e)})}}})}}),a.widget("ui.tabs",a.ui.tabs,{options:{enable:null,disable:null},enable:function(b){var d=this.options,e;if(b&&!0===d.disabled||a.isArray(d.disabled)&&-1!==a.inArray(b,d.disabled))e=!0;this._superApply(arguments);e&&this._trigger("enable",null,this._ui(this.anchors[b],this.panels[b]))},disable:function(b){var d=this.options,e;if(b&&
!1===d.disabled||a.isArray(d.disabled)&&-1===a.inArray(b,d.disabled))e=!0;this._superApply(arguments);e&&this._trigger("disable",null,this._ui(this.anchors[b],this.panels[b]))}}),a.widget("ui.tabs",a.ui.tabs,{options:{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},add:function(b,e,f){f===d&&(f=this.anchors.length);var m,n,p=this.options;e=a(p.tabTemplate.replace(/#\{href\}/g,b).replace(/#\{label\}/g,e));b=b.indexOf("#")?this._tabId(e):b.replace("#","");return e.addClass("ui-state-default ui-corner-top").data("ui-tabs-destroy",
!0),e.attr("aria-controls",b),m=f>=this.tabs.length,n=this.element.find("#"+b),n.length||(n=this._createPanel(b),m?0<f?n.insertAfter(this.panels.eq(-1)):n.appendTo(this.element):n.insertBefore(this.panels[f])),n.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide(),m?e.appendTo(this.tablist):e.insertBefore(this.tabs[f]),p.disabled=a.map(p.disabled,function(a){return a>=f?++a:a}),this.refresh(),1===this.tabs.length&&!1===p.active&&this.option("active",0),this._trigger("add",null,this._ui(this.anchors[f],
this.panels[f])),this},remove:function(b){b=this._getIndex(b);var d=this.options,e=this.tabs.eq(b).remove(),f=this._getPanelForTab(e).remove();return e.hasClass("ui-tabs-active")&&2<this.anchors.length&&this._activate(b+(b+1<this.anchors.length?1:-1)),d.disabled=a.map(a.grep(d.disabled,function(a){return a!==b}),function(a){return a>=b?--a:a}),this.refresh(),this._trigger("remove",null,this._ui(e.find("a")[0],f[0])),this}}),a.widget("ui.tabs",a.ui.tabs,{length:function(){return this.anchors.length}}),
a.widget("ui.tabs",a.ui.tabs,{options:{idPrefix:"ui-tabs-"},_tabId:function(b){b=b.is("li")?b.find("a[href]"):b;return b=b[0],a(b).closest("li").attr("aria-controls")||b.title&&b.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF\-]/g,"")||this.options.idPrefix+ ++e}}),a.widget("ui.tabs",a.ui.tabs,{options:{panelTemplate:"<div></div>"},_createPanel:function(b){return a(this.options.panelTemplate).attr("id",b).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)}}),
a.widget("ui.tabs",a.ui.tabs,{_create:function(){var a=this.options;null===a.active&&a.selected!==d&&(a.active=-1===a.selected?!1:a.selected);this._super();a.selected=a.active;!1===a.selected&&(a.selected=-1)},_setOption:function(a,b){if("selected"!==a)return this._super(a,b);var d=this.options;this._super("active",-1===b?!1:b);d.selected=d.active;!1===d.selected&&(d.selected=-1)},_eventHandler:function(){this._superApply(arguments);this.options.selected=this.options.active;!1===this.options.selected&&
(this.options.selected=-1)}}),a.widget("ui.tabs",a.ui.tabs,{options:{show:null,select:null},_create:function(){this._super();!1!==this.options.active&&this._trigger("show",null,this._ui(this.active.find(".ui-tabs-anchor")[0],this._getPanelForTab(this.active)[0]))},_trigger:function(a,b,d){var e,f,p=this._superApply(arguments);return p?("beforeActivate"===a?(e=d.newTab.length?d.newTab:d.oldTab,f=d.newPanel.length?d.newPanel:d.oldPanel,p=this._super("select",b,{tab:e.find(".ui-tabs-anchor")[0],panel:f[0],
index:e.closest("li").index()})):"activate"===a&&d.newTab.length&&(p=this._super("show",b,{tab:d.newTab.find(".ui-tabs-anchor")[0],panel:d.newPanel[0],index:d.newTab.closest("li").index()})),p):!1}}),a.widget("ui.tabs",a.ui.tabs,{select:function(a){a=this._getIndex(a);if(-1===a){if(!this.options.collapsible||-1===this.options.selected)return;a=this.options.selected}this.anchors.eq(a).trigger(this.options.event+this.eventNamespace)}}),function(){var b=0;a.widget("ui.tabs",a.ui.tabs,{options:{cookie:null},
_create:function(){var a=this.options,b;null==a.active&&a.cookie&&(b=parseInt(this._cookie(),10),-1===b&&(b=!1),a.active=b);this._super()},_cookie:function(d){var e=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++b)];return arguments.length&&(e.push(!1===d?-1:d),e.push(this.options.cookie)),a.cookie.apply(null,e)},_refresh:function(){this._super();this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_eventHandler:function(){this._superApply(arguments);this.options.cookie&&
this._cookie(this.options.active,this.options.cookie)},_destroy:function(){this._super();this.options.cookie&&this._cookie(null,this.options.cookie)}})}(),a.widget("ui.tabs",a.ui.tabs,{_trigger:function(b,d,e){e=a.extend({},e);return"load"===b&&(e.panel=e.panel[0],e.tab=e.tab.find(".ui-tabs-anchor")[0]),this._super(b,d,e)}}),a.widget("ui.tabs",a.ui.tabs,{options:{fx:null},_getFx:function(){var b,d,e=this.options.fx;return e&&(a.isArray(e)?(b=e[0],d=e[1]):b=d=e),e?{show:d,hide:b}:null},_toggle:function(a,
b){function d(){f.running=!1;f._trigger("activate",a,b)}function e(){b.newTab.closest("li").addClass("ui-tabs-active ui-state-active");p.length&&s.show?p.animate(s.show,s.show.duration,function(){d()}):(p.show(),d())}var f=this,p=b.newPanel,r=b.oldPanel,s=this._getFx();if(!s)return this._super(a,b);f.running=!0;r.length&&s.hide?r.animate(s.hide,s.hide.duration,function(){b.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");e()}):(b.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),
r.hide(),e())}}))})(jQuery);
(function(a){function d(b,d){var e=(b.attr("aria-describedby")||"").split(/\s+/);e.push(d);b.data("ui-tooltip-id",d).attr("aria-describedby",a.trim(e.join(" ")))}function b(b){var d=b.data("ui-tooltip-id"),e=(b.attr("aria-describedby")||"").split(/\s+/),d=a.inArray(d,e);-1!==d&&e.splice(d,1);b.removeData("ui-tooltip-id");(e=a.trim(e.join(" ")))?b.attr("aria-describedby",e):b.removeAttr("aria-describedby")}var e=0;a.widget("ui.tooltip",{version:"1.9.2",options:{content:function(){return a(this).attr("title")},hide:!0,
items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};this.options.disabled&&this._disable()},_setOption:function(b,d){var e=this;"disabled"===b?(this[d?"_disable":"_enable"](),this.options[b]=d):(this._super(b,d),"content"===b&&a.each(this.tooltips,function(a,b){e._updateContent(b)}))},_disable:function(){var b=
this;a.each(this.tooltips,function(d,e){var l=a.Event("blur");l.target=l.currentTarget=e[0];b.close(l,!0)});this.element.find(this.options.items).andSelf().each(function(){var b=a(this);b.is("[title]")&&b.data("ui-tooltip-title",b.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var b=a(this);b.data("ui-tooltip-title")&&b.attr("title",b.data("ui-tooltip-title"))})},open:function(b){var d=this,e=a(b?b.target:this.element).closest(this.options.items);
e.length&&!e.data("ui-tooltip-id")&&(e.attr("title")&&e.data("ui-tooltip-title",e.attr("title")),e.data("ui-tooltip-open",!0),b&&"mouseover"===b.type&&e.parents().each(function(){var b=a(this),e;b.data("ui-tooltip-open")&&(e=a.Event("blur"),e.target=e.currentTarget=this,d.close(e,!0));b.attr("title")&&(b.uniqueId(),d.parents[this.id]={element:this,title:b.attr("title")},b.attr("title",""))}),this._updateContent(e,b))},_updateContent:function(a,b){var d;d=this.options.content;var e=this,m=b?b.type:
null;if("string"==typeof d)return this._open(b,a,d);(d=d.call(a[0],function(d){a.data("ui-tooltip-open")&&e._delay(function(){b&&(b.type=m);this._open(b,a,d)})}))&&this._open(b,a,d)},_open:function(b,e,h){function l(a){p.of=a;m.is(":hidden")||m.position(p)}var m,n,p=a.extend({},this.options.position);if(h)if(m=this._find(e),m.length)m.find(".ui-tooltip-content").html(h);else{e.is("[title]")&&(b&&"mouseover"===b.type?e.attr("title",""):e.removeAttr("title"));m=this._tooltip(e);d(e,m.attr("id"));m.find(".ui-tooltip-content").html(h);
this.options.track&&b&&/^mouse/.test(b.type)?(this._on(this.document,{mousemove:l}),l(b)):m.position(a.extend({of:e},this.options.position));m.hide();this._show(m,this.options.show);this.options.show&&this.options.show.delay&&(n=setInterval(function(){m.is(":visible")&&(l(p.of),clearInterval(n))},a.fx.interval));this._trigger("open",b,{tooltip:m});h={keyup:function(b){b.keyCode===a.ui.keyCode.ESCAPE&&(b=a.Event(b),b.currentTarget=e[0],this.close(b,!0))},remove:function(){this._removeTooltip(m)}};
if(!b||"mouseover"===b.type)h.mouseleave="close";if(!b||"focusin"===b.type)h.focusout="close";this._on(!0,e,h)}},close:function(d){var e=this,h=a(d?d.currentTarget:this.element),l=this._find(h);this.closing||(h.data("ui-tooltip-title")&&h.attr("title",h.data("ui-tooltip-title")),b(h),l.stop(!0),this._hide(l,this.options.hide,function(){e._removeTooltip(a(this))}),h.removeData("ui-tooltip-open"),this._off(h,"mouseleave focusout keyup"),h[0]!==this.element[0]&&this._off(h,"remove"),this._off(this.document,
"mousemove"),d&&"mouseleave"===d.type&&a.each(this.parents,function(b,d){a(d.element).attr("title",d.title);delete e.parents[b]}),this.closing=!0,this._trigger("close",d,{tooltip:l}),this.closing=!1)},_tooltip:function(b){var d="ui-tooltip-"+e++,h=a("<div>").attr({id:d,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return a("<div>").addClass("ui-tooltip-content").appendTo(h),h.appendTo(this.document[0].body),a.fn.bgiframe&&h.bgiframe(),
this.tooltips[d]=b,h},_find:function(b){return(b=b.data("ui-tooltip-id"))?a("#"+b):a()},_removeTooltip:function(a){a.remove();delete this.tooltips[a.attr("id")]},_destroy:function(){var b=this;a.each(this.tooltips,function(d,e){var l=a.Event("blur");l.target=l.currentTarget=e[0];b.close(l,!0);a("#"+d).remove();e.data("ui-tooltip-title")&&(e.attr("title",e.data("ui-tooltip-title")),e.removeData("ui-tooltip-title"))})}})})(jQuery);
jQuery.effects||function(a,d){var b=!1!==a.uiBackCompat;a.effects={effect:{}};(function(b,d){function k(a,b,d){var e=s[b.type]||{};return null==a?d||!b.def?null:b.def:(a=e.floor?~~a:parseFloat(a),isNaN(a)?b.def:e.mod?(a+e.mod)%e.mod:0>a?0:e.max<a?e.max:a)}function h(a){var d=p(),f=d._rgba=[];return a=a.toLowerCase(),w(n,function(b,e){var h,k=e.re.exec(a),k=k&&e.parse(k),l=e.space||"rgba";if(k)return h=d[l](k),d[r[l].cache]=h[r[l].cache],f=d._rgba=h._rgba,!1}),f.length?("0,0,0,0"===f.join()&&b.extend(f,
x.transparent),d):x[a]}function l(a,b,d){return d=(d+1)%1,1>6*d?a+6*(b-a)*d:1>2*d?b:2>3*d?a+6*(b-a)*(2/3-d):a}var m=/^([\-+])=\s*(\d+\.?\d*)/,n=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,
parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],p=b.Color=function(a,d,f,h){return new b.Color.fn.parse(a,d,f,h)},r={rgba:{props:{red:{idx:0,type:"byte"},
green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},s={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},v=p.support={},t=b("<p>")[0],x,w=b.each;t.style.cssText="background-color:rgba(1,1,1,.5)";v.rgba=-1<t.style.backgroundColor.indexOf("rgba");w(r,function(a,b){b.cache="_"+a;b.props.alpha={idx:3,type:"percent",def:1}});p.fn=b.extend(p.prototype,{parse:function(l,m,n,
s){if(l===d)return this._rgba=[null,null,null,null],this;if(l.jquery||l.nodeType)l=b(l).css(m),m=d;var t=this,v=b.type(l),B=this._rgba=[];m!==d&&(l=[l,m,n,s],v="array");if("string"===v)return this.parse(h(l)||x._default);if("array"===v)return w(r.rgba.props,function(a,b){B[b.idx]=k(l[b.idx],b)}),this;if("object"===v)return l instanceof p?w(r,function(a,b){l[b.cache]&&(t[b.cache]=l[b.cache].slice())}):w(r,function(b,d){var e=d.cache;w(d.props,function(a,b){if(!t[e]&&d.to){if("alpha"===a||null==l[a])return;
t[e]=d.to(t._rgba)}t[e][b.idx]=k(l[a],b,!0)});t[e]&&0>a.inArray(null,t[e].slice(0,3))&&(t[e][3]=1,d.from&&(t._rgba=d.from(t[e])))}),this},is:function(a){var b=p(a),d=!0,e=this;return w(r,function(a,f){var h,k=b[f.cache];return k&&(h=e[f.cache]||f.to&&f.to(e._rgba)||[],w(f.props,function(a,b){if(null!=k[b.idx])return d=k[b.idx]===h[b.idx],d})),d}),d},_space:function(){var a=[],b=this;return w(r,function(d,e){b[e.cache]&&a.push(d)}),a.pop()},transition:function(a,b){var d=p(a),e=d._space(),f=r[e],h=
0===this.alpha()?p("transparent"):this,l=h[f.cache]||f.to(h._rgba),m=l.slice();return d=d[f.cache],w(f.props,function(a,e){var f=e.idx,h=l[f],n=d[f],p=s[e.type]||{};null!==n&&(null===h?m[f]=n:(p.mod&&(n-h>p.mod/2?h+=p.mod:h-n>p.mod/2&&(h-=p.mod)),m[f]=k((n-h)*b+h,e)))}),this[e](m)},blend:function(a){if(1===this._rgba[3])return this;var d=this._rgba.slice(),f=d.pop(),h=p(a)._rgba;return p(b.map(d,function(a,b){return(1-f)*h[b]+f*a}))},toRgbaString:function(){var a="rgba(",d=b.map(this._rgba,function(a,
b){return null==a?2<b?1:0:a});return 1===d[3]&&(d.pop(),a="rgb("),a+d.join()+")"},toHslaString:function(){var a="hsla(",d=b.map(this.hsla(),function(a,b){return null==a&&(a=2<b?1:0),b&&3>b&&(a=Math.round(100*a)+"%"),a});return 1===d[3]&&(d.pop(),a="hsl("),a+d.join()+")"},toHexString:function(a){var d=this._rgba.slice(),f=d.pop();return a&&d.push(~~(255*f)),"#"+b.map(d,function(a){return a=(a||0).toString(16),1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":
this.toRgbaString()}});p.fn.parse.prototype=p.fn;r.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/255,d=a[1]/255,e=a[2]/255;a=a[3];var f=Math.max(b,d,e),h=Math.min(b,d,e),k=f-h,l=f+h,m=0.5*l,n,p;return h===f?n=0:b===f?n=60*(d-e)/k+360:d===f?n=60*(e-b)/k+120:n=60*(b-d)/k+240,0===m||1===m?p=m:0.5>=m?p=k/l:p=k/(2-l),[Math.round(n)%360,p,m,null==a?1:a]};r.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/
360,d=a[1],e=a[2];a=a[3];d=0.5>=e?e*(1+d):e+d-e*d;e=2*e-d;return[Math.round(255*l(e,d,b+1/3)),Math.round(255*l(e,d,b)),Math.round(255*l(e,d,b-1/3)),a]};w(r,function(a,h){var l=h.props,n=h.cache,s=h.to,r=h.from;p.fn[a]=function(a){s&&!this[n]&&(this[n]=s(this._rgba));if(a===d)return this[n].slice();var h,m=b.type(a),t="array"===m||"object"===m?a:arguments,v=this[n].slice();return w(l,function(a,b){var d=t["object"===m?a:b.idx];null==d&&(d=v[b.idx]);v[b.idx]=k(d,b)}),r?(h=p(r(v)),h[n]=v,h):p(v)};w(l,
function(d,f){p.fn[d]||(p.fn[d]=function(h){var k=b.type(h),l="alpha"===d?this._hsla?"hsla":"rgba":a,n=this[l](),p=n[f.idx],s;return"undefined"===k?p:("function"===k&&(h=h.call(this,p),k=b.type(h)),null==h&&f.empty?this:("string"===k&&(s=m.exec(h),s&&(h=p+parseFloat(s[2])*("+"===s[1]?1:-1))),n[f.idx]=h,this[l](n)))})})});w("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),function(a,
d){b.cssHooks[d]={set:function(a,f){var k,l="";if("string"!==b.type(f)||(k=h(f))){f=p(k||f);if(!v.rgba&&1!==f._rgba[3]){for(k="backgroundColor"===d?a.parentNode:a;(""===l||"transparent"===l)&&k&&k.style;)try{l=b.css(k,"backgroundColor"),k=k.parentNode}catch(m){}f=f.blend(l&&"transparent"!==l?l:"_default")}f=f.toRgbaString()}try{a.style[d]=f}catch(n){}}};b.fx.step[d]=function(a){a.colorInit||(a.start=p(a.elem,d),a.end=p(a.end),a.colorInit=!0);b.cssHooks[d].set(a.elem,a.start.transition(a.end,a.pos))}});
b.cssHooks.borderColor={expand:function(a){var b={};return w(["Top","Right","Bottom","Left"],function(d,e){b["border"+e+"Color"]=a}),b}};x=b.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);(function(){function b(){var d=this.ownerDocument.defaultView?
this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,e={},f,k;if(d&&d.length&&d[0]&&d[d[0]])for(k=d.length;k--;)f=d[k],"string"==typeof d[f]&&(e[a.camelCase(f)]=d[f]);else for(f in d)"string"==typeof d[f]&&(e[f]=d[f]);return e}var f=["add","remove","toggle"],k={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(b,d){a.fx.step[d]=
function(a){if("none"!==a.end&&!a.setAttr||1===a.pos&&!a.setAttr)jQuery.style(a.elem,d,a.end),a.setAttr=!0}});a.effects.animateClass=function(d,l,m,n){var p=a.speed(l,m,n);return this.queue(function(){var l=a(this),m=l.attr("class")||"",n,t=p.children?l.find("*").andSelf():l,t=t.map(function(){return{el:a(this),start:b.call(this)}});n=function(){a.each(f,function(a,b){d[b]&&l[b+"Class"](d[b])})};n();t=t.map(function(){this.end=b.call(this.el[0]);var d=this.start,f=this.end,h={},l,m;for(l in f)m=f[l],
d[l]!==m&&!k[l]&&(a.fx.step[l]||!isNaN(parseFloat(m)))&&(h[l]=m);return this.diff=h,this});l.attr("class",m);t=t.map(function(){var b=this,d=a.Deferred(),e=jQuery.extend({},p,{queue:!1,complete:function(){d.resolve(b)}});return this.el.animate(this.diff,e),d.promise()});a.when.apply(a,t.get()).done(function(){n();a.each(arguments,function(){var b=this.el;a.each(this.diff,function(a){b.css(a,"")})});p.complete.call(l[0])})})};a.fn.extend({_addClass:a.fn.addClass,addClass:function(b,d,e,f){return d?
a.effects.animateClass.call(this,{add:b},d,e,f):this._addClass(b)},_removeClass:a.fn.removeClass,removeClass:function(b,d,e,f){return d?a.effects.animateClass.call(this,{remove:b},d,e,f):this._removeClass(b)},_toggleClass:a.fn.toggleClass,toggleClass:function(b,e,f,k,p){return"boolean"==typeof e||e===d?f?a.effects.animateClass.call(this,e?{add:b}:{remove:b},f,k,p):this._toggleClass(b,e):a.effects.animateClass.call(this,{toggle:b},e,f,k)},switchClass:function(b,d,e,f,k){return a.effects.animateClass.call(this,
{add:d,remove:b},e,f,k)}})})();(function(){function e(b,d,e,f){a.isPlainObject(b)&&(d=b,b=b.effect);b={effect:b};null==d&&(d={});a.isFunction(d)&&(f=d,e=null,d={});if("number"==typeof d||a.fx.speeds[d])f=e,e=d,d={};return a.isFunction(e)&&(f=e,e=null),d&&a.extend(b,d),e=e||d.duration,b.duration=a.fx.off?0:"number"==typeof e?e:e in a.fx.speeds?a.fx.speeds[e]:a.fx.speeds._default,b.complete=f||d.complete,b}function f(d){return!d||"number"==typeof d||a.fx.speeds[d]?!0:"string"==typeof d&&!a.effects.effect[d]?
b&&a.effects[d]?!1:!0:!1}a.extend(a.effects,{version:"1.9.2",save:function(a,b){for(var d=0;d<b.length;d++)null!==b[d]&&a.data("ui-effects-"+b[d],a[0].style[b[d]])},restore:function(a,b){var e,f;for(f=0;f<b.length;f++)null!==b[f]&&(e=a.data("ui-effects-"+b[f]),e===d&&(e=""),a.css(b[f],e))},setMode:function(a,b){return"toggle"===b&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var d,e;switch(a[0]){case "top":d=0;break;case "middle":d=0.5;break;case "bottom":d=1;break;default:d=a[0]/
b.height}switch(a[1]){case "left":e=0;break;case "center":e=0.5;break;case "right":e=1;break;default:e=a[1]/b.width}return{x:e,y:d}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var d={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},e=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),f={width:b.width(),height:b.height()},n=document.activeElement;try{n.id}catch(p){n=
document.body}return b.wrap(e),(b[0]===n||a.contains(b[0],n))&&a(n).focus(),e=b.parent(),"static"===b.css("position")?(e.css({position:"relative"}),b.css({position:"relative"})):(a.extend(d,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,e){d[e]=b.css(e);isNaN(parseInt(d[e],10))&&(d[e]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),b.css(f),e.css(d).show()},removeWrapper:function(b){var d=document.activeElement;
return b.parent().is(".ui-effects-wrapper")&&(b.parent().replaceWith(b),(b[0]===d||a.contains(b[0],d))&&a(d).focus()),b},setTransition:function(b,d,e,f){return f=f||{},a.each(d,function(a,d){var h=b.cssUnit(d);0<h[0]&&(f[d]=h[0]*e+h[1])}),f}});a.fn.extend({effect:function(){function d(b){function e(){a.isFunction(l)&&l.call(k[0]);a.isFunction(b)&&b()}var k=a(this),l=f.complete,m=f.mode;(k.is(":hidden")?"hide"===m:"show"===m)?e():n.call(k[0],f,e)}var f=e.apply(this,arguments),l=f.mode,m=f.queue,n=
a.effects.effect[f.effect],p=!n&&b&&a.effects[f.effect];return a.fx.off||!n&&!p?l?this[l](f.duration,f.complete):this.each(function(){f.complete&&f.complete.call(this)}):n?!1===m?this.each(d):this.queue(m||"fx",d):p.call(this,{options:f,duration:f.duration,callback:f.complete,mode:f.mode})},_show:a.fn.show,show:function(a){if(f(a))return this._show.apply(this,arguments);var b=e.apply(this,arguments);return b.mode="show",this.effect.call(this,b)},_hide:a.fn.hide,hide:function(a){if(f(a))return this._hide.apply(this,
arguments);var b=e.apply(this,arguments);return b.mode="hide",this.effect.call(this,b)},__toggle:a.fn.toggle,toggle:function(b){if(f(b)||"boolean"==typeof b||a.isFunction(b))return this.__toggle.apply(this,arguments);var d=e.apply(this,arguments);return d.mode="toggle",this.effect.call(this,d)},cssUnit:function(b){var d=this.css(b),e=[];return a.each(["em","px","%","pt"],function(a,b){0<d.indexOf(b)&&(e=[parseFloat(d),b])}),e}})})();(function(){var b={};a.each(["Quad","Cubic","Quart","Quint","Expo"],
function(a,d){b[d]=function(b){return Math.pow(b,a+2)}});a.extend(b,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,d=4;a<((b=Math.pow(2,--d))-1)/11;);return 1/Math.pow(4,3-d)-7.5625*Math.pow((3*b-2)/22-a,2)}});a.each(b,function(b,d){a.easing["easeIn"+b]=d;a.easing["easeOut"+b]=function(a){return 1-
d(1-a)};a.easing["easeInOut"+b]=function(a){return 0.5>a?d(2*a)/2:1-d(-2*a+2)/2}})})()}(jQuery);
(function(a,d){var b=/up|down|vertical/,e=/up|left|vertical|horizontal/;a.effects.effect.blind=function(d,k){var h=a(this),l="position top bottom left right height width".split(" "),m=a.effects.setMode(h,d.mode||"hide"),n=d.direction||"up",p=b.test(n),r=p?"height":"width",s=p?"top":"left",n=e.test(n),v={},t="show"===m,x,w,y;h.parent().is(".ui-effects-wrapper")?a.effects.save(h.parent(),l):a.effects.save(h,l);h.show();x=a.effects.createWrapper(h).css({overflow:"hidden"});w=x[r]();y=parseFloat(x.css(s))||
0;v[r]=t?w:0;n||(h.css(p?"bottom":"right",0).css(p?"top":"left","auto").css({position:"absolute"}),v[s]=t?y:w+y);t&&(x.css(r,0),n||x.css(s,y+w));x.animate(v,{duration:d.duration,easing:d.easing,queue:!1,complete:function(){"hide"===m&&h.hide();a.effects.restore(h,l);a.effects.removeWrapper(h);k()}})}})(jQuery);
(function(a,d){a.effects.effect.bounce=function(b,d){var f=a(this),k="position top bottom left right height width".split(" "),h=a.effects.setMode(f,b.mode||"effect"),l="hide"===h,m="show"===h,n=b.direction||"up",h=b.distance,p=b.times||5,r=2*p+(m||l?1:0),s=b.duration/r,v=b.easing,t="up"===n||"down"===n?"top":"left",n="up"===n||"left"===n,x,w,y=f.queue(),z=y.length;(m||l)&&k.push("opacity");a.effects.save(f,k);f.show();a.effects.createWrapper(f);h||(h=f["top"===t?"outerHeight":"outerWidth"]()/3);m&&
(w={opacity:1},w[t]=0,f.css("opacity",0).css(t,n?2*-h:2*h).animate(w,s,v));l&&(h/=Math.pow(2,p-1));w={};for(m=w[t]=0;m<p;m++)x={},x[t]=(n?"-=":"+=")+h,f.animate(x,s,v).animate(w,s,v),h=l?2*h:h/2;l&&(x={opacity:0},x[t]=(n?"-=":"+=")+h,f.animate(x,s,v));f.queue(function(){l&&f.hide();a.effects.restore(f,k);a.effects.removeWrapper(f);d()});1<z&&y.splice.apply(y,[1,0].concat(y.splice(z,r+1)));f.dequeue()}})(jQuery);
(function(a,d){a.effects.effect.clip=function(b,d){var f=a(this),k="position top bottom left right height width".split(" "),h="show"===a.effects.setMode(f,b.mode||"hide"),l="vertical"===(b.direction||"vertical"),m=l?"height":"width",l=l?"top":"left",n={},p,r;a.effects.save(f,k);f.show();p=a.effects.createWrapper(f).css({overflow:"hidden"});p="IMG"===f[0].tagName?p:f;r=p[m]();h&&(p.css(m,0),p.css(l,r/2));n[m]=h?r:0;n[l]=h?0:r/2;p.animate(n,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){h||
f.hide();a.effects.restore(f,k);a.effects.removeWrapper(f);d()}})}})(jQuery);
(function(a,d){a.effects.effect.drop=function(b,d){var f=a(this),k="position top bottom left right opacity height width".split(" "),h=a.effects.setMode(f,b.mode||"hide"),l="show"===h,m=b.direction||"left",n="up"===m||"down"===m?"top":"left",m="up"===m||"left"===m?"pos":"neg",p={opacity:l?1:0},r;a.effects.save(f,k);f.show();a.effects.createWrapper(f);r=b.distance||f["top"===n?"outerHeight":"outerWidth"](!0)/2;l&&f.css("opacity",0).css(n,"pos"===m?-r:r);p[n]=(l?"pos"===m?"+=":"-=":"pos"===m?"-=":"+=")+
r;f.animate(p,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===h&&f.hide();a.effects.restore(f,k);a.effects.removeWrapper(f);d()}})}})(jQuery);
(function(a,d){a.effects.effect.explode=function(b,d){function f(){s.push(this);s.length===k*h&&(l.css({visibility:"visible"}),a(s).remove(),m||l.hide(),d())}var k=b.pieces?Math.round(Math.sqrt(b.pieces)):3,h=k,l=a(this),m="show"===a.effects.setMode(l,b.mode||"hide"),n=l.show().css("visibility","hidden").offset(),p=Math.ceil(l.outerWidth()/h),r=Math.ceil(l.outerHeight()/k),s=[],v,t,x,w,y,z;for(v=0;v<k;v++){w=n.top+v*r;z=v-(k-1)/2;for(t=0;t<h;t++)x=n.left+t*p,y=t-(h-1)/2,l.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",
visibility:"visible",left:-t*p,top:-v*r}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:p,height:r,left:x+(m?y*p:0),top:w+(m?z*r:0),opacity:m?0:1}).animate({left:x+(m?0:y*p),top:w+(m?0:z*r),opacity:m?1:0},b.duration||500,b.easing,f)}}})(jQuery);(function(a,d){a.effects.effect.fade=function(b,d){var f=a(this),k=a.effects.setMode(f,b.mode||"toggle");f.animate({opacity:k},{queue:!1,duration:b.duration,easing:b.easing,complete:d})}})(jQuery);
(function(a,d){a.effects.effect.fold=function(b,d){var f=a(this),k="position top bottom left right height width".split(" "),h=a.effects.setMode(f,b.mode||"hide"),l="show"===h,m="hide"===h,h=b.size||15,n=/([0-9]+)%/.exec(h),p=!!b.horizFirst,r=l!==p,s=r?["width","height"]:["height","width"],v=b.duration/2,t,x={},w={};a.effects.save(f,k);f.show();t=a.effects.createWrapper(f).css({overflow:"hidden"});r=r?[t.width(),t.height()]:[t.height(),t.width()];n&&(h=parseInt(n[1],10)/100*r[m?0:1]);l&&t.css(p?{height:0,
width:h}:{height:h,width:0});x[s[0]]=l?r[0]:h;w[s[1]]=l?r[1]:0;t.animate(x,v,b.easing).animate(w,v,b.easing,function(){m&&f.hide();a.effects.restore(f,k);a.effects.removeWrapper(f);d()})}})(jQuery);
(function(a,d){a.effects.effect.highlight=function(b,d){var f=a(this),k=["backgroundImage","backgroundColor","opacity"],h=a.effects.setMode(f,b.mode||"show"),l={backgroundColor:f.css("backgroundColor")};"hide"===h&&(l.opacity=0);a.effects.save(f,k);f.show().css({backgroundImage:"none",backgroundColor:b.color||"#ffff99"}).animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===h&&f.hide();a.effects.restore(f,k);d()}})}})(jQuery);
(function(a,d){a.effects.effect.pulsate=function(b,d){var f=a(this),k=a.effects.setMode(f,b.mode||"show"),h="show"===k,l="hide"===k,k=2*(b.times||5)+(h||"hide"===k?1:0),m=b.duration/k,n=0,p=f.queue(),r=p.length;if(h||!f.is(":visible"))f.css("opacity",0).show(),n=1;for(h=1;h<k;h++)f.animate({opacity:n},m,b.easing),n=1-n;f.animate({opacity:n},m,b.easing);f.queue(function(){l&&f.hide();d()});1<r&&p.splice.apply(p,[1,0].concat(p.splice(r,k+1)));f.dequeue()}})(jQuery);
(function(a,d){a.effects.effect.puff=function(b,d){var f=a(this),k=a.effects.setMode(f,b.mode||"hide"),h="hide"===k,l=parseInt(b.percent,10)||150,m=l/100,n={height:f.height(),width:f.width(),outerHeight:f.outerHeight(),outerWidth:f.outerWidth()};a.extend(b,{effect:"scale",queue:!1,fade:!0,mode:k,complete:d,percent:h?l:100,from:h?n:{height:n.height*m,width:n.width*m,outerHeight:n.outerHeight*m,outerWidth:n.outerWidth*m}});f.effect(b)};a.effects.effect.scale=function(b,d){var f=a(this),k=a.extend(!0,
{},b),h=a.effects.setMode(f,b.mode||"effect"),l=parseInt(b.percent,10)||(0===parseInt(b.percent,10)?0:"hide"===h?0:100),m=b.direction||"both",n=b.origin,p={height:f.height(),width:f.width(),outerHeight:f.outerHeight(),outerWidth:f.outerWidth()},r="horizontal"!==m?l/100:1,l="vertical"!==m?l/100:1;k.effect="size";k.queue=!1;k.complete=d;"effect"!==h&&(k.origin=n||["middle","center"],k.restore=!0);k.from=b.from||("show"===h?{height:0,width:0,outerHeight:0,outerWidth:0}:p);k.to={height:p.height*r,width:p.width*
l,outerHeight:p.outerHeight*r,outerWidth:p.outerWidth*l};k.fade&&("show"===h&&(k.from.opacity=0,k.to.opacity=1),"hide"===h&&(k.from.opacity=1,k.to.opacity=0));f.effect(k)};a.effects.effect.size=function(b,d){var f,k,h,l,m,n,p=a(this),r="position top bottom left right width height overflow opacity".split(" ");m="position top bottom left right overflow opacity".split(" ");var s=["width","height","overflow"],v=["fontSize"],t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],x=["borderLeftWidth",
"borderRightWidth","paddingLeft","paddingRight"],w=a.effects.setMode(p,b.mode||"effect"),y=b.restore||"effect"!==w,z=b.scale||"both",A=b.origin||["middle","center"],F=p.css("position"),u=y?r:m,C={height:0,width:0,outerHeight:0,outerWidth:0};"show"===w&&p.show();m={height:p.height(),width:p.width(),outerHeight:p.outerHeight(),outerWidth:p.outerWidth()};"toggle"===b.mode&&"show"===w?(p.from=b.to||C,p.to=b.from||m):(p.from=b.from||("show"===w?C:m),p.to=b.to||("hide"===w?C:m));h=p.from.height/m.height;
l=p.from.width/m.width;f=p.to.height/m.height;k=p.to.width/m.width;if("box"===z||"both"===z)h!==f&&(u=u.concat(t),p.from=a.effects.setTransition(p,t,h,p.from),p.to=a.effects.setTransition(p,t,f,p.to)),l!==k&&(u=u.concat(x),p.from=a.effects.setTransition(p,x,l,p.from),p.to=a.effects.setTransition(p,x,k,p.to));("content"===z||"both"===z)&&h!==f&&(u=u.concat(v).concat(s),p.from=a.effects.setTransition(p,v,h,p.from),p.to=a.effects.setTransition(p,v,f,p.to));a.effects.save(p,u);p.show();a.effects.createWrapper(p);
p.css("overflow","hidden").css(p.from);A&&(n=a.effects.getBaseline(A,m),p.from.top=(m.outerHeight-p.outerHeight())*n.y,p.from.left=(m.outerWidth-p.outerWidth())*n.x,p.to.top=(m.outerHeight-p.to.outerHeight)*n.y,p.to.left=(m.outerWidth-p.to.outerWidth)*n.x);p.css(p.from);if("content"===z||"both"===z)t=t.concat(["marginTop","marginBottom"]).concat(v),x=x.concat(["marginLeft","marginRight"]),s=r.concat(t).concat(x),p.find("*[width]").each(function(){var d=a(this),e=d.height(),m=d.width(),n=d.outerHeight(),
p=d.outerWidth();y&&a.effects.save(d,s);d.from={height:e*h,width:m*l,outerHeight:n*h,outerWidth:p*l};d.to={height:e*f,width:m*k,outerHeight:e*f,outerWidth:m*k};h!==f&&(d.from=a.effects.setTransition(d,t,h,d.from),d.to=a.effects.setTransition(d,t,f,d.to));l!==k&&(d.from=a.effects.setTransition(d,x,l,d.from),d.to=a.effects.setTransition(d,x,k,d.to));d.css(d.from);d.animate(d.to,b.duration,b.easing,function(){y&&a.effects.restore(d,s)})});p.animate(p.to,{queue:!1,duration:b.duration,easing:b.easing,
complete:function(){0===p.to.opacity&&p.css("opacity",p.from.opacity);"hide"===w&&p.hide();a.effects.restore(p,u);y||("static"===F?p.css({position:"relative",top:p.to.top,left:p.to.left}):a.each(["top","left"],function(a,b){p.css(b,function(b,d){var e=parseInt(d,10),f=a?p.to.left:p.to.top;return"auto"===d?f+"px":e+f+"px"})}));a.effects.removeWrapper(p);d()}})}})(jQuery);
(function(a,d){a.effects.effect.shake=function(b,d){var f=a(this),k="position top bottom left right height width".split(" "),h=a.effects.setMode(f,b.mode||"effect"),l=b.direction||"left",m=b.distance||20,n=b.times||3,p=2*n+1,r=Math.round(b.duration/p),s="up"===l||"down"===l?"top":"left",v="up"===l||"left"===l,l={},t={},x={},w=f.queue(),y=w.length;a.effects.save(f,k);f.show();a.effects.createWrapper(f);l[s]=(v?"-=":"+=")+m;t[s]=(v?"+=":"-=")+2*m;x[s]=(v?"-=":"+=")+2*m;f.animate(l,r,b.easing);for(m=
1;m<n;m++)f.animate(t,r,b.easing).animate(x,r,b.easing);f.animate(t,r,b.easing).animate(l,r/2,b.easing).queue(function(){"hide"===h&&f.hide();a.effects.restore(f,k);a.effects.removeWrapper(f);d()});1<y&&w.splice.apply(w,[1,0].concat(w.splice(y,p+1)));f.dequeue()}})(jQuery);
(function(a,d){a.effects.effect.slide=function(b,d){var f=a(this),k="position top bottom left right width height".split(" "),h=a.effects.setMode(f,b.mode||"show"),l="show"===h,m=b.direction||"left",n="up"===m||"down"===m?"top":"left",m="up"===m||"left"===m,p,r={};a.effects.save(f,k);f.show();p=b.distance||f["top"===n?"outerHeight":"outerWidth"](!0);a.effects.createWrapper(f).css({overflow:"hidden"});l&&f.css(n,m?isNaN(p)?"-"+p:-p:p);r[n]=(l?m?"+=":"-=":m?"-=":"+=")+p;f.animate(r,{queue:!1,duration:b.duration,
easing:b.easing,complete:function(){"hide"===h&&f.hide();a.effects.restore(f,k);a.effects.removeWrapper(f);d()}})}})(jQuery);
(function(a,d){a.effects.effect.transfer=function(b,d){var f=a(this),k=a(b.to),h="fixed"===k.css("position"),l=a("body"),m=h?l.scrollTop():0,l=h?l.scrollLeft():0,n=k.offset(),k={top:n.top-m,left:n.left-l,height:k.innerHeight(),width:k.innerWidth()},n=f.offset(),p=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(b.className).css({top:n.top-m,left:n.left-l,height:f.innerHeight(),width:f.innerWidth(),position:h?"fixed":"absolute"}).animate(k,b.duration,b.easing,function(){p.remove();
d()})}})(jQuery);function ExpressionInterpreter(){}
ExpressionInterpreter.prototype={html:function(a,d){$(a).html(this.addImgs(this.eval(this.addStored(d))));this.renderMath(a)},append:function(a,d){$(a).append(this.addImgs(this.eval(this.addStored(d))));this.renderMath(a)},interpInput:function(a){return this.eval(this.addStored(a))},interpImgs:function(a){return this.addImgs(a)},interp:function(a){return this.addImgs(this.eval(this.addStored(a)))},renderMath:function(a){MathJax.Hub.Queue(["Typeset",MathJax.Hub,a?$(a).attr("id"):void 0])},addStored:function(a){with({get:DataGetFuncs.get})return a.replace(/get[\s]*\([A-Za-z0-9,\s\-\.'"]*\)/g,
function(a,b){return eval(a)})},eval:function(a){if("number"==typeof a)return a;a=a.replace(/eval[\s]*\([0-9\(\)\+\-\*\/\s,\.'"]*\)/g,function(a,b){return eval(a)});return Number(a)===a?Number(a):a},sliceArgs:function(a){var d=[];a=a.replace(/[A-Za-z0-9\s-]*\(/,"");a=a.replace(")","");a+=",";for(var b=-1<a.indexOf(",");b;)b=a.indexOf(","),d.push(a.slice(0,b).killWhiteSpace()),a=a.slice(b+1,a.length),b=-1<a.indexOf(",");return d},finishAppend:function(){this.div=void 0;this.addedMath=!1},addImgs:function(a,
d){return a.replace(/img[\s]*\([A-Za-z0-9\+\-\*\/\s,\.'"]*\)/g,function(a,d){return eval(a)})},parseImgFunc:function(a,d){var b=this.sliceArgs(a),e=b[0],f=b[1],b=b[2],e=e.replace(/['"]/g,"");if(d)return{attrs:{src:[window.IMGPATHPREFIX+e]}};e=templater.img({attrs:{src:[window.IMGPATHPREFIX+e]}});b&&(e=templater.center({innerHTML:e}));"br"==f?e=templater.br()+e+templater.br():"p"==f&&(e=templater.p({innerHTML:e}));return e}};function SceneNavigator(){}
SceneNavigator.prototype={showPrompt:function(a,d,b){timeline.show(a,d,b)},refresh:function(){timeline.refresh()},nextPrompt:function(a,d){d=defaultTo(!0,d);timeline.curSection();var b=timeline.curPrompt(),e=timeline.now();if(a||this.checkWillAdvance()){this.sendAnswersToCW(window.curLevel.quiz);if(d)var f=this.checkDirections(b.directions);instrs=void 0!=f?this.evalDirections(f):{advance:!0,killBranches:!1};instrs.killBranches&&timeline.sections[timeline.sectionIdx].killBranches();instrs.advance&&
(b=this.getNextIdxs(),e=timeline.now(),b.sectionIdx==e.sectionIdx&&b.promptIdx==Math.floor(e.promptIdx)?timeline.surface(!0):this.showPrompt(b.sectionIdx,b.promptIdx))}},getNextIdxs:function(){var a=timeline.sectionIdx,d=timeline.curSection(),b=Math.floor(d.promptIdx);b+1==d.sectionData.prompts.length?a+1<timeline.sections.length&&(a++,b=0):b++;return{sectionIdx:a,promptIdx:b}},checkDirections:function(a){return a&&(a=a())?a:{advance:!0,killBranches:!0}},evalDirections:function(a){var d={branchPromptsPreClean:function(a,
d){a=a instanceof Array?a:[a];timeline.sections[timeline.sectionIdx].branchPromptsPreClean(a);return{advance:!0,killBranches:defaultTo(!1,d)}},branchPromptsPostClean:function(a,d){a=a instanceof Array?a:[a];timeline.sections[timeline.sectionIdx].branchPromptsPostClean(a);return{advance:!0,killBranches:defaultTo(!1,d)}},branchSections:function(a,d){a=a instanceof Array?a:[a];timeline.sections[timeline.sectionIdx].branchSections(a);return{advance:!0,killBranches:defaultTo(!1,d)}},surface:function(a,
d){timeline.surface(a);return{advance:!1,killBranches:defaultTo(!1,d)}},advance:function(){return{advance:!0,killBranches:!0}}};with(d)return eval(a)},getPrevIdxs:function(){var a=timeline.now(),d=a.sectionIdx,b=d,e=a=Math.ceil(a.promptIdx);0==a?0<d&&(b--,e=timeline.sections[b].sectionData.prompts.length-1):e--;return{sectionIdx:b,promptIdx:e}},checkWillAdvance:function(){var a=this.getNextIdxs();(a=Math.min(1,this.checkWillAdvanceConditions(a.sectionIdx,a.promptIdx)))&&(a=Math.min(a,this.checkWillAdvanceQuiz()));
return a},checkWillAdvanceConditions:function(a,d){var b=timeline.sectionIdx!=a,e=timeline.now(),e=conditionManager.canAdvance(e.promptIdx),f=!0;b&&e&&(f=conditionManager.canAdvance(-1));return Math.min(e,f)},checkWillAdvanceQuiz:function(){var a=curLevel.quiz;if(a){if(a.allAnswered()){if(a.allCorrect())return!0;a.fireAlertWrong();return!1}alert("You haven't answered all the questions.");return!1}return!0},sendAnswersToCW:function(a){a&&a.sendAnswersToCW()},prevPrompt:function(){var a=this.getPrevIdxs(),
d=timeline.now();a.sectionIdx==d.sectionIdx&&a.promptIdx==d.promptIdx?timeline.surface(!1):this.showPrompt(a.sectionIdx,a.promptIdx)}};function Templater(){}
Templater.prototype={elem:function(a){a.attrs=a.attrs||{};a.style=a.style||void 0;a.innerHTML=a.innerHTML||"";!a.attrs.class?a.attrs.class=[globalHTMLClass]:a.attrs.class.push(globalHTMLClass);a.templater=this;return this.elemTemp(a)},img:function(a){a?a.type="img":a={type:"img"};return this.elem(a)},div:function(a){a?a.type="div":a={type:"div"};return this.elem(a)},button:function(a){a?a.type="button":a={type:"button"};return this.elem(a)},textarea:function(a){a?a.type="textarea":a={type:"textarea"};
return this.elem(a)},p:function(a){a?a.type="p":a={type:"p"};return this.elem(a)},br:function(){return"<br>"},tab:function(){return"&#09;"},table:function(a){a?a.type="table":a={type:"table"};return this.elem(a)},tr:function(a){a?a.type="tr":a={type:"tr"};return this.elem(a)},td:function(a){a?a.type="td":a={type:"td"};return this.elem(a)},center:function(a){a?a.type="center":a={type:"center"};return this.elem(a)},label:function(a){a?a.type="label":a={type:"label"};return this.elem(a)},canvas:function(a){a?
a.type="canvas":a={type:"canvas"};return this.elem(a)},input:function(a){a?a.type="input":a={type:"input"};return this.elem(a)},checkbox:function(a){a=a||{};a.attrs=a.attrs||{};a.attrs.type=["checkbox"];return this.input(a)},select:function(a){a?a.type="select":a={type:"select"};return this.elem(a)},option:function(a){a?a.type="option":a={type:"option"};return this.elem(a)},ul:function(a){a?a.type="ul":a={type:"ul"};return this.elem(a)},li:function(a){a?a.type="li":a={type:"li"};return this.elem(a)},
a:function(a){a?a.type="a":a={type:"a"};return this.elem(a)},appendRadio:function(a,d,b,e){var f=templater.div({attrs:{id:[e+"TemplaterWrapper"]},style:{height:46,position:"relative",top:"15px"}});$(a).append(f);a=$("#"+e+"TemplaterWrapper");f="";b=b||0;for(var k=0;k<d.length;k++){var h,l,m;h=d[k];l=h.text;h=h.id;l=this.a({innerHTML:l,attrs:{href:["#"]}});m=[e];k==b&&m.push("on");h=this.li({innerHTML:l,attrs:{"class":m,id:[h]}});f+=h}b=this.ul({innerHTML:f,attrs:{id:[e]}});$(a).append(b);this.radioActivate(d,
e)},radioActivate:function(a,d){for(var b=0;b<a.length;b++){var e,f;e=a[b];f=$("#"+e.id);this.bindRadio(f,d,e.cb)}},bindRadio:function(a,d,b){$(a).click(function(){$("li."+d).removeClass("on");$(this).addClass("on");b&&b()})},tableFromArray:function(a,d,b){var e="";d=d||{};b=b||{};var f=d.table,k=d.tr;d=d.td;var h=b.table,l=b.tr;b=b.td;for(var m=0;m<a.length;m++){var n=a[m];rowInnerHTML="";for(var p=0;p<n.length;p++)rowInnerHTML+=templater.td({innerHTML:n[p],attrs:d?{"class":d.concat()}:void 0,style:b?
b:void 0});e+=templater.tr({innerHTML:rowInnerHTML,attrs:k?{"class":k.concat()}:void 0,style:l?l:void 0})}return templater.table({innerHTML:e,attrs:f?{"class":f.concat()}:void 0,style:h?h:void 0})},style:function(a){return this.styleTemp(a)},elemTemp:_.template("<<%= type%><% for (var attr in attrs) { %><%= ' ' + attr %>='<%= attrs[attr].join(' ') %>'<% } %><%= style ? ' ' : '' %><%= templater.style({style: style}) %>><%= innerHTML %></<%= type %>>"),styleTemp:_.template("<% if (!style) {return ''} %>style='<% for (var stylet in style) { %><%= stylet %>:<%= style[stylet] %>;<% } %>'")};function Dot(a,d,b,e,f,k,h){var l=window.spcs[e];this.x=a;this.y=d;this.v=b;this.m=l.m;this.r=l.r;this.spcName=e;this.elemId=defaultTo(-1,k);this.idNum=l.idNum;this.hF298=defaultTo(0,1E3*l.hF298/N);this.uF298=defaultTo(0,1E3*l.uF298/N);this.hVap298=defaultTo(0,1E3*l.hVap298/N);this.sF298=defaultTo(0,1E3*l.sF298/N);this.cvKinetic=1.5*R/N;this.cv=l.cv/N;this.cp=this.cv+R;this.cpLiq=defaultTo(this.cv,l.cpLiq/N);this.spcVolLiq=defaultTo(0.001,l.spcVolLiq/N);this.tag=f;this.returnTo=h;this.tConst=tConst;
this.pxToE=pxToE;this.pxToMS=pxToMS;this.parentLists=[];this.internalPotential=this.temp()*(this.cv-this.cvKinetic);this.peCur=this.tempLast=this.peLast=0;this.active=!0}function Species(a,d,b,e,f,k,h,l,m,n,p,r,s){this.spcName=a;this.m=d;this.r=b;this.col=e;this.idNum=f;this.cv=k;this.cp=k+R;this.hF298=h;this.uF298=this.hF298-298.15*R/1E3;this.hVap298=l;this.sF298=m;this.antoineCoeffs=n;this.cpLiq=p;this.spcVolLiq=r;this.dots=s.addSpcs(a)}
Species.prototype={populate:function(a,d,b,e,f,k,h,l){l=l||dotManager;var m=a.x;a=a.y;var n=d.dx;d=d.dy;for(var p=[],r=0;r<b;r++){var s=m+Math.random()*n,v=a+Math.random()*d,t=tempToV(this.m,e),x=2*Math.random()*Math.PI,w=t*Math.cos(x),t=t*Math.sin(x);p.push(D(s,v,V(w,t),this.spcName,f,k,h))}l.add(p)},depopulate:function(a){console.trace();a?dotManager.removeByInfo({name:this.def.spcName,tag:a}):dotManager.removeByInfo({name:this.def.spcName})},place:function(a){for(var d=[],b=0;b<a.length;b++){var e=
a[b];d.push(D(e.pos.x,e.pos.y,e.dir.copy().mult(tempToV(this.m,e.temp)),this.spcName,e.tag,void 0,e.returnTo))}dotManager.add(d)},placeSingle:function(a,d,b,e,f){birth=D(a.x,a.y,d.copy().mult(tempToV(this.m,b)),this.spcName,e,void 0,f);dotManager.add(birth)},enthalpy:function(a){return(1E3*this.hF298+(this.cv+R)*(a-298.15))/N},internalEnergy:function(a){return(1E3*this.uF298+this.cv*(a-298.15))/N},tBoil:function(a){a/=MMHGTOBAR;var d=this.antoineCoeffs;return d.b/(d.a-Math.log10(a))-d.c},pPure:function(a){var d=
this.antoineCoeffs;return MMHGTOBAR*Math.pow(10,d.a-d.b/(d.c+a))}};function Point(a,d){this.x=a;this.y=d}function Vector(a,d){this.dx=a;this.dy=d}function Color(a,d,b){this.r=a;this.g=d;this.b=b;this.setHex()}function D(a,d,b,e,f,k,h){return new Dot(a,d,b,e,f,k,h)}function P(a,d){return new Point(a,d)}function V(a,d){return new Vector(a,d)}function Col(a,d,b){return new Color(a,d,b)}function ValObj(a){this.x=a}
Vector.prototype={UV:function(){var a=Math.sqrt(this.dx*this.dx+this.dy*this.dy);return V(this.dx/a,this.dy/a)},mag:function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},add:function(a){this.dx+=a.dx;this.dy+=a.dy;return this},sub:function(a){this.dx-=a.dy;this.dy-=a.dx;return this},set:function(a){this.dx=a.dx;this.dy=a.dy},neg:function(){this.dx*=-1;this.dy*=-1;return this},dotProd:function(a){return this.dx*a.dx+this.dy*a.dy},perpDotProd:function(a){return this.dx*a.dy-this.dy*a.dx},magSqr:function(){return this.dx*
this.dx+this.dy*this.dy},copy:function(){return new Vector(this.dx,this.dy)},mult:function(a){this.dx*=a;this.dy*=a;return this},multVec:function(a){this.dx*=a.dx;this.dy*=a.dy;return this},setMag:function(a){this.mult(a/this.mag());return this},adjust:function(a,d){this.dx+=a;this.dy+=d;return this},rotate:function(a){var d=this.dx,b=this.dy;this.dx=d*Math.cos(a)-b*Math.sin(a);this.dy=d*Math.sin(a)+b*Math.cos(a);return this},perp:function(a){var d=this.dx,b=this.dy;a?"cw"==a?(this.dx=b,this.dy=-d):
(this.dx=-b,this.dy=d):(this.dx=b,this.dy=-d);return this},angle:function(){return Math.atan2(this.dy,this.dx)},sameAs:function(a){return this.dx==a.dx&&this.dy==a.dy},isValid:function(){return void 0!==this.dx&&!isNaN(this.dx)&&void 0!==this.dy&&!isNaN(this.dy)},zero:function(){this.y=this.x=0}};
Color.prototype={adjust:function(a,d,b){this.r=Math.round(Math.min(255,Math.max(0,this.r+a)));this.g=Math.round(Math.min(255,Math.max(0,this.g+d)));this.b=Math.round(Math.min(255,Math.max(0,this.b+b)));this.setHex();return this},set:function(a){void 0!==a.r&&(this.r=a.r);void 0!==a.g&&(this.g=a.g);void 0!==a.b&&(this.b=a.b);this.setHex();return this},setFromUnround:function(a){void 0!==a.r&&(this.r=Math.round(a.r));void 0!==a.g&&(this.g=Math.round(a.g));void 0!==a.b&&(this.b=Math.round(a.b));this.setHex();
return this},setHex:function(){var a=Number(Math.round(this.r)).toString(16),d=Number(Math.round(this.g)).toString(16),b=Number(Math.round(this.b)).toString(16);1==a.length&&(a="0"+a);1==d.length&&(d="0"+d);1==b.length&&(b="0"+b);this.hex="#"+a+d+b},copy:function(){return new Color(this.r,this.g,this.b)},add:function(a){this.r=Math.round(Math.min(255,Math.max(0,this.r+a.r)));this.g=Math.round(Math.min(255,Math.max(0,this.g+a.g)));this.b=Math.round(Math.min(255,Math.max(0,this.b+a.b)));this.setHex();
return this},addNoBounds:function(a){this.r=Math.round(this.r+a.r);this.g=Math.round(this.g+a.g);this.b=Math.round(this.b+a.b);this.setHex();return this},mult:function(a){this.r=Math.round(Math.min(255,Math.max(0,this.r*a)));this.g=Math.round(Math.min(255,Math.max(0,this.g*a)));this.b=Math.round(Math.min(255,Math.max(0,this.b*a)));this.setHex();return this},sameAs:function(a){return this.r==a.r&&this.g==a.g&&this.b==a.b}};
Point.prototype={distTo:function(a){var d=this.x-a.x;a=this.y-a.y;return Math.sqrt(d*d+a*a)},distSqrTo:function(a){var d=this.x-a.x;a=this.y-a.y;return d*d+a*a},VTo:function(a){return new Vector(a.x-this.x,a.y-this.y)},UVTo:function(a){var d=Math.sqrt((this.x-a.x)*(this.x-a.x)+(this.y-a.y)*(this.y-a.y));return new Vector((a.x-this.x)/d,(a.y-this.y)/d)},fracVTo:function(a,d){return this.VTo(a).mult(d)},fracMoveTo:function(a,d){this.movePt(this.fracVTo(a,d));return this},set:function(a){this.x=a.x;
this.y=a.y},avg:function(a){return new Point((this.x+a.x)/2,(this.y+a.y)/2)},area:function(a,d){var b=V(a.x-this.x,a.y-this.y),e=b.UV(),b=b.mag(),e=V(-e.dy,e.dx),f=V(d.x-this.x,d.y-this.y),e=Math.abs(e.dotProd(f));return 0.5*b*e},copy:function(){return new Point(this.x,this.y)},movePt:function(a){void 0!==a.dx&&(this.x+=a.dx);void 0!==a.dy&&(this.y+=a.dy);return this},moveInDir:function(a,d){this.x+=Math.cos(d)*a;this.y+=Math.sin(d)*a;return this},position:function(a){void 0!==a.x&&(this.x=a.x);void 0!==
a.y&&(this.y=a.y);return this},scale:function(a,d){var b=this.y-a.y;this.x=a.x+(this.x-a.x)*d;this.y=a.y+b*d;return this},rotate:function(a,d){var b=new Vector(a.x,a.y);this.movePt(b.copy().neg());var e=this.x,f=this.y;this.x=e*Math.cos(d)-f*Math.sin(d);this.y=e*Math.sin(d)+f*Math.cos(d);this.movePt(b);return this},mirror:function(a,d){var b=d.UV(),e=a.VTo(this),b=b.perp("cw"),e=e.dotProd(b);0>e?this.movePt(b.mult(Math.abs(2*e))):0<e&&this.movePt(b.neg().mult(2*e));return this},rect:function(a,d){var b=
Array(4);"ccw"==d?(b[0]=this.copy(),b[1]=this.copy().movePt({dy:a.dy}),b[2]=this.copy().movePt(a),b[3]=this.copy().movePt({dx:a.dx})):(b[0]=this.copy(),b[1]=this.copy().movePt({dx:a.dx}),b[2]=this.copy().movePt(a),b[3]=this.copy().movePt({dy:a.dy}));return b},roundedRect:function(a,d,b){a=this.rect(a,b);return this.roundPts(a,d)},roundPts:function(a,d){this.sameAs(a[0])||(a=[this].concat(a));var b=Array(2*a.length);a["-1"]=a[a.length-1];a.push(a[0]);for(var e=0;e<a.length-1;e++)b[2*e]=a[e].copy().fracMoveTo(a[String(e-
1)],d/2),b[2*e+1]=a[e].copy().fracMoveTo(a[String(e+1)],d/2);return b},sameAs:function(a){return this.x==a.x&&this.y==a.y},closeTo:function(a){return 1>Math.abs(this.x-a.x)&&1>Math.abs(this.y-a.y)},isValid:function(){return void 0!==this.x&&!isNaN(this.x)&&void 0!==this.y&&!isNaN(this.y)},track:function(a){if(a instanceof Point)d=a,e=a=b=!1;else{var d=a.pt,b=a.offset,e=defaultTo("",a.noTrack);a=e.indexOf("x")+1;var e=e.indexOf("y")+1}this.trackListenerId=unique(this.x+","+this.y+"tracksWithUniqueId",
curLevel.updateListeners);if(isNaN(this.x)||isNaN(this.y))console.log("Trying to track NaN!"),console.trace();if(!a&&!e)if(b)b.dx?f=function(){this.x=d.x+b.dx;this.y=d.y}:b.dy?f=function(){this.x=d.x;this.y=d.y+b.dy}:b.dy&&b.dx&&(f=function(){this.x=d.x+b.dx;this.y=d.y+b.dy});else var f=function(){this.x=d.x;this.y=d.y};else a?b?b.dy&&(f=function(){this.y=d.y+b.dy}):f=function(){this.y=d.y}:e&&(b?b.dx&&(f=function(){this.x=d.x+b.dx}):f=function(){this.x=d.x});addListener(curLevel,"update",this.trackListenerId,
f,this);f||(console.log("tried to track "+this.trackListenerId+" but input wasn't right"),console.trace());this.tracking=!0;return this},trackStop:function(){this.tracking&&(removeListener(curLevel,"update",this.trackListenerId),this.trackListenerId=void 0,this.tracking=!1);return this}};
Dot.prototype={KE:function(){return 0.5*this.m*(this.v.dx*this.v.dx+this.v.dy*this.v.dy)},temp:function(){return 0.5*this.m*(this.v.dx*this.v.dx+this.v.dy*this.v.dy)*this.tConst},tempCondense:function(){return(this.cv*(this.temp()-298.15)+this.hVap298)/this.cpLiq+298.15},tempVaporize:function(a){return(this.cpLiq*(this.temp()-298.15)-this.hVap298)/this.cv+298.15},hVap:function(){return this.hVap298+(this.temp()-298.15)*(this.cv-this.cpLiq)},setTemp:function(a){var d=this.temp();this.v.mult(Math.sqrt(a/
d));this.internalPotential*=a/d;return this},setTempNoReference:function(a){var d=this.v.UV(),b=Math.sqrt(2*a/(this.m*this.tConst));this.v.dx=d.dx*b;this.v.dy=d.dy*b;this.internalPotential=a*(this.cv-this.cvKinetic)},addEnergy:function(a){var d=this.temp();tF=Math.max(1,d+a/this.cv);this.v.mult(Math.sqrt(tF/d));this.internalPotential*=tF/d;return(tF-d)*this.cv},adjTemp:function(a){var d=this.temp();this.internalPotential+=a*(this.cv-this.cvKinetic)/this.N;this.v.mult(Math.sqrt((d+a)/d));return this},
enthalpy:function(){return this.hF298+(this.temp()-298.15)*(this.cv+R/N)},internalEnergy:function(){return this.uF298+(this.temp()-298.15)*this.cv},kineticEnergy:function(){return this.temp()*this.cvKinetic},speed:function(){return this.v.mag()*this.pxToMS},kill:function(){for(var a=0;a<this.parentLists.length;a++)this.parentLists[a].splice(this.parentLists[a].indexOf(this),1);this.parentLists.splice(0,this.parentLists.length);this.active=!1}};toInherit={gridder:{makeGrid:function(){for(var a=this.numCols,d=this.numRows,b=Array(a),e=0;e<a;e++){for(var f=Array(d),k=0;k<d;k++)f[k]=[];b[e]=f}return b}},ArrayExtenders:{pushNumber:function(a){!isNaN(a)&&void 0!==a&&this.push(a);return this},append:function(a){for(var d=0;d<a.length;d++)this.push(a[d]);return this},average:function(){for(var a=0,d=0;d<this.length;d++)a+=this[d];return a/this.length},switchElements:function(a,d){var b=this[a];this[a]=this[d];this[d]=b;return this}},MathExtenders:{log10:function(a){return Math.log(a)/
2.302585092994046}},StringExtenders:{killWhiteSpace:function(){return this.replace(/\s+/g,"")},killNumbers:function(){return this.replace(/[0-9]/g,"")},toCamelCase:function(){return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(a,d){return 0==d?a.toLowerCase():a.toUpperCase()}).replace(/\s+/g,"")},toCapitalCamelCase:function(){return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(a,d){return a.toUpperCase()}).replace(/\s+/g,"")},sanitize:function(){return this.replace(/'/g,"&#39;").replace(/"/g,"&#34;").replace(/</g,
"&#60;").replace(/>/g,"&#62;").replace(/{/g,"&#123;").replace(/}/g,"&#125;")}},ArrowFuncs:{getPts:function(){var a=Array(3),d=this.dims.dx,b=this.dims.dy;a[0]=P(0,0.2*b);a[1]=P(0.7*d,0.2*b);a[2]=P(0.7*d,0.5*b);b=deepCopy(a).reverse();a.push(P(d,0));for(d=0;d<b.length;d++)a.push(P(b[d].x,-b[d].y));return a}}};function gauss(a,d){var b=Math.random()+Math.random()+Math.random()-1.5;return a+b*d}function bound(a,d,b){return Math.min(Math.max(a,d),b)}function stepTowards(a,d,b){b=Math.abs(b);return a<d?Math.min(d,a+b):Math.max(d,a-b)}function changeTemp(a,d){for(var b=dotManager.get(a),e=0;e<b.length;e++)b[e].setTemp(d)}function changeRMS(a,d){for(var b=dotManager.get(a),e=rms(dataHandler.velocities(a)),e=d/e,f=0;f<b.length;f++)b[f].v.mult(e)}function tempToV(a,d){d=2*d/tConst;return Math.sqrt(d/a)}
function VToTemp(a,d){return 0.5*a*d*d*tConst}function tempToKE(a){return a/tConst}function returnEscapist(a){returnTo=defaultTo(0,a.returnTo);var d=walls[returnTo][0],b=walls[returnTo][1],e=walls[returnTo].wallUVs[0],f=(d.x+b.x)/2-5*e.dy,d=(d.y+b.y)/2+5*e.dx;a.v.dy=Math.abs(a.v.dy);a.x=f;a.y=d}function defaultTo(a,d){return void 0===d?a:d}function validNumber(a){return isNaN(a)||void 0===a?!1:a}function round(a,d){var b=Math.pow(10,d);return Math.round(a*b)/b}
function unique(a,d){if("function"==typeof d){if(d(a)){for(var b=1;d(a+b);)b++;return a+b}}else if(d[a]){for(b=1;d[a+b];)b++;return a+b}return a}function addListener(a,d,b,e,f){a[d+"Listeners"][b]={func:e,obj:f}}function addListenerOnce(a,d,b,e,f){a[d+"Listeners"][b]={func:e,obj:f};a[d+"Listeners"][b+"Remove"]={func:function(){removeListener(a,d,b);removeListener(a,d,b+"Remove")},obj:""}}function addInterval(a,d,b,e){extraIntervals[a]=window.setInterval(function(){d.apply(b)},e)}
function removeInterval(a){extraIntervals[a]&&(window.clearInterval(extraIntervals[a]),extraIntervals[a]=void 0)}function removeListener(a,d,b){delete a[d+"Listeners"][b]}function removeListenerByName(a,d,b){for(var e=!1,f=getListenerByName(a,d,b);void 0!==f;)e=!0,delete a[d+"Listeners"][f],f=getListenerByName(a,d,b);return e}function makeListenerHolder(a,d){a[d+"Listeners"]={};return a[d+"Listeners"]}function listenerExists(a,d,b){return void 0!==a[d+"Listeners"][b]}
function emptyListener(a,d){a[d+"Listeners"]={}}function getListenerByName(a,d,b){for(thisFuncName in a[d+"Listeners"])if(-1!=thisFuncName.indexOf(b))return thisFuncName}function store(a,d){stored[a]=d}function getStore(a){return stored[a]}function eraseStore(a){a?stored[a]=void 0:stored={}}
function getAndEval(a){if("number"==typeof a)return a;if("string"==typeof a)return interpreter.interpInput(a);if("boolean"==typeof a)return a;if(a instanceof Point){var d=this.getAndEval(a.x);a=this.getAndEval(a.y);return P(d,a)}if(a instanceof Vector)return d=this.getAndEval(a.dx),a=this.getAndEval(a.dy),V(d,a);if(a instanceof Color){var d=this.getAndEval(a.r),b=this.getAndEval(a.g);a=this.getAndEval(a.b);return Col(d,b,a)}if(a instanceof Array){d=[];for(b=0;b<a.length;b++)d.push(this.getAndEval(a[b]));
return d}if("function"==typeof a)return a;if(a instanceof Object){d={};for(b in a)d[b]=this.getAndEval(a[b]);return d}}function deepCopy(a){var d=new a.constructor,b;for(b in a)d[b]="object"==typeof a[b]?deepCopy(a[b]):a[b];return d}function deepCopySafe(a){return deepCopyStep(a,[a],[])}
function deepCopyStep(a,d,b){var e;try{e=new a.constructor}catch(f){e={}}b.push(e);for(var k in a){var h=a[k];if("object"==typeof h){var l=d.indexOf(h);e[k]=-1==l?deepCopyStep(h,d.concat([h]),b.concat()):b[l]}else e[k]=h}return e}function recordData(a,d,b,e,f){f=defaultTo("record",f);store("record"+a,f);addListener(curLevel,f,a,function(){d.push(b.apply(e))},e)}function recordDataStop(a){var d=getStore("record"+a);removeListener(curLevel,d,a)}
function grabAttrs(a,d){var b={},e;for(e in a){b[e]={};for(var f=0;f<d.length;f++)b[e][d[f]]=a[e][d[f]]}return b}function execListeners(a){for(var d in a){var b=a[d];b.func.apply(b.obj)}}
function makeSlider(a,d,b,e,f,k,h){b=/\#[a-zA-Z0-9]+/.exec(b)[0].replace("#","");var l="";e=""+templater.center({innerHTML:e});l+=templater.div({attrs:{id:[b+"parent"]},style:{padding:"5px"},innerHTML:templater.div({attrs:{id:[b]}})});a.append(e);d.append(l);l=$(".active #"+b+"parent");e=$(".active #"+b);(!l.length||!e.length)&&l;addJQueryElems($(e),"slider");e.slider("option",f);for(f=0;f<k.length;f++){var m=k[f],l=m.eventType,n=m.obj,m=m.func;void 0===n?sliderBind(e,l,m,""):sliderBind(e,l,m,n)}if(h)div[h]();
sliderList.push(b);return[a,d]}function sliderBind(a,d,b,e){a.bind(d,function(a,d){b.apply(e,[a,d])});return a}function addJQueryElems(a,d){a=a instanceof Array?a:[a];for(var b=0;b<a.length;b++){var e=a[b];$(e)[d]();recursiveAddClass(e,globalHTMLClass)}}function recursiveAddClass(a,d){$(a).addClass(d);for(var b=$(a).children(),e=0;e<b.length;e++){var f=$(b[e]);recursiveAddClass(f,d)}}function stringTogetherGET(a){var d=[],b;for(b in a)d.push(b+"="+a[b]);return d.join("&")}
function hideSliders(){for(;0<sliderList.length;idIdx++)$("#"+sliderList[0]).hide()}function S(a,d,b){sceneNavigator.showPrompt(a,d,b)}function alertValid(a){void 0!==a&&""!=a&&alert(a)}function fillEmptyGraphDivs(){for(var a=0;a<graphHolderDivs.length;a++)fillEmptyGraphDiv($("#"+graphHolderDivs[a]))}function fillEmptyGraphDiv(a){"empty"==$(a).attr("filledWith")&&new GraphBlank(a)}function rotatePts(a,d,b){for(var e=0;e<a.length;e++)a[e].rotate(d,b)}
function mirrorPts(a,d,b){for(var e=0;e<a.length;e++)a[e].mirror(d,b);return a}function angleToUV(a){return V(Math.cos(a),Math.sin(a))}function UVToAngle(a){return Math.atan2(a.dy,a.dx)}function getSign(a){return 0>a?-1:1}function fracDiff(a,d){return Math.abs(a-d)/Math.min(Math.abs(a),Math.abs(d))}function getLen(a){for(var d=0,b=0;b<a.length-1;b++)d+=a[b].distTo(a[b+1]);return d}function exprHasReturn(a){return/(\(|\:|\?|\s)return/.test(" "+a)}
function byAttr(a,d,b){if(a instanceof Array)for(var e=0;e<a.length;e++){if(a[e][b]==d)return a[e]}else for(e in a)if(a[e][b]==d)return a[e]}function inRect(a,d,b){b=mouseOffset(b);return b.x>=a.x&&b.x<=a.x+d.dx&&b.y>=a.y&&b.y<=a.y+d.dy}function ptInRect(a,d,b){return b.x>=a.x&&b.x<=a.x+d.dx&&b.y>=a.y&&b.y<=a.y+d.dy}function extend(a,d){return function(){return d(a())}}function getNth(a,d){var b=0,e;for(e in a)if(b++==d)return a[e]}function countAttrs(a){var d=0,b;for(b in a)d++;return d}
function objectsEqual(a,d){return Math.min(objectsEqualInDirection(a,d),objectsEqualInDirection(d,a))}function objectsEqualInDirection(a,d){for(var b in a)if(d&&d.hasOwnProperty(b))if("object"==typeof a[b]){if(!objectsEqual(a[b],d[b]))return!1}else{if(a[b]!=d[b])return!1}else return!1;return!0}function rms(a){for(var d=0,b=0;b<a.length;b++)d+=a[b]*a[b];d/=a.length;return Math.sqrt(d)}globalMousePos=P(0,0);
function mouseOffset(a){a=$(a).offset();return P(globalMousePos.x-a.left,globalMousePos.y-a.top)}function mouseOffsetDiv(a){a=$("#"+a).offset();return P(globalMousePos.x-a.left,globalMousePos.y-a.top)}$(document).mousemove(function(a){globalMousePos.x=a.pageX;globalMousePos.y=a.pageY;for(var d in curLevel.mousemoveListeners)a=curLevel.mousemoveListeners[d],a.func.apply(a.obj)});$(document).mousedown(function(a){for(var d in curLevel.mousedownListeners)a=curLevel.mousedownListeners[d],a.func.apply(a.obj)});
$(document).mouseup(function(a){for(var d in curLevel.mouseupListeners)a=curLevel.mouseupListeners[d],a.func.apply(a.obj)});function DrawingTools(){}
DrawingTools.prototype={clear:function(a){var d=myCanvas.width,b=myCanvas.height;c.clearRect(0,0,d,b);c.fillStyle=a.hex;c.fillRect(0,0,d,b)},dots:function(){for(var a in spcs){var d=spcs[a].dots;c.fillStyle=spcs[a].col.hex;if(d[0])var b=d[0].r;for(var e=0;e<d.length;e++)c.beginPath(),c.arc(d[e].x,d[e].y,b,0,2*Math.PI,!0),c.closePath(),c.fill()}},dotsAsst:function(a){for(var d=0;d<a.length;d++)c.fillStyle=spcs[a[d].spcName].col.hex,c.beginPath(),c.arc(a[d].x,a[d].y,a[d].r,0,2*Math.PI,!0),c.closePath(),
c.fill()},walls:function(a,d){for(var b=0;b<a.length;b++){var e=a[b];if(e.show){c.beginPath();c.strokeStyle=e.col.hex;c.moveTo(e[0].x,e[0].y);for(var f=1;f<e.length-1;f++)c.lineTo(e[f].x,e[f].y);c.closePath();c.stroke()}}},circle:function(a,d,b,e,f){f.beginPath();f.arc(a.x,a.y,d,0,2*Math.PI,!0);f.closePath();e?(f.fillStyle=b.hex,f.fill()):(f.strokeStyle=b.hex,f.stroke())},fillPts:function(a,d,b){b.fillStyle=d.hex;b.beginPath();b.moveTo(a[0].x,a[0].y);for(d=1;d<a.length;d++)b.lineTo(a[d].x,a[d].y);
b.closePath();b.fill()},fillPtsAlpha:function(a,d,b,e){var f=e.globalAlpha;e.globalAlpha=b;draw.fillPts(a,d,e);e.globalAlpha=f},fillPtsStroke:function(a,d,b,e){e.fillStyle=d.hex;e.strokeStyle=b.hex;e.beginPath();e.moveTo(a[0].x,a[0].y);for(d=1;d<a.length;d++)e.lineTo(a[d].x,a[d].y);e.closePath();e.stroke();e.fill()},roundedRect:function(a,d,b,e,f){var k=a.x;a=a.y;var h=d.dx;d=d.dy;f.fillStyle=e.hex;f.beginPath();f.moveTo(k+b,a);this.curvedLine(P(k+h-b,a),P(k+h,a),P(k+h,a+b),f);this.curvedLine(P(k+
h,a+d-b),P(k+h,a+d),P(k+h-b,a+d),f);this.curvedLine(P(k+b,a+d),P(k,a+d),P(k,a+d-b),f);this.curvedLine(P(k,a+b),P(k,a),P(k+b,a),f);f.closePath();f.fill()},fillRect:function(a,d,b,e){e.fillStyle=b.hex;e.fillRect(a.x,a.y,d.dx,d.dy)},fillStrokeRect:function(a,d,b,e,f){f.strokeStyle=e.hex;f.fillStyle=b.hex;f.fillRect(a.x,a.y,d.dx,d.dy);f.strokeRect(a.x,a.y,d.dx,d.dy)},strokeRect:function(a,d,b,e){e.strokeStyle=b.hex;e.strokeRect(a.x,a.y,d.dx,d.dy)},line:function(a,d,b,e){e.strokeStyle=b.hex;e.beginPath();
e.moveTo(a.x,a.y);e.lineTo(d.x,d.y);e.closePath();e.stroke()},curvedLine:function(a,d,b,e){e.lineTo(a.x,a.y);e.quadraticCurveTo(d.x,d.y,b.x,b.y)},path:function(a,d,b){b.strokeStyle=d.hex;b.beginPath();b.moveTo(a[0].x,a[0].y);for(d=1;d<a.length;d++)b.lineTo(a[d].x,a[d].y);b.stroke()},text:function(a,d,b,e,f,k,h){h.save();h.translate(d.x,d.y);h.rotate(k);h.fillStyle=e.hex;h.font=b;h.textAlign=f;d=parseFloat(b);b=0;for(e=a.indexOf("\n");-1!=e;)f=a.slice(0,e),h.fillText(f,0,b),b+=d+2,a=a.slice(e+1,a.length),
e=a.indexOf("\n");h.fillText(a,0,b);h.restore()}};function DotManager(){this.lists={ALLDOTS:[]};this.spcLists={};this.count=0}
DotManager.prototype={add:function(a){a instanceof Array?this.count+=a.length:this.count++;this.execAllCombos(this.addFunc,a)},remove:function(a){if(a instanceof Array){this.count-=a.length;for(var d=0;d<a.length;d++)a[d].kill()}else this.count--,a.kill()},removeByAttr:function(a,d){for(var b=this.lists.ALLDOTS,e=b.length-1;0<=e;e--)b[e][a]==d&&b[e].kill()},changeDotSpc:function(a,d){a instanceof Array||(a=[a]);for(var b=spcs[d],e=0;e<a.length;e++){var f=a[e],k=(f.hF298-1E3*b.hF298/N+f.cv*(f.temp()-
298.15))/(b.cv/N)+298.15;if(0<k){for(var h=0;h<f.parentLists.length;h++)f.parentLists[h].splice(f.parentLists[h].indexOf(f),1);f.parentLists=[];f.m=b.m;f.r=b.r;f.col=b.col;f.spcName=b.spcName;f.hF298=1E3*b.hF298/N;f.hVap298=1E3*b.hVap298/N;f.idNum=b.idNum;f.cvKinetic=1.5*R/N;f.cv=b.cv/N;f.cp=f.cv+R;f.cpLiq=b.cpLiq/N;f.spcVolLiq=b.spcVolLiq/N;f.setTempNoReference(k);k=this.getRelevantLists(f);for(h=0;h<k.length;h++)f.parentLists.push(k[h]),k[h].push(f)}}},changeDotWall:function(a,d){var b,e;a instanceof
Array||(a=[a]);for(var f=0;f<a.length;f++){var k=a[f];k.tag=d;k.returnTo=d;b=0;for(e=k.parentLists.length;b<e;b++)k.parentLists[b].splice(k.parentLists[b].indexOf(k),1);k.parentLists=[];var h=this.getRelevantLists(k);b=0;for(e=h.length;b<e;b++)k.parentLists.push(h[b]),h[b].push(k)}},addSpcs:function(a){this.lists[a]||(this.lists[a]=[],this.spcLists[a]=this.lists[a]);return this.lists[a]},removeByInfo:function(a){a.spcName&&a.tag?this.execAllCombos(this.removeByNameAndTagFunc,a):a.spcName?this.execAllCombos(this.removeByNameFunc,
a):a.tag?this.execAllCombos(this.removeByTagFunc,a):(console.log("No useful info given to removeByInfo func in DotManager"),console.trace())},getWithLog:function(a){var d=this.get(a);if(d)return d;console.log("Bad species data");console.log(a)},get:function(a){return this.createIfNotExists(a)},clearAll:function(){for(var a in this.lists)this.lists[a].splice(0,this.lists[a].length)},createIfNotExists:function(a){if(a){if(a.spcName&&a.tag)return this.getByNameAndTag(a);if(a.spcName)return this.getByName(a.spcName);
if(a.tag)return this.getByTag(a.tag)}else return this.lists.ALLDOTS},addFunc:function(a,d){a.push(d);d.parentLists.push(a)},removeFunc:function(a,d){var b=a.indexOf(d);-1<b?(a.splice(b,1),d.parentLists.splice(d.parentLists.indexOf(a),1)):(console.log("Tried to remove dot from global list of spcName "+d.spcName+" and tag "+d.tag+". Dot not present."),console.trace())},removeByNameAndTagFunc:function(a,d){for(var b=a.length-1;-1<b;b--)a[b].spcName==d.spcName&&a[b].tag==d.tag&&a[b].kill()},removeByNameFunc:function(a,
d){for(var b=a.length-1;-1<b;b--)a[b].spcName==d.spcName&&(a.splice(b,1),a[b].kill())},removeByNameAndTagFunc:function(a,d){for(var b=a.length-1;-1<b;b--)a[b].tag==d.tag&&(a.splice(b,1),a[b].kill())},execAllCombos:function(a,d){if(d instanceof Array&&d.length)var b=d,e={spcName:b[0].spcName,tag:b[0].tag};else e=d;e=this.getRelevantLists(e);if(b)for(var f=0;f<b.length;f++)this.execFuncOnLists(a,e,b[f]);else d instanceof Dot&&this.execFuncOnLists(a,e,d)},execFuncOnLists:function(a,d,b){b.active=!0;
for(var e=0;e<d.length;e++)a(d[e],b)},getRelevantLists:function(a){var d=[];d.push(this.lists.ALLDOTS);a.spcName&&a.tag&&d.push(this.getByNameAndTag(a));a.spcName&&d.push(this.getByName(a.spcName));a.tag&&d.push(this.getByTag(a.tag));return d},getByNameAndTag:function(a){if(this.lists[a.spcName+"-"+a.tag])return this.lists[a.spcName+"-"+a.tag];if(spcs[a.spcName])return this.lists[a.spcName+"-"+a.tag]=[],this.lists[a.spcName+"-"+a.tag];console.log("Tried to get bad spcName "+spcName);console.trace()},
getByName:function(a){if(this.lists[a])return this.lists[a];if(spcs[a])return this.lists[a]=[],this.lists[a];console.log("Tried to get bad spcName "+a);console.trace()},getByTag:function(a){this.lists[a]||(this.lists[a]=[]);return this.lists[a]}};AuxFunctions={getDims:function(){var a=$("#main").height(),a=a-$("#auxSpacer").height();return V(400,a/2)},pickParentDiv:function(a,d){if(void 0===d){for(var b=0;b<auxHolderDivs.length;b++){var e=$("#"+auxHolderDivs[b]),f=$(e).attr("filledWith");if(""==f)return $(e).attr("filledWith",a),e}console.log("Aux divs are all full!");console.trace()}else{e=$("#"+auxHolderDivs[d]);if(!e.length)return console.log("Bad div idx "+d+".  Defaulting to next empty slot"),this.pickParentDiv(a);f=$(e).attr("filledWith");
if(""==f||void 0==f)return $(e).attr("filledWith",a),e;console.log("Trying to add "+a+" in "+d+" but "+d+" is already filled with "+f+".");console.log("Defaulting to next empty slot");return this.pickParentDiv(a)}},parentDivEmpty:function(){var a=this.parentDiv.attr("filledWith");return void 0==a||""==a},cleanUpParent:function(){$(this.parentDiv).removeAttr("style");$(this.parentDiv).html("");$(this.parentDiv).attr("filledWith","")}};function PhaseEquilGenerator(){this.oneComp=new PhaseEquilGenerator.OneComp;this.twoComp=new PhaseEquilGenerator.TwoComp}PhaseEquilGenerator.TwoComp=function(){};
PhaseEquilGenerator.TwoComp.prototype={constP:function(a,d,b,e,f){var k=a.tBoil(e),h=d.tBoil(e),l=k<h?a:d;a=k>h?a:d;b=this.makeConstPEquil(e,l,a,k<h?k:h,k>h?k:h,b[l.spcName],b[a.spcName],f);return new PhaseEquilGenerator.TwoComp.EquilData(b,l.spcName,a.spcName,e)},makeConstPEquil:function(a,d,b,e,f,k,h,l){for(var m=[],n=1/(l-1),p=0,r=0;p<l;p++){var s=this.solveTAtStep(e+(f-e)*r,a,r,d,b,e,f,k,h);if(!1!==s){var v=this.solvePTotal(s,r,d,b,k,h),t=this.pSpc(d,s,k,1-r);m.push(new PhaseEquilGenerator.TwoComp.EquilPt(1-
r,r,t/v,1-t/v,s,a))}r+=n}return m},solveTAtStep:function(a,d,b,e,f,k,h,l,m){for(var n=this.solvePTotal(a,b,e,f,l,m),p=0;0.01<fracDiff(n,d);){p++;var r=this.getDPDT(a,b,e,f,k,h,l,m);a+=(d-n)/r;n=this.solvePTotal(a,b,e,f,l,m);if(40==p)return!1}return a},getDPDT:function(a,d,b,e,f,k,h,l){f=0.995*a;a*=1.005;k=this.solvePTotal(f,d,b,e,h,l);return(this.solvePTotal(a,d,b,e,h,l)-k)/(a-f)},solvePTotal:function(a,d,b,e,f,k){b=this.pSpc(b,a,f,1-d);a=this.pSpc(e,a,k,d);return b+a},pSpc:function(a,d,b,e){return a.pPure(d)*
b(e,d)*e}};PhaseEquilGenerator.TwoComp.EquilPt=function(a,d,b,e,f,k){this.xLight=a;this.xHeavy=d;this.yLight=b;this.yHeavy=e;this.temp=f;this.pressure=k};PhaseEquilGenerator.TwoComp.EquilData=function(a,d,b,e){this.data=a;this.keyLight=d;this.keyHeavy=b;this.pressure=e};PhaseEquilGenerator.OneComp=function(){};
PhaseEquilGenerator.OneComp.prototype={equilData:function(a,d,b,e,f){f=window.spcs[a];a=this.genLiqGasData(f,d,b);b=this.genSolidLiqEqData(f,d,b);d=this.genSolidGasEqData(f,e,d);return[a,b,d]},genLiqGasData:function(a,d,b){for(var e=[],f=d;f<=b;f+=(b-d)/20){var k=a.pPure(f);e.push(new PhaseEquilGenerator.OneComp.EquilPt(a.spcName,f,k))}return e},genSolidLiqEqData:function(a,d,b){var e=a.pPure(d);b=a.pPure(b);e=new PhaseEquilGenerator.OneComp.EquilPt(a.spcName,d,e);a=new PhaseEquilGenerator.OneComp.EquilPt(a.spcName,
d,b);return[e,a]},genSolidGasEqData:function(a,d,b){for(var e=[],f=a.pPure(b),k=0.5*a.pPure(d),h=Math.log(f/k)/(b-d),l=k/Math.exp(h*d),m=0;20>m;m++){var n=d+m/19*(b-d),p=l*Math.exp(n*h),p=k+(p-k)*Math.log((Math.E-1)*(p-k)/(f-k)+1);e.push(new PhaseEquilGenerator.OneComp.EquilPt(a.spcName,n,p))}return e}};PhaseEquilGenerator.OneComp.EquilPt=function(a,d,b){this.spcName=a;this.temp=d;this.pressure=b};GraphBase={setStds:function(){window.storedGraphs[this.handle]=this;window.curLevel.graphs[this.handle]=this;this.hashMarkLen=10;this.checkMarkOversize=3;this.bgCol=curLevel.bgCol;this.gridCol=Col(72,72,72);this.toggleCol=Col(255,255,255);this.data={};this.legend={};this.markers={};this.textCol=Col(255,255,255);this.flashMult=1.5;this.flashRate=0.1;this.graphBoundCol=Col(255,255,255);this.integralCol=Col(150,150,150);this.integralAlpha=0.5;this.ptStroke=Col(0,0,0);this.rectSideLen=8;this.characLen=
Math.sqrt(Math.pow(this.rectSideLen,2)/2);this.buttonId=this.handle+"Reset";this.graphId=this.handle+"Graph";this.parentDiv=this.pickParentDiv("graph");this.parentDivId=$(this.parentDiv).attr("id");this.makeReset=defaultTo(!0,this.makeReset);var a=this.makeCanvas(this.dims,this.parentDiv,this.handle+"Graph",this.makeReset,this.handle+"Button");this.graphDisplayHTMLElement=a.HTMLElem;this.graphDisplay=a.canvas;this.layers=new GraphBase.Layers;this.wrapperId;this.initDrawLayers();this.hasData=!1},makeDataFunc:function(a){with(DataGetFuncs)return exprHasReturn(a)?
eval("(function(){"+a+"})"):eval("(function(){return "+a+"})")},initDrawLayers:function(){addListener(curLevel,"update","drawLayers"+this.handle,this.drawLayers,this)},setNumGridLinesAndSpacing:function(a){var d,b,e;a=a?a:{};a.x?(d=a.x,b=this.getGridSpacing(d,this.graphRangeFrac.x,this.dims.dx)):(b=40,d=Math.ceil(this.dims.dx*Math.abs(this.graphRangeFrac.x.max-this.graphRangeFrac.x.min)/b));a.y?(a=a.y,e=this.getGridSpacing(a,this.graphRangeFrac.y,this.dims.dy)):(e=40,a=Math.ceil(this.dims.dy*Math.abs(this.graphRangeFrac.y.max-
this.graphRangeFrac.y.min)/e));this.numGridLines=P(d,a);this.gridSpacing=P(b,e)},makeCanvas:function(a,d,b,e,f){var k=this;d.html("");a=templater.canvas({attrs:{id:[b],"class":["noSelect"],width:[a.dx],height:[a.dy]}});e&&(a+=templater.button({attrs:{id:[f]},style:{position:"absolute",right:".5em",bottom:".5em"},innerHTML:templater.img({attrs:{src:[window.IMGPATHPREFIX+"img/refresh.gif"]}})}));a=$(a);$(d).append(a);e&&(addJQueryElems($("#"+f),"button"),$("#"+f).click(function(){k.reset()}));d=document.getElementById(b);
b=d.getContext("2d");return{HTMLElem:d,canvas:b}},restoreHTML:function(){this.parentDivEmpty()||(this.parentDiv=this.pickParentDiv("graph"),this.parentDivId=$(this.parentDiv).attr("id"));var a=this.makeCanvas(this.dims,this.parentDiv,this.handle+"Graph",this.makeReset,this.handle+"Button");this.graphDisplayHTMLElement=a.HTMLElem;this.graphDisplay=a.canvas;this.layers.setDrawCanvas(this.graphDisplay);if(this.legend)for(var d in this.legend)this.legend[d].setCanvas(this.graphDisplay),this.legend[d].toggleActivate()},
clearHTML:function(){this.cleanUpParent()},remove:function(){this.disable();removeListener(curLevel,"update","drawLayers"+this.handle);removeListenerByName(curLevel,"update","flashAdvance"+this.handle);this.layers.removeAll();this.cleanUpParent();return this},enable:function(a){for(var d in this.data)this.data[d].recordStart();this.active=!0;if(a){for(d in this.data)this.data[d].addVal();this.addLast()}return this},disable:function(){for(var a in this.data)this.data[a].recordStop();this.active=!1;
return this},integrate:function(a){this.data[a].integralPts=this.getIntegralPts(a);this.drawIntegral(a);return this},getIntegralPts:function(a){var d=this.data[a].src.x,b=this.data[a].src.y;a=Array(d.length);for(var e=0;e<d.length;e++)a[e]=this.valToCoord(P(d[e],b[e]));d=this.yStart*this.dims.dy;b=a[0].x;a.push(P(a[a.length-1].x,d));a.push(P(b,d));return a},setData:function(a,d){var b=this.data[a];b?b.setData(d):console.log("Bad set handle "+a)},drawAllBG:function(){this.drawBGRect();this.drawGrid();
this.drawBounds();this.legend&&this.drawLegend();this.drawLabels()},drawBGRect:function(){draw.roundedRect(P(0,0),V(this.dims.dx,this.dims.dy),20,this.bgCol,this.graphDisplay)},drawGrid:function(){for(var a=this.axisRange.x.min/10,d=0;d<this.numGridLines.x;d++){var a=this.logScale.x?10*a:this.axisRange.x.min+this.stepSize.x*d,b=this.valToCoord(P(a,1)),e=b.x,f=this.graphRangeFrac.y.max*this.dims.dy,b=P(e,this.graphRangeFrac.y.min*this.dims.dy+this.hashMarkLen),e=P(e,f);draw.line(b,e,this.gridCol,this.graphDisplay)}a=
this.axisRange.y.min/10;for(d=0;d<this.numGridLines.y;d++)a=this.logScale.y?10*a:this.axisRange.y.min+this.stepSize.y*d,b=this.valToCoord(P(1,a)),e=b.y,f=this.graphRangeFrac.x.min*this.dims.dx,b=P(this.graphRangeFrac.x.max*this.dims.dx-this.hashMarkLen,e),e=P(f,e),draw.line(b,e,this.gridCol,this.graphDisplay)},drawBounds:function(){var a=P(this.graphRangeFrac.x.min*this.dims.dx,this.graphRangeFrac.y.max*this.dims.dy),d=V(this.dims.dx*(this.graphRangeFrac.x.max-this.graphRangeFrac.x.min),this.dims.dy*
(this.graphRangeFrac.y.min-this.graphRangeFrac.y.max));draw.strokeRect(a,d,this.graphBoundCol,this.graphDisplay)},drawLabels:function(){var a=P(this.dims.dx*(this.graphRangeFrac.x.min+this.graphRangeFrac.x.max)/2,Math.min(this.dims.dy*this.graphRangeFrac.y.min+50,this.dims.dy-20)),d=P(Math.max(this.dims.dx*this.graphRangeFrac.x.min-50,20),this.dims.dy*(this.graphRangeFrac.y.min+this.graphRangeFrac.y.max)/2);a.y+=this.labelFontSize/2;d.y+=this.labelFontSize/2;draw.text(this.xLabel,a,this.labelFont,
this.textCol,"center",0,this.graphDisplay);draw.text(this.yLabel,d,this.labelFont,this.textCol,"center",-Math.PI/2,this.graphDisplay)},drawLegend:function(){for(var a in this.legend)this.legend[a].draw()},drawMarkers:function(){for(var a in this.markers)this.markers[a].draw()},clearData:function(a,d){var b=this.data[a];b&&b.clearData();d&&this.drawAllData()},enqueueData:function(a,d){var b=this.data[a];b&&b.enqueueData(d)},updateRange:function(){var a=this.valRange.copy(),d;for(d in this.data)this.data[d].updateRange(this.valRange);
this.setAxisBounds(a)},flushQueues:function(a,d){d=defaultTo(!1,d);a=defaultTo(!0,a);var b=this.valRange.copy(),e;for(e in this.data){var f=this.data[e];f.visible&&f.updateRange(this.valRange)}f=this.axisRange.copy();this.setAxisBounds(b);if(!this.rangeIsSame(f.x,this.axisRange.x)||!this.rangeIsSame(f.y,this.axisRange.y))d=!0;d?this.drawAllData():this.drawPts();a&&this.flashInit();for(e in this.data)this.data[e].flushQueue();this.drawLayers()},drawLayers:function(a){if((turn%2||a)&&this.hasData&&
this.layers.count){this.drawAllData();for(a=0;a<this.layers.layers.length;a++)for(var d=this.layers.layers[a],b=0;b<d.length;b++)d[b].draw()}},flashInit:function(){for(var a in this.data)this.data[a].flashInit()},rangeIsSame:function(a,d){return!(a.max!=d.max||a.min!=d.min)},getGridSpacing:function(a,d,b){d=b*Math.abs(d.max-d.min);return(d-20)/(a-1)},setAxisBounds:function(a){this.setAxisBoundsX(a);this.setAxisBoundsY(a)},setAxisBoundsX:function(a){var d=this.axisInit,b=this.valRange;!(d.x.min<b.x.min&&
d.x.max>b.x.max)&&!this.axesFixed.x?a?this.rangeIsSame(a.x,this.valRange.x)||this.getXBounds():this.getXBounds():this.setAxisToInit("x")},setAxisBoundsY:function(a){var d=this.axisInit,b=this.valRange;!(d.y.min<b.y.min&&d.y.max>b.y.max)&&!this.axesFixed.y?a?this.rangeIsSame(a.y,this.valRange.y)||this.getYBounds():this.getYBounds():this.setAxisToInit("y")},setAxisToInit:function(a){var d=this.axisRange[a],b=this.axisInit[a],e=this.numGridLines[a];d.min=b.min;d.max=b.max;this.stepSize[a]=(d.max-d.min)/
(e-1)},getXBounds:function(){var a=this.valRange.x.max-this.valRange.x.min,d=void 0,b=void 0;0!=a?this.logScale.x?(b=this.numGridLines.x-1,d=Math.pow(10,Math.floor(Math.log(this.valRange.x.min)/Math.LN10)),b=d*Math.pow(10,b),a=1):(d=a/(this.numGridLines.x-2),b=Math.pow(10,Math.floor(Math.log10(d))),a=Math.ceil(d/b)*b,d=Math.floor(this.valRange.x.min/a)*a,b=d+(this.numGridLines.x-1)*a):(a=0.2,d=Math.floor(this.valRange.x.min),b=d+a*this.numGridLines.x);if(d<this.axisRange.x.min||b>this.axisRange.x.max)this.axisRange.x.min=
d,this.axisRange.x.max=b,this.stepSize.x=a},getYBounds:function(){var a=Math.abs(this.valRange.y.max-this.valRange.y.min),d=void 0,b=void 0;0!=a?this.logScale.y?(b=this.numGridLines.y-1,d=Math.pow(10,Math.floor(Math.log(this.valRange.y.min)/Math.LN10)),b=d*Math.pow(10,b),a=1):(d=a/(this.numGridLines.y-2),b=Math.pow(10,Math.floor(Math.log10(d))),a=Math.ceil(d/b)*b,d=Math.floor(this.valRange.y.min/a)*a,b=d+(this.numGridLines.y-1)*a):(d=Math.floor(this.valRange.y.min),a=0.2,b=d+a*this.numGridLines.y);
if(d<this.axisRange.y.min||b>this.axisRange.y.max)this.axisRange.y.min=d,this.axisRange.y.max=b,this.stepSize.y=a},drawAxisVals:function(){if(0<this.stepSize.x&&0<this.stepSize.y){for(var a=0;a<this.numGridLines.x;a++){var d=this.graphRangeFrac.x.min*this.dims.dx+this.gridSpacing.x*a,b=this.graphRangeFrac.y.min*this.dims.dy+this.hashMarkLen+10+this.axisValFontSize/2,e;e=this.logScale.x?this.numToAxisVal(this.axisRange.x.min*Math.pow(10,a)):this.numToAxisVal(this.axisRange.x.min+this.stepSize.x*a,
1);draw.text(e,P(d,b),this.axisValFont,this.textCol,"center",0,this.graphDisplay)}for(a=0;a<this.numGridLines.y;a++)b=this.graphRangeFrac.y.min*this.dims.dy-this.gridSpacing.y*a,d=this.graphRangeFrac.x.min*this.dims.dx-this.hashMarkLen-10,e=this.logScale.y?this.numToAxisVal(this.axisRange.y.min*Math.pow(10,a)):this.numToAxisVal(this.axisRange.y.min+this.stepSize.y*a,1),draw.text(e,P(d,b),this.axisValFont,this.textCol,"center",-Math.PI/2,this.graphDisplay)}},makeLegendEntry:function(a,d,b,e){var f=
this.dims.dx-this.legendWidth+5,k=30,h;for(h in this.legend)k+=35;a=new GraphBase.LegendEntry(this,a,d,f,k,this.legendFontSize,this.dims,this.toggleCol,this.legendFont,this.textCol,e);a.toggleActivate();this.legend[b]=a;this.drawAllBG()},numToAxisVal:function(a){return(0.1>=Math.abs(a)||1E3<=Math.abs(a))&&0!=a?a.toExponential():a.toFixed(1)},getRange:function(a){var d=Number.MAX_VALUE,b=-Number.MAX_VALUE,e;for(e in this.data)for(var f=this.data[e].data[a],k=0;k<f.length;k++)var h=f[k],d=Math.min(d,
h),b=Math.max(b,h);return{min:d,max:b}},resetStd:function(){for(var a in this.data)this.data[a].reset();removeListener(curLevel,"update","flash"+this.name);this.drawAllBG();this.resetRanges();this.hasData=!1},resetRanges:function(){this.axisRange=new GraphBase.Range(Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE);this.valRange=new GraphBase.Range(Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE)},ptsExist:function(a){for(var d=0;d<a.length;d++){var b=a[d];
if(void 0===b.x||void 0===b.y||isNaN(b.x)||isNaN(b.y))return!1}return!0},valToCoord:function(a){var d;d=this.logScale.x?this.graphRangeFrac.x.min*this.dims.dx+this.gridSpacing.x*(this.numGridLines.x-1)*Math.log(a.x/this.axisRange.x.min)/Math.log(this.axisRange.x.max/this.axisRange.x.min):this.graphRangeFrac.x.min*this.dims.dx+this.gridSpacing.x*(this.numGridLines.x-1)*(a.x-this.axisRange.x.min)/(this.axisRange.x.max-this.axisRange.x.min);a=this.logScale.y?this.dims.dy-(1-this.graphRangeFrac.y.min)*
this.dims.dy-this.gridSpacing.y*Math.log(a.y/this.axisRange.y.min)/Math.LN10:this.dims.dy-(1-this.graphRangeFrac.y.min)*this.dims.dy-this.gridSpacing.y*(this.numGridLines.y-1)*(a.y-this.axisRange.y.min)/(this.axisRange.y.max-this.axisRange.y.min);return P(d,a)},dataScaling:function(){return V(this.gridSpacing.x/this.stepSize.x,this.gridSpacing.y/this.stepSize.y)},checkMark:function(a,d,b,e,f){var k=Col(0,0,0);a.x-=b;a.y-=b;d.dx+=2*b;d.dy+=2*b;return new CheckMark(a,d,e,k,f)},addMarker:function(a){a.handle?
(a.graphDisplay=this.graphDisplay,a.graph=this,a.layers=this.layers,this.markers[a.handle]=new GraphBase.Marker(a)):console.log("Tried to add a graph marker for "+this.handle+" with no handle.  Add a handle.")},LegendEntry:function(a,d,b,e,f,k,h,l,m,n,p){this.graph=a;this.set=d;this.pos=P(e,f);this.font=m;this.textCol=n;this.toggleCol=l;this.text=b;this.textPos=P(e+10,f+k/2);this.fontSize=k;this.boxPos=P(h.dx-18,f-5);this.boxDims=V(13,13);this.mouseListenerName="toggle"+this.graph.handle.toCapitalCamelCase()+
this.set.handle.toCapitalCamelCase();this.drawMarker=p;this.checkMark=a.checkMark(this.boxPos.copy(),this.boxDims.copy(),a.checkMarkOversize,a.toggleCol,a.graphDisplay)}};
GraphBase.LegendEntry.prototype={draw:function(){this.drawToggle();this.drawText();this.drawMarker(this.pos)},drawToggle:function(){draw.fillStrokeRect(this.boxPos,this.boxDims,this.graph.gridCol,this.toggleCol,this.graph.graphDisplay);this.set.visible&&this.checkMark.draw()},drawText:function(){draw.text(this.text,this.textPos,this.font,this.textCol,"left",0,this.graph.graphDisplay)},toggle:function(){ptInRect(this.boxPos,this.boxDims,mouseOffsetDiv(this.graph.parentDivId))&&(this.set.visible=this.set.visible?
!1:!0,this.graph.drawAllBG(),this.graph.drawAllData())},toggleActivate:function(){addListener(curLevel,"mouseup",this.mouseListenerName,this.toggle,this)},toggleDeactivate:function(){removeListener(curLevel,"mouseup",this.mouseListenerName)},setCanvas:function(a){this.checkMark.setCanvas(a)}};GraphBase.Range=function(a,d,b,e){this.x={min:a,max:d};this.y={min:b,max:e}};GraphBase.Range.prototype={copy:function(){return new GraphBase.Range(this.x.min,this.x.max,this.y.min,this.y.max)}};
GraphBase.Marker=function(a){this.handle=a.handle;this.dataX="function"==typeof a.x?a.x:this.wrapInDataGet(a.x);this.dataY="function"==typeof a.y?a.y:this.wrapInDataGet(a.y);this.graph=a.graph;this.graphDisplay=a.graphDisplay;validNumber(this.dataX())&&validNumber(this.dataY())?this.coordLast=this.graph.valToCoord(P(this.dataX(),this.dataY())):this.coordLast=void 0;this.markerType=a.markerType;this.col=a.col;this.visible=!0;this.layers=a.layers;this.dataValid=!0;if(this.drawFuncs[this.markerType])this.drawCB=
this.drawFuncs[this.markerType];else{console.log("Bad marker type "+this.markerType+".  Choices include ");for(var d in this.drawFuncs)console.log(d)}this.characLen=15;this.imgCharacLen=this.characLen+2;this.layers.addItem("marker",this);var b=this;a.label&&(this.legendEntry=this.addLegendEntry(a.label,function(a){b.drawCB(a)}))};
GraphBase.Marker.prototype={wrapInDataGet:function(a){with(DataGetFuncs)a=exprHasReturn(a)?eval("(function(){"+a+"})"):eval("(function(){return "+a+"})");return a},setDataValid:function(){try{this.dataValid=!1!==validNumber(this.dataX())&&!1!==validNumber(this.dataY())?!0:!1}catch(a){this.dataValid=!1}},setDrawCanvas:function(a){this.graphDisplay=a},addLegendEntry:function(a,d){this.graph.makeLegendEntry(this,a,this.handle,d)},draw:function(){this.visible&&(this.dataValid&&(this.coordLast=this.graph.valToCoord(P(this.dataX(),
this.dataY()))),this.drawCB(this.coordLast))},drawFuncs:{bullseye:function(a){var d=this.characLen;window.draw.circle(a,0.15*d,this.col,!0,this.graphDisplay);window.draw.line(a.copy().movePt(V(-d/2,0)),a.copy().movePt(V(d/2,0)),this.col,this.graphDisplay);window.draw.line(a.copy().movePt(V(0,-d/2)),a.copy().movePt(V(0,d/2)),this.col,this.graphDisplay);window.draw.circle(a,0.3*d,this.col,!1,this.graphDisplay)}},remove:function(){this.layers.removeItem("marker",this)}};
GraphBase.Layers=function(){this.layers=[];this.handleIdxPairs={};this.count=0};
GraphBase.Layers.prototype={addLayer:function(a){this.layers.push([]);this.handleIdxPairs[a]=this.layers.length-1},setDrawCanvas:function(a){for(var d=0;d<this.layers.length;d++)for(var b=this.layers[d],e=0;e<b.length;e++)b[e].setDrawCanvas(a)},removeLayer:function(a){var d=this.handleIdxPairs[a];for(a in this.handleIdxPairs)this.handleIdxPairs[a]>d&&this.handleIdxPairs[a]--;this.count-=this.layers[d].length;this.layers.splice(d,1);delete this.handleIdxPairs[a]},addItem:function(a,d){this.layers[this.handleIdxPairs[a]].push(d);
this.count++},removeItem:function(a,d){var b=this.layers[this.handleIdxPairs[a]].indexOf(d);this.layers[this.handleIdxPairs[a]].splice(b,1);this.count--},removeAll:function(){for(var a=0;a<this.layers.length;a++)for(var d=this.layers[a],b=0;b<d.length;b++)d[b].remove()}};function GraphPhaseTwoComp(a){this.spcAName=a.spcAName;this.spcBName=a.spcBName;this.spcA=spcs[this.spcAName];this.spcB=spcs[this.spcBName];this.wallGas=a.wallGas;this.liquid=a.liquid;this.primaryKeyType=/light/i.test(a.primaryKey)?"Light":"Heavy";this.handle=a.handle;this.actCoeffFuncs=a.actCoeffFuncs;this.pressure=a.pressure||1;a.axesFixed={x:!0};a.numGridLines={x:6};this.keyNamePairs=this.getKeyNamePairs(this.spcA,this.spcB,this.pressure);(!this.spcA||!this.spcB)&&console.log("Bad species data for phase diagram "+
this.spcAName+" "+this.spcBName);a.yLabel="Temp";a.xLabel="frac "+this.keyNamePairs[this.primaryKeyType].toCapitalCamelCase();a.makeReset=!1;this.graph=new GraphScatter(a);this.equilData;this.updateEquilData(this.pressure);this.equilDataHandle=this.handle+"PhaseData";this.graph.addSet({handle:this.equilDataHandle,label:"Phase\nData",pointCol:Col(255,255,255),flashCol:Col(0,0,0),trace:!0,recording:!1,showPts:!1});this.recordFracData(this.wallGas,this.keyNamePairs[this.primaryKeyType]);this.recordFracData(this.liquid.wallLiq,
this.keyNamePairs[this.primaryKeyType]);var d=this.liquid;this.liqTempFunc=function(){return d.temp};this.gasTempFunc=this.makeTempFunc(this.wallGas);this.yFuncKillLow=this.makeFracFunc(this.wallGas,this.keyNamePairs[this.primaryKeyType],!0);this.yFunc=this.makeFracFunc(this.wallGas,this.keyNamePairs[this.primaryKeyType]);this.xFuncKillLow=this.makeFracFunc(this.liquid.wallLiq,this.keyNamePairs[this.primaryKeyType],!0);this.xFunc=this.makeFracFunc(this.liquid.wallLiq,this.keyNamePairs[this.primaryKeyType]);
this.updateGraph();this.active=!1;defaultTo(!0,a.makeLiquidMarker)&&this.makeLiquidMarker();defaultTo(!0,a.makeSystemMarker)&&this.makeSystemMarker();defaultTo(!0,a.makeGasMarker)&&this.makeGasMarker();this.graph.hasData=!0}
GraphPhaseTwoComp.prototype={recordFracData:function(a,d){a.recordFrac({spcName:d,tag:a.handle})},setDataValid:function(){this.graph.setDataValid()},makeLiquidMarker:function(){this.graph.addMarker({handle:"liquid",col:Col(200,0,0),markerType:"bullseye",x:this.xFuncKillLow,y:this.liqTempFunc,label:"Liquid"})},makeSystemMarker:function(){var a=this,d=a.liquid,b=d.wallGas,e=d.wallGas.dotManager,f=d.wallLiq.dotManager;this.graph.addMarker({handle:"system",col:Col(200,200,0),markerType:"bullseye",x:function(){return(a.xFunc()*
f.count+a.yFunc()*e.count)/(e.count+f.count)},y:function(){var e=b.getCv();return(e*a.gasTempFunc()+d.Cp*a.liqTempFunc())/(e+d.Cp)},label:"System"})},makeGasMarker:function(){this.graph.addMarker({handle:"gas",col:Col(0,200,0),markerType:"bullseye",x:this.yFuncKillLow,y:this.gasTempFunc,label:"Gas"})},makeTempFunc:function(a){var d=a.getDataSrc("temp");return function(){for(var a=0,e=Math.max(0,d.length-30);e<d.length;e++)a+=d[e];return a/Math.min(Math.max(1,d.length),30)}},makeFracFunc:function(a,
d,b){var e=a.getDataSrc("frac",{spcName:d,tag:a.handle}),f=a.dotManager;return b?function(){if(50<f.count){for(var a=0,b=Math.max(0,e.length-30);b<e.length;b++)a+=e[b];return a/Math.min(Math.max(1,e.length),30)}return-1E5}:function(){for(var a=0,b=Math.max(0,e.length-30);b<e.length;b++)a+=e[b];return a/Math.min(Math.max(1,e.length),30)}},clearHTML:function(){this.graph.clearHTML()},restoreHTML:function(){this.graph.restoreHTML()},drawAllData:function(){this.graph.drawAllData()},disable:function(){this.graph.disable()},
save:function(){},addLast:function(){this.graph.addLast()},remove:function(){this.graph.remove()},setPressure:function(a){var d=this.updateEquilData(a);this.updateGraph();this.pressure=a;return d},getKeyNamePairs:function(a,d,b){return a.tBoil(b)<d.tBoil(b)?{Light:a.spcName,Heavy:d.spcName}:{Light:d.spcName,Heavy:a.spcName}},updateEquilData:function(a){a=phaseEquilGenerator.twoComp.constP(this.spcA,this.spcB,this.actCoeffFuncs,a,20);for(var d=[],b=[],e=0;e<a.data.length;e++){var f=a.data[e],k=f.temp,
h=f["y"+this.primaryKeyType];d.push(P(f["x"+this.primaryKeyType],k));b.push(P(h,k))}this.equilData=d.concat(b.reverse());return a},updateGraph:function(){this.graph.clearData(this.equilDataHandle,!1);this.graph.enqueueData(this.equilDataHandle,this.equilData);this.graph.updateRange();this.graph.drawAllData()}};function GraphPhaseOneComp(a){this.spcName=a.spcName;this.spc=spcs[this.spcName];this.wallGas=a.wallGas;this.liquid=a.liquid;this.handle=a.handle;this.pressure=a.pressure||1;a.axesFixed={x:!1,y:!1};a.numGridLines={x:6};a.xLabel="Temperature";a.yLabel="Pressure "+this.spcName;a.makeReset=!1;this.equilDataSets=void 0;this.triplePointTemp=a.triplePointTemp;this.criticalPointTemp=a.criticalPointTemp;this.updateEquilData();var d=this.getYMin(this.equilDataSets),b=this.getYMax(this.equilDataSets),b=this.getOrderOfMagRange(d,
b);a.numGridLines=defaultTo({},a.numGridLines);a.numGridLines.y=b+1;a.axisInit.y={min:Math.pow(10,Math.floor(Math.log(d)/Math.LN10)),step:1};a.logScale={y:!0};this.graph=new GraphScatter(a);this.equilDataHandles=this.makeEqDataHandles(this.equilDataSets,this.handle);this.addEqDataSets(this.graph,this.equilDataSets,this.equilDataHandles);this.tempFunc=this.makeTempFunc(this.wallGas,this.liquid);this.pressureFunc=this.makePressureFunc(this.wallGas,this.spcName);this.updateGraph();this.active=!1;defaultTo(!0,
a.makeSystemMarker)&&this.makeMarker();this.graph.hasData=!0}
GraphPhaseOneComp.prototype={addEqDataSets:function(a,d,b){for(a=0;a<d.length;a++)this.graph.addSet({handle:this.equilDataHandles[a],label:"Phase\nData",pointCol:Col(255,255,255),flashCol:Col(0,0,0),trace:!0,recording:!1,showPts:!1})},makeMarker:function(){this.graph.addMarker({handle:"system",col:Col(200,0,0),markerType:"bullseye",x:this.tempFunc,y:this.pressureFunc,label:"System"})},updateEquilData:function(){this.equilDataSets=phaseEquilGenerator.oneComp.equilData(this.spcName,this.triplePointTemp,
this.criticalPointTemp,this.triplePointTemp-25,!1)},getYMin:function(a){for(var d=Number.MAX_VALUE,b=0;b<a.length;b++)for(var e=a[b],f=0;f<e.length;f++)d=Math.min(e[f].pressure,d);return d},getYMax:function(a){for(var d=Number.MIN_VALUE,b=0;b<a.length;b++)for(var e=a[b],f=0;f<e.length;f++)d=Math.max(e[f].pressure,d);return d},getOrderOfMagRange:function(a,d){return Math.ceil(Math.log(d)/Math.LN10)-Math.floor(Math.log(a)/Math.LN10)},makePressureFunc:function(a,d){var b=a.recordFrac({spcName:d,tag:a.handle}).src(),
e=a.getDataSrc("pExt",void 0,!0),f=!1!==e?e:a.getDataSrc("pInt",void 0,!0);return function(){for(var a=0,d=Math.max(0,f.length-30);d<f.length;d++)a+=f[d];return a/Math.min(f.length,30)*b[b.length-1]}},makeTempFunc:function(a,d){var b=a.getDataSrc("temp");return function(){var e=d.Cp,f=a.getCv();return(b[b.length-1]*f+d.temp*e)/(f+e)}},updateGraph:function(){for(var a=0;a<this.equilDataSets.length;a++)this.graph.clearData(this.equilDataHandles[a],!1),this.graph.enqueueData(this.equilDataHandles[a],
this.equilDataToPoints(this.equilDataSets[a]));this.graph.updateRange();this.graph.drawAllData()},setPressure:function(){},makeEqDataHandles:function(a,d){for(var b=[],e=0;e<a.length;e++)b.push(d+"PhaseDataSet"+e);return b},equilDataToPoints:function(a){for(var d=[],b=0;b<a.length;b++)d.push(P(a[b].temp,a[b].pressure));return d}};function GraphScatter(a){this.active=!0;this.handle=a.handle;this.dims=this.getDims();this.xLabel=a.xLabel;this.yLabel=a.yLabel;var d=a.axesInit||a.axisInit;this.labelFontSize=15;this.legendFontSize=12;this.axisValFontSize=11;this.labelFont=this.labelFontSize+"pt calibri";this.legendFont=this.legendFontSize+"pt calibri";this.axisValFont=this.axisValFontSize+"pt calibri";this.borderSpacing=70;this.logScale=a.logScale?{x:defaultTo(!1,a.logScale.x),y:defaultTo(!1,a.logScale.y)}:{x:!1,y:!1};this.legendWidth=
80;a.axesFixed=a.axesFixed||{};this.axesFixed={x:defaultTo(!1,a.axesFixed.x),y:defaultTo(!1,a.axesFixed.y)};this.graphRangeFrac=new GraphBase.Range(this.borderSpacing/this.dims.dx,(this.dims.dx-(this.legendWidth+8))/this.dims.dx,1-this.borderSpacing/this.dims.dy,0.05);this.makeReset=a.makeReset;this.setNumGridLinesAndSpacing(a.numGridLines);this.axisInit=this.setAxesInit(d,this.numGridLines);this.resetRanges();this.stepSize=new GraphScatter.Coord(0,0);this.setStds();this.layers.addLayer("flasher");
this.layers.addLayer("marker");this.drawAllBG()}
_.extend(GraphScatter.prototype,AuxFunctions,GraphBase,{setAxesInit:function(a,d){var b,e,f,k;this.logScale.x?(k=d.x-1,Math.pow(10,Math.floor(Math.log(a.x.min)/Math.LN10)),Math.pow(10,k)):(b=a.x.min,e=b+a.x.step*(d.x-1));this.logScale.y?(k=d.y-1,f=Math.pow(10,Math.floor(Math.log(a.y.min)/Math.LN10)),k=f*Math.pow(10,k)):(f=a.y.min,k=f+a.y.step*(d.y-1));return new GraphBase.Range(b,e,f,k)},addSet:function(a){if(!this.data[a.handle]){var d=this,b=new GraphScatter.Set(this,a.handle,a.label,a.data,a.pointCol,
a.flashCol,a.fillInPts,a.fillInPtsMin,a.trace,a.recording,a.showPts),e=a.pointCol.copy();this.data[a.handle]=b;var f;f=a.trace&&defaultTo(!0,a.showPts)?function(a){draw.line(a.copy().movePt(V(-9,0)),a.copy().movePt(V(9,0)),e,d.graphDisplay);d.drawPtStd(a,e)}:a.trace?function(a){draw.line(a.copy().movePt(V(-9,0)),a.copy().movePt(V(9,0)),e,d.graphDisplay)}:function(a){d.drawPtStd(a,e)};this.makeLegendEntry(b,b.label,a.handle,f);this.drawAllBG()}},setDataValid:function(){for(var a in this.data)this.data[a].setDataValid();
for(var d in this.markers)this.markers[d].setDataValid()},drawAllData:function(){this.drawAllBG();this.drawAxisVals();this.drawPts(!1)},drawPts:function(a){for(var d in this.data)this.data[d].drawPts(!1!==a)},addLast:function(){for(var a in this.data){var d=this.data[a];d.recording&&d.dataValid&&(d.trimNewData(),d.enqueuePts())}this.flushQueues(!0,!1);this.hasData=!0},getAxisBounds:function(){this.getXBounds();this.getYBounds()},graphPt:function(a,d,b){a=this.valToCoord(P(a,d));this.drawPtStd(a,b)},
drawPtStd:function(a,d){this.drawPt(a,d,this.characLen)},drawPt:function(a,d,b,e){e=e||this.graphDisplay;var f=a.x,k=a.y;a=P(f-b,k);var h=P(f,k-b),l=P(f+b,k);b=P(f,k+b);draw.fillPtsStroke([a,h,l,b],d,this.ptStroke,e)},reset:function(){this.resetStd()}});
GraphScatter.Set=function(a,d,b,e,f,k,h,l,m,n,p){this.graph=a;this.handle=d;this.label=b;this.data=new GraphScatter.Data;this.showPts=defaultTo(!0,p);this.graphedPts=[];this.graphedPtIdxs=[];e=e||{};this.dataFuncs=new GraphScatter.DataFuncs(a,e.x,e.y);this.pointCol=f;this.flashCol=k;this.fillInPts=defaultTo(!0,h);this.fillInPtsMin=defaultTo(5,l);this.trace=defaultTo(!1,m);this.visible=!0;this.recordListenerName=this.graph.handle+this.handle.toCapitalCamelCase()+"Record";this.traceLastIdxs=new GraphScatter.Coord(0,
0);this.flashers=[];this.queuePts=[];this.queueIdxs=[];this.recording=defaultTo(!0,n);this.dataValid=!0;this.recording&&this.recordStart()};
GraphScatter.Set.prototype={reset:function(){this.graphedPts.splice(0,this.graphedPts.length);this.graphedPtIdxs.splice(0,this.graphedPtIdxs.length);this.flashers.splice(0,this.flashers.length);this.queueIdxs.splice(0,this.queueIdxs.length);this.queuePts.splice(0,this.queuePts.length)},setDataValid:function(){try{var a=this.dataFuncs.x(),d=this.dataFuncs.y();this.dataValid=!1!==validNumber(a)&&!1!==validNumber(d)?!0:!1}catch(b){this.dataValid=!1}},addVal:function(){this.data.x.push(this.dataFuncs.x());
this.data.y.push(this.dataFuncs.y())},clearData:function(){this.queuePts.splice(0,this.queuePts.length);this.queueIdxs.splice(0,this.queueIdxs.length);this.data.clear()},enqueueData:function(a){var d=this.data.x.length;this.queuePts=this.queuePts.concat(a);this.addData(a);for(a=d;a<this.data.x.length;a++)this.queueIdxs.push(P(a,a))},addData:function(a){this.data.addData(a)},recordStart:function(){addListener(curLevel,"update",this.recordListenerName,function(){this.dataValid&&this.addVal()},this)},
recordStop:function(){removeListener(curLevel,"update",this.recordListenerName)},trimNewData:function(){if(this.graphedPtIdxs.length){var a=this.data.x,d=this.data.y,b=this.graphedPtIdxs[this.graphedPtIdxs.length-1].x,e=this.graphedPtIdxs[this.graphedPtIdxs.length-1].y,f=a.length-b;if(f!=d.length-e)return!1;b=this.findRuns(a,d,e,b,f);for(e=b.length-1;0<=e;e--)this.trimRun(a,d,b[e])}},findRuns:function(a,d,b,e,f){for(var k=function(a,b,d){this.xStartIdx=a;this.yStartIdx=b;this.length=d},h=[],l=[],
m=void 0,n=b,p=e,r=0;r<f-1;r++){var s=P(a[b+r],d[e+r]);if(1>=l.length)l.push(s),2==l.length&&(m=l[0].VTo(l[1]).UV());else{var v=l[l.length-1].VTo(s).UV();0.99<Math.abs(v.dotProd(m))?l.push(s):(3<=l.length&&h.push(new k(n,p,b+r-n,e+r-p)),l=[s],n=b+r,p=e+r)}}3<=l.length&&h.push(new k(n,p,b+r-n,e+r-p));return h},trimRun:function(a,d,b){for(var e=P(a[b.xStartIdx],d[b.yStartIdx]),f=P(a[b.xStartIdx+b.length-1],d[b.yStartIdx+b.length-1]),k=e,h=f,l=k.VTo(h),m=h.VTo(k),n=!0,p=1;p<b.length-1;p++){var r=P(a[b.xStartIdx+
p],d[b.yStartIdx+p]);if(n&&(0>e.VTo(r).dotProd(l)||0>f.VTo(r).dotProd(m)))n=!1;0>l.dotProd(k.VTo(r))?(k=r,l=k.VTo(h)):0>m.dotProd(h.VTo(r))&&(h=r,m=h.VTo(k))}m=[e.x];l=[e.y];k!=e&&(m.push(k.x),l.push(k.y));h!=f&&(m.push(h.x),l.push(h.y));m.push(f.x);l.push(f.y);e=[b.xStartIdx,b.length].concat(m);b=[b.yStartIdx,b.length].concat(l);Array.prototype.splice.apply(a,e);Array.prototype.splice.apply(d,b)},enqueuePts:function(){var a=this.data.pt(),d=[],b=[];if(a.isValid()){var e=new GraphScatter.Coord(this.data.x.length-
1,this.data.y.length-1);if(this.fillInPts&&this.data.x.length&&this.data.y.length&&this.graphedPtIdxs.length)var f=this.graphedPtIdxs[this.graphedPtIdxs.length-1],k=this.data.pt(f.x,f.y),f=this.fillInPtsFunc(a,e,k,f,this.data),d=d.concat(f.newPts),b=b.concat(f.dataIdxs);d.push(a);b.push(e)}this.queuePts=this.queuePts.concat(d);this.queueIdxs=this.queueIdxs.concat(b)},fillInPtsFunc:function(a,d,b,e,f){var k=d.x-e.x;if(k!=d.y-e.y)return{newPts:[],dataIdxs:[]};a=this.graph.valToCoord(a);var h=this.graph.valToCoord(b);
d=this.graph.dataScaling();for(var h=a.VTo(h).UV().perp(),l=k-1;0<l;l--){var k=e.x+l,m=e.y+l,n=a.VTo(this.graph.valToCoord(P(f.x[k],f.y[m]))),n=Math.abs(n.dotProd(h));if(n>this.fillInPtsMin){l=P(f.x[k],f.y[m]);d=this.getEdgePt({x:k,y:m},e,h,l,n,a,f,d);if(!d)break;a=d.dataIdx;d=d.pt;b=this.fillInPtsFunc(d,a,b,e,f);return{newPts:[d].concat(b.newPts),dataIdxs:[a].concat(b.dataIdxs)}}}return{newPts:[],dataIdxs:[]}},getEdgePt:function(a,d,b,e,f,k,h,l){for(a=a.x-d.x-1;0<a;a--){l=d.x+a;var m=d.y+a,n=k.VTo(this.graph.valToCoord(P(h.x[l],
h.y[m]))),n=Math.abs(n.dotProd(b));if(n<f)return{pt:e,dataIdx:{x:l+1,y:m+1}};e=P(h.x[l],h.y[m]);f=n}},updateRange:function(a){this.trace?this.updateRangeFromData(a):this.updateRangeFromPts(a)},updateRangeFromData:function(a){for(var d=this.queueIdxs[0]?this.queueIdxs[0].x:0;d<this.data.x.length;d++){var b=this.data.x[d],e=this.data.y[d];a.x.max=Math.max(a.x.max,b);a.x.min=Math.min(a.x.min,b);a.y.max=Math.max(a.y.max,e);a.y.min=Math.min(a.y.min,e)}},updateRangeFromPts:function(a){for(var d=0;d<this.queuePts.length;d++){var b=
this.queuePts[d].x,e=this.queuePts[d].y;a.x.max=Math.max(a.x.max,b);a.x.min=Math.min(a.x.min,b);a.y.max=Math.max(a.y.max,e);a.y.min=Math.min(a.y.min,e)}},drawPts:function(a){if(this.visible&&(this.showPts||this.trace)&&(this.queuePts.length||this.graphedPts.length)){var d,b=[];a?(d=this.queuePts,b=this.queueIdxs):(d=this.graphedPts.concat(this.queuePts),b=this.graphedPtIdxs.concat(this.queueIdxs));this.trace&&(a?this.graphedPtIdxs.length&&b.length&&this.drawTrace(this.graphedPtIdxs[this.graphedPtIdxs.length-
1].x,b[b.length-1].x,this.graphedPtIdxs[this.graphedPtIdxs.length-1].y,b[b.length-1].y):this.drawTrace(b[0].x,b[b.length-1].x,b[0].y,b[b.length-1].y));if(this.showPts)for(a=0;a<d.length;a++)this.graph.graphPt(d[a].x,d[a].y,this.pointCol)}},flashInit:function(){if(this.visible&&this.showPts)for(var a=0;a<this.queuePts.length;a++){var d=this.queuePts[a],b=this.pointCol,e=this.flashCol,f=e.copy();new GraphScatter.Flasher(d,b,e,f,this.graph.characLen*this.graph.flashMult,2*this.graph.characLen*this.graph.flashMult,
this.graph.characLen,this.graph.flashMult,this.graph.flashRate,this.graph.graphDisplay,this.graph.layers,this.graph)}},flushQueue:function(){this.graphedPts=this.graphedPts.concat(this.queuePts);this.graphedPtIdxs=this.graphedPtIdxs.concat(this.queueIdxs);this.queuePts.splice(0,this.queuePts.length);this.queueIdxs.splice(0,this.queueIdxs.length)},drawTrace:function(a,d,b,e){if(d-a==e-b&&void 0!==a&&void 0!==b){d-=a;e=[this.graph.valToCoord(P(this.data.x[a],this.data.y[b]))];for(var f=1;f<d+1;f++){var k=
this.graph.valToCoord(P(this.data.x[a+f],this.data.y[b+f]));k.closeTo(e[e.length-1])||e.push(k)}draw.path(e,this.pointCol,this.graph.graphDisplay)}else console.log("Data count mismatch for tracing"),console.trace()}};GraphScatter.DataFuncs=function(a,d,b){this.x=a.makeDataFunc(d);this.y=a.makeDataFunc(b)};GraphScatter.Data=function(){this.x=[];this.y=[]};
GraphScatter.Data.prototype={pt:function(a){return void 0===a?P(this.x[this.x.length-1],this.y[this.y.length-1]):P(this.x[a],this.y[a])},addData:function(a){for(var d=0;d<a.length;d++)this.x.push(a[d].x),this.y.push(a[d].y)},toPts:function(){for(var a=[],d=0;d<this.x.length;d++)a.push(this.x[d],this.y[d]);return a},clear:function(){this.x.splice(0,this.x.length);this.y.splice(0,this.y.length)}};GraphScatter.Coord=function(a,d){this.x=a;this.y=d};
GraphScatter.Coord.prototype={copy:function(){return new GraphScatter.prototype.Coord(this.x,this.y)}};
GraphScatter.Flasher=function(a,d,b,e,f,k,h,l,m,n,p,r){this.pt=a;this.pointCol=d;this.flashCol=b;this.curCol=e;this.curCharacLen=f;this.imgCharacLen=k;this.finalCharacLen=h;this.flashMult=l;this.flashRate=m;this.graphDisplay=n;this.layers=p;this.graph=r;this.coordLast=this.graph.valToCoord(this.pt);this.advanceListenerHandle=this.addAdvanceListener();this.lifetime=1/this.flashRate;this.age=0;p.addItem("flasher",this)};
GraphScatter.Flasher.prototype={addAdvanceListener:function(){var a="flashAdvance"+this.graph.handle+this.pt.x+this.pt.y;addListener(curLevel,"update",a,function(){this.advance()},this);return a},setDrawCanvas:function(a){this.graphDisplay=a},draw:function(){this.coordLast=this.graph.valToCoord(this.pt);this.graph.drawPt(this.coordLast,this.curCol,this.curCharacLen,this.graphDisplay)},remove:function(){this.layers.removeItem("flasher",this);removeListener(curLevel,"update",this.advanceListenerHandle)},
advance:function(){this.curCharacLen=stepTowards(this.curCharacLen,this.finalCharacLen,-this.finalCharacLen*this.flashMult*this.flashRate);var a=this.curCol,d=Col(0,0,0);d.r=this.colStep("r");d.g=this.colStep("g");d.b=this.colStep("b");a.set(d);this.age>this.lifetime+1&&this.remove();this.age++},colStep:function(a){var d=this.pointCol[a];return stepTowards(this.curCol[a],d,(d-this.flashCol[a])*this.graph.flashRate)}};function GraphHist(a){this.active=!0;this.handle=a.handle;this.dims=this.getDims();this.xLabel=a.xLabel;this.yLabel=a.yLabel;this.labelFontSize=15;this.axisValFontSize=11;var d=a.axesInit;this.labelFont=this.labelFontSize+"pt calibri";this.axisValFont=this.axisValFontSize+"pt calibri";this.borderSpacing=70;this.graphRangeFrac=new GraphBase.Range(this.borderSpacing/this.dims.dx,0.95,1-this.borderSpacing/this.dims.dy,0.05);this.logScale=a.logScale?{x:defaultTo(!1,a.logScale.x),y:defaultTo(!1,a.logScale.y)}:
{x:!1,y:!1};this.numBins=18;this.axesFixed={x:defaultTo(!1,a.axesFixed.x),y:defaultTo(!1,a.axesFixed.y)};this.setNumGridLinesAndSpacing(a.numGridLines);this.axisInit=new GraphBase.Range(d.x.min,d.x.min+d.x.step*(this.numGridLines.x-1),d.y.min,d.y.min+d.y.step*(this.numGridLines.y-1));this.resetRanges();this.stepSize={x:0,y:0};Col(255,100,0);this.setStds();this.drawAllBG()}
_.extend(GraphHist.prototype,AuxFunctions,GraphBase,{addSet:function(a){this.data[a.handle]||(a=new GraphHist.Set(this,a.handle,a.data,a.barCol),this.data[a.handle]=a,this.drawAllBG())},drawAllData:function(){this.drawAllBG();this.bins&&(this.drawAxisVals(),this.graphBins())},addLast:function(){var a="",d;for(d in this.data)a=d;a=this.data[a];a.addVal();this.makeBins(a);this.hasData=!0},plotData:function(a){var d="",b;for(b in this.data)d=b;this.data[d].data.x=a;this.makeBins(this.data[d])},makeBins:function(a){this.valRange.x=
this.getRange("x");this.setAxisBoundsX();this.bins=this.makeBinBlanks(a.data.x);this.populateBins(a.data.x);this.setYAxis();this.drawAllData()},makeBinBlanks:function(a){a=[];this.binWidth=round((this.valRange.x.max-this.valRange.x.min)/(this.numBins-1),1);for(var d=0;d<this.numBins;d++)a.push(0);return a},populateBins:function(a){for(var d=0;d<a.length;d++)this.bins[Math.floor((a[d]-this.valRange.x.min)/this.binWidth)]++},setYAxis:function(){for(var a=0,d=0;d<this.bins.length;d++)a=Math.max(this.bins[d],
a);this.valRange.y.min=0;this.valRange.y.max=a;this.setAxisBoundsY()},graphBins:function(){var a,d;for(d in this.data)a=d;a=this.data[a].barCol;for(d=0;d<this.bins.length;d++){var b=this.binWidth*(d+1),e=this.valToCoord(P(this.binWidth*d,this.bins[d])),b=this.valToCoord(P(b,0)),b=e.VTo(b);draw.fillStrokeRect(e,b,a,this.bgCol,this.graphDisplay)}},clear:function(){this.clearStd()}});
GraphHist.Set=function(a,d,b,e){this.graph=a;this.handle=d||"onlyData";this.data=new GraphHist.Data;this.dataFunc=new GraphHist.DataFunc(a,b);this.dataValid=!0;this.barCol=e;this.visible=!0};GraphHist.Set.prototype={addVal:function(){this.data.x=this.dataFunc.x()},recordStop:function(){},setDataValid:function(){try{this.dataValid=!1!==validNumber(this.dataFunc.x())?!0:!1}catch(a){}}};GraphHist.Data=function(){this.x=[]};GraphHist.DataFunc=function(a,d){this.x=a.makeDataFunc(d)};function GraphBlank(a){this.dims=this.getGraphDims();this.borderSpacing=70;this.xStart=this.borderSpacing/this.dims.dx;this.yStart=1-this.borderSpacing/this.dims.dy;this.legendWidth=80;this.xEnd=(this.dims.dx-(this.legendWidth+8))/this.dims.dx;this.yEnd=0.05;this.gridSpacing=40;this.setNumGridLines();this.setStds();this.handle="blank"+Math.round(1E5*Math.random());this.parentDiv=a;this.makeCanvasNoReset(this.dims,a);this.parentDiv.attr("filledWith","blank");this.drawBGBlank()}
_.extend(GraphBlank.prototype,GraphBase,{drawBGBlank:function(){this.graph.save();this.drawBGRect();this.graph.globalAlpha=0.2;this.drawGrid();this.drawBounds();this.graph.restore()}});function DataDisplayer(){this.entries={}}
DataDisplayer.prototype={setReadouts:function(a){this.readouts=a},addEntry:function(a){var d=a.label||"",b=defaultTo(1,a.decPlaces),e=a.handle,f=a.expr||"",k=a.units||"",h=this.readouts[a.readout];h||console.log("Bad readout name "+a.readout);a="display"+d+this.entries.length;var l=h.addEntry(d+e),e=new this.Entry(e,d,b,f,k,a,this,l);this.entries[e.handle]=e;with(DataGetFuncs){var m;m=exprHasReturn(f)?eval("(function(){"+f+"})"):eval("(function(){return "+f+"})");addListener(curLevel,"update",a,function(){var a=
d,e;e=m();e=isNaN(e)||void 0===e?"":e.toFixed(b);a=a+(e+" ")+k;l.setText(a)})}return e},removeEntry:function(a){this.entries[a]&&this.entries[a].remove()},Entry:function(a,d,b,e,f,k,h,l){this.handle=a;this.label=d;this.decPlaces=b;this.expr=e;this.units=f;this.listenerStr=k;this.dataDisplayer=h;this.readoutEntry=l;this.removed=!1}};
DataDisplayer.prototype.Entry.prototype={remove:function(){this.removed||(delete this.dataDisplayer.entries[this.handle],this.readoutEntry.remove(),removeListener(curLevel,"update",this.listenerStr),this.removed=!0)}};DataGetFuncs={tempSmooth:function(a){a=walls[a].getDataSrc("temp");for(var d=Math.min(15,a.length),b=a.length-d,e=0,f=0;f<d;f++)e+=a[b+f];return e/d},collisions:function(){for(var a=collide.hitsPerTurn,d=Math.min(15,a.length),b=a.length-d,e=0,f=0;f<d;f++)e+=a[b+f];return 1E3*e/d/updateInterval},temp:function(a){a=walls[a].getDataSrc("temp");return a[a.length-1]},pInt:function(a){a=walls[a].getDataSrc("pInt");return a[a.length-1]},pExt:function(a){a=walls[a].getDataSrc("pExt");return a[a.length-1]},
vol:function(a){a=walls[a].getDataSrc("vol");return a[a.length-1]},q:function(a){a=walls[a].getDataSrc("q");return a[a.length-1]},mass:function(a){a=walls[a].getDataSrc("mass");return a[a.length-1]},moles:function(a,d){var b=walls[a].getDataSrc("moles",d);return b[b.length-1]},frac:function(a,d){var b=walls[a].getDataSrc("frac",d);return b[b.length-1]},time:function(a){a=walls[a].getDataSrc("time");return a[a.length-1]},work:function(a){a=walls[a].getDataSrc("work");return a[a.length-1]},enthalpy:function(a){a=
walls[a].getDataSrc("enthalpy");return a[a.length-1]},internalEnergy:function(a){a=walls[a].getDataSrc("internalEnergy");return a[a.length-1]},vDist:function(a,d){var b=walls[a].getDataSrc("vDist",d);return b[b.length-1]},get:function(a,d,b,e,f){a=getStore(a);var k,h="int"==d||"float"==d;a&&(k="int"==d?Math.round(parseFloat(a)):"float"==d?parseFloat(a):"string"==d?a.sanitize():Number(a)==a?Number(a):a,h&&(f=void 0===f||isNaN(f)?k:f,e=void 0===e||isNaN(e)?k:e,k=bound(k,e,f)));if(void 0===k||h&&isNaN(k))k=
b;return k},img:function(a,d,b,e){if(e)return{attrs:{src:[window.IMGPATHPREFIX+a]}};a=templater.img({attrs:{src:[window.IMGPATHPREFIX+a]}});b&&(a=templater.center({innerHTML:a}));"br"==d?a=templater.br()+a+templater.br():"p"==d&&(a=templater.p({innerHTML:a}));return a}};window.BCollide=1.5;
function Experiment(){this.mutables={eAF:new Experiment.Mutable("LevelData.mainSequence[0].sceneData.rxns[0].activeE"),eAR:new Experiment.Mutable("LevelData.mainSequence[0].sceneData.rxns[1].activeE"),hFA:new Experiment.Mutable("LevelData.spcDefs[0].hF298"),hFB:new Experiment.Mutable("LevelData.spcDefs[1].hF298"),hFC:new Experiment.Mutable("LevelData.spcDefs[2].hF298"),hFD:new Experiment.Mutable("LevelData.spcDefs[3].hF298"),tempDots1:new Experiment.Mutable("LevelData.mainSequence[0].sceneData.dots[0].temp"),tempDots2:new Experiment.Mutable("LevelData.mainSequence[0].sceneData.dots[1].temp"),
tempWalls:new Experiment.Mutable("LevelData.mainSequence[0].sceneData.walls[0].temp"),BCollide:new Experiment.Mutable("window.BCollide")};this.data={nA:new Experiment.Data('walls[0].getDataSrc("frac", {spcName: "a", tag: "wally"})'),nB:new Experiment.Data('walls[0].getDataSrc("frac", {spcName: "b", tag: "wally"})'),nC:new Experiment.Data('walls[0].getDataSrc("frac", {spcName: "c", tag: "wally"})'),nD:new Experiment.Data('walls[0].getDataSrc("frac", {spcName: "d", tag: "wally"})'),temp:new Experiment.Data('walls[0].getDataSrc("temp")')};
this.dataToEval={fracProdsExp:new Experiment.Data("nC + nD"),eqConstExp:new Experiment.Data("nC * nD / (nB * nA)")};this.dimensions=[new Experiment.Dimension([{paths:["tempDots1","tempDots2","tempWalls"],testVals:"[298.15, 398.15 ... 900]"}]),new Experiment.Dimension([{paths:["hFC","hFD"],testVals:"[-20, -18 ... -16]"},{paths:["eAR"],testVals:"[24, 20... 16]"}])];this.appendEqData=!0;this.numReps=4;this.runTime=40;this.draw=!1;this.runNum=0;this.totalRuns=this.getTotalRuns();console.log("Running "+
this.totalRuns+" tests at "+this.runTime+" seconds each.");console.log("Total run time: "+this.totalRuns*this.runTime+" seconds");this.resultsSets=[];this.repIdx=0;this.dimValIdxs=this.makeDimValIdxs(this.dimensions);this.finished=!1;this.measureNext()}
Experiment.prototype={measureNext:function(){var a=this;this.finished?(console.log("Done!  Ready to print"),curLevel.pause()):(this.setVals(this.mutables,this.dimensions,this.dimValIdxs),sceneNavigator.refresh(),this.draw||(curLevel.drawRun=function(){}),setTimeout(function(){a.tryNextMeasurement()},1E3*this.runTime))},print:function(a){a||(a=Experiment.Dimension.prototype.extendSet("[0 ... "+(this.dimensions.length-1)+"]"));a=this.sortResults(this.resultsSets,a);var d;d='<table border="1" cellpadding="3">'+
this.makeHeaderRow();for(var b=0;b<a.length;b++)d+=a[b].asTableRow(this.appendEqData,!0);d+="</table>";$("body").append("<br>");$("body").append(d)},sortResults:function(a,d){if(!d.length)return a;for(var b=d[0],e=this.sortSetsByDimIdx(a.concat(),b),b=this.pluckGroups(e,b),f=e=0;f<b.length;f++){var k=[e,b[f].length].concat(this.sortResults(b[f],d.slice(1,d.length-1)));Array.prototype.splice.apply(a,k);e+=b[f].length}return a},pluckGroups:function(a,d){for(var b=[],e=-1,f=0;f<a.length;f++)a[f].dimValIdxs[d]!=
e&&(b.push([]),e=a[f].dimValIdxs[d]),b[b.length-1].push(a[f]);return b},sortSetsByDimIdx:function(a,d){for(var b=0;b<a.length;b++)for(var e=0;e<a.length-1;e++){var f=a[e],k=a[e+1];k.dimValIdxs[d]<f.dimValIdxs[d]&&(a[e]=k,a[e+1]=f)}return a},tryNextMeasurement:function(){this.recordPt(this.data,this.mutables,this.dimValIdxs);this.finished=this.tick();this.measureNext()},tick:function(){this.runNum++;console.log(Math.round(100*this.runNum/this.totalRuns)+" %");var a=this.dimensions,d=this.dimValIdxs;
this.repIdx++;return this.repIdx==this.numReps?(this.repIdx=0,this.nextDimVal(a,d)):!1},nextDimVal:function(a,d){for(var b=a.length-1;0<=b;b--)if(d[b]++,d[b]==a[b].numPts)d[b]=0;else return!1;return!0},makeDimValIdxs:function(a){for(var d=[],b=0;b<a.length;b++)d.push(0);return d},makeHeaderRow:function(){var a="<tr>",d;for(d in this.mutables)a+="<td>"+d+"</td>";for(d in this.data)a+="<td>"+d+"</td>";for(d in this.dataToEval)a+="<td>"+d+"</td>";this.appendEqData&&(a+="<td>eq const</td><td>mole frac prods</td>");
return a+="</tr>"},getTotalRuns:function(){for(var a=1,d=0;d<this.dimensions.length;d++)a*=this.dimensions[d].numPts;return a*this.numReps},recordPt:function(a,d,b){this.resultsSets.length?this.resultsSets[this.resultsSets.length-1].isAtIdxs(b)||this.resultsSets.push(new Experiment.ResultsSet(b)):this.resultsSets.push(new Experiment.ResultsSet(b));this.resultsSets[this.resultsSets.length-1].addResults(new Experiment.Results(a,d,this.dataToEval))},setVals:function(a,d,b){for(var e=0;e<d.length;e++)for(var f=
d[e],k=b[e],h=0;h<f.paths.length;h++)for(var l=f.testVals[h][k],m=f.paths[h],n=0;n<m.length;n++)eval(a[m[n]].path+" = "+l)}};Experiment.ResultsSet=function(a){this.dimValIdxs=a.concat();this.results=[]};
Experiment.ResultsSet.prototype={addResults:function(a){this.results.push(a)},isAtIdxs:function(a){for(var d=0;d<a.length;d++)if(a[d]!=this.dimValIdxs[d])return!1;return!0},asTableRow:function(a,d){var b="";d&&(b+="<tr><td></td></tr>");for(var e=0;e<this.results.length;e++)b+=this.results[e].asTableRow(a);return b}};Experiment.Dimension=function(a){this.paths=_.pluck(a,"paths");a=_.pluck(a,"testVals");this.testVals=this.extendSets(a,this.paths);this.numPts=this.testVals[0].length};
Experiment.Dimension.prototype={extendSets:function(a,d){for(var b=[],e=0;e<a.length;e++)a[e]instanceof Array?b.push(a[e]):b.push(this.extendSet(a[e]));this.checkValLens(b,d);return b},extendSet:function(a){-1==a.indexOf("...")&&console.log("Unrecognized set "+a);a=a.replace("..."," ... ");var d=this.cleanSigVals(a.match(/[\-0-9\.]+/g)),b;a=d[0];3==d.length?(b=d[1]-d[0],d=d[2]):(d=d[1],b=d>a?1:-1);return this.setFromSigVals(a,b,d)},checkValLens:function(a,d){for(var b=a[0].length,e=a[0].length,f=
0;f<a.length;f++)b=Math.min(a[f].length,b),e=Math.max(a[f].length,e);b!=e&&(console.log("Dimension with paths "),console.log(d),console.log("has mismatched values sets: max length is "+e+" and min length is "+b),console.log("THIS EXPERIMENT WILL NOT WORK"))},cleanSigVals:function(a){for(var d=[],b=0;b<a.length;b++){var e=/[\.]+/.exec(a[b]);e&&e[0]!=a[b]?d.push(Number(a[b])):e||d.push(Number(a[b]))}return d},setFromSigVals:function(a,d,b){var e=[];if(a<b)for(;a<=b;a+=d)e.push(a);else for(;a>=b;a+=
d)e.push(a);return e}};Experiment.Results=function(a,d,b){this.data={};this.spcDefs=deepCopy(LevelData.spcDefs);var e=walls[0].getDataSrc("temp");this.finalTemp=this.avgLast(e,300);this.setPts=this.recordMutables(d);for(var f in a)this.data[f]=a[f].avg(200);this.evaledData=this.evalData(b,this.data)};
Experiment.Results.prototype={log:function(){console.log("\nSet point");console.log(this.objToStr(this.setPts));console.log("Produced data");console.log(this.objToStr(this.data)+"\n")},recordMutables:function(a){var d={},b;for(b in a)d[b]=eval(a[b].path);return d},evalData:function(a,d){var b={};with(d)for(var e in a)b[e]=eval(a[e].path);return b},asTableRow:function(a){var d="<tr>",b;for(b in this.setPts)d+="<td>"+this.setPts[b]+"</td>";for(b in this.data)d+="<td>"+this.data[b]+"</td>";for(b in this.evaledData)d+=
"<td>"+this.evaledData[b]+"</td>";a&&(d+=this.makeEqData(this.spcDefs));return d+"</tr>"},makeEqData:function(a){var d=this.finalTemp,b=1E3*a[3].hF298+a[3].cv*(d-298.15)+(1E3*a[2].hF298+a[2].cv*(d-298.15))-(1E3*a[1].hF298+a[1].cv*(d-298.15)+(1E3*a[0].hF298+a[0].cv*(d-298.15)));a=Math.exp(-(1E3*(a[2].hF298+a[3].hF298-(a[1].hF298+a[0].hF298)))/(298.15*R))*Math.exp(-(b/R)*(1/d-1/298.15));for(var e,d=0;1>=d&&!(e=Newton(a+" - (x*x)/((1-x)*(1-x))",{x:d},"x"),0<=e&&1>=e);d+=0.1);return"<td>"+a+"</td><td>"+
e+"</td>"},objToStr:function(a){var d="",b;for(b in a)d+=b+": "+a[b]+", ";return d},avgLast:function(a,d){for(var b=0,e=Math.max(0,a.length-d);e<a.length;e++)b+=a[e];return b/Math.min(d,a.length)}};Experiment.Mutable=function(a){this.path=a};Experiment.Mutable.prototype={get:function(){return eval(this.path)},set:function(a){eval(this.path+" = "+a)}};Experiment.Data=function(a){this.path=a};
Experiment.Data.prototype={all:function(){return eval(this.path)},last:function(){var a=eval(this.path);return a[a.length-1]},avg:function(a){for(var d=eval(this.path),b=0,e=Math.max(0,d.length-a);e<d.length;e++)b+=d[e];return b/a}};
function Newton(a,d,b){for(var e=function(d){d=deepCopy(d);with(d){d[b]+=1E-7;var e=eval(a);d[b]-=2E-7;d=eval(a);return(e-d)/2E-7}},f=function(b){with(b)return eval(a)},k=f(d),h=0;1E-7<Math.abs(k);){var l=e(d);d[b]-=k/l;k=f(d);h++;if(1E3<h)return d[b]+" EQ DID NOT CONVERGE"}return d[b]};ReactionHandler={addReaction:function(a){a.parent=this;a=new ReactionHandler.Reaction(a);this.initRxn(a);return a},rxnIsEnabled:function(a){return this.getRxn(this.activeRxns,a)?!0:!1},disableRxn:function(a){this.removeRxn(a)},enableRxn:function(a){if(a=this.getRxn(this.pausedRxns,a))this.pausedRxns.splice(this.pausedRxns.indexOf(a),1),this.initRxn(a)},removeRxn:function(a){for(var d in this.rxns){for(var b=this.rxns[d],e=!1,f=b.length-1;0<=f;f--)b[f].handle==a&&(b.splice(f,1),e=!0);e&&(0==b.length?
this.setHandlerByIdStr(d,{func:this.impactStd,obj:this}):1==b.length&&(b=b[0],this.initPair(b,!0)))}if(b=this.getRxn(this.activeRxns,a))this.activeRxns.splice(this.activeRxns.indexOf(b),1),this.pausedRxns.push(b)},getRxn:function(a,d){for(var b=0;b<a.length;b++)if(d==a[b].handle)return a[b]},initRxn:function(a){this.initPair(a);this.activeRxns.push(a)},removeAllReactions:function(){this.setDefaultHandler({func:this.impactStd,obj:this})},getIdStr:function(a,d){return a.idNum<d.idNum?a.idNum+"-"+d.idNum:
d.idNum+"-"+a.idNum},initPair:function(a){var d=this.getIdStr(a.rctADef,a.rctBDef);this.rxns[d]?this.rxns[d].push(a):this.rxns[d]=[a];1<this.rxns[d].length?this.setHandler(a.rctA,a.rctB,{func:this.rctHandlerMultPairs(d),obj:this}):this.setHandler(a.rctA,a.rctB,{func:this.rctHandlerSinglePair(d),obj:this})},countProds:function(a){var d=0,b;for(b in a)d+=a[b];return d},hitE:function(a,d,b,e){return 0.5*(Math.abs(b)*b*a.m*a.cvKinetic+Math.abs(e)*e*d.m*d.cvKinetic)*this.tConst},probFunc:function(a,d,
b){return a>1.5*d?1/(1+Math.exp(-b/R)):0},rctHandlerSinglePair:function(a){var d=this.rxns[a][0],b=d.activeE,e=d.prods;return function(a,k,h,l,m){var n=this.hitE(a,k,l,-m);return Math.random()<this.probFunc(n,b,d.sRxn298)?!this.react(a,k,e)?this.impactStd(a,k,h,l,m):!1:this.impactStd(a,k,h,l,m)}},rctHandlerMultPairs:function(a){var d=this.rxns[a];return function(a,e,f,k,h){for(var l=this.hitE(a,e,k,-h),m=[],n=0,p=0;p<d.length;p++)m[p]=this.probFunc(l,d[p].activeE,rxn.sF298),n+=m[p];p=this.pickRxnIdx(m,
1<n?1/n:1);return!1===p?this.impactStd(a,e,f,k,h):this.react(a,e,d[p].prods)?!1:this.impactStd(a,e,f,k,h)}},pickRxnIdx:function(a,d){for(var b=Math.random(),e=0,f=0;f<a.length;f++)if(e+=a[f]*d,e>b)return f;return!1},react:function(a,d,b){for(var e=a.internalEnergy()+d.internalEnergy(),f=0,k=0,h=0.5*(a.x+d.x),l=0.5*(a.y+d.y),m=[],n=0;n<b.length;n++){for(var p=b[n].name,r=b[n],s=[],f=f+this.spcs[p].uF298*r.count,k=k+this.spcs[p].cv*r.count,v=0;v<r.count;v++){var t=2*Math.random()*Math.PI,t=V(Math.sin(t),
Math.cos(t));s.push(D(h+3*t.dx,l+3*t.dy,t,p,a.tag,a.elemId,a.returnTo))}m.push(s)}f*=1E3/N;k/=N;b=(e-f)/k+298.15;if(0<b){this.dotManager.remove([a,d]);for(a=0;a<m.length;a++){s=m[a];this.dotManager.add(s);for(d=0;d<s.length;d++)s[d].setTemp(b)}return!0}return!1},Reaction:function(a){this.attrs=a;this.handle=a.handle;this.parent=a.parent;this.rctA=a.rctA||a.rctB;this.rctB=a.rctA&&a.rctB?a.rctB:void 0;this.rctADef=this.parent.spcs[this.rctA];this.rctBDef=this.parent.spcs[this.rctB];this.activeE=1E3*
a.activeE/N;if(this.rctA&&!this.rctADef)return console.log("reactant a "+this.rctA+" doesn't exist");if(this.rctB&&!this.rctBDef)return console.log("reactant b "+this.rctB+" doesn't exist");this.prods=this.reformatProds(a.prods);this.prodCount=this.countProds(this.prods);this.sRxn298=this.calcSRxn([new ReactionHandler.ReactionComponent(this.rctA,1),new ReactionHandler.ReactionComponent(this.rctB,1)],this.prods,this.parent.spcs)}};
ReactionHandler.Reaction.prototype={copy:function(){return new this.parent.Reaction(this.attrs)},doubleProds:function(){for(var a=0;a<this.prods.length;a++)this.prods[a].count*=2;this.prodCount*=2;return this},calcSRxn:function(a,d,b){for(var e=0,f=0;f<d.length;f++)e+=b[d[f].name].sF298;for(f=0;f<a.length;f++)e-=b[a[f].name].sF298;return e},increaseProd:function(a,d){for(var b=!1,e=0;e<this.prods.length;e++){var f=this.prods[e];if(f.name==a){f.count+=d;b=!0;break}}b||this.prods.push(new ReactionHandler.ReactionComponent(a,
d));this.prodCount+=d;return this},reformatProds:function(a){var d=[],b;for(b in a)d.push(new ReactionHandler.ReactionComponent(b,a[b]));return d},countProds:function(a){for(var d=0,b=0;b<a.length;b++)d+=a[b].count;return d},remove:function(){this.parent.removeRxn(this.handle)}};ReactionHandler.ReactionComponent=function(a,d){this.name=a;this.count=d};function CollideHandler(a){this.tConst=tConst;this.rxns={};this.dotManager=a;this.activeRxns=[];this.pausedRxns=[];this.numHits=0;this.hitsPerTurn=[];this.checkStore=this.check;this.breakUpStore=this.breakUp;this.recordingHits=!1;this.recordCleanUpListenerName="recordCollideHits"}
_.extend(CollideHandler.prototype,ReactionHandler,toInherit.gridder,{setSpcs:function(a){this.spcs=a;this.setDefaultHandler({func:this.impactStd,obj:this},this.spcs);this.setup(this.spcs)},setDefaultHandler:function(a,d){for(var b=countAttrs(d),e=0;e<b;e++)for(var f=e;f<b;f++)this[e+"-"+f]=a,this.rxns[e+"-"+f]=[]},setHandler:function(a,d,b){var e=this.getIdStr(this.spcs[a],this.spcs[d]);this.isIdStr(e)?this[e]=b:console.log("bad spc names "+a+" "+d)},setHandlerByIdStr:function(a,d){this.isIdStr(a)?
this[a]=d:console.log("bad id string "+a)},isIdStr:function(a){return/^[0-9]+\-[0-9]+$/.test(a)},recordCollisions:function(){this.check=this.checkRecord;this.breakUp=this.breakUpRecord;this.recordingCollisions=!0;addListener(curLevel,"sectionCleanUp",this.recordCleanUpListenerName,this.recordCollisionsStop,this)},recordCollisionsStop:function(){this.check=this.checkStore;this.breakUp=this.breakUpStore;this.recordingCollisions=!1;removeListener(curLevel,"sectionCleanUp",this.recordCleanUpListenerName)},
check:function(){for(var a=this.gridSize,d=this.xSpan,b=this.ySpan,e=this.grid=this.makeGrid(),f=dotManager.lists.ALLDOTS,k=f.length-1;-1<k;k--){var h=f[k],l=Math.floor(h.x/a),m=Math.floor(h.y/a),n=!0,p=Math.max(l-1,0),r=Math.min(l+1,d)+1;a:for(;p<r;p++)for(var s=Math.max(m-1,0),v=Math.min(m+1,b)+1;s<v;s++)for(var t=e[p][s].length-1;0<=t;t--){var x=e[p][s][t],w=h.x-x.x,y=h.y-x.y;if(w*w+y*y<=(h.r+x.r)*(h.r+x.r)&&(w=this[Math.min(h.idNum,x.idNum)+"-"+Math.max(h.idNum,x.idNum)],y=V(x.x-h.x,x.y-h.y).UV(),
!1===w.func.apply(w.obj,[h,x,y,h.v.dotProd(y),x.v.dotProd(y)]))){n=!1;e[p][s].splice(t,1);break a}}0<=l&&0<=m&&l<this.numCols&&m<this.numRows?n&&e[l][m].push(h):(returnEscapist(h),console.log("ball out of bounds"))}},checkRecord:function(){var a=this.gridSize,d=this.xSpan,b=this.ySpan,e=this.grid=this.makeGrid();this.hitsPerTurn.push(this.numHits);this.numHits=0;for(var f=dotManager.lists.ALLDOTS,k=f.length-1;-1<k;k--){var h=f[k],l=Math.floor(h.x/a),m=Math.floor(h.y/a),n=!0,p=Math.max(l-1,0),r=Math.min(l+
1,d)+1;a:for(;p<r;p++)for(var s=Math.max(m-1,0),v=Math.min(m+1,b)+1;s<v;s++)for(var t=e[p][s].length-1;-1<t;t--){var x=e[p][s][t],w=h.x-x.x,y=h.y-x.y;if(w*w+y*y<=(h.r+x.r)*(h.r+x.r)&&(w=this[Math.min(h.idNum,x.idNum)+"-"+Math.max(h.idNum,x.idNum)],y=V(x.x-h.x,x.y-h.y).UV(),!1===w.func.apply(w.obj,[h,x,y,h.v.dotProd(y),x.v.dotProd(y)]))){n=!1;e[p][s].splice(t,1);break a}}0<=l&&0<=m&&l<this.numCols&&m<this.numRows?n&&e[l][m].push(h):(returnEscapist(h),console.log("ball out of bounds"))}},impactStd:function(a,
d,b,e,f){var k=(e*(a.m-d.m)+2*d.m*f)/(a.m+d.m),h=(f*(d.m-a.m)+2*a.m*e)/(a.m+d.m),l=a.temp(),m=d.temp();a.v.dx+=b.dx*(k-e);a.v.dy+=b.dy*(k-e);d.v.dx+=b.dx*(h-f);d.v.dy+=b.dy*(h-f);e=a.temp();f=d.temp();k=l+(e-l)*a.cvKinetic/a.cv;h=m+(f-m)*d.cvKinetic/d.cv;a.v.mult(Math.sqrt(k/e));a.internalPotential*=k/l;d.v.mult(Math.sqrt(h/f));d.internalPotential*=h/m;this.breakUp(a,d,b);return!0},breakUp:function(a,d,b){var e=a.r+d.r,f=d.x-b.dx*e,k=d.y-b.dy*e;d.x=a.x+b.dx*e;d.y=a.y+b.dy*e;a.x=f;a.y=k},breakUpRecord:function(a,
d,b){this.numHits++;var e=a.r+d.r,f=d.x-b.dx*e,k=d.y-b.dy*e;d.x=a.x+b.dx*e;d.y=a.y+b.dy*e;a.x=f;a.y=k},setup:function(a){this.gridSize=Math.max(5,2*this.getMaxR(a));this.numCols=Math.ceil(myCanvas.width/this.gridSize+1);this.numRows=Math.ceil(myCanvas.height/this.gridSize+1);this.xSpan=Math.floor(myCanvas.width/this.gridSize);this.ySpan=Math.floor(myCanvas.height/this.gridSize)},getMaxR:function(a){var d=0,b;for(b in a)d=Math.max(d,a[b].r);return d}});function DotMigrator(){this.numCols=this.numRows=40}
DotMigrator.prototype={migrateDots:function(a,d,b){this.width=$("#myCanvas").width();this.height=$("#myCanvas").height();this.colWidth=this.width/(this.numCols-1);this.rowHeight=this.height/(this.numRows-1);this.offset=0.12345;d=window.walls.getWallsByHandles(d);b=window.walls.getWallsByHandles(b);var e=this.makeWallGrid(this.numRows,this.numCols),f=this.makeWallGrid(this.numRows,this.numCols);this.mapWallsOnToGrid(d,e);this.mapWallsOnToGrid(b,f);f=this.expandGrid(f);e=this.contractGrid(e);this.subtractGrid(e,
f);this.placeDots(a,e,this.gridToPtList(e,this.colWidth,this.rowHeight,this.offset))},placeDots:function(a,d,b){for(var e=0;e<a.length;e++)if(!d[Math.floor((a[e].y-this.offset)/this.rowHeight)][Math.floor((a[e].x-this.offset)/this.colWidth)]){var f=b[Math.floor(Math.random()*b.length)].copy();a[e].x=f.x+Math.random()*this.colWidth;a[e].y=f.y+Math.random()*this.rowHeight}},gridToPtList:function(a,d,b,e){for(var f=[],k=0;k<a.length;k++)for(var h=0,l=a[0].length;h<l;h++)a[k][h]&&f.push(P(e+h*d,e+k*b));
return f},mapWallsOnToGrid:function(a,d){for(var b=0;b<a.length;b++)this.mapWallOnToGrid(a[b],d)},subtractGrid:function(a,d){for(var b=0;b<a.length;b++)for(var e=0;e<a[0].length;e++)a[b][e]=Math.min(a[b][e],!d[b][e])},mapWallOnToGrid:function(a,d){for(var b,e,f=0;f<d.length;f++){var k=this.offset+this.rowHeight*(f+0.5),h=[];b=0;for(e=a.length-1;b<a.length;b++)(a[b].y<k&&a[e].y>=k||a[e].y<k&&a[b].y>=k)&&h.push(a[b].x+(k-a[b].y)/(a[e].y-a[b].y)*(a[e].x-a[b].x)),e=b;for(b=0;b<h.length-1;)h[b]>h[b+1]?
(e=h[b],h[b]=h[b+1],h[b+1]=e,b&&b--):b++;for(b=0;b<h.length;b+=2)for(e=h[b];e<h[b+1];e+=5)xGridIdx=Math.floor((e-this.offset)/this.colWidth),d[f][xGridIdx]=!0}},expandGrid:function(a){for(var d=this.makeWallGrid(a.length,a[0].length),b=0;b<a.length;b++)for(var e=0;e<a[0].length;e++)if(a[b][e]||a[b][e+1]||a[b-1]&&a[b-1][e]||a[b+1]&&a[b+1][e])d[b][e]=!0;return d},contractGrid:function(a){for(var d=this.makeWallGrid(a.length,a[0].length),b=0;b<a.length;b++)for(var e=0;e<a[0].length;e++)if(a[b][e]&&a[b][e+
1]&&(a[b-1]?a[b-1][e]:1)&&(a[b+1]?a[b+1][e]:1))d[b][e]=!0;return d},makeWallGrid:function(a,d){for(var b=Array(d),e=0;e<d;e++){for(var f=Array(a),k=0;k<a;k++)f[k]=!1;b[e]=f}return b}};function Attractor(){this.eDebt=0;this.k1=0.5;this.k2=0.07}
_.extend(Attractor.prototype,toInherit.gridder,{setup:function(){this.gridSize=30;this.numCols=Math.ceil(myCanvas.width/this.gridSize+1);this.numRows=Math.ceil(myCanvas.height/this.gridSize+1);this.xSpan=Math.floor(myCanvas.width/this.gridSize);this.ySpan=Math.floor(myCanvas.height/this.gridSize);this.dotManager=dotManager;return this},attract:function(){for(var a=this.makeGrid(),d=this.gridSize,b=this.xSpan,e=this.ySpan,f=dotMagnager.lists.ALLDOTS,k=0;k<f.length;k++){var h=f[k];if(0<h.attractStr){h.tempLast=
h.temp();for(var l=Math.floor(h.x/d),m=Math.floor(h.y/d),n=Math.max(l-1,0);n<=Math.min(l+1,b);n++)for(var p=Math.max(m-1,0);p<=Math.min(m+1,e);p++)for(var r=a[n][p].length-1;-1<r;r-=1){var s=a[n][p][r],v=h.x-s.x,t=h.y-s.y,x=Math.sqrt(v*v+t*t),w=V(v,t);w.dx/=x;w.dy/=x;var x=Math.max(0,x-h.r-s.r)*pxToE,v=h.attractStrs[s.idNum],t=(h.attractRad+s.attractRad)/2,y=t*t*t*t*t,z=(0.97*t+x)*(0.97*t+x)*(0.97*t+x)*(0.97*t+x)*(0.97*t+x),A=-v*(5*y/(z*(0.97*t+x))-8*y*t*t*t/(z*(0.97*t+x)*(0.97*t+x)*(0.97*t+x)*(0.97*
t+x))),F=w.copy().mult(A/h.m),w=w.mult(-A/s.m);h.v.add(F);s.v.add(w);x=-v*(y*t*t*t/(z*(0.97*t+x)*(0.97*t+x)*(0.97*t+x))-y/z);h.peCur+=x;s.peCur+=x}a[l][m].push(h)}}this.adjustE()},adjustE:function(){for(var a=dotManager.lists.ALLDOTS,d=0;d<a.length;d++){var b=a[d];if(0<b.attractStr){var e=b.tempLast+b.peCur-b.peLast;0>e&&(this.eDebt+=10-e,e=10);b.setTemp(e);b.peLast=b.peCur;b.peCur=0}}0<this.eDebt&&this.exactDebt()},exactDebt:function(){for(var a=0.3*dataHandler.avgTemp(),d=dotManager.lists.ALLDOTS,
b=0;b<d.length;b++){var e=d[b],f=e.temp();if(f>a){var k=Math.min(Math.min(f-a,5),this.eDebt);this.eDebt-=k;e.setTemp(f-k);if(0>=this.eDebt)break}}},zeroAllEnergies:function(){for(var a=dotManager.lists.ALLDOTS,d=0;d<a.length;d++)a[d].peLast=0,a[d].keLast=0,a[d].tempLast=0},assignELastAll:function(){for(var a=this.makeGrid(),d=this.gridSize,b=this.xSpan,e=this.ySpan,f=dotManager.lists.ALLDOTS,k=0;k<f.length;k++){var h=f[k];if(0<h.attrStr){h.tempLast=h.temp();for(var l=Math.floor(h.x/d),m=Math.floor(h.y/
d),n=Math.max(l-1,0);n<=Math.min(l+1,b);n++)for(var p=Math.max(m-1,0);p<=Math.min(m+1,e);p++)for(var r=a[n][p].length-1;-1<r;r-=1){var s=a[n][p][r],v=pxToE*V(h.x-s.x,h.y-s.y).mag(),v=Math.max(0,v-h.r-s.r)*pxToE,t=(h.attractRad+s.attractRad)/2,x=t*t*t*t*t,w=(0.97*t+v)*(0.97*t+v)*(0.97*t+v)*(0.97*t+v)*(0.97*t+v),v=-h.attractStrs[s.idNum]*(x*t*t*t/(w*(0.97*t+v)*(0.97*t+v)*(0.97*t+v))-x/w);h.peLast+=v;s.peLast+=v}a[l][m].push(h)}}}});function DataHandler(){this.tConst=tConst}
DataHandler.prototype={temp:function(a){return this.KEAvg(a)*this.tConst},tempFunc:function(a){var d=this;return function(){return d.KEAvg(a)*d.tConst}},countFunc:function(a){var d=this;return function(){return d.count(a)}},count:function(a){return dotManager.get(a).length},RMS:function(a){var d=0;a=dotManager.get(a);for(var b=0;b<a.length;b++)d+=a[b].v.magSqr();return pxToMS*Math.sqrt(d/a.length)},velocities:function(a){a=dotManager.get(a);for(var d=Array(a.length),b=0;b<a.length;b++)d[b]=a[b].v.mag();
return d},velocityAvg:function(a){vList=this.velocities(a);for(var d=a=0;d<vList.length;d++)a+=vList[d];return a/vList.length},KEAvg:function(a){var d=0;a=dotManager.get(a);for(var b=0;b<a.length;b++)d+=a[b].KE();return d/a.length},volume:function(a){return void 0===a?walls.totalVolume():walls.wallVolume(a)},volumeFunc:function(a){var d=this;return function(){return d.volume(a)}}};function WallHandler(a){var d=a?Array(a.pts.length):[];_.extend(d,WallMethods.main,WallMethods.collideMethods);d.defaultCol=Col(255,255,255);a&&(d.assemble(a),a.handles.length!=a.pts.length&&console.log("NAME YOUR WALLS"),a.handlers&&d.doInitHandlers(a.handlers));d.setup();return d}
WallMethods={main:{assemble:function(a){this.removed=!1;var d=a.pts,b=a.handles;this.numWalls=d.length;this.qArrowFill=Col(200,0,0);this.qArrowFillFinal=Col(100,0,0);this.qArrowStroke=Col(255,255,255);var e=defaultTo([],a.bounds),f=defaultTo([],a.vols),k=defaultTo([],a.shows),h=defaultTo([],a.records);a=defaultTo([],a.temps);for(var l=0;l<d.length;l++)this.setWallVals(l,d[l],b[l],e[l],f[l],k[l],h[l],a[l])},setDefaultReadout:function(a){this.defaultReadout=a;return this},unsetDefaultReadout:function(){this.defaultReadout=
void 0;return this},setup:function(){this.gridDim=20;this.xSpan=Math.floor(myCanvas.width/this.gridDim);this.ySpan=Math.floor(myCanvas.height/this.gridDim);this.numCols=Math.ceil(myCanvas.width/this.gridDim);this.numRows=Math.ceil(myCanvas.height/this.gridDim);for(var a=0;a<this.length;a++)this.setupWall(a)},setAllHandler:function(a){for(var d=0;d<this.length;d++)this.setWallHandler(d,a)},pareData:function(){for(var a=0;a<this.length;a++)this[a].pareData()},setWallHandler:function(a,d){var b=this.idxByInfo(a);
/isothermal/i.test(d)&&this[b].isothermalInit();for(var e=0;e<this[b].length;e++)"string"==typeof d?this[b].handlers[e]={obj:this,func:this[d]}:"object"==typeof d&&(this[b].handlers[e]=d)},setSubWallHandler:function(a,d,b){a=this.idxByInfo(a);"string"==typeof b?(this[a][d].isothermal=/isothermal/i.test(b),this[a].handlers[d]={obj:this,func:this[b]}):"object"==typeof b&&(this[a].handlers[d]=b)},getSubWallHandler:function(a,d){return this[this.idxByInfo(a)+"-"+d]},setupWall:function(a){this[a].wallUVs=
this.getWallUV(a);this[a].wallPerpUVs=this.getPerpUVs(a);this[a].wallGrids=this.scatterPts(a)},scatterPts:function(a){var d=this.makeBlankGrid(),b=this[a];b.scatter=Array(b.length-1);var e=b.wallUVs,f=this.gridDim;for(a=0;a<b.scatter.length;a++)for(var k=e[a],h=b[a].distTo(b[a+1]),h=Math.ceil(h/f),l=b[a],m=0;m<h;m++){var n=Math.floor((l.x+k.dx*f*m)/f),p=Math.floor((l.y+k.dy*f*m)/f);(-1!=n||-1!=p)&&d[n][p].push(a)}return d},makeBlankGrid:function(){for(var a=Array(this.numCols+1),d=0;d<this.numCols+
1;d++){for(var b=Array(this.numRows+1),e=0;e<this.numRows+1;e++)b[e]=[];a[d]=b}return a},setWallVals:function(a,d,b,e,f,k,h,l,m,n,p,r){e={min:P(0,e&&e.yMin?e.yMin:30),max:P(0,e&&e.yMax?e.yMax:435)};this[a]=d;_.extend(this[a],WallMethods.wall,WallMethods.wallDataHandler);this[a].handle=b;this[a].hitMode="Std";this[a].vs=this.makeWallVs(d);this[a].bounds=e;this[a].dotManager=n||dotManager;f&&this[a].setVol(f);this[a].col=defaultTo(this.defaultCol,m);this[a].show=defaultTo(!0,k);!1!==p&&this.closeWall(this[a]);
this[a].ptsInit=this.copyWallPts(this[a]);this[a].g=g;this[a].pConst=pConst;this[a].liquids={};this[a].data={};this[a].q=0;this[a].hitThreshold=-15;this[a].handlers=[];this[a].pIntLen=35;this[a].surfAreaAdj={};this[a].eToAdd=0;this[a].isLiquid=!1;this[a].isothermal=!1;this[a].removed=!1;this[a].tSet=l;this[a].massChunks={};this[a].forceInternal=0;this[a].pLastRecord=turn;this[a].isothermalRate=defaultTo(1,r);this[a].boundMaxHandlers=[];this[a].boundMinHandlers=[];this[a].mass=0;this[a].Cp=this[a].setupCp();
this[a].parent=this;makeListenerHolder(this[a],"cleanUp");this[b]=this[a];(h=defaultTo(!0,h))&&this[a].recordDefaults()},addWall:function(a){this.numWalls++;var d=this.length;this.setWallVals(d,a.pts,a.handle,a.bounds,a.vol,a.show,a.record,a.temp,a.col,a.dotManager,a.close,a.isothermalRate);this.setupWall(d);this.setWallHandler(d,a.handler);a.border&&this[d].addBorder(a.border);a.hitMode&&this[d].setHitMode(a.hitMode);return this[d]},makeWallVs:function(a){for(var d=[],b=0;b<a.length;b++)d.push(V(0,
0));d.push(d[0]);return d},setPtsInit:function(){for(var a=0;a<this.length;a++)this[a].ptsInit=this.copyWallPts(this[a])},copyWallPts:function(a){for(var d=a.length,b=Array(d),e=0;e<d;e++)b[e]=a[e].copy();return b},idxByHandle:function(a){for(var d=0;d<this.length;d++)if(a==this[d].handle)return d;console.log("Failed to get wall idx by handle\nHandle:"+a)},idxByInfo:function(a){return parseFloat(a)!=a?this.idxByHandle(a):a},remove:function(){for(var a=this.length-1;0<=a;a-=1)this.removeWall(a);this.removed=
!0;emptyListener(curLevel,"wallMove")},removeWall:function(a){this[a]&&(this.numWalls-=1,this[a].recordAllStop(),this[a].cleanUp(),this[a].removeBorder(),this[a].removed=!0,a=this.idxByInfo(a),this[this[a].handle]=void 0,this.splice(a,1),this.removeHandlers(a))},removeHandlers:function(a){for(var d in this)-1!=d.indexOf(a+"-")&&(this[d]=void 0)},closeWall:function(a){a.push(P(a[0].x,a[0].y))},getPerpUVs:function(a){a=this[a].wallUVs;for(var d=Array(a.length),b=0;b<a.length;b++){var e=a[b];d[b]=V(-e.dy,
e.dx)}return d},getWallUV:function(a){for(var d=this[a].length-1,b=Array(d),e=0;e<d;e++){var f=this[a][e],k=this[a][e+1];b[e]=V(k.x-f.x,k.y-f.y).UV()}return b},check:function(){for(var a=this.gridDim,d=this.xSpan,b=this.ySpan,e=dotManager.lists.ALLDOTS,f=0;f<e.length;f++){var k=e[f],h=[],l=[],m=Math.floor(k.x/a),n=Math.floor(k.y/a),p=Math.max(m-1,0),m=Math.min(m+1,d)+1;a:for(;p<m;p++)for(var r=Math.max(n-1,0),s=Math.min(n+1,b)+1;r<s;r++)for(var v=0;v<this.length;v++)for(var t=this[v].wallGrids[p][r],
x=0;x<t.length;x++){var w=t[x];if(!1===this.haveChecked(v,w,h,l)){if(!0===this[v].checkWallHit(k,w))break a;h.push(v);l.push(w)}}}},haveChecked:function(a,d,b,e){for(var f=0;f<b.length;f++)if(b[f]==a&&e[f]==d)return!0;return!1},getWallsByHandles:function(a){for(var d=[],b=0;b<a.length;b++)d.push(this[a[b]]),d[d.length-1]||console.log("Bad wall handle "+a[b]);return d},wallVolume:function(a){return this.area(this[a].slice(0,this[a].length-1))*vConst},area:function(a){var d=0,b=this.isConvex(a),e=b.multiplier;
if(b.isConvex)return this.areaConvex(a);a=this.splitConcave(a,e);d+=this.area(a[0]);return d+=this.area(a[1])},isConvex:function(a){for(var d=this.getMult(a),b=1;b<a.length-1;b++){var e=this.abcs(a,b),e=this.angleBetweenPts(e.a,e.b,e.c,d);if(e>Math.PI)return{isConvex:!1,multiplier:d}}this.angleBetweenPts(a[a.length-2],a[a.length-1],a[0],d);e=this.angleBetweenPts(a[a.length-1],a[0],a[1],d);return e>Math.PI?{isConvex:!1,multiplier:d}:{isConvex:!0,multiplier:d}},getMult:function(a){var d=Math.PI*(a.length-
2),b=this.getAreaUVs(a),e=this.getIntAngles(a,b,1);a=this.getIntAngles(a,b,-1);if(round(e,2)==round(d,2))return 1;if(round(a,2)==round(d,2))return-1},getAreaUVs:function(a){for(var d=Array(a.length),b=0;b<a.length-1;b++){var e=a[b],f=a[b+1];d[b]=e.VTo(f).UV()}e=a[a.length-1];f=a[0];d[d.length]=e.VTo(f).UV();return d},getIntAngles:function(a,d,b){d=0;for(var e=1;e<a.length-1;e++)d+=this.angleBetweenPts(a[e-1],a[e],a[e+1],b);d+=this.angleBetweenPts(a[a.length-2],a[a.length-1],a[0],b);return d+=this.angleBetweenPts(a[a.length-
1],a[0],a[1],b)},splitConcave:function(a,d){for(var b=Array(a.length+2),e=0;e<a.length;e++)b[e]=a[e];b[b.length-2]=a[0];b[b.length-1]=a[1];for(e=1;e<b.length-1;e++){var f=this.abcs(b,e);if(this.angleBetweenPts(f.a,f.b,f.c,d)>Math.PI)return e==a.length&&(e=0),this.splitAt(b.slice(0,b.length-2),e,d)}},splitAt:function(a,d,b){a=a.slice(d,a.length).concat(a.slice(0,d));b=a[0];for(d=2;d<a.length-1;d++)if(!this.crossesWall(b,a[d],a))return b=a.slice(0,d+1),a=a.slice(0,1).concat(a.slice(d,a.length)),[b,
a]},abcs:function(a,d){return{a:a[d-1],b:a[d],c:a[d+1]}},crossesWall:function(a,d,b){a.VTo(d);for(var e=1;e<b.length;e++){var f,k;e==b.length-1?(f=b[e],k=b[0]):(f=b[e],k=b[e+1]);if(this.linesCross({p1:a,p2:d},{p1:f,p2:k}))return!0}return!1},linesCross:function(a,d){var b=a.p1.VTo(a.p2),e=d.p1.VTo(d.p2),f=b.mag(),k=e.mag(),b=b.UV(),h=e.UV(),e=this.getDist(a,d,b,h,"p1"),b=this.getDist(a,d,b.neg(),h.neg(),"p2");e.da=round(e.da,5);e.db=round(e.db,5);b.da=round(b.da,5);b.db=round(b.db,5);f=round(f,5);
k=round(k,5);return e.da>=f||e.db>=k||b.da>=f||b.db>=k?!1:!0},getDist:function(a,d,b,e,f){"p1"==f?(a=a.p1,d=d.p1):(a=a.p2,d=d.p2);if(0==b.dx&&0==e.dx)return{da:Infinity,db:Infinity};if(0==b.dx)return f=a.x-d.x,f=Math.abs(f/e.dx),b=d.copy().movePt(e.copy().mult(f)),{da:a.distTo(b),db:d.distTo(b)};if(0==e.dx)return f=d.x-a.x,f=Math.abs(f/b.dx),b=a.copy().movePt(b.copy().mult(f)),{da:a.distTo(b),db:d.distTo(b)};if(0==b.dy&&0==e.dy)return{da:Infinity,db:Infinity};if(0==b.dy)return f=a.y-d.y,f=Math.abs(f/
e.dy),b=d.copy().movePt(e.copy().mult(f)),{da:a.distTo(b),db:d.distTo(b)};if(0==e.dy)return f=d.y-a.y,f=Math.abs(f/b.dy),b=a.copy().movePt(b.copy().mult(f)),{da:a.distTo(b),db:d.distTo(b)};f=e.dx*b.dy/b.dx-e.dy;if(0==f)return{da:Infinity,db:Infinity};f=(d.y-a.y-b.dy*d.x/b.dx+a.x*b.dy/b.dx)/f;return{da:(d.x+e.dx*f-a.x)/b.dx,db:f}},angleBetweenPts:function(a,d,b,e){var f=a.VTo(d).UV();a=f.copy().neg();d=d.VTo(b).UV();e=f.copy().add(d).rotate(Math.PI/2*e);a=Math.atan2(a.dy,a.dx);d=Math.atan2(d.dy,d.dx);
e=Math.atan2(e.dy,e.dx);return this.distBetweenAngles(a,e)+this.distBetweenAngles(e,d)},distBetweenAngles:function(a,d){0>a&&(a+=2*Math.PI);0>d&&(d+=2*Math.PI);var b=Math.max(a,d)-Math.min(a,d);return b>Math.PI?2*Math.PI-b:b},areaConvex:function(a){for(var d=0,b=a[0],e=2;e<a.length;e++)d+=b.area(a[e-1],a[e]);return d}}};WallMethods.DataObj=function(){this.srcVal=[];this.idVal;this.typeVal;this.idArgsVal;this.wallHandleVal;this.recordingVal=!1;this.recordStopVal=void 0;this.readoutVal};
WallMethods.DataObj.prototype={id:function(a){a&&(this.idVal=a);return this.idVal},type:function(a){a&&(this.typeVal=a);return this.typeVal},idArgs:function(a){a&&(this.idArgsVal=a);return this.idArgsVal},argsMatch:function(a){return objectsEqual(this.idArgsVal,a)},readout:function(a){a&&(this.readoutVal=a);return this.readoutVal},wallHandle:function(a){a&&(this.wallHandleVal=a);return this.wallHandleVal},src:function(a){a&&(this.srcVal=a);return this.srcVal},recording:function(a){void 0!==a&&(this.recordingVal=
a);return this.recordingVal},recordStop:function(a){a?this.recordStopVal=a:this.recordStopVal&&this.recordingVal&&this.recordStopVal()}};WallMethods.wall={reset:function(){for(var a=this.ptsInit,d=0;d<a.length;d++)this[d].x=a[d].x,this[d].y=a[d].y;for(a=this.forceInternal=0;a<this.vs.length;a++)this.vs[a].zero();this.parent.setupWall(this.parent.indexOf(this))},setVol:function(a){a=this.volToY(a);this[0].position({y:a});this[1].position({y:a})},volToY:function(a){var d=this[2].distTo(this[3]);return this[2].y-a/(vConst*d)},checkWallHit:function(a,d){var b=this.wallUVs[d],e=this.wallPerpUVs[d],f=V(a.x+a.v.dx-e.dx*a.r-this[d].x,a.y+
a.v.dy-e.dy*a.r-this[d].y),f=e.dotProd(f),k=-e.dotProd(a.v);return 0>f&&f>this.hitThreshold&&this.isBetween(a,d,b)?(this["didHit"+this.hitMode](a,d,b,k,e),!0):!1},didHitStd:function(a,d,b,e,f){var k=this.handlers[d];k.func.apply(k.obj,[a,this,d,b,e,f])},isBetween:function(a,d,b){var e=a.v.dotProd(b),f=e*b.dx,k=e*b.dy,e=P(this[d].x+f,this[d].y+k),f=P(this[d+1].x+f,this[d+1].y+k);d=V(-b.dx,-b.dy);e=V(a.x-e.x,a.y-e.y);a=V(a.x-f.x,a.y-f.y);return 0<=e.dotProd(b)&&0<=a.dotProd(d)},didHitArrowDV:function(a,
d,b,e,f){var k=a.v.copy(),h=this.handlers[d];h.func.apply(h.obj,[a,this,d,b,e,f]);d=P(a.x,a.y);b=a.v.copy();a=-f.dotProd(a.v);this.drawArrowV(d,k,b,e,a)},didHitArrowSpd:function(a,d,b,e,f){var k=a.v.copy(),h=this.handlers[d];h.func.apply(h.obj,[a,this,d,b,e,f]);d=P(a.x,a.y);b=a.v.copy();a=-f.dotProd(a.v);this.drawArrowSpd(d,k,b,e,a)},didHitGravity:function(a,d,b,e,f){var k=this.handlers[d];if(0!=b.dx)var h=a.y,l=a.v.dy;k.func.apply(k.obj,[a,this,d,b,e,f]);0!=b.dx&&(d=a.v.dy*a.v.dy+2*gInternal*(a.y-
h),0<=d?a.v.dy=0<a.v.dy?Math.sqrt(d):-Math.sqrt(d):(a.v.dy=-1E-7,a.y=(a.v.dy*a.v.dy-l*l)/(2*gInternal)+h))},drawArrowV:function(a,d,b,e,f){var k=Array(3);k[0]=a.copy().movePt(d.copy().mult(10).neg());k[1]=a.copy();k[2]=a.copy().movePt(b.copy().mult(10));d="drawArrow"+round(a.x,0)+round(a.y,0);new ArrowLine(d,k,Col(255,0,0),50,c);a=a.copy().movePt(b.mult(15));e=(Math.abs(e)+Math.abs(f))*pxToMS;animText.newAnim({pos:a},{pos:a.copy().movePt({dy:-20}),col:curLevel.bgCol},{text:"deltaV = "+round(e,1)+
"m/s",time:3E3})},drawArrowSpd:function(a,d,b,e,f){e=Array(3);e[0]=a.copy().movePt(d.copy().mult(10).neg());e[1]=a.copy();e[2]=a.copy().movePt(b.copy().mult(10));d="drawArrow"+round(a.x,0)+round(a.y,0);new ArrowLine(d,e,Col(255,0,0),50,c);a=a.copy().movePt(b.mult(15));b=0.1*b.mag()*pxToMS;animText.newAnim({pos:a},{pos:a.copy().movePt({dy:-20}),col:curLevel.bgCol},{text:"Speed = "+round(b,1)+"m/s",time:3E3})},changeSetPt:function(a,d,b){if(-1!=d.indexOf("isothermal"))var e="cVIsothermal";else-1!=d.indexOf("adiabatic")&&
(e="cVAdiabatic");removeListener(curLevel,"wallMove","cV"+this.handle);d=a-this[0].y;0!=d&&(d=getSign(d),this.vs[0].dy=b*d,this.vs[1].dy=b*d,this.parent.setSubWallHandler(this.handle,0,e),addListener(curLevel,"wallMove","cV"+this.handle,function(){var b=this[0].y,d=stepTowards(b,a,this.vs[0].dy);this[0].y=d;this[1].y=d;this[this.length-1].y=d;this.parent.setupWall(this.handle);round(b,2)==round(a,2)&&(removeListener(curLevel,"wallMove","cV"+this.handle),this.parent.setSubWallHandler(this.handle,0,
"staticAdiabatic"),this.vs[0].dy=0,this.vs[1].dy=0)},this))},releaseWithBounds:function(a,d,b,e){this.moveStop();removeListener(curLevel,"wallMove","releaseWithBounds"+this.handle);removeListener(curLevel,"wallMove","cP"+this.handle);this.parent.setSubWallHandler(this.handle,0,b);a=defaultTo(0,a);d=defaultTo(Number.MAX_VALUE,d);var f=g,k=this.bounds;addListener(curLevel,"wallMove","releaseWithBounds"+this.handle,function(){var b=this[0].y,l=b+this.vs[0].dy+0.5*f;l<a||l>d?(this.moveStop(),this.parent.setSubWallHandler(this.handle,
0,"staticAdiabatic"),l<a?(e(a),b=a):(e(d),b=d)):l>k.max.y||l<k.min.y?b=this.hitBounds(b,f,k.min.y,k.max.y):(b=l,this.vs[0].dy+=f,this.vs[1].dy+=f);this[0].y=b;this[1].y=b;this[this.length-1].y=b;this.parent.setupWall(this.handle)},this)},moveInit:function(){var a=g,d=this.bounds;addListener(curLevel,"wallMove","cP"+this.handle,function(){var b=this[0].y,e,f=b+this.vs[0].dy+0.5*a;if(f>d.max.y){for(var k=!0,h=0;h<this.boundMaxHandlers.length;h++)this.boundMaxHandlers[h].replacesStd?(e=this.boundMaxHandlers[h].func.apply(this.boundMaxHandlers[h].obj,
[this,f,d.max.y]),k=!1):this.boundMaxHandlers[h].func.apply(this.boundMaxHandlers[h].obj,[this,f,d.max.y]);k&&(e=this.hitBounds(b,a,d.min.y,d.max.y))}else if(f<d.min.y){k=!0;for(h=0;h<this.boundMinHandlers.length;h++)this.boundMinHandlers[h].replacesStd?(e=this.boundMinHandlers[h].func.apply(this.boundMinHandlers[h].obj,[this,f,d.min.y]),k=!1):this.boundMinHandlers[h].func.apply(this.boundMinHandlers[h].obj,[this,f,d.min.y]);k&&(e=this.hitBounds(b,a,d.min.y,d.max.y))}else e=f,this.vs[0].dy+=a,this.vs[1].dy+=
a;this[0].y=e;this[1].y=e;this[this.length-1].y=e;this.parent.setupWall(this.handle)},this)},addBoundHandler:function(a,d){var b=this["bound"+a.toCapitalCamelCase()+"Handlers"];b?b.push(d):console.log("Bad wall bound handler type "+a)},removeBoundHandler:function(a,d){var b=this["bound"+a.toCapitalCamelCase()+"Handlers"];if(b){var e=b.indexOf(d);0<=e&&b.splice(e,1)}else console.log("Bad wall bound handler type "+a)},moveStop:function(){this.vs[0].dy=0;this.vs[1].dy=0;removeListener(curLevel,"wallMove",
"cP"+this.handle);removeListener(curLevel,"wallMove","releaseWithBounds"+this.handle)},hitBounds:function(a,d,b,e){var f=1,k=this.vs[0].dy,h=Math.max(b,Math.min(e,a+k*f+0.5*d*f*f));a=k*k+2*d*(h-a);if(h==e)var l=(-k+Math.sqrt(a))/d;else h==b&&(l=(-k-Math.sqrt(a))/d);this.vs[0].dy+=d*l;this.vs[1].dy+=d*l;this.vs[0].dy*=-1;this.vs[1].dy*=-1;f-=l;k=this.vs[0].dy;-2*k<f*d&&0>k&&(b=Math.abs(2*k/d),f-=Math.floor(f/b)*b);this.vs[0].dy+=d*f;this.vs[1].dy+=d*f;return h+k*f+0.5*d*f*f},setHitMode:function(a){/^[sS]td$/.test(a)||
/^[aA]rrowDV$/.test(a)||/^[aA]rrowSpd$/.test(a)||/^[gG]ravity$$/.test(a)?this.hitMode=a.toCapitalCamelCase():console.log("bad hitMode "+a)},setDefaultReadout:function(a){this.defaultReadout=a;return this},unsetDefaultReadout:function(){this.defaultReadout=void 0;return this},setTemp:function(a){this.tSet=a},getCv:function(){var a=0,d;for(d in window.spcs)var b=dotManager.get({tag:this.handle,spcName:d}),a=a+(b?b.length:0)*spcs[d].cv/N;return a},isothermalInit:function(a){if(a)if("number"==typeof a)this.tSet=
a;else if(/current/i.test(a)){var d=this.getDataSrc("temp");d.length&&(this.tSet=d[d.length-1])}this.eToAdd=0;dotManager.get({tag:this.handle});d=this.data.temp.src();this.isothermal||(addListener(curLevel,"data","recordEnergyForIsothermal"+this.handle,function(){var a;a=this.tSet-(d[d.length-1]||this.tSet);this.eToAdd=this.getCv()*a;for(var e in this.liquids){var f=this.liquids[e],k="setT"+f.handle;removeListener(curLevel,"update",k);var h=this.tSet;a=h-f.temp;if(1<Math.abs(a)){var l=a/15;addListener(curLevel,
"update",k,function(){var a=stepTowards(f.temp,h,l);this.q+=(a-f.temp)*f.Cp*JtoKJ;f.temp=a;a==h&&removeListener(curLevel,"update",k)},this)}}},this),this.recordQ());for(a=0;a<this.length;a++)this[a].isothermal=!0;this.isothermal=!0},isothermalStop:function(){this.isothermal=!1;removeListener(curLevel,"data","recordEnergyForIsothermal"+this.handle)},surfArea:function(){var a=0;for(ptIdx=0;ptIdx<this.length-1;ptIdx++)a+=this[ptIdx].distTo(this[ptIdx+1]);return a},updateMass:function(){var a=0,d;for(d in this.massChunks)a+=
this.massChunks[d];this.mass=a},setMass:function(a,d){this.massChunks[a]=d;this.updateMass();return this},unsetMass:function(a){if(a)delete this.massChunks[a];else for(a in this.massChunks)delete this.massChunk[a];this.updateMass();return this},addLiquid:function(a){this.liquids[a.handle]=a},removeLiquid:function(a){"string"==typeof a&&(a=this.liquids[a]);a&&a.handle&&delete this.liquids[a.handle]},setBounds:function(a,d){var b=this.bounds;d&&(d instanceof Point?b.max=d:b.max.y=d);a&&(a instanceof
Point?b.min=a:b.min.y=a)},addBorder:function(a){a.wall=this;this.border=new WallMethods.Border(a)},removeBorder:function(){this.border&&this.border.remove()},addPts:function(a,d){for(var b=[],e=this.parent.idxByInfo(this.handle),f=a;f<this.length;f++)b.push(this.parent.getSubWallHandler(e,a));this.concat();e=[];for(f=0;f<d.length;f++)e.push(V(0,0));e=[a,0].concat(e);f=[a,0].concat(d);Array.prototype.splice.apply(this,f);Array.prototype.splice.apply(this.vs,e);for(e=a+d.length;e<this.length;e++)this.parent.setSubWallHandler(this.handle,
e,b[e-d.length-a]);b=b[0]||this.parent[id+"-"+(a-1)];for(e=a;e<a+d.length;e++)this.parent.setSubWallHandler(this.handle,e,b);this.parent.setupWall(this.handle);this.border&&!this.border.removed&&this.border.update()},removePts:function(a,d){for(var b=[],e=this.parent.idxByInfo(this.handle),f=a+d;f<this.length;f++)b.push(this.parent.getSubWallHandler(e,f));this.splice(a,d);this.vs.splice(splice,d);for(f=a;f<this.length;f++)this.parent.setSubWallHandler(e,f,b[f-a]);this.parent.setupWall(this.handle);
this.border&&!this.border.removed&&this.border.update()},getPt:function(a){return this[a]},getUV:function(a){return this.wallUVs[a]},getPerpUV:function(a){return this.wallPerpUVs[a]},populateArrows:function(a){var d=this.parent.qArrowFill,b=this.parent.qArrowFillFinal,e=this.parent.qArrowStroke,f=getSign(a),k={"-1":"cw",1:"ccw"}[f];this.turnLastArrow=this.data.q.src().length-1;a=V(110*Math.abs(a),170*Math.abs(a));var h=a.copy();h.dx*=1.4;h.dy*=0.85;var l={"-1":0,1:-h.dx-30};if(7<a.dx||7<a.dy)for(var m=
0;m<this.length-1;m++)if(this[m].isothermal)for(var n=this[m].distTo(this[m+1]),p=Math.round(n/150),r=n/=p+1,s=0;s<p;s++){var v=this[m].copy().movePt(this.wallUVs[m].copy().mult(r)).movePt(this.wallPerpUVs[m].copy().mult(l[f]));new ArrowFly({pos:v,dist:30,UV:this.wallUVs[m].copy().perp(k),fill:d,fillFinal:b,stroke:e,dims:a,dimsFinal:h,lifespan:3500});r+=n}},cleanUp:function(){var a=this.cleanUpListeners,d;for(d in a){var b=a[d];b.func.apply(b.obj)}}};
WallMethods.BoundHandler=function(a,d,b){this.func=a;this.obj=d;this.replacesStd=b};WallMethods.wallDataHandler={setupCp:function(){for(var a=this.handle,d=[],b=[],e=0;e<LevelData.spcDefs.length;e++){var f=dotManager.get({tag:a,spcName:LevelData.spcDefs[e].spcName});f&&(d.push(f),b.push(LevelData.spcDefs[e].cv/N))}return function(){for(var a=0,e=0;e<d.length;e++)a+=d[e].length*b[e];return a}},pExt:function(){return this.pConst*this.mass*this.g/(this[1].x-this[0].x)},pInt:function(){var a=this.surfArea(),d;for(d in this.surfAreaAdj)a+=this.surfAreaAdj[d].val;a=this.pConst*this.forceInternal/
((turn-this.pLastRecord)*a);this.forceInternal=0;this.pLastRecord=turn;this.pIntList[this.pIntIdx]=a;this.pIntIdx++;this.pIntIdx==this.pIntLen&&(this.pIntIdx=0);return this.pIntList.average()},addSurfAreaAdjust:function(a){this.surfAreaAdj[a]={val:0};return this.surfAreaAdj[a]},removeSurfAreaAdjust:function(a){delete this.surfAreaAdj[a]},getDataObj:function(a,d,b){if(this.data[a])if(this.data[a]instanceof Array)for(b=0;b<this.data[a].length;b++){if(this.data[a][b].argsMatch(d))return this.data[a][b]}else return this.data[a];
else!0!==b&&(console.log('Tried to get bad data type "'+a+'" with args'),console.log(d));return!1},getDataSrc:function(a,d,b){if(this.data[a])if(this.data[a]instanceof Array)for(b=0;b<this.data[a].length;b++){if(this.data[a][b].argsMatch(d))return this.data[a][b].srcVal}else return this.data[a].srcVal;else b||(console.log('Tried to get bad data type "'+a+'" with args'),console.log(d));return!1},removeDataObj:function(a,d){if(this.data[a])if(this.data[a]instanceof Array){for(var b=0;b<this.data[a].length;b++)if(this.data[a][b].argsMatch(d))return this.data[a].splice(b,
1);console.log("Couldn't find data "+a+" with args "+d)}else return delete this.data[a]},pareData:function(){for(var a in this.data){var d=this.data[a];if(d instanceof Array)for(var b=0;b<d.length;b++)600<d[b].srcVal.length&&d[b].srcVal.splice(0,d[b].srcVal.length-300);else 600<d.srcVal.length&&d.srcVal.splice(0,d.srcVal.length-300)}},createSingleValDataObj:function(a,d,b){var e=new WallMethods.DataObj;b?this.data[a]?this.data[a].push(e):this.data[a]=[e]:this.data[a]=e;this.setupStdDataObj(e,a);e.recordStop(function(){});
e.srcVal=[d()];return e},recordDefaults:function(){this.recordTime();this.recordTemp();this.recordPInt();this.recordVol()},recordTime:function(){this.data.time=new WallMethods.DataObj;var a=this.data.time;this.setupStdDataObj(a,"time");var d=Date.now();recordData(a.id()+a.wallHandle(),a.src(),function(){return(Date.now()-d)/1E3},this,"update")},recordTemp:function(a){var d=this.data.temp;if(!d||!d.recording()){this.data.temp=new WallMethods.DataObj;d=this.data.temp;this.setupStdDataObj(d,"temp");
var b=this.dotManager.getWithLog({tag:this.handle});a||(a=function(){for(var a=0,d=0;d<b.length;d++)a+=b[d].KE();return b.length?tConst*a/b.length:0});recordData(d.id()+d.wallHandle(),d.src(),a,this,"update")}return this},recordRMS:function(){},getRMSMass:function(a){if(a)for(var d in spcs)for(var b=spcs[d].dots,e=0;e<b.length;e++)if(a){if(b[e].tag==a)return b[e].m}else return b[e].m},recordPInt:function(){var a=this.data.pInt;if(!a||!a.recording())this.data.pInt=new WallMethods.DataObj,a=this.data.pInt,
this.setupStdDataObj(a,"pInt"),this.pIntList=[],this.pIntIdx=0,recordData(a.id()+a.wallHandle(),a.src(),this.pInt,this,"update");return a},recordPExt:function(){var a=this.data.pExt;if(!a||!a.recording())this.data.pExt=new WallMethods.DataObj,a=this.data.pExt,this.setupStdDataObj(a,"pExt"),recordData(a.id()+a.wallHandle(),a.src(),this.pExt,this,"update");return a},recordVol:function(){var a=this.data.vol;if(!a||!a.recording())this.data.vol=new WallMethods.DataObj,a=this.data.vol,this.setupStdDataObj(a,
"vol"),recordData(a.id()+a.wallHandle(),a.src(),function(){return this.parent.wallVolume(this.handle)},this,"update");return a},recordWork:function(){var a=this.data.work;if(!a||!a.recording()){this.data.work=new WallMethods.DataObj;a=this.data.work;this.setupStdDataObj(a,"work");this.work=0;var d=LtoM3,b=PUNITTOPA,e=JtoKJ,f=this,k=this.getDataObj("vol").src();recordData(a.id()+a.wallHandle(),a.src(),function(){var a=k.length,a=d*(k[a-1]-k[a-2]);if(isNaN(a))return f.work=0;var l=f.pExt()*b;f.work-=
e*l*a;return f.work},this,"update")}return a},recordMass:function(){var a=this.data.mass;if(!a||!a.recording())this.data.mass=new WallMethods.DataObj,a=this.data.mass,this.setupStdDataObj(a,"mass"),recordData(a.id()+a.wallHandle(),a.src(),function(){return this.mass},this,"update");return a},recordQ:function(){var a=this.data.q;if(!a||!a.recording())this.data.q=new WallMethods.DataObj,a=this.data.q,this.setupStdDataObj(a,"q"),recordData(a.id()+a.wallHandle(),a.src(),function(){return this.q},this,
"update");return a},recordEnthalpy:function(){return this.recordEnergy("enthalpy","cp","hF298")},recordInternalEnergy:function(){return this.recordEnergy("internalEnergy","cv","uF298")},recordEnergy:function(a,d,b){var e=[],f=[],k=[],h=[],l=[],m=this.data[a];if(!m||!m.recording()){this.data[a]=new WallMethods.DataObj;m=this.data[a];this.setupStdDataObj(m,a);var n=this.getDataSrc("temp");if(this.isLiquid){for(a=0;a<LevelData.spcDefs.length;a++)if(void 0!==LevelData.spcDefs[a][b]&&void 0!==LevelData.spcDefs[a].cpLiq){var p=
this.dotManager.get({tag:this.handle,spcName:LevelData.spcDefs[a].spcName});l.push(p);f.push(1E3*LevelData.spcDefs[a][b]/N);k.push(1E3*LevelData.spcDefs[a].hVap298/N);h.push(LevelData.spcDefs[a].cpLiq/N)}d=function(){for(var a=0,b=0,d=n[n.length-1]-298.15,e=0;e<l.length;e++)a+=l[e].length*(f[e]+h[e]*d-k[e]),b+=l[e].length;return a*N/b}}else{for(a=0;a<LevelData.spcDefs.length;a++)p=this.dotManager.get({tag:this.handle,spcName:LevelData.spcDefs[a].spcName}),l.push(p),f.push(1E3*LevelData.spcDefs[a][b]/
N),e.push(LevelData.spcDefs[a][d]/N);d=function(){for(var a=0,b=0,d=n[n.length-1]-298.15,h=0;h<l.length;h++)a+=l[h].length*(f[h]+e[h]*d),b+=l[h].length;return a*N/b}}recordData(m.id()+m.wallHandle(),m.src(),d,this,"update")}return m},recordVDist:function(a){var d=this.dotManager.createIfNotExists(a);this.data.vDist||(this.data.vDist=[]);if(!this.getDataObj("vDist",a)){this.data.vDist.push(new WallMethods.DataObj);var b=this.data.vDist[this.data.vDist.length-1];this.setupInfoDataObj(b,"vDist",a);recordData(b.id()+
b.wallHandle(),b.src(),function(){for(var a=[],b=0;b<d.length;b++)a.push(d[b].speed());return a},this,"update")}},recordMoles:function(a){var d,b=this.dotManager.createIfNotExists(a);this.data.moles||(this.data.moles=[]);this.getDataObj("moles",a)?d=this.getDataObj("moles",a):(this.data.moles.push(new WallMethods.DataObj),d=this.data.moles[this.data.moles.length-1],this.setupInfoDataObj(d,"moles",a),recordData(d.id()+d.wallHandle(),d.src(),function(){return b.length/N},this,"update"));return d},recordFrac:function(a){var d,
b=this.dotManager.createIfNotExists(a),e=this.dotManager.createIfNotExists(a.tag?{tag:a.tag}:void 0);this.data.frac||(this.data.frac=[]);this.getDataObj("frac",a)?d=this.getDataObj("frac",a):(this.data.frac.push(new WallMethods.DataObj),d=this.data.frac[this.data.frac.length-1],this.setupInfoDataObj(d,"frac",a),recordData(d.id()+d.wallHandle(),d.src(),function(){return b.length/(e.length||1)},this,"update"));return d},setupStdDataObj:function(a,d){a.recording(!0);a.recordStop(this.recordStop);a.id(d);
a.type(d);a.wallHandle(this.handle)},setupInfoDataObj:function(a,d,b){a.recording(!0);a.recordStop(this.recordStopDestroy);a.id(d+(b.spcName||"").toCapitalCamelCase()+(b.tag||"").toCapitalCamelCase());a.wallHandle(this.handle);a.type(d);a.idArgs(b)},recordStopDestroy:function(){this.recording(!1);walls[this.wallHandle()].removeDataObj(this.type(),this.idArgs());recordDataStop(this.id()+this.wallHandle())},recordStop:function(){this.recording(!1);recordDataStop(this.id()+this.wallHandle())},recordAllStop:function(){for(var a in this.data){var d=
this.data[a];if(d instanceof Array)for(var b=0;b<d.length;b++)d[b].recordStop();else d.recordStop()}return this},resetWork:function(){this.work=0;return this},resetQ:function(){this.q=0;return this},displayQArrowsRate:function(a){a=a.threshold;if(this.data.q.recording()&&(!this.data.qArrowsRate||!this.data.qArrowsRate.recording())&&(!this.data.qArrowsAmmt||!this.data.qArrowsAmmt.recording())){this.data.qArrowsRate=new WallMethods.DataObj;var d=this.data.qArrowsRate;d.displaying(!0);d.wallHandle(this.handle);
d.id("qArrowsRate");this.turnLastArrow=Math.max(0,this.data.q.length-1);this.qArrowThreshold=defaultTo(a,0.3);var b="checkForDisplayArrows"+d.wallHandle(),e=this;qSrc=this.data.q.src();addListener(curLevel,"update",b,function(){e.checkDisplayArrows(qSrc)},this);this.turnLastArrow=turn;addListener(this,"cleanUp","qArrowsRate",function(){removeListener(curLevel,"update",b);removeListenerByName(curLevel,"update","ArrowFly")})}else console.log("Tried to display q arrowsRate for wall "+this.handle+" while not recording or already displaying.  Will not display."),
console.trace()},makeDataList:function(){var a=[];a.displaying=!1;a.recording=!1;return a},resetQ:function(){this.q=0;this.displayingQArrowsAmmt&&(this.displayQArrowsAmmtStop(),this.displayQArrowsAmmt(this.qArrowAmmtMax))},resetWork:function(){this.work=0},checkDisplayArrows:function(a){a=a[a.length-1]-a[this.turnLastArrow];Math.abs(a)>this.qArrowThreshold&&(this.populateArrows(a),this.turnLastArrow=turn)}};WallMethods.collideMethods={cPAdiabaticDamped:function(a,d,b,e,f,k){e=a.temp();k=0.5*a.m*(a.v.dx*a.v.dx+a.v.dy*a.v.dy);a.v.copy();var h=a.v.dy,l=d.vs[b].dy,m=a.m,n=d.mass,p=Math.abs(l);if(1<p){b=h*h;var r=l*l,p=0.0017*p*p*p-0.0281*p*p+0.205*p+0.8466,s=p*p,v=m*(1+m/(s*n)),t=-2*m*(h*m/n+l)/s;b=(-t+Math.sqrt(t*t-4*v*((m*(m*b/n+2*l*h)+n*r)/s-m*b-n*r)))/(2*v);a.y+=a.r;d.vs[0].dy=(m*h+n*l-m*b)/(n*p);d.vs[1].dy=d.vs[0].dy}else r=d[b],b=(h*(m-n)+2*n*l)/(a.m+n),d.vs[0].dy=(l*(n-m)+2*m*h)/(n+m),d.vs[1].dy=
d.vs[0].dy,a.y=r.y+a.r;h=0.5*a.m*(a.v.dx*a.v.dx+b*b);k=Math.sqrt((k+2*(h-k)/3)/h);b*=k;a.v.dx*=k;a.setTemp(e+(0.5*tConst*a.m*(a.v.dx*a.v.dx+b*b)-e)*a.cvKinetic/a.cv);0>a.v.dy*b&&(a.v.dy*=-1);d.forceInternal+=a.m*(Math.abs(f)+Math.abs(a.v.dy))},cPAdiabatic:function(a,d,b,e,f,k){d=a.temp();a.v.copy();e=a.v.dy;k=wall.vs[b].dy;var h=a.m,l=wall.mass,m=wall[b];b=(e*(h-l)+2*l*k)/(a.m+l);wall.vs[0].dy=(k*(l-h)+2*h*e)/(l+h);wall.vs[1].dy=wall.vs[0].dy;a.y=m.y+a.r;e=Math.sqrt((KEO+2*(KEF-KEO)/3)/KEF);b*=e;
a.v.dx*=e;a.setTemp(d+(0.5*tConst*a.m*(a.v.dx*a.v.dx+b*b)-d)*a.cvKinetic/a.cv);0>a.v.dy*b&&(a.v.dy*=-1);wall.forceInternal+=a.m*(Math.abs(f)+Math.abs(a.v.dy))},staticAdiabatic:function(a,d,b,e,f,k){this.reflect(a,e,f);d.forceInternal+=2*a.m*Math.abs(f)},cVIsothermal:function(a,d,b,e,f,k){if(d.eToAdd){k=getSign(d.eToAdd);b=a.temp();k*=Math.min(Math.abs(d.eToAdd),20*a.cv*d.isothermalRate);0>k&&b<=20*d.isothermalRate&&(k=-Math.max(0,b-1)*a.cv);d.eToAdd-=k;var h=b+k/a.cv,l=Math.sqrt(h/b),m=f*l;this.reflect(a,
e,f);a.v.dx*=l;a.v.dy*=l;a.internalPotential*=h/b;d.forceInternal+=a.m*(Math.abs(f)+Math.abs(m));d.q+=k*JtoKJ}else d.forceInternal+=2*a.m*Math.abs(f),this.reflect(a,e,f)},cVAdiabatic:function(a,d,b,e,f,k){a.v.dy=-a.v.dy+2*d.vs[b].dy},reflect:function(a,d,b){a.v.dx-=2*d.dy*b;a.v.dy+=2*d.dx*b;a.x-=d.dy;a.y+=d.dx},outlet:function(a){dotManager.remove(a)}};WallMethods.Border=function(a){this.wall=a.wall;this.type=a.type;this.yMin=void 0!==a.yMin?a.yMin:this.wall[0].y;this.col=a.col||this.wall.col.copy().adjust(-100,-100,-100);this.thick=a.thickness||5;this.update=this.pickGenerator(this.type);this.update();this.removed=!1};
WallMethods.Border.prototype={remove:function(){this.removed=!0;removeListener(curLevel,"update",this.listenerName)},pickGenerator:function(a){if("open"==a)return this.genOpen();if("wrap"==a)return this.genWrap()},genOpen:function(){return this.genBorder(this.thick,this.col,1,"end",!0)},genWrap:function(){return this.genBorder(this.thick,this.col,0,"end",!1)},genBorder:function(a,d,b,e,f){var k=this,h=c;this.listenerName="drawBorder"+this.wall.handle.toCapitalCamelCase();return function(){k.remove();
var l=k.genSegs(b,e,a,f);addListener(curLevel,"update",k.listenerName,function(){for(var a=0;a<l.length;a++)draw.fillPts(l[a],d,h)});k.removed=!1}},genSegs:function(a,d,b,e){var f=[];d="end"==d?this.wall.length-1:d;for(var k=a;k<d;k++){var h=this.wall.wallPerpUVs[k].copy().neg(),l=this.wall[k].copy(),m=this.wall[k+1].copy(),n=k+1==d?0:k+1,p;p=this.getExtendV(h,this.wall[k-1]?k-1:this.wall.length-2,a-1,b,e);h=this.getExtendV(h,n,0,b,e);h=m.copy().movePt(h);p=l.copy().movePt(p);"open"==this.type&&(k==
a?(l.y=this.yMin,p.y=this.yMin):k==d-1&&(m.y=this.yMin,h.y=this.yMin));f.push([l,m,h,p])}return f},getExtendV:function(a,d,b,e,f){var k=this.wall.wallPerpUVs[d].copy().neg();d=f&&d==b?a.copy():k.add(a).UV();a=a.dotProd(d);return d.mult(e/a)}};function ButtonManager(a){this.wrapperDivId=a;this.groups=[]}
ButtonManager.prototype={addGroup:function(a,d,b,e,f){var k=$("#"+this.wrapperDivId),h="group"+a,l=h+"Wrapper",m=h+"Padder",n=templater.div({attrs:{id:[h],"class":["buttonGroup"]}}),n=d+templater.br()+n,l=templater.div({attrs:{id:[l],handle:[a],"class":["buttonManagerElem","displayText","buttonGroupWrapper"]},innerHTML:n}),m=templater.div({attrs:{id:[m],handle:[a],"class":["buttonManagerElem","buttonGroupPadder"]},innerHTML:l});k.append(m);this.groups.push(new ButtonManager.Group(k,h,a,d,b,e,f))},
removeGroup:function(a){var d=this.getGroup(a);d?(a=this.groups.indexOf(d),d=this.getGroupDiv(d),this.groups.splice(a,1),d.remove()):console.log("Bad group handle "+a)},removeButton:function(a,d){var b=this.getGroup(a);b?b.removeButton(d):console.log("Bad group handle "+a)},getGroupDiv:function(a){for(var d=$("#"+this.wrapperDivId).children(),b=0;b<d.length;b++)if($(d[b]).attr("handle")==a.handle)return $(d[b])},arrangeGroupWrappers:function(){var a=this.arrangeObjs(this.groups);this.arrangeHTML($("#"+
this.wrapperDivId),a)},arrangeAllGroups:function(){for(var a=0;a<this.groups.length;a++)this.arrangeGroup(this.groups[a].handle)},arrangeGroup:function(a){var d=this.getGroup(a);d?(a=this.arrangeObjs(d.buttons),this.arrangeHTML($("#"+d.groupId),a)):console.log("Bad group name "+a)},setButtonWidth:function(){for(var a=$("button.buttonManagerElem"),d=100,b=0;b<a.length;b++)var e=a[b],d=Math.max(d,$(e).outerWidth());for(b=0;b<a.length;b++)e=a[b],$(e).css("width",d)},arrangeHTML:function(a,d){for(var b=
a.children(),e=!1,f=0;f<b.length;f++){var k=b[f],h=d[f],k=$(k).attr("handle");if(e=Math.max(e,k!=h.handle))break}if(e){e={};for(f=0;f<b.length;f++)k=b[f],e[$(k).attr("handle")]=$(k).clone(!0);a.html("");for(b=0;b<d.length;b++)a.append(e[d[b].handle])}},addButton:function(a,d,b,e,f,k){var h=this.getGroup(a);h?h.addButton(d,b,e,f,k):console.log("Bad group handle "+a)},getGroup:function(a){for(var d=0;d<this.groups.length;d++)if(this.groups[d].handle==a)return this.groups[d]},arrangeObjs:function(a){var d=
[];a=this.sortObjs(a.concat());var b=this.slicePrefs(a);a=this.sliceNoPrefs(a);for(var e=0;e<b.length;e++){var f=b[e].prefIdx;d[f]?d.push(b[e]):d[f]=b[e]}for(e=b=0;b<a.length;)void 0==d[e]&&(d[e]=a[b],b++),e++;for(e=d.length-1;0<=e;e--)void 0==d[e]&&d.splice(e,1);return d},sortObjs:function(a){for(var d=0;d<a.length;d++)for(var b=0;b<a.length-1;b++)if(a[b].prefIdx>a[b+1].prefIdx||void 0==a[b].prefIdx){var e=a[b];a[b]=a[b+1];a[b+1]=e}return a},slicePrefs:function(a){for(var d=0;d<a.length;d++)if(void 0==
a[d].prefIdx)return a.slice(0,d);return a.slice(0,a.length)},sliceNoPrefs:function(a){for(var d=0;d<a.length;d++)if(void 0==a[d].prefIdx)return a.slice(d,a.length);return[]}};ButtonManager.Group=function(a,d,b,e,f,k,h){this.mgrDiv=a;this.groupId=d;this.handle=b;this.label=e;this.prefIdx=f;this.buttons=[];this.isRadio=k;this.isToggle=h&&!k};
ButtonManager.Group.prototype={addButton:function(a,d,b,e,f,k){var h=a+"Button",l=a+"Wrapper";this.buttons.push(new ButtonManager.Button(a,h,l,d,b,e,k));d=templater.button({innerHTML:d,attrs:{id:[h],"class":["buttonManagerElem","buttonManagerButton"],handle:[a]}});a=templater.div({innerHTML:d,attrs:{id:[l],"class":["buttonManagerElem","buttonWrapper"],handle:[a]}});$("#"+this.groupId).append(a);h=$("button#"+h);addJQueryElems(h,"button");a=this.buttons[this.buttons.length-1];l=a.click;d=a.mousedown;
b=a.mouseup;this.isRadio?l=this.wrapInRadio(a,l):this.isToggle&&(l=this.wrapInToggle(a,l));f&&l&&l();f&&this.isRadio?this.pushRadio(a):f&&this.isToggle&&this.toggleButton(a);l&&$(h).click(l);d&&$(h).mousedown(d);b&&$(h).mouseup(b)},removeButton:function(a){a=this.getButton(a);this.getButtonDiv(a).remove();this.buttons.splice(this.buttons.indexOf(a),1)},wrapInRadio:function(a,d){var b=d,e=this;return function(){e.pushRadio(a);b()}},wrapInToggle:function(a,d){var b=d,e=this;return function(){e.toggleButton(a);
b()}},pushRadio:function(a){for(var d=0;d<this.buttons.length;d++)$("#"+this.buttons[d].buttonId).removeClass("ui-button-as-radio-selected");$("#"+a.buttonId).addClass("ui-button-as-radio-selected")},toggleButton:function(a){a=$("#"+a.buttonId);a.hasClass("ui-button-as-radio-selected")?a.removeClass("ui-button-as-radio-selected"):a.addClass("ui-button-as-radio-selected")},getButton:function(a){for(var d=0;d<this.buttons.length;d++)if(this.buttons[d].handle==a)return this.buttons[d];console.log("Bad button handle "+
a)},getButtonDiv:function(a){for(var d=$("#"+this.groupId).children(),b=0;b<d.length;b++)if($(d[b]).attr("handle")==a.handle)return $(d[b])}};ButtonManager.Button=function(a,d,b,e,f,k,h){this.handle=a;this.buttonId=d;this.wrapperId=b;this.label=e;this.click;this.mousedown;this.mouseup;f.mousedown||f.mouseup?(f.mousedown&&(this.mousedown=this.wrapExprs(f.mousedown)),f.mouseup&&(this.mouseup=this.wrapExprs(f.mouseup))):this.click=this.wrapExprs(f);this.prefIdx=k};
ButtonManager.Button.prototype={wrapExprs:function(a){if("function"==typeof a)return a;a=a instanceof Array?a.join(";")+";":a+";";with(DataGetFuncs)a=eval("(function() {"+a+"})");return a}};function QuizRenderer(){this.hoverCol=Col(0,81,117);this.selectedCol=Col(40,121,147)}
QuizRenderer.prototype={render:function(a,d){var b=new QuizRenderer.Quiz(a);if(this.checkQuizTyping(b)){var e=templater.div({attrs:{id:["quizWrapper"]}}),f=templater.div({attrs:{id:["quizContent"],"class":["niceFont","whiteFont"]}}),k=templater.div({attrs:{id:["quizFooter"]}});$(d).append(e);e=$("#quizWrapper");$(e).append(f);$(e).append(k);f=$("#quizContent");k=$("#quizFooter");for(e=0;e<b.questions.length;e++)this.renderQuestion(b.questions[e],f);a[0]&&"setVals"==a[0].type?this.appendButtons(k,
function(){sceneNavigator.prevPrompt()},function(){sceneNavigator.refresh()},"Back","Set values"):this.appendButtons(k,function(){sceneNavigator.prevPrompt()},function(){sceneNavigator.nextPrompt()},"Back","Submit");return b}},checkQuizTyping:function(a){a=a.questions;for(var d=!1,b=!1,e=0;e<a.length;e++)"setVals"==a.type?d=!0:b=!0;return d&&b?(console.log("Bad quiz typing.  Can't mix setVals with others"),!1):!0},renderQuestion:function(a,d){"multChoice"==a.type?this.renderMultChoice(a,d):"text"==
a.type?this.renderTextBox(a,d,3,50):"textSmall"==a.type?this.renderTextBox(a,d,1,10):"setVals"==a.type&&this.renderTextBox(a,d,1,10)},renderMultChoice:function(a,d){for(var b=a.options,e=void 0===a.questionText?"":interpreter.interp(a.questionText)+templater.br(),e=e+"<div style = 'padding-top:4px;'>",f=0;f<b.length;f++)var k=b[f],e=e+templater.div({attrs:{id:[a.storeAs+String(f)],"class":["multChoiceBlock"]},innerHTML:k.text});d.append(e+"</div>");for(f=0;f<b.length;f++)k=b[f],k.div=$("#"+a.storeAs+
String(f));this.bindMultChoiceQuestion(a)},bindMultChoiceQuestion:function(a){var d=this,b=a.options,e=function(e){var f=b[e];a.answered=!0;if(!f.selected){for(var l=0;l<b.length;l++)b[l]!=f&&(b[l].div.css("background-color","transparent"),b[l].selected=!1);f.selected=!0;store(a.storeAs,e);a.hasCorrectAnswer()?a.correct=f.correct?!0:!1:a.correct=!0;$(f.div).css("background-color",d.selectedCol.hex)}};void 0!==getStore(a.storeAs)&&e(getStore(a.storeAs));for(var f=0;f<a.options.length;f++)this.bindMultChoiceOption(a,
e,a.options,a.options[f])},bindMultChoiceOption:function(a,d,b,e){var f=this;e.div.click(function(){d(b.indexOf(e))});e.div.hover(function(){e.selected||$(this).css("background-color",f.hoverCol.hex)},function(){e.selected||$(this).css("background-color","transparent")})},renderTextBox:function(a,d,b,e){var f=a.storeAs,k=defaultTo("Type your answer here.",a.boxText);textareaHTML=templater.textarea({attrs:{id:[f],rows:[b],cols:[e],placeholder:[k]}});b=(void 0===a.questionText?"":interpreter.interp(a.questionText)+
templater.br())+templater.table({attrs:{"class":["niceFont","whiteFont"]},innerHTML:templater.tr({innerHTML:templater.td({innerHTML:a.label})+templater.td({innerHTML:"&#32;&#32;"})+templater.td({innerHTML:textareaHTML})+templater.td({innerHTML:a.units||""})})});d.append(b);a.div=$("#"+f);var h=function(b){b=void 0!==b?b:a.div.val();""!=b&&(store(a.storeAs,b),a.answered=!0,a.hasCorrectAnswer()?0.05>fracDiff(parseFloat(a.answer),parseFloat(val))?a.correct=!0:a.correct=!1:a.correct=!0)};getStore(a.storeAs)&&
(h(getStore(a.storeAs)),a.div.html(getStore(a.storeAs)));a.div.change(function(){h()})},appendButtons:function(a,d,b,e,f){e=templater.button({attrs:{id:["quizButtonLeft"]},innerHTML:e})+templater.button({attrs:{id:["quizButtonRight"]},innerHTML:f});e=templater.div({attrs:{id:["quizSubmitWrapper"]},style:{"float":"right"},innerHTML:e});$(a).append(e);$("#quizButtonLeft").click(d);$("#quizButtonRight").click(b);addJQueryElems($("#quizButtonLeft"),"button");addJQueryElems($("#quizButtonRight"),"button");
$(a).css("min-height",$("#quizButtonLeft").height()+5+"px")}};QuizRenderer.Quiz=function(a){this.questions=[];for(var d=0;d<a.length;d++)this.questions.push(new QuizRenderer.Question(a[d]))};
QuizRenderer.Quiz.prototype={allAnswered:function(){for(var a=0;a<this.questions.length;a++)if(!this.questions[a].answered)return!1;return!0},allCorrect:function(){for(var a=0;a<this.questions.length;a++)if(!this.questions[a].correct)return!1;return!0},fireAlertWrong:function(){for(var a=0;a<this.questions.length;a++){var d=this.questions[a];if(d.hasCorrectAnswer()&&!d.correct)if("multChoice"==d.type)for(var b=0;b<d.options.length;b++){if(d.options[b].selected&&d.options[b].message){alert(d.options[b].message);
return}}else if(d.message){alert(d.message);break}}},sendAnswersToCW:function(){for(var a=0;a<this.questions.length;a++)this.questions[a].sendAnswerToCW()}};
QuizRenderer.Question=function(a){this.type=a.type;this.label=this.getQuestionLabel(a.label,this.CWQuestionId);this.boxText=defaultTo(a.text,a.boxText);this.CWQuestionId=a.CWQuestionId;this.questionText=this.getQuestionText(a.questionText||a.preText,this.CWQuestionId);this.units=a.units;this.message=a.message;this.storeAs=a.storeAs;this.options=this.makeOptions(a.options);this.answered=!1;this.answer=a.answer;this.correct=!1;this.div=void 0};
QuizRenderer.Question.prototype={makeOptions:function(a){if(a){for(var d=[],b=0;b<a.length;b++)d.push(new QuizRenderer.MultChoiceOption(a[b],this.CWQuestionId));return d}},getQuestionText:function(a,d){if(void 0===d)return a;var b=new XMLHttpRequest;if(/^(http|https)/.test(document.URL)){var e=window.stringTogetherGET({"goto":"simulation",command:"get_question_text",question_id:d});b.open("GET","CW.php?"+e);b.send(null)}return b.responseText?atob(b.responseText):a},getQuestionLabel:function(a,d){if(void 0===
d)return a;var b=new XMLHttpRequest;if(/^(http|https)/.test(document.URL)){var e=window.stringTogetherGET({"goto":"simulation",command:"get_question_label",question_id:d});b.open("GET","CW.php?"+e);b.send(null)}return requiest.responseText?atob(b.responseText):defaultText},hasCorrectAnswer:function(){if(("text"==this.type||"textSmall"==this.type||"setVals"==this.type)&&void 0!==this.answer)return!0;if("multChoice"==this.type)for(var a=0;a<this.options.length;a++)if(this.options[a].correct)return!0;
return!1},sendAnswerToCW:function(){var a=new XMLHttpRequest,d;if("text"==this.type||"textSmall"==this.type||"setVals"==this.type)d=getStore(this.storeAs),d=btoa(d),/^(http|https)/.test(document.URL)&&(d=window.stringTogetherGET({"goto":"simulation",command:"send_answer",question_id:this.CWQuestionId,answer_text_64:d}),a.open("GET","CW.php?"+d),a.send(null));else if("multChoice"==this.type)for(var b=0;b<this.options.length;b++)this.options[b].selected&&(void 0!==this.options[b].CWAnswerId&&/^(http|https)/.test(document.URL))&&
(d=window.stringTogetherGET({"goto":"simulation",command:"send_answer",question_id:this.CWQuestionId,answer_id:this.options[b].CWanswerId}),a.open("GET","CW.php?"+d),a.send(null))}};QuizRenderer.MultChoiceOption=function(a,d){this.CWAnswerId=a.CWAnswerId;this.correct=a.correct||!1;this.text=this.getAnswerText(a.text,d,this.CWAnswerId);this.selected=!1;this.message=a.message;this.div=void 0};
QuizRenderer.MultChoiceOption.prototype={getAnswerText:function(a,d,b){if(void 0===d||void 0===b)return a;var e=new XMLHttpRequest;d=window.stringTogetherGET({"goto":"simulation",command:"get_answer_text",question_id:d,answer_id:b});/^(http|https)/.test(document.URL)&&(e.open("GET","CW.php?"+d),e.send(null));return e.responseText?atob(e.responseText):a}};function ActivationEnergySpcChanger(a){this.collideHandler=a;this.pairs={};this.active=!1;this.standardBreakUp=this.collideHandler.breakUp;this.breakUpFunc=this.makeBreakUpFunc()}
ActivationEnergySpcChanger.prototype={addPair:function(a){var d=a.spcNameLow,b=a.spcNameHigh;this.pairs[d]||this.pairs[b]?console.log("Trying to add another energy threshold to either "+d+" or "+b):(this.pairs[a.spcNameLow]=a,this.pairs[a.spcNameHigh]=a,this.active||this.addActiveEBreakUp())},removePair:function(a){delete this.pairs[a.spcNameLow];delete this.pairs[a.spcNameHigh];countAttrs(this.pairs)||(this.active=!1,this.restoreBreakUp())},addActiveEBreakUp:function(){this.collideHandler.breakUp=
this.breakUpFunc},restoreBreakUp:function(){this.collideHandler.breakUp=this.standardBreakUp},makeBreakUpFunc:function(){var a=this;return function(d,b,e){var f,k=a.pairs[d.spcName],h=a.pairs[b.spcName];k&&(f=d.kineticEnergy(),k.activationEnergy>=f&&d.spcName==k.spcNameHigh?dotManager.changeDotSpc([d],k.spcNameLow):k.activationEnergy<f&&d.spcName==k.spcNameLow&&dotManager.changeDotSpc([d],k.spcNameHigh));h&&(f=b.kineticEnergy(),h.activationEnergy>=f&&b.spcName==h.spcNameHigh?dotManager.changeDotSpc([b],
h.spcNameLow):h.activationEnergy<f&&b.spcName==h.spcNameLow&&dotManager.changeDotSpc([b],h.spcNameHigh));a.standardBreakUp(d,b,e)}}};function ConditionManager(){this.conditionSets={}}
ConditionManager.prototype={add:function(a){var d=this.timeStrToStamp(a.requiredFor);this.conditionSets[d]||(this.conditionSets[d]=[]);var d=this.conditionSets[d],b=this.getIfExists(a,d);a=new ConditionManager.TriggerEntry(a);b&&(a.satisfied=b.satisfied,d.splice(d.indexOf(b,1)));d.push(a)},canAdvance:function(a){var d;"number"==typeof a?d=a:/prompt/i.test(a)?d=/[0-9]+/.exec(a):/section/i.test(a)&&(d=-1);return this.checkConditions(this.conditionSets[d]||[])},checkConditions:function(a,d){d=defaultTo(!0,
d);for(var b,e=-1,f=!0,k=0;k<a.length;k++){var h=a[k],l=h.trigger;h.satisfied||(h=!0,"conditions"==l.checkOn&&!l.conditionFunc()?h=!1:!l.isSatisfied()&&!l.conditionFunc()&&(h=!1),!h&&(l.priority>e&&l.message)&&(b=l.message,e=l.priority),h||(f=!1))}d&&b&&alert(b);f&&a.map(function(a){a.satisfied=!0;/conditions/i.test(a.checkOn)&&a.recordVals()});return f},stripForInheritance:function(){for(var a in this.conditionSets)for(var d=this.conditionSets[a],b=d.length-1;0<=b;b--)d[b].satisfied&&d.splice(b,
1);return this},getIfExists:function(a,d){for(var b=0;b<d.length;b++)if(a.handle==d[b].trigger.handle)return d[b]},timeStrToStamp:function(a){return/section/i.test(a)?-1:/prompt/i.test(a)?Number(/[0-9]+/.exec(a)):isNaN(Number(a))?timeline.nowTime().promptIdx:Number(a)}};ConditionManager.TriggerEntry=function(a){this.trigger=a;this.satisfied=!1};compressorFuncs={getBinPts:function(a,d,b,e){var f=[];e=defaultTo(5,e);f.push(P(a.x-d*b.dx/2,a.y-b.dy));f.push(P(a.x-b.dx/2,a.y));f.push(P(a.x+b.dx/2,a.y));f.push(P(a.x+d*b.dx/2,a.y-b.dy));f.push(P(a.x+d*b.dx/2+e,a.y-b.dy));f.push(P(a.x+b.dx/2+e,a.y+e));f.push(P(a.x-b.dx/2-e,a.y+e));f.push(P(a.x-d*b.dx/2-e,a.y-b.dy));f.push(P(a.x-d*b.dx/2,a.y-b.dy));return f}};
objectFuncs={setupStd:function(){this.enabled=!0;this.removed=!1;this.handle&&this.addToCurLevel();this.wrapRemove()},wrapRemove:function(){var a=this.remove;this.remove=function(){this.removed=!0;this.handle&&this.removeFromCurLevel();a.apply(this)}},addToCurLevel:function(){curLevel[curLevel.key(this.type,this.handle)]=this},removeFromCurLevel:function(){var a=curLevel.key(this.type,this.handle);delete curLevel[a]},pickSliderPos:function(){var a;this.wall?a=(this.wall[0].x+this.wall[1].x)/2:this.pos&&
this.dims?a=this.pos.x+this.dims.dx/2:this.pos&&(a=this.pos.x);if(a){var d=$("#main").width()/3;a=Math.floor(a/d);if(0==a)return"left";if(1!=a&&2==a)return"right"}return this.checkForMigrateCenter()},addSlider:function(a,d,b,e,f,k){if(!f||!k){e||(e=this.pickSliderPos());switch(e){case "left":f=$(".active #sliderHolderLeft");$(".active #sliderHolderSingle").hide();$(".active #sliderHolderDouble").show();break;case "center":f=$(".active #sliderHolderCenter");$(".active #sliderHolderSingle").show();
$(".active #sliderHolderDouble").hide();break;case "right":f=$(".active #sliderHolderRight"),$(".active #sliderHolderSingle").hide(),$(".active #sliderHolderDouble").show()}k=f}e=".active #slider"+this.handle.toCapitalCamelCase();f=makeSlider(k,f,e,a,d,b);this.sliderWrapperSelectors||(this.sliderWrapperSelectors=[]);this.sliderWrapperSelectors.push(".active #"+$(k).attr("id"));this.sliderWrapperSelectors.push(".active #"+$(f).attr("id"));return e},checkForMigrateCenter:function(){return""!=$("#sliderHolderCenter").html().killWhiteSpace()?
(this.migrateCenterSlider(),"right"):"center"},migrateCenterSlider:function(){var a=$("#sliderHolderCenter").html();$("#sliderHolderCenter").html("");$("#sliderHolderLeft").html(a)},removeSlider:function(){if(this.sliderWrapperSelectors)for(var a=0;a<this.sliderWrapperSelectors.length;a++)$(this.sliderWrapperSelectors[a]).html("")},hideSliderDivs:function(){$(".active #sliderHolderSingle").hide();$(".active #sliderHolderDouble").hide()},valToPercent:function(a){return 100*(a-this.min)/(this.max-this.min)},
percentToVal:function(a){return a*(this.max-this.min)/100+this.min},pressureToMass:function(a){return a*(this.wall[1].x-this.wall[0].x)/(pConst*g)},massToPressure:function(a){return a*pConst*g/(this.wall[1].x-this.wall[0].x)},toggle:function(){this.enabled?this.disable():this.enable()}};function ActivationEnergyPair(a){this.type="ThresholdEnergyPair";spcs[a.spcNameLow]&&spcs[a.spcNameHigh]?(this.spcNameLow=a.spcNameLow,this.spcNameHigh=a.spcNameHigh,this.spcDefLow=spcs[this.spcNameLow],this.spcDefHigh=spcs[this.spcNameHigh],this.activationEnergy=a.activationEnergy,this.addToChanger(),this.setupStd()):(console.log("One of the species names in threshold energy pair is bad"),console.log("The names are "+a.spcNameLow+" and "+a.spcNameHigh))}
_.extend(ActivationEnergyPair.prototype,objectFuncs,{addToChanger:function(){activationEnergySpcChanger.addPair(this)},remove:function(){activationEnergySpcChanger.removePair(this)}});function ArrowFly(a){this.type="ArrowFly";this.pos=a.pos.copy();if(a.posFinal)this.posFinal=a.posFinal,this.UV=this.pos.VTo(this.posFinal).UV(),this.dir=this.UV.angle(),this.dist=this.pos.distTo(this.posFinal);else if(a.V)this.posFinal=this.pos.copy().movePt(a.V),this.UV=a.V.UV(),this.dir=this.UV.angle();else if((a.dir||a.UV)&&a.dist)a.dir?(this.dir=a.dir,this.UV=angleToUV(a.dir)):(this.UV=a.UV,this.dir=this.UV.angle(),this.UV=a.UV),this.posFinal=this.pos.copy().movePt(this.UV.copy().mult(a.dist)),
this.dist=a.dist;this.drawCanvas=defaultTo(c,a.drawCanvas);this.dims=a.dims.copy();this.dimsFinal=defaultTo(this.dims,a.dimsFinal);this.fill=a.fill.copy();this.fillUnround={r:this.fill.r,g:this.fill.g,b:this.fill.b};this.fillFinal=defaultTo(this.fill,a.fillFinal);this.stroke=defaultTo(this.fill,a.stroke.copy());this.fade=defaultTo(!0,a.fade);this.fadeTurns=defaultTo(4,a.fadeTurns);this.strokeUnround={r:this.stroke.r,g:this.stroke.g,b:this.stroke.b};this.strokeFinal=defaultTo(this.fillFinal,a.strokeFinal);
this.alpha=defaultTo(1,a.alpha);this.alphaFinal=defaultTo(this.alpha,a.alphaFinal);this.age=0;this.lifespan=Math.round(a.lifespan/updateInterval);this.getSteps();this.pts=this.getPts();this.onFinish=a.onFinish;return this.init()}
_.extend(ArrowFly.prototype,objectFuncs,toInherit.ArrowFuncs,{getSteps:function(){var a=1/this.lifespan;this.posStep=this.pos.VTo(this.posFinal).mult(a);this.dimsStep=V(this.dimsFinal.dx-this.dims.dx,this.dimsFinal.dy-this.dims.dy).mult(a);this.fillStep={r:a*(this.fillFinal.r-this.fill.r),g:a*(this.fillFinal.g-this.fill.g),b:a*(this.fillFinal.b-this.fill.b)};this.strokeStep={r:a*(this.strokeFinal.r-this.stroke.r),g:a*(this.strokeFinal.g-this.stroke.g),b:a*(this.strokeFinal.b-this.stroke.b)};this.alphaStep=
(this.alphaFinal-this.alpha)*a},init:function(){this.updateListenerName=unique(this.type+defaultTo("",this.handle),curLevel.updateListeners);addListener(curLevel,"update",this.updateListenerName,this.run,this);this.setupStd();return this},run:function(){this.drawCanvas.save();this.drawCanvas.globalAlpha=this.alpha;this.drawCanvas.translate(this.pos.x,this.pos.y);this.drawCanvas.rotate(this.dir);draw.fillPtsStroke(this.pts,this.fill,this.stroke,this.drawCanvas);this.drawCanvas.restore();this.takeStep();
this.age++;this.age==this.lifespan&&(this.onFinish&&this.onFinish.func.apply(this.onFinish.obj),this.fade?(this.alphaStep=-this.alpha/this.fadeTurns,this.remove(),this.updateListenerName=unique(this.type+defaultTo("",this.handle)+"fade",curLevel.updateListeners),addListener(curLevel,"update",this.updateListenerName,this.runFade,this),this.addCleanUp()):this.remove())},runFade:function(){this.drawCanvas.save();this.drawCanvas.globalAlpha=this.alpha;this.drawCanvas.translate(this.pos.x,this.pos.y);
this.drawCanvas.rotate(this.dir);draw.fillPtsStroke(this.pts,this.fill,this.stroke,this.drawCanvas);this.drawCanvas.restore();this.takeStepFade();this.age++;this.age==this.lifespan+this.fadeTurns&&this.remove()},scale:function(){for(var a=(this.dims.dx+this.dimsStep.dx)/this.dims.dx,d=(this.dims.dy+this.dimsStep.dy)/this.dims.dy,b=0;b<this.pts.length;b++)this.pts[b].x*=a,this.pts[b].y*=d},takeStep:function(){this.pos.movePt(this.posStep);this.dims.add(this.dimsStep);this.scale();this.alpha+=this.alphaStep;
this.fillUnround.r+=this.fillStep.r;this.fillUnround.g+=this.fillStep.g;this.fillUnround.b+=this.fillStep.b;this.strokeUnround.r+=this.strokeStep.r;this.strokeUnround.g+=this.strokeStep.g;this.strokeUnround.b+=this.strokeStep.b;this.fill.setFromUnround(this.fillUnround);this.stroke.setFromUnround(this.strokeUnround)},takeStepFade:function(){this.pos.movePt(this.posStep);this.dims.add(this.dimsStep);this.scale();this.alpha+=this.alphaStep},remove:function(){removeListener(curLevel,"update",this.updateListenerName);
this.removeCleanUp()}});function ArrowLine(a,d,b,e,f){this.handle=a;this.pts={line:d,arrow:Array(3)};this.col=b;this.drawCanvas=defaultTo(c,f);a=this.pts.line[this.pts.line.length-1];b=a.VTo(this.pts.line[this.pts.line.length-2]).UV();d=b.copy().rotate(0.5);b=b.copy().rotate(-0.5);this.pts.arrow[0]=a.copy().movePt(d.mult(10));this.pts.arrow[1]=a;this.pts.arrow[2]=a.copy().movePt(b.mult(10));return this.show(e)}
ArrowLine.prototype={draw:function(){for(var a=this.pts.line,d=0;d<a.length-1;d++)draw.line(a[d],a[d+1],this.col,this.drawCanvas);a=this.pts.arrow;draw.line(a[0],a[1],this.col,this.drawCanvas);draw.line(a[1],a[2],this.col,this.drawCanvas)},show:function(a){addListener(curLevel,"update","drawArrow"+this.handle,this.makeDrawFunc(a),this);return this},makeDrawFunc:function(a){var d=0,b=this,e=function(){b.draw()};a&&(e=extend(e,function(){d++;d==a&&removeListener(curLevel,"update","drawArrow"+b.handle)}));
return e},hide:function(){removeListener(curLevel,"update","drawArrow"+this.handle)}};function ArrowStatic(a){this.type="ArrowStatic";this.pos=a.pos.copy();this.dims=a.dims.copy();this.handle=a.handle;this.pts=this.getPts();this.drawCanvas=defaultTo(c,a.drawCanvas);this.label=a.label?a.label:!1;a.angle?this.angle=a.angle:a.UV&&(this.angle=UVToAngle(a.UV));this.setTextOffset();this.fill=a.fill.copy();this.textCol=defaultTo(Col(255,255,255),a.textCol);this.stroke=defaultTo(a.stroke,Col(0,0,0));this.init()}
_.extend(ArrowStatic.prototype,objectFuncs,toInherit.ArrowFuncs,{init:function(){this.updateListenerName=unique(this.type+defaultTo("",this.handle),curLevel.updateListeners);this.label?addListener(curLevel,"update",this.updateListenerName,this.runLabel,this):addListener(curLevel,"update",this.updateListenerName,this.runNoLabel,this);this.setupStd()},runLabel:function(){this.drawCanvas.save();this.drawCanvas.translate(this.pos.x,this.pos.y);this.drawCanvas.rotate(this.angle);draw.fillPtsStroke(this.pts,
this.fill,this.stroke,this.drawCanvas);this.drawCanvas.translate(this.textOffset.dx,this.textOffset.dy);this.drawCanvas.rotate(-this.angle);draw.text(this.label,P(0,0),"13pt calibri",this.textCol,"center",0,this.drawCanvas);this.drawCanvas.restore()},runNoLabel:function(){this.drawCanvas.save();this.drawCanvas.translate(this.pos.x,this.pos.y);this.drawCanvas.rotate(this.angle);draw.fillPtsStroke(this.pts,this.fill,this.stroke,this.drawCanvas);this.drawCanvas.restore()},setTextOffset:function(){this.textOffset=
V(7+5*Math.sin(Math.abs(-this.angle)),5*Math.cos(this.angle))},getDims:function(){return this.dims},move:function(a){this.pos.movePt(a);return this},scale:function(a){this.dims.multVec(a);this.pts=this.getPts();return this},size:function(a){this.dims=a.copy();this.pts=this.getPts();return this},rotate:function(a){this.angle+=a;this.setTextOffset();return this},getAngle:function(){return this.angle},setFill:function(a){this.fill=a.copy()},setStroke:function(a){this.stroke=a.copy()},remove:function(){removeListener(curLevel,
"update",this.updateListenerName);this.removeCleanUp()}});function Cell(a){this.type="Cell";this.handle=a.handle;var d=a.pos;this.nodeMass=a.nodeMass||100;var b=a.rad;this.drawCanvas=a.drawCanvas||window.c;var e=d.copy().movePt(V(b,b)),f=Math.max(3,a.numCorners)||8;this.membraneColor=a.col;this.sideLenMin=15;this.energyTransferMax=0.5;this.guideNodes=this.makeGuideNodes(d,b,f,this.nodeMass);d=this.makeOuterWallPts(this.guideNodes,10);b=this.makeInnerWallPts(this.guideNodes,10);this.outerWall=walls.addWall({pts:d,handle:"cell"+this.handle.toCapitalCamelCase()+
"Outer",handler:"staticAdiabatic",show:!1,record:!1,col:Col(255,255,255)});this.innerWall=walls.addWall({pts:b,handle:"cell"+this.handle.toCapitalCamelCase()+"Inner",handler:"staticAdiabatic",show:!1,record:!0,col:Col(255,255,255)});this.innerWall.hitThreshold=-10;this.outerWall.hitThreshold=-10;this.parentWallMemberTag=a.parentWallHandle;this.cellMemberTag=this.innerWall.handle;this.assignWallHandlers(this.guideNodes,this.innerWall,this.outerWall,this.parentWallMemberTag,this.cellMemberTag,this.energyTransferMax,
a.innerChanceTransport||{},a.outerChanceTransport||{},10);this.wallUpdateListenerName=this.addWallUpdateListener(this.guideNodes,this.innerWall,this.outerWall,this.handle,10,this.sideLenMin,a.boundingCorner,a.boundingVector,this.wallColor);this.drawListenerName=this.addDrawListener(this.guideNodes,this.innerWall,this.outerWall,this.membraneColor,this.drawCanvas);this.dotId=timeline.takeNumber();this.addDots(e,this.innerWall,a.dots||{},a.temp,this.dotId,this.cellMemberTag);this.energyBank=this.energyToTransfer=
0;this.energyBankMax=20;this.calcHeatTransferListenerName="calcHeatTrans"+this.handle;this.setupCalcHeatTransfer(this.calcHeatTransferListenerName,this.innerWall,walls[a.parentWallHandle]);window.dotMigrator.migrateDots(window.dotManager.get({tag:this.parentWallMemberTag}),[this.parentWallMemberTag],[this.outerWall.handle]);this.setupStd()}
_.extend(Cell.prototype,objectFuncs,{makeGuideNodes:function(a,d,b,e){center=a.copy().movePt(V(d,d));a=[];for(var f=0,k=Math.PI*(b-2)/b,h=2*Math.PI/b,l=0;l<b;l++){var m=P(center.x+d*Math.cos(f),center.y+d*Math.sin(f));a.push(new Cell.GuideNode(m,e,k));f+=h}for(l=0;l<a.length;l++)a[l].prev=0==l?a[a.length-1]:a[l-1],a[l].next=l==a.length-1?a[0]:a[l+1];return a},makeOuterWallPts:function(a,d){for(var b=[],e=0,f=a[0];e<a.length;){f.prev.outerWallIdx=e;var k=f.next.pos.VTo(f.pos).perp("ccw"),h=f.pos.VTo(f.prev.pos).perp("ccw"),
k=f.pos.copy().movePt(k.add(h).UV().mult(d/2));b.push(k);e++;f=f.prev}return b},makeInnerWallPts:function(a,d){for(var b=[],e=0,f=a[0];e<a.length;){f.innerWallIdx=e;var k=f.prev.pos.VTo(f.pos).perp("ccw"),h=f.pos.VTo(f.next.pos).perp("ccw"),k=f.pos.copy().movePt(k.add(h).UV().mult(d/2));b.push(k);e++;f=f.next}return b},assignWallHandlers:function(a,d,b,e,f,k,h,l,m){for(var n=0;n<a.length;n++)this.assignWallHandler(d,a[n].innerWallIdx,b,a[n].outerWallIdx,a[n],a[n].next,f,e,-1,k,h,m),this.assignWallHandler(b,
a[n].outerWallIdx,d,a[n].innerWallIdx,a[n].next,a[n],e,f,1,k,l,m)},assignWallHandler:function(a,d,b,e,f,k,h,l,m,n,p,r){walls.setSubWallHandler(a.handle,d,{func:function(a,d,t,x,w,y){if(a.tag==h)if(Math.random()<p[a.spcName])this.transferDot(a,l,y,r);else{d=x.dx*(k.pos.x-f.pos.x)+x.dy*(k.pos.y-f.pos.y);var z=x.dx*(a.x-f.pos.x)+x.dy*(a.y-f.pos.y),A=-x.dx*(a.x-k.pos.x)-x.dy*(a.y-k.pos.y);t=new Point(f.pos.x+0.5*x.dx*d,f.pos.y+0.5*x.dy*d);var z=z/d,F=A/d;vecNodeAPerp=y.copy().mult(f.v.dotProd(y));vecNodeBPerp=
y.copy().mult(k.v.dotProd(y));f.v.dx-=vecNodeAPerp.dx;f.v.dy-=vecNodeAPerp.dy;k.v.dx-=vecNodeBPerp.dx;k.v.dy-=vecNodeBPerp.dy;var A=vecNodeAPerp.dx*y.dx+vecNodeAPerp.dy*y.dy,u=vecNodeBPerp.dx*y.dx+vecNodeBPerp.dy*y.dy,z=w+(1-z)*A+(1-F)*u;w=-0.5*(A+u);A+=w;u=f.m*t.distSqrTo(f.pos)+k.m*t.distSqrTo(k.pos);x=x.dx*(a.x-t.x)+x.dy*(a.y-t.y);t=-2*z/(1/a.m+1/(f.m+k.m)+x*x/u);a.v.dx-=y.dx*t/a.m;a.v.dy-=y.dy*t/a.m;x=0.5*(A/(0.5*d)-x*t/u)*d;vWallTrans_F=w-t/(f.m+k.m);d=-(vWallTrans_F-x);x=-(vWallTrans_F+x);f.v.dx+=
y.dx*d;f.v.dy+=y.dy*d;k.v.dx+=y.dx*x;k.v.dy+=y.dy*x;a.x+=y.dx;a.y+=y.dy;y=m*this.energyToTransfer;0<y?(y=Math.min(y,Math.min(this.energyBank,n)),a.addEnergy(y),this.energyBank-=y,this.energyToTransfer-=y*m):(y=Math.min(this.energyBank-y,Math.min(this.energyBankMax-this.energyBank,Math.min(n,Math.max(0,(a.temp()-10)*a.cv)))),a.addEnergy(-y),this.energyBank+=y)}else a.tag==l&&(y=b.handlers[e],y.func.apply(y.obj,[a,b,e,b.wallUVs[e],-a.v.dotProd(b.wallPerpUVs[e]),b.wallPerpUVs[e]]))},obj:this})},transferDot:function(a,
d,b,e){e=2*a.r+e;a.x-=e*b.dx;a.y-=e*b.dy;dotManager.changeDotWall(a,d)},addWallUpdateListener:function(a,d,b,e,f,k,h,l){var m=h.x,n=h.x+l.dx,p=h.y,r=h.y+l.dy;addListener(curLevel,"wallMove","moveCell"+this.handle.toCapitalCamelCase(),function(){for(var e=0;e<a.length;e++){a[e].pos.x+=a[e].v.dx;a[e].pos.y+=a[e].v.dy;a[e].v.dx*=0.999;a[e].v.dy*=0.999;if(b[a[e].prev.outerWallIdx].x<m){a[e].pos.x+=2;a[e].v.dx=Math.abs(a[e].v.dx);for(var h=0;h<a.length;h++)a[h].v.dx+=0.5}else if(b[a[e].prev.outerWallIdx].x>
n){a[e].pos.x-=2;a[e].v.dx=-Math.abs(a[e].v.dx);for(h=0;h<a.length;h++)a[h].v.dx-=0.5}if(b[a[e].prev.outerWallIdx].y<p){a[e].pos.y+=2;a[e].v.dy=Math.abs(a[e].v.dy);for(h=0;h<a.length;h++)a[h].v.dy+=0.5}else if(b[a[e].prev.outerWallIdx].y>r){a[e].pos.y-=2;a[e].v.dy=-Math.abs(a[e].v.dy);for(h=0;h<a.length;h++)a[h].v.dy-=0.5}}for(e=0;e<a.length;e++){var h=a[e],l=h.prev.pos.UVTo(h.pos).perp("cw"),x=h.next.pos.UVTo(h.pos).perp("ccw"),l=l.add(x).UV();this.addAngleForce(h,h.prev,h.next,new Vector(-l.dx,
-l.dy));this.addExpansionForce(h,h.next,k);b[h.outerWallIdx+1].x=h.pos.x+l.dx*f/2;b[h.outerWallIdx+1].y=h.pos.y+l.dy*f/2;d[h.innerWallIdx].x=h.pos.x-l.dx*f/2;d[h.innerWallIdx].y=h.pos.y-l.dy*f/2}b[0].x=b[b.length-1].x;b[0].y=b[b.length-1].y;d[d.length-1].x=d[0].x;d[d.length-1].y=d[0].y;window.walls.setupWall(walls.indexOf(d));window.walls.setupWall(walls.indexOf(b))},this)},addAngleForce:function(a,d,b,e){d=this.angleBetweenPts(a.pos,d.pos,b.pos,e);a.v.dx-=e.dx*(d-a.nativeAngle);a.v.dy-=e.dy*(d-a.nativeAngle)},
addExpansionForce:function(a,d,b){var e=a.pos.VTo(d.pos);e.magSqr()<b*b&&(b=e.UV(),d.v.dx+=0.2*b.dx,d.v.dy+=0.2*b.dy,a.v.dx-=0.2*b.dx,a.v.dy-=0.2*b.dy)},angleBetweenPts:function(a,d,b,e){e=Math.atan2(e.dy,e.dx);d=a.VTo(d);a=a.VTo(b);b=Math.atan2(d.dy,d.dx);a=Math.atan2(a.dy,a.dx);return this.distBetweenAngles(b,e)+this.distBetweenAngles(e,a)},distBetweenAngles:function(a,d){0>a&&(a+=2*Math.PI);0>d&&(d+=2*Math.PI);var b=Math.max(a,d)-Math.min(a,d);return b>Math.PI?2*Math.PI-b:b},addDrawListener:function(a,
d,b,e,f){addListener(curLevel,"update","drawCell"+this.handle,function(){for(var k=0;k<a.length;k++){var h=a[k];window.draw.fillPts([d[h.innerWallIdx],d[h.next.innerWallIdx],b[h.outerWallIdx],b[h.prev.outerWallIdx]],e,f)}},this)},setupCalcHeatTransfer:function(a,d,b){var e=d.getDataSrc("temp"),f=b.getDataSrc("temp");addListener(curLevel,"update",a,function(){var a=d.Cp(),h=b.Cp();this.energyToTransfer=((a*e[e.length-1]+h*f[f.length-1])/(a+h)-f[f.length-1])*h},this)},addDots:function(a,d,b,e,f,k){for(var h in b){var l=
window.spcs[h];l||console.log("Bad species name sent to cell: "+h);for(var m=b[h],n=Math.floor(b[h]/(2*(d.length-1))),p=0;p<d.length-1;p++){var r=d[p],s=d[p+1],v=a.VTo(r.avg(s)).UV();this.populateRightTriangle(a,r,r.avg(s),n,l,e,v,k,f,h);this.populateRightTriangle(a,s,r.avg(s),n,l,e,v,k,f,h);m-=2*n}this.populateRightTriangle(a,r,r.avg(s),m,l,e,v,k,f,h)}},populateRightTriangle:function(a,d,b,e,f,k,h,l,m,n){f=h.copy().perp("cw");0>b.VTo(d).dotProd(f)&&(f=h.copy().perp("ccw"));var p=[];d=b.distTo(d);
b=a.distTo(b);for(var r=0;r<e;r++){var s=Math.sqrt(Math.random())*b,v=Math.random()*d*s/b,t=a.x+h.dx*s+f.dx*v,s=a.y+h.dy*s+f.dy*v,v=V(Math.random()-0.5,Math.random()-0.5).UV();p.push(new Dot(t,s,v,n,l,m,l));p[p.length-1].setTemp(k)}window.dotManager.add(p)},remove:function(){}});Cell.GuideNode=function(a,d,b){this.pos=a;this.prev=this.next=void 0;this.v=V(0,0);this.m=d;this.outerWallIdx=this.innerWallIdx=void 0;this.nativeAngle=b};Cell.GuideNode.prototype={};function CheckMark(a,d,b,e,f){var k=P(a.x,a.y+0.6*d.dy),h=P(a.x+0.4*d.dx,a.y+d.dy),l=P(a.x+d.dx,a.y);a=P(a.x+0.35*d.dx,a.y+0.75*d.dy);this.pts=[k,h,l,a];this.col=b;this.stroke=e;this.drawCanvas=f}CheckMark.prototype={draw:function(){draw.fillPtsStroke(this.pts,this.col,this.stroke,this.drawCanvas)},setCanvas:function(a){this.drawCanvas=a}};function Clamps(a){this.type="Clamps";this.handle=a.handle;this.draw=defaultTo(!1,a.draw);this.releaseWith=defaultTo("button",a.releaseWith);this.currentClamper=void 0;this.clamps=a.clamps;this.wall=walls[a.wallInfo];this.buttonId="clampRelease"+this.wall.handle;this.wallHandler=this.wall.parent.getSubWallHandler(this.wall.handle,0);this.init()}
_.extend(Clamps.prototype,objectFuncs,{init:function(){this.setupStd();this.wall.moveStop();this.assembleClamps();"button"==this.releaseWith?this.makeReleaseButton():this.setupClampClicking();this.draw&&this.drawClamps();this.freezeWall()},assembleClamps:function(){for(var a=0;a<this.clamps.length;a++){var d=this.clamps[a];d.vol&&(d.y=this.wall.volToY(d.vol),delete d.vol);d.clamping=!1}this.sortClamps();this.addInitClamp()},sortClamps:function(){for(var a=0;a<this.clamps.length;a++){for(var d=!1,
b=0;b<this.clamps.length-1;b++)this.clamps[b].y>this.clamps[b+1].y&&(this.clamps.switchElements(b,b+1),d=!0);if(!d)break}},addInitClamp:function(){for(var a=this.wall[0].y,d=0;d<this.clamps.length;d++)if(this.clamps[d].y>a){this.clamps.splice(d,0,{y:a,clamping:!0});this.currentClamper=this.clamps[d];break}},makeReleaseButton:function(){var a=this;addButton(this.buttonId,"Release");$("#"+this.buttonId).click(function(){a.release()})},removeReleaseButton:function(){removeButton(this.buttonId)},release:function(){var a=
void 0,d=void 0;this.currentClamper.clamping=!1;var b=this.clamps.indexOf(this.currentClamper),e=this.clamps[b+1],b=this.clamps[b-1];e&&(a=e.y);b&&(d=b.y);var f=this;this.wall.releaseWithBounds(d,a,this.wallHandler,function(a){f.activateClamp(a)})},activateClamp:function(a){var d=this.clamps.indexOf(this.currentClamper);this.currentClamper.clamping=!1;this.currentClamper=a<this.currentClamper.y?this.clamps[d-1]:this.clamps[d+1];this.currentClamper.clamping=!0;this.freezeWall()},freezeWall:function(){walls.setSubWallHandler(this.wall.handle,
0,"staticAdiabatic")},remove:function(){this.wall.removed||(this.wall.moveInit(),this.wall.parent.setSubWallHandler(walls.indexOf(this.wall),0,this.wallHandler));"button"==this.releaseWith&&this.removeReleaseButton()}});function CompArrow(a){this.type="CompArrow";var d=defaultTo(0,a.wallInfo),b=defaultTo(1.5,a.speed),e=defaultTo("adiabatic",a.compMode),f=defaultTo(!0,a.stops),k=defaultTo({y:{min:30,max:350}},a.bounds);this.wall=walls[d];var h={};h.outer=Col(44,118,172);h.onClick=Col(44,118,172);h.inner=curLevel.bgCol.copy();var l=V(25,15);a="volDragger"+defaultTo("",a.handle);var m=c,n=canvas,p={};f&&(this.stops=new Stops({stopPt:{height:k.y.max},wallInfo:d}));var r=this.wall;p.onDown=function(){};p.onMove=function(){r.changeSetPt(this.pos.y,
e,b)};p.onUp=function(){};this.dragArrowFunc=this.makeDragArrowFunc(this.wall,0,h,l,a,m,n,p,k);this.dragArrow=this.dragArrowFunc();this.setupStd();return this}
_.extend(CompArrow.prototype,objectFuncs,{remove:function(){this.dragArrow.remove();this.stop&&this.stops.remove()},makeDragArrowFunc:function(a,d,b,e,f,k,h,l,m){return function(){var n=a[1].copy();return(new DragArrow(n,d,b,e,f,k,h,l,m)).show()}},enable:function(){this.dragArrow.setPos(this.wall[1].copy());this.dragArrow.show();this.enabled=!0},disable:function(){this.dragArrow.hide();this.enabled=!1}});function DragArrow(a,d,b,e,f,k,h,l,m){this.type="DragArrow";this.pos=a;this.rotation=d;this.posInit=this.pos.copy();this.cols=b;this.dims=e;this.name=f;this.listeners=l;this.drawCanvas=k;this.canvasElement=h;this.bounds=m;this.bounds.x?(this.bounds.x.max||(this.bounds.x.max=h.width-e.dx),this.bounds.x.min||(this.bounds.x.min=0)):this.bounds.x={min:0,max:h.width-e.dx};this.bounds.y?(this.bounds.y.max||(this.bounds.y.max=h.height-e.dy),this.bounds.y.min||(this.bounds.y.min=0)):this.bounds.y={min:0,
max:h.height-e.dy};this.pts={};this.pts.outer=[];this.pts.inner=[];a=this.dims.dx;d=this.dims.dy;this.pts.outer.push(P(0,0));this.pts.outer.push(P(0.9*a,-d/2));this.pts.outer.push(P(a,0));this.pts.outer.push(P(0.9*a,d/2));this.pts.outer.push(P(0,0));this.makeDrawFunc();this.clickListeners=this.makeListenerFuncs();return this}
DragArrow.prototype={makeDrawFunc:function(){this.dirUV=V(Math.cos(this.rotation+Math.PI/2),Math.sin(this.rotation+Math.PI/2));this.draw=function(){};var a=this;this.draw=extend(this.draw,function(){a.drawCanvas.save();a.drawCanvas.translate(a.pos.x,a.pos.y);a.drawCanvas.rotate(a.rotation)});this.draw=this.cols.stroke?extend(this.draw,function(){draw.fillPtsStroke(a.pts.outer,a.cols.outer,a.cols.stroke,a.drawCanvas)}):extend(this.draw,function(){draw.fillPts(a.pts.outer,a.cols.outer,a.drawCanvas)});
if(this.cols.inner||this.cols.onClick){for(var d=0;d<this.pts.outer.length;d++){var b=this.pts.outer[d].copy().movePt({dx:-this.dims.dx/2}).scale(P(0,0),0.6).movePt({dx:this.dims.dx/2});this.pts.inner.push(b)}this.cols.curInner=this.cols.inner?this.cols.inner:this.cols.outer;this.draw=extend(this.draw,function(){draw.fillPts(a.pts.inner,a.cols.curInner,a.drawCanvas)})}this.draw=extend(this.draw,function(){a.drawCanvas.restore()})},makeListenerFuncs:function(){var a=this.listeners,d=this;d.amSelected=
new Boolean;if(a.onDown||a.onMove||a.onUp){var b=function(){};d.cols.onClick&&(b=extend(b,function(){d.cols.curInner=d.cols.onClick}));var b=extend(b,function(){a.onDown.apply(d)}),e=this.makeMoveListenerFunc(d),b=extend(b,e);a.onUp&&(e=this.makeUpListenerFunc(d),b=extend(b,e));return function(){d.amSelected=d.checkSelected();d.amSelected&&(d.posInit=d.pos.copy(),d.mouseInit=mouseOffset(d.canvasElement),b())}}},makeMoveListenerFunc:function(a){var d=a.listeners,b=function(){var b=mouseOffset(a.canvasElement),
d=V(b.x-a.mouseInit.x,b.y-a.mouseInit.y).dotProd(a.dirUV),b=a.posInit.x+d*Math.cos(a.rotation+Math.PI/2),d=a.posInit.y+d*Math.sin(a.rotation+Math.PI/2);a.pos.x=Math.max(a.bounds.x.min,Math.min(b,a.bounds.x.max));a.pos.y=Math.max(a.bounds.y.min,Math.min(d,a.bounds.y.max))};d.onMove&&(b=extend(b,function(){d.onMove.apply(a)}));var e=function(){addListener(curLevel,"mouseup","dragArrow"+a.name+"RemoveMove",function(){removeListener(curLevel,"mousemove","dragArrow"+a.name);removeListener(curLevel,"mouseup",
"dragArrow"+a.name+"RemoveMove")},"")};return function(){addListener(curLevel,"mousemove","dragArrow"+a.name,b,"");e()}},makeUpListenerFunc:function(a){var d=function(){addListener(curLevel,"mouseup","mouseup"+a.name,function(){a.listeners.onUp.apply(a)},"");addListener(curLevel,"mouseup","mouseup"+a.name+"remove",function(){removeListener(curLevel,"mouseup","mouseup"+a.name);removeListener(curLevel,"mouseup","mouseup"+a.name+"remove")},"")};if(a.cols.onClick)var b=function(){},b=a.cols.inner?extend(b,
function(){a.cols.curInner=a.cols.inner}):extend(b,function(){a.cols.curInner=a.cols.outer}),d=extend(d,function(){addListener(curLevel,"mouseup","revertCols"+a.name,function(){b();removeListener(curLevel,"mouseup","revertCols"+a.name)},"")});return d},setPos:function(a){"number"==typeof a.x&&(this.pos.x=a.x);"number"==typeof a.y&&(this.pos.y=a.y)},show:function(){addListener(curLevel,"mousedown","dragArrow"+this.name,this.clickListeners,"");addListener(curLevel,"update","drawDragArrow"+this.name,
this.draw,"");return this},hide:function(){removeListener(curLevel,"mousedown","dragArrow"+this.name);removeListener(curLevel,"update","drawDragArrow"+this.name);return this},reset:function(){this.pos=this.posInit.copy();removeListener(curLevel,"update","moveWall");return this},remove:function(){removeListener(curLevel,"mousedown","dragArrow"+this.name);removeListener(curLevel,"update","drawDragArrow"+this.name)},checkSelected:function(){var a=mouseOffset(this.canvasElement).rotate(this.pos,-this.rotation),
d=this.pos.copy().movePt({dy:-this.dims.dy/2});return ptInRect(d,this.dims,a)}};function DragWeights(a){this.type="DragWeights";this.handle=a.handle;this.tempWeightDefs=a.weightDefs;this.wallInfo=defaultTo(0,a.wallInfo);this.wall=walls[this.wallInfo];this.zeroY=defaultTo(this.wall[2].y,a.min);this.pistonPt=defaultTo(this.wall[0],a.pistonPt);this.pistonOffset=defaultTo(void 0,a.pistonOffset);this.wallHandler=defaultTo("cPAdiabaticDamped",a.compMode);this.binY=defaultTo(myCanvas.height-15,a.binY);this.blockCol=defaultTo(Col(224,165,75),a.blockCol);this.binCol=defaultTo(Col(150,
150,150),a.binCol);void 0!==a.pInit?this.massInit=this.pressureToMass(a.pInit):this.massInit=this.pressureToMass(1);this.binHeight=defaultTo(45,a.binHeight);this.weightDimRatio=defaultTo(0.5,a.weightDimRatio);this.moveSpeed=defaultTo(20,a.moveSpeed);this.weightScalar=defaultTo(70,a.weightScalar);this.displayText=defaultTo(!0,a.displayText);this.binSlant=1.3;this.storeBinWidth=110;this.storeBinSpacing=60;this.pistonBinWidth=150;this.pistonBinSpacing=15;this.blockSpacing=2;this.mass=this.massInit;this.massChunkName=
"dragWeights";this.weightsOnPiston=[];this.font="12pt Calibri";this.fontCol=Col(255,255,255);this.binThickness=5;this.trackingPts=[];this.wall.setMass(this.massChunkName,this.massInit);this.wall.recordPExt();this.wall.recordWork();this.wall.recordMass();this.setupStd();return this.init()}
_.extend(DragWeights.prototype,objectFuncs,compressorFuncs,{init:function(){this.weightGroups=this.makeWeights(this.tempWeightDefs);this.bins={};this.bins.store=this.makeStoreBins();this.bins.piston=this.makePistonBins();walls.setSubWallHandler(this.wallInfo,0,this.wallHandler);this.displayText||(this.draw=this.drawNoText);addListener(curLevel,"update","drawDragWeights"+this.wallInfo,this.draw,this);this.enable();this.wall.moveInit();this.dropAllIntoBins("instant");delete this.tempWeightDefs;return this},
remove:function(){this.wall.moveStop();this.trackingPts.map(function(a){a.trackStop()});this.trackingPts.splice(0,this.trackingPts.length);removeListener(curLevel,"update","drawDragWeights"+this.wallInfo);removeListener(curLevel,"mousedown","weights"+this.wallInfo)},getWeightDims:function(a){for(var d={},b=this.storeBinWidth-this.blockSpacing,e=0,f=0,k=0;k<a.length;k++){var h=a[k],l=Math.sqrt(h.mass*this.weightScalar/this.weightDimRatio);Math.max(l,e)>e&&(f=h.mass,e=l);d[h.name]=V(l,l*this.weightDimRatio)}return e>
b?(this.weightScalar=0.99*b*b*this.weightDimRatio/f,this.getWeightDims(a)):d},nameWeights:function(a){for(var d=0;d<a.length;d++)a[d].name="grp"+d},assignMasses:function(a){for(var d=0;d<a.length;d++)weightDef=a[d],weightDef.mass=this.pressureToMass(weightDef.pressure)},makeWeights:function(a){this.nameWeights(a);var d={};this.assignMasses(a);for(var b=this.getWeightDims(a),e=0,f=0;f<a.length;f++){var k=a[f],h={};h.name=k.name;h.dims=b[h.name];h.pressure=k.pressure;h.mass=k.mass;h.weights=[];for(var l=
0;l<k.count;l++){var m={};m.pos=P(300,500);m.name=k.name;m.status="";m.id=e;h.weights.push(m);e++}d[h.name]=h}return d},makeStoreBins:function(){var a=(this.wall[0].x+this.wall[1].x)/2,d={},b=this.getNumGroups(),a=a-this.storeBinWidth*(b-1)/2-this.storeBinSpacing*(b-1)/2,e;for(e in this.weightGroups)d[e]=this.makeStoreBin(a,this.weightGroups[e]),a+=this.storeBinWidth+this.storeBinSpacing;return d},makeStoreBin:function(a,d){var b={};b.pts=this.getBinPts(P(a,this.binY),this.binSlant,V(this.storeBinWidth,
this.binHeight),this.binThickness);b.x=a-this.storeBinWidth/2;b.y=this.binY;b.slots=this.getBinSlots(P(b.x,b.y),d);b.visible=!0;return b},makePistonBins:function(){var a=(this.wall[0].x+this.wall[1].x)/2,d={},b=this.getNumGroups(),a=a-this.pistonBinWidth*(b-1)/2-this.pistonBinSpacing*(b-1)/2,e;for(e in this.weightGroups)d[e]=this.makePistonBin(a,this.weightGroups[e]),a+=this.pistonBinWidth+this.pistonBinSpacing;return d},makePistonBin:function(a,d){var b={};if(this.pistonOffset){var e=this.pistonOffset.dx;
b.pos=P(a-this.pistonBinWidth/2,0).movePt({dx:e}).track({pt:this.pistonPt,noTrack:"x",offset:{dy:this.pistonOffset.dy}})}else b.pos=P(a-this.pistonBinWidth/2,0).track({pt:this.pistonPt,noTrack:"x"});this.trackingPts.push(b.pos);b.slots=this.getPistonBinSlots(b.pos,d);b.visible=!1;return b},getBinSlots:function(a,d){var b=d.weights.length,e=d.dims,f=Math.floor(this.storeBinWidth/(e.dx+this.blockSpacing));a.x+=(this.storeBinWidth-f*(e.dx+this.blockSpacing))/2;for(var b=Math.ceil(b/f),k=[],h=a.y-this.blockSpacing-
e.dy,l=0;l<b;l++){for(var m=[],n=a.x+this.blockSpacing,p=0;p<f;p++){var r=P(n,h),s=new Boolean,s=!1;m.push(this.newSlot(s,r,d.name,"store",l,p));n+=e.dx+this.blockSpacing}k.push(m);h-=e.dy+this.blockSpacing}return k},getPistonBinSlots:function(a,d){var b=d.weights.length,e=d.dims,f=Math.floor(this.pistonBinWidth/(e.dx+this.blockSpacing));startX=a.x+(this.pistonBinWidth-f*(e.dx+this.blockSpacing))/2;for(var b=Math.ceil(b/f),k=[],h=this.blockSpacing,l=0;l<b;l++){for(var m=[],n=startX+this.blockSpacing,
p=0;p<f;p++){var r=P(n,0).track({pt:a,offset:{dy:-(h+e.dy)},noTrack:"x"});this.trackingPts.push(r);var s=new Boolean,s=!1;m.push(this.newSlot(s,r,d.name,"piston",l,p));n+=e.dx+this.blockSpacing}k.push(m);h+=e.dy+this.blockSpacing}return k},newSlot:function(a,d,b,e,f,k){return{isFull:a,pos:d,name:b,type:e,row:f,col:k}},binIsFull:function(a,d){var b=this.bins[a][d].slots;for(rowIdx=0;rowIdx<b.length;rowIdx++)for(var e=b[rowIdx],f=0;f<e.length;f++)if(!e[f].isFull)return!1;return!0},binIsEmpty:function(a,
d){var b=this.bins[a][d].slots;for(rowIdx=0;rowIdx<b.length;rowIdx++)for(var e=b[rowIdx],f=0;f<e.length;f++)if(e[f].isFull)return!1;return!0},allEmpty:function(a){var d=new Boolean,d=!0,b;for(b in this.bins[a])d=Math.min(d,this.binIsEmpty(a,b));return d},weightCount:function(a,d){var b=this.bins[a][d].slots,e=0;for(rowIdx=0;rowIdx<b.length;rowIdx++)for(var f=b[rowIdx],k=0;k<f.length;k++)e+=f[k].isFull;return e},getPistonMass:function(){var a=0,d;for(d in this.weightGroups)for(var b=this.weightGroups[d],
e=b.weights,b=b.mass,f=0;f<e.length;f++)"piston"==e[f].status&&(a+=b);return a+this.massInit},dropAllIntoBins:function(a){for(var d in this.weightGroups)for(var b=this.weightGroups[d],e=0;e<b.weights.length;e++){var f=b.weights[e];"piston"==f.status?(f.status="inTransit",f.slot.isFull=!1,this.takeOffPiston(f),this.dropIntoBin(f,"store",a)):"store"!=f.status&&(f.status="inTransit",this.dropIntoBin(f,"store",a))}return this},dropAllOntoPiston:function(a){for(var d in this.weightGroups)for(var b=this.weightGroups[d],
e=0;e<b.weights.length;e++){var f=b.weights[e];"store"==f.status?(f.status="inTransit",f.slot.isFull=!1,this.takeOffPiston(f),this.dropIntoBin(f,"piston",a)):"piston"!=f.status&&(f.status="inTransit",this.dropIntoBin(f,"piston",a))}return this},dropIntoBin:function(a,d,b){var e=this;a.status="inTransit";var f=this.getDropSlot(a.name,d),k=f.slot;k.isFull=!0;a.slot=k;f=f.id;if("instant"==b)this.dropInstant(a,k);else{b=a.name+a.id+"endId"+this.wallInfo;var h="moveWeight"+b+d+f;removeListenerByName(curLevel,
"update",b)&&(a.slot.isFull=!1,a.slot=void 0);addListener(curLevel,"update",h,function(){var b=k.pos,d=V(b.x-a.pos.x,b.y-a.pos.y).UV();!1!==validNumber(d.dx)&&!1!==validNumber(d.dy)&&(a.pos.x=stepTowards(a.pos.x,b.x,d.dx*this.moveSpeed),a.pos.y=stepTowards(a.pos.y,b.y,d.dy*this.moveSpeed));this.weightArrived(a,k)&&(removeListener(curLevel,"update",h),e.placeWeight(a,k))},this)}},placeWeight:function(a,d){a.status=d.type;"piston"==a.status&&this.putOnPiston(a,d)},dropInstant:function(a,d){a.pos=d.pos.copy();
this.placeWeight(a,d)},weightArrived:function(a,d){return a.pos.sameAs(d.pos)},getDropSlot:function(a,d){for(var b=this.bins[d][a],e=0;e<b.slots.length;e++)for(var f=b.slots[e],k=0;k<f.length;k++){var h=b.slots[e][k];if(!h.isFull)return{slot:h,id:String(e)+String(k)}}alert("BOX IS FULL!  WHY IS THIS HAPPENING?")},getNumGroups:function(){var a=0;for(idx in this.weightGroups)a++;return a},draw:function(){this.drawWeights();this.drawBins();this.drawBinLabels()},drawNoText:function(){this.drawWeights();
this.drawBins()},drawWeights:function(){var a=c,d;for(d in this.weightGroups)for(var b=this.weightGroups[d],e=b.weights,b=b.dims,f=0;f<e.length;f++)draw.fillRect(e[f].pos,b,this.blockCol,a)},drawBins:function(){var a=c,d;for(d in this.bins){var b=this.bins[d],e;for(e in b){var f=b[e];f.visible&&draw.fillPts(f.pts,this.binCol,a)}}},drawBinLabels:function(){for(var a in this.bins.store){var d=this.bins.store[a];d.visible&&draw.text(this.weightGroups[a].pressure+" bar each",P(d.x+this.storeBinWidth/
2,d.y-this.binHeight),this.font,this.fontCol,"center",0,c)}},putOnPiston:function(a,d){this.weightsOnPiston.push(a);a.pos.track({pt:d.pos,noTrack:"x"});this.trackingPts.push(a.pos);a.status="piston";this.mass=this.getPistonMass();this.wall.setMass(this.massChunkName,this.mass)},takeOffPiston:function(a){for(var d=0;d<this.weightsOnPiston.length;d++)a==this.weightsOnPiston[d]&&this.weightsOnPiston.splice([d],1);a.pos.trackStop();this.trackingPts.splice(this.trackingPts.indexOf(a.pos),1);this.mass=
this.getPistonMass();this.wall.setMass(this.massChunkName,this.mass)},mousedown:function(){var a=this.getClicked();a&&(this.pickup(a),"piston"==this.selected.cameFrom&&this.takeOffPiston(this.selected),addListener(curLevel,"mousemove","weights",this.mousemove,this),addListener(curLevel,"mouseup","weights",this.mouseup,this))},mousemove:function(){var a=mouseOffset(myCanvas),d=this.selected.origPos,b=d.weight,d=d.mouse,e=b.y+(a.y-d.y);this.selected.pos.x=b.x+(a.x-d.x);this.selected.pos.y=e},mouseup:function(){removeListener(curLevel,
"mousemove","weights");removeListener(curLevel,"mouseup","weights");var a=this.getDest();this.dropIntoBin(this.selected,a);delete this.origPos;this.selected=void 0},getDest:function(){var a=this.selected,d=this.weightGroups[a.name].dims.dy;return"piston"==a.cameFrom||a.pos.y+d>this.zeroY?"store":"piston"},pickup:function(a){a.cameFrom=a.status;a.status="holding";var d=mouseOffset(myCanvas);void 0!==a.slot&&(a.slot.isFull=!1);"piston"==a.status&&this.takeOffPiston(a);delete a.slot;this.selected=a;
this.selected.origPos={mouse:d.copy(),weight:a.pos.copy()}},getClicked:function(){for(var a in this.weightGroups){a=this.weightGroups[a];for(var d=0;d<a.weights.length;d++){var b=a.weights[d];if(inRect(b.pos,a.dims,myCanvas)&&("inTransit"==b.status||this.isOnTop(b)))return b}}return!1},mouseOnWeight:function(a,d){var b=mouseOffset(myCanvas);return b.x>=d.x&&b.x<=d.x+a.dx&&b.y<=d.y&&b.y>=d.y-a.dy},isOnTop:function(a){var d=a.slot;a=this.bins[d.type][a.name];for(var b=d.col,d=d.row+1;d<a.slots.length;d++)if(!0==
a.slots[d][b].isFull)return!1;return!0},mass:function(){return this.mass},disable:function(){removeListener(curLevel,"mousedown","weights"+this.wallInfo);this.enabled=!1},enable:function(){addListener(curLevel,"mousedown","weights"+this.wallInfo,this.mousedown,this);this.enabled=!0}});var flowFuncs={getPts:function(a,d,b,e,f){b=a.VTo(d).mag();var k=this.width/b;this.fracOffset=Math.max(Math.min(this.fracOffset,1-k/2),k/2);b=f+k;f=a.copy().fracMoveTo(d,f-k);a=a.copy().fracMoveTo(d,b);d=f.copy().movePt(e.copy().neg().mult(this.depth));e=a.copy().movePt(e.copy().neg().mult(this.depth));return[f,d,e,a]},addPts:function(){var a=Math.min(this.ptIdxs[0],this.ptIdxs[1]),d=Math.max(this.ptIdxs[0],this.ptIdxs[1]),b=this.wall.getPt(a).copy(),d=this.wall.getPt(d).copy();this.perp=this.wall.getPerpUV(a);
a=this.wall.getUV(a);this.pts=this.getPts(b,d,a,this.perp,this.fracOffset)},addArrows:function(a,d){var b=[],e=30<this.width?2:1,f=this.pts[1].copy();f.movePt(a.copy().neg().mult(this.arrowDims.dy/3));for(var k=this.pts[1].VTo(this.pts[2]),k=k.copy().UV().copy().mult(k.mag()/(e+1)),h=0;h<e;h++)f.movePt(k),b.push(new ArrowStatic({pos:f,dims:this.arrowDims,UV:a.copy(),fill:this.arrowFill,stroke:this.arrowStroke,cleanUpWith:this.cleanUpWith}));return b}};function Heater(a){this.type="Heater";this.dims=defaultTo(V(100,40),a.dims);this.sliderWrapper=a.sliderWrapper;this.sliderTitleWrapper=a.sliderTitleWrapper;this.wall=walls[a.wallInfo];this.pos=a.pos?a.pos:this.centerOnWall(a.wallInfo,this.dims);a.offset&&this.pos.movePt(a.offset);this.wall.recordQ();this.wall.hitThreshold=-30;this.makeSlider=defaultTo(!0,a.makeSlider);this.handle=a.handle;this.drawCanvas=defaultTo(c,a.drawCanvas);this.cornerRound=0.2;this.qRate=defaultTo(0,a.init);this.qRateMax=defaultTo(1,
a.max);this.qRateMin=-this.qRateMax;this.rot=defaultTo(0,a.rotation);this.tempMax=defaultTo(Number.MAX_VALUE,a.tempMax);this.tempMin=defaultTo(1,a.tempMin);this.center=this.pos.copy().movePt(this.dims.copy().mult(0.5));var d=defaultTo(Col(200,0,0),a.colMax),b=defaultTo(Col(0,0,200),a.colMin),e=defaultTo(Col(100,100,100),a.colDefault);this.draw=this.makeDrawFunc(b,e,d);this.wallPts=this.pos.roundedRect(this.dims,0.3,"ccw");this.addWallHump(this.wallPts);this.eAdded=0;a.liquidHandle&&this.setupLiquidHeat(a.liquidHandle);
this.wallHandleHeater="heater"+this.handle.toCapitalCamelCase();this.hit=this.wrapHit(this.wall.getDataSrc("temp"));this.setupStd();this.makeSlider&&(this.sliderSelector=this.addSlider("Heater",{value:50},[{eventType:"slide",obj:this,func:this.parseSlider},{eventType:"slidestop",obj:this,func:function(a,b){$(this.sliderSelector).slider("option",{value:50});b.value=50;this.parseSlider(a,b)}}],this.sliderWrapper,this.sliderTitleWrapper));this.init(this.wallHandleHeater,this.wall.handle)}
_.extend(Heater.prototype,objectFuncs,{parseSlider:function(a,d){this.setQRate(d.value)},setQRate:function(a){this.qRate=0.02*(a-50)*this.qRateMax;this.liquid&&(50!=a?addListener(curLevel,"update","heatLiquid"+this.handle,this.heatLiq,this):removeListener(curLevel,"update","heatLiquid"+this.handle))},heatLiq:function(){this.liquid.addQ(0.15*this.qRate*updateInterval)},addWallHump:function(a){for(var d=[],b=0;b<a.length-1;b++)a[b].y==a[b+1].y&&d.push(b);a[a.length-1].y==a[0].y&&d.push(a.length-1);
for(var e=d[0],b=0;b<d.length;b++)e=a[d[b]].y<a[e].y?d[b]:e;a.splice(e+1,0,P(e==a.length-1?(a[e].x+a[0].x)/2:(a[e].x+a[e+1].x)/2,a[e].y-5))},disable:function(){var a=$(this.sliderSelector);a.length&&$(a).slider("disable");this.enabled=!1},enable:function(){var a=$(this.sliderSelector);a.length&&$(a).slider("enable");this.enabled=!0},makeDrawFunc:function(a,d,b){this.pts=this.getPts(this.pos,this.dims);rotatePts(this.pts,this.center,this.rot);var e=this.getColorSteps(a,d,b),f=this,k=this.pts;return function(){var a=
getSign(f.qRate),b=e[String(a)],a=a*f.qRate/f.qRateMax,b=d.copy().adjust(b[0]*a,b[1]*a,b[2]*a);draw.path(k,b,f.drawCanvas)}},centerOnWall:function(a,d){var b=walls[a];return P((b[3].x+b[2].x)/2-d.dx/2,b[2].y-30-d.dy)},getPts:function(a,d,b){b=[];a=a.copy().movePt({dy:d.dy/2});var e=d.dy/2+2.5,f=d.dy/2-2.5,k=Math.floor((d.dx-2*e)/(2*(e-f)));b.push(a.copy().movePt({dy:200}));b.push(a.copy());b=b.concat(this.halfElipse(a,e,d.dy/2,0,5));a.movePt({dx:2*e});for(var h=0;h<k;h++)b=b.concat(this.halfElipse(a,
f,d.dy/2,Math.PI,5)),a.movePt({dx:-2*f}),b=b.concat(this.halfElipse(a,e,d.dy/2,0,5)),a.movePt({dx:2*e});b.push(a.copy());b.push(a.copy().movePt({dy:200}));this.endX=b[b.length-1].x;this.dims=V(this.endX-this.pos.x,d.dy);this.center=this.pos.copy().movePt(this.dims.copy().mult(0.5));return b},halfElipse:function(a,d,b,e,f){f=defaultTo(5,f);for(var k=Array(f),h=Math.PI/f,l=a.x+d,m=Math.PI,n=0;n<f;n++){var p=l+d*Math.cos(m),r=a.y+b*Math.sin(m);k[n]=P(p,r);m+=h}rotatePts(k,a,e);return k},getColorSteps:function(a,
d,b){var e={};b=[b.r-d.r,b.g-d.g,b.b-d.b];e["-1"]=[a.r-d.r,a.g-d.g,a.b-d.b];e["1"]=b;return e},init:function(a,d){addListener(curLevel,"update","drawHeater"+this.handle,this.draw,"");this.setupWalls(a);this.eAdded=0;dotMigrator.migrateDots(dotManager.get({tag:d}),[d],[a])},setupWalls:function(a){walls.addWall({pts:this.wallPts,handler:{func:this.hit,obj:this},handle:a,record:!1,show:!1});walls[a].createSingleValDataObj("vol",function(){return walls.wallVolume(a)})},wrapHit:function(a){return function(d,
b,e,f,k,h){walls.reflect(d,f,k);d.temp();if(0<this.qRate&&a[a.length-1]<this.tempMax||0>this.qRate&&a[a.length-1]>this.tempMin)d=0.001*d.addEnergy(this.qRate),this.eAdded+=d,this.wall.q+=d}},setupLiquidHeat:function(a){var d=this;timeline.curSection().addCmmdPoint("now","setup",function(){var b=curLevel.selectObj("Liquid",a);b||console.log("Bad liquid handle for heater "+this.handle+".  Handle "+handle);b.heater=d;b.getWallLiq().recordQ();d.liquid=b},!0,!0)},removeLiquid:function(){this.liquid=void 0},
remove:function(){this.removeSlider();removeListener(curLevel,"update","drawHeater"+this.handle);window.walls&&!walls.removed&&walls.removeWall(this.wallHandleHeater)}});function Inlet(a){this.arrowDims=V(15,20);this.arrowFill=Col(200,0,0);this.arrowStroke=Col(100,100,100);this.type="Inlet";this.handle=a.handle;this.width=defaultTo(30,a.width);this.depth=defaultTo(20,a.depth);this.fracOpen=defaultTo(1,a.fracOpen);this.makePts=this.depth;this.wallInfo=a.wallInfo;this.wall=walls[this.wallInfo];this.ptIdxs=a.ptIdxs;this.fracOffset=defaultTo(0.5,a.fracOffset);this.flows=this.processFlows(a.flows);if(this.makeSlider=a.makeSlider)this.sliderId=this.addSlider("Flow rate",
{value:100*this.fracOpen},[{eventType:"slide",obj:this,func:this.parseSlider}]);this.setupStd();this.arrows=[];this.init()}
_.extend(Inlet.prototype,flowFuncs,objectFuncs,{init:function(){this.addPts();this.makePts&&this.wall.addPts(this.ptIdxs[1],this.pts);var a={pos:this.pts[1].copy(),vec:this.pts[1].VTo(this.pts[2]),dir:this.perp.copy()};this.arrows=this.addArrows(this.pts[1].VTo(this.pts[2]).UV().perp("ccw"));this.makeInlet(a,this.flows)},processFlows:function(a){for(var d=[],b=0;b<a.length;b++){var e=a[b];d.push({spc:spcs[e.spcName],temp:e.temp,nDotMax:e.nDotMax,returnTo:this.wallInfo,tag:e.tag});d[d.length-1].nDotMax*=
1E3/updateInterval}return d},parseSlider:function(a,d){this.fracOpen=d.value/100},makeInlet:function(a,d){for(var b=a.pos,e=a.vec,f=a.dir,k=Array(d.length),h=d.length,l=0;l<k.length;l++)k[l]=0;addListener(curLevel,"update",this.type+this.handle,function(){for(var a=0;a<h;a++){var l=d[a];k[a]+=this.fracOpen*l.nDotMax;var p=Math.floor(k[a]);if(p){for(var r=[],s=0;s<p;s++){var v=Math.random(),v=P(b.x+e.dx*v,b.y+e.dy*v);r.push({pos:v,dir:f,temp:l.temp,returnTo:l.returnTo,tag:l.tag})}l.spc.place(r);k[a]-=
p}}},this)},remove:function(){this.sliderId&&this.removeSlider();this.arrows.map(function(a){a.remove()});removeListener(curLevel,"update",this.type+this.handle)}});function Liquid(a){this.type="Liquid";this.wallInfo=a.wallInfo;this.wallGas=walls[this.wallInfo];this.wallPtIdxs=a.wallPts||[this.wallGas.length-2,this.wallGas.length-3];this.handle=a.handle;this.actCoeffType=a.actCoeffType||"ideal";this.actCoeffInfo=a.actCoeffInfo;var d=a.makePhaseDiagram;this.Cp=0;var b=a.tempInit;this.temp=b;var e=a.spcCounts;this.spcDefs=this.getSpcDefs(e);this.tempDisplay=this.temp;this.criticalPointTemp=a.criticalPointTemp;this.triplePointTemp=a.triplePointTemp;this.isTwoComp=
2==countAttrs(this.spcDefs);this.spcA=getNth(this.spcDefs,0);this.isTwoComp&&(this.spcB=getNth(this.spcDefs,1));this.drivingForce=this.makeDrivingForce(this.spcDefs);this.dotMgrLiq=this.makeDotManager(this.spcDefs);this.wallLiq=this.makeWallLiq(this.spcDefs,e,this.wallGas,this.wallPtIdxs,this.dotMgrLiq);this.wallLiq.isLiquid=!0;this.surfAreaObj=this.wallGas.addSurfAreaAdjust(this.handle);this.numAbs=deepCopy(this.drivingForce);this.numEjt=deepCopy(this.numAbs);this.makeDots(this.wallLiq,this.wallGas,
this.wallPtIdxs,e,b,this.dotMgrLiq)&&this.deleteCount(this.spcDefs);this.dataGas=this.initData(this.wallGas,this.spcDefs,["pInt","temp"]);this.setupGrabPExt(this.wallGas,this.dataGas);this.dataLiq=this.initData(this.wallLiq,this.spcDefs);this.recordTempLiq(this.wallLiq);this.drawList=this.makeDrawList(this.dotMgrLiq);this.actCoeffFuncs=this.makeActCoeffFuncs(this.actCoeffType,this.actCoeffInfo,this.spcDefs);this.chanceZeroDf=0.4;this.drivingForceSensitivity=10;this.updateListenerName=this.type+this.handle;
this.phasePressure=a.phasePressure||1;this.makePhaseDiagram=this.wrapMakePhaseDiagram(this,this.spcDefs,this.actCoeffFuncs,"liquid"+this.handle.toCapitalCamelCase(),a.primaryKey,a.makeGasMarker,a.makeSystemMarker,a.makeLiquidMarker,this.phasePressure);d&&(this.phaseDiagram=this.makePhaseDiagram());this.updateEquilData(this.phaseDiagram,[this.phasePressure]);this.setupUpdate(this.spcDefs,this.dataGas,this.dataLiq,this.actCoeffFuncs,this.drivingForce,this.updateListenerName,this.drawList,this.dotMgrLiq,
this.wallLiq,this.numAbs,this.drivingForceSensitivity,this.numEjt,this.wallGas,this.wallPtIdxs,this.surfAreaObj);this.wallGas.addLiquid(this);this.wallBound=this.addWallBound(this.wallGas);this.phaseChangeEnabled=!0;this.equilData;this.energyForDots=0;this.setupStd()}
_.extend(Liquid.prototype,objectFuncs,{getSpcDefs:function(a){var d={},b;for(b in a)d[b]=window.spcs[b];return d},setupGrabPExt:function(a,d){timeline.curSection().addCmmdPoint("now","setup",function(){var b=a.getDataSrc("pExt",void 0,!0);b&&(d.pExt=b)},!0,!0)},makeActCoeffFuncs:function(a,d,b){a=a||"ideal";if(/(twoSfxMrg|twosuffixmargoules)/i.test(a))return this.makeTwoSfxMrgFuncs(b,d.a);if(/van[\s]*laar/i.test(a))return this.makeVanLaar(b,d);if(/ideal/i.test(a)){a={};for(var e in b)a[e]=function(a,
b){return 1};return a}},makeTwoSfxMrgFuncs:function(a,d){var b={},e=R,f;for(f in a)b[f]=function(a,b){return Math.exp(d*(1-a)*(1-a)/(e*b))};return b},makeVanLaar:function(a,d){var b={},e;for(e in a){var f=d[e],k=this.getActCoeffOther(e,d);void 0===f&&console.log("Missing activity coefficient for "+e);b[e]=this.makeVanLaarFunc(f,k)}return b},makeVanLaarFunc:function(a,d){return function(b,e){return Math.exp(a*d*(1-b)/(a*b+d*(1-b))*d*(1-b)/(a*b+d*(1-b)))}},getActCoeffOther:function(a,d){for(var b in d)if(b!=
a)return d[b]},makeWallLiq:function(a,d,b,e,f,k){a=this.getLiqWallVol(a,d);b=this.getWallLiqPts(b,e,a);return window.walls.addWall({pts:b,handler:{func:this.hit,obj:this},handle:"liquid"+this.handle.toCapitalCamelCase(),record:!1,show:!0,dotManager:f,close:!1})},makeNumAbsorbed:function(a){var d={},b;for(b in a)d[b]=0;return d},togglePhaseChange:function(){this.phaseChangeEnabled?this.disablePhaseChange():this.enablePhaseChange()},enablePhaseChange:function(){window.walls.setWallHandler(this.wallLiq.handle,
{func:this.hit,obj:this});this.phaseChangeEnabled=!0},disablePhaseChange:function(){window.walls.setWallHandler(this.wallLiq.handle,{func:this.hitNoPhaseChange,obj:this});this.phaseChangeEnabled=!1},getLiqWallVol:function(a,d,b){var e=0;if(b)for(f in a)e+=a[f].spcVolLiq*b.get({spcName:f}).length/N;else for(var f in a)e+=a[f].spcVolLiq*d[f]/N;return e},getWallLiqPts:function(a,d,b){var e=a[d[0]];d=a[d[1]];a=e.x<d.x?e:d;e=a==e?d:e;b=this.getWallHeight(e.x-a.x,b);a=a.copy().movePt(V(0,-b));return[e.copy().movePt(V(0,
-b)),a]},getWallHeight:function(a,d){return d/(vConst*a)+2},makeDotManager:function(a){var d=new DotManager,b;for(b in a)d.addSpcs(b);return d},makeDots:function(a,d,b,e,f,k){var h=a[1].copy();d=P(Math.max(d[b[0]].x,d[b[1]].x),d[b[0]].y);d=h.VTo(d);for(var l in e)spcs[l].populate(h,d,e[l],f,a.handle,void 0,a.handle,k)},recordTempLiq:function(a){var d=this;a.recordTemp(function(){return d.tempDisplay})},initData:function(a,d,b){var e={};if(b)for(var f=0;f<b.length;f++){var k=b[f],h=a.getDataObj(k,
void 0,!0);h&&(e[k]=h.src())}for(var l in d)d={spcName:l,tag:a.handle},a.recordFrac(d),e[l]=a.getDataObj("frac",d).src();return e},makeDrivingForce:function(a){var d={},b;for(b in a)d[b]=0;return d},setupUpdate:function(a,d,b,e,f,k,h,l,m,n,p,r,s,v,t){this.calcCp=this.setupCalcCp(a,l);this.calcEquil=this.setupUpdateEquil(s,m,a,d,b,e,f,l);this.drawDots=this.setupDrawDots(h);this.moveDots=this.setupMoveDots(l,a,m,s,v);this.ejectDots=this.setupEjectDots(l,a,f,n,p,h,m,r);var x=this.setupSizeWall(m,s,a,
l,v,t),w=this.setupFixLiquidTemp(s,dotManager,d),y=this.calcCp,z=this.calcEquil,A=this.drawDots,F=this.moveDots,u=this.ejectDots;y();var C=0,B=this;addListener(curLevel,"update",k,function(){if(5==C){var a;B.isTwoComp?(B.checkUpdateEquilAndPhaseDiagram=B.setupCheckUpdateEquilPhaseDiagram(B.phaseDiagram,B.wallGas.getDataSrc("pExt"),B.wallGas.getDataSrc("pInt")),a=B.checkUpdateEquilAndPhaseDiagram):a=function(){};removeListener(curLevel,"update",k);addListener(curLevel,"update",k,function(){0<B.Cp&&
2.5>B.Cp&&w();B.tempDisplay=B.temp;y();z();A();F();B.phaseChangeEnabled&&u();x();a();B.addEnergyToDots(window.dotManager.lists.ALLDOTS,B.energyForDots)&&(B.energyForDots=0)})}B.tempDisplay=B.temp;y();z();A();F();x();C++})},setupFixLiquidTemp:function(a,d,b){var e=this;return function(){var a=e.tDew(e.spcA,e.spcB,b,e.equilData),d=b.temp[b.temp.length-1],h=getSign(d-a),a=a+h*Math.min(15,h*(d-a)),d=(a-e.temp)*e.Cp;e.temp=a;e.energyForDots-=d}},tDew:function(a,d,b,e){if(a&&d){a=e.data;b=b[e.keyLight][b[e.keyLight].length-
1];e=1;for(d=a.length;e<d;e++)if(a[e].yLight<=b){d=a[e-1].yLight;var f=a[e-1].temp;return f+(b-d)*(a[e].temp-f)/(a[e].yLight-d)}}else return a.tBoil(b.pExt?b.pExt[b.pExt.length-1]:b.pInt[b.pInt.length-1])},addEnergyToDots:function(a,d){if(a.length&&d){for(var b=Math.min(a.length,20),e=Math.max(0,Math.floor(Math.random()*a.length-b)),f=d/b,b=b+e;e<b;e++)a[e].addEnergy(f);return!0}return!1},setupCalcCp:function(a,d){var b=this,e={},f;for(f in a)e[f]=d.get({spcName:f});return function(){var d=0,f;for(f in a)d+=
a[f].cpLiq*e[f].length/N;b.Cp=d}},setupUpdateEquil:function(a,d,b,e,f,k,h,l){var m=this;return function(){var n=5>Math.abs(a[0].y-d[0].y);0==l.count?m.updateEquilAllVap(a,d,b,e,f,k,h,l):n?m.updateEquilWithPExt(a,d,b,e,f,k,h,l):m.updateEquilStd(a,d,b,e,f,k,h,l)}},updateEquilAllVap:function(a,d,b,e,f,k,h,l){a=this.tDew(this.spcA,this.spcB,e,this.equilData);e=e.temp[e.temp.length-1]>a?-10:0;for(var m in b)h[m]=e},updateEquilWithPExt:function(a,d,b,e,f,k,h,l){d=0;e={};for(var m in b){l=f[m][f[m].length-
1];var n=this.temp,p=k[m](l,n),r=b[m].antoineCoeffs;l*=this.getPPure(r.a,r.b,r.c,n)*p;d+=l;e[m]=l}a=a.pExt()-d;for(m in b)h[m]=a*e[m]/d},updateEquilStd:function(a,d,b,e,f,k,h,l){for(var m in b){a=e[m][e[m].length-1];d=f[m][f[m].length-1];l=this.temp;var n=k[m](d,l),p=b[m].antoineCoeffs;d*=this.getPPure(p.a,p.b,p.c,l)*n;h[m]=a*(e.pExt?e.pExt[e.pExt.length-1]:e.pInt[e.pInt.length-1])-d}},setupDrawDots:function(a){return function(){window.draw.dotsAsst(a)}},setupMoveDots:function(a,d,b,e,f){var k=this,
h=[],l;for(l in d)h.push(a.get({spcName:l}));return function(){for(var a,d,l,r,s=b[0].x,v=b[1].x,t=e[f[0]].y,x=b[0].y,w=0;w<h.length;w++){var y=h[w];if(d=y.length){r=y[0].m;a=15+Math.ceil(15*Math.random());for(var z=0;z<a;z++){l=0.5*tempToV(r,k.temp);var A=2*Math.PI*Math.random();l=V(Math.cos(A)*l,Math.sin(A)*l);for(A=z;A<d;A+=a)y[A].x=Math.max(v,Math.min(s,y[A].x+l.dx)),y[A].y=Math.max(x,Math.min(t,y[A].y+l.dy))}}}}},setupEjectDots:function(a,d,b,e,f,k,h,l){var m=this,n=this.wallGas,p={},r;for(r in d)p[r]=
a.get({spcName:r});return function(){for(var r in d){var v=b[r],t=e[r];e[r]=0;0<v?l[r]+=t/(v*f+1):0>v&&(l[r]+=1+Math.sqrt(t*(-v*f+1)),l[r]+=(h[0].x-h[1].x)*-v*f/2E3);l[r]=Math.min(l[r],p[r].length);if(v=Math.floor(l[r]))m.eject(a,window.dotManager,d,r,v,n,k,h),l[r]=0}}},setupSizeWall:function(a,d,b,e,f,k){var h=this;return function(){var l=h.getLiqWallVol(b,void 0,e),l=h.getWallHeight(Math.abs(d[f[0]].x-d[f[1]].x),l);a[0].y=d[f[0]].y-l;a[1].y=d[f[0]].y-l;a.parent.setupWall(a.parent.indexOf(a));k.val=
2*l+a[1].x-a[0].x}},setupCheckUpdateEquilPhaseDiagram:function(a,d,b){var e=d?d:b,f=0,k=this;return function(){e[e.length-1]!=k.equilData.pressure&&f++;15<f&&(k.updateEquilData(a,e),f=0)}},updateEquilData:function(a,d){a?this.equilData=a.setPressure(d[d.length-1]):this.isTwoComp&&(this.equilData=phaseEquilGenerator.constP(this.spcA,this.spcB,this.actCoeffFuncs,d[d.length-1],20))},eject:function(a,d,b,e,f,k,h,l){b=a.get({spcName:e});f=Math.min(b.length,f);f=b.slice(0,f);for(b=0;b<f.length;b++){e=f[b];
0==e.temp()&&(e.v.dy=-1);e.setTemp(this.temp);var m=e.hVap();e.v.dy=-Math.abs(e.v.dy);e.y=l[0].y-1;e.setWall(k.handle);h.splice(h.indexOf(e),1);a.remove(e);this.calcCp();this.temp-=m/this.Cp;0==this.Cp&&(this.temp=0,this.energyForDots-=m);0>this.temp&&(this.energyForDots-=this.Cp*(1-this.temp),this.temp=1)}d.add(f)},getPPure:function(a,d,b,e){return Math.pow(10,a-d/(e+b))*MMHGTOBAR},makeDrawList:function(a){for(var d=a.lists.ALLDOTS.concat(),b=[],e=0;e<a.lists.ALLDOTS.length;e++){var f=Math.floor(Math.random()*
d.length);b.push(d[f]);d.splice(f,1)}return b},hit:function(a,d,b,e,f,k,h){d=this.drivingForce;if(void 0!==d[a.spcName]&&(b=this.chanceZeroDf,b/=1-b,b/(b+Math.exp(-d[a.spcName]*this.drivingForceSensitivity))>Math.random()))return this.absorbDot(a,this.drawList,this.dotMgrLiq,this.wallLiq,this.spcDefs,this.dataGas.temp);this.dotMgrLiq.count?this.adjTemps(a,e,f,this.dataGas,this.dataLiq,this.temp,window.dotManager.spcLists,this.spcDefs):WallMethods.collideMethods.reflect(a,e,f)},hitNoPhaseChange:function(a,
d,b,e,f,k,h){this.adjTemps(a,e,f,this.dataGas,this.dataLiq,this.temp,window.dotManager.spcLists,this.spcDefs)},absorbDot:function(a,d,b,e,f,k){window.dotManager.remove(a);d.splice(Math.floor(Math.random()*d.length),0,a);a.setWall(e.handle);b.add(a);d=k[k.length-1];this.energyForDots+=(a.temp()-d)*a.cv;a.setTemp(d);d=this.Cp;this.calcCp();this.temp=(this.temp*d+a.tempCondense()*a.cpLiq)/this.Cp;this.numAbs[a.spcName]++;return!1},adjTemps:function(a,d,b,e,f,k,h,l){var m=e.temp[e.temp.length-1];e=a.temp();
f=a.cv;var n=0,p;for(p in l)n+=h[p].length*l[p].cv/N;h=getSign(k-m);k=Math.abs((k-(this.Cp*k+n*m)/(this.Cp+n))*this.Cp);k=Math.max(h*Math.min(k,100*f),(5-e)*f);f=e+k/f;h=1;0<this.temp-k/this.Cp&&(this.temp-=k/this.Cp,h=Math.sqrt(f/e),a.v.mult(h),a.internalPotential*=f/e);WallMethods.collideMethods.reflect(a,d,b*h)},getWallLiq:function(){return this.wallLiq},getWallGas:function(){return this.wallGas},addQ:function(a){var d=this.Cp;if(0!=d){var b=this.temp;a=Math.min(d*(3E3-b),Math.max((-b+10)*d,a));
this.temp+=a/d;this.wallLiq.q+=a}},wrapMakePhaseDiagram:function(a,d,b,e,f,k,h,l,m){var n=this,p=this.makePhaseDiagram;return function(){return p.apply(n,[a,d,b,e,f,k,h,l,m])}},makePhaseDiagram:function(a,d,b,e,f,k,h,l,m){var n,p,r;for(r in d)n?p=r:n=r;this.isTwoComp?(a={x:{min:0,step:0.2},y:{min:300,step:1}},b=new GraphPhaseTwoComp({spcAName:n,spcBName:p,axisInit:a,actCoeffFuncs:b,handle:e,primaryKey:f,liquid:this,wallGas:this.wallGas,makeGasMarker:k,makeSystemMarker:h,makeLiquidMarker:l,pressure:m})):
(a={x:{min:200,step:1}},b=new GraphPhaseOneComp({spcName:n,axisInit:a,handle:e,liquid:this,wallGas:this.wallGas,makeSystemMarker:h,logScale:{y:!0},criticalPointTemp:this.criticalPointTemp,triplePointTemp:this.triplePointTemp}));return b},addWallBound:function(a){a.setBounds(void 0,this.wallLiq[0]);var d=new WallMethods.BoundHandler(function(a,d,f){d=a.vs[0].dy;var k=a.mass;d=(0.5*k*d*d+k*window.g*(f-a[0].y))*window.tConst*window.KB;a.vs[0].dy=0;a.vs[1].dy=0;this.temp+=d/this.Cp;return f},this,!0);
a.addBoundHandler("max",d);return d},remove:function(){removeListener(curLevel,"update",this.updateListenerName);this.wallGas.removeLiquid(this);this.heater&&this.heater.removeLiquid();this.wallLiq.removed||walls.removeWall(this.wallLiq.handle);this.wallGas.removed||this.wallGas.removeSurfAreaAdjust(this.handle)}});function Outlet(a){this.arrowDims=V(15,20);this.arrowFill=Col(200,0,0);this.arrowStroke=Col(100,100,100);this.type="Outlet";this.handle=a.handle;this.width=defaultTo(30,a.height);this.depth=defaultTo(20,a.depth)||20;this.fracOpen=defaultTo(1,a.fracOpen);this.makePts=this.depth;this.wallInfo=a.wallInfo;this.wall=walls[this.wallInfo];this.ptIdxs=a.ptIdxs;this.fracOffset=defaultTo(0.5,a.fracOffset);this.arrows=[];this.init()}
_.extend(Outlet.prototype,flowFuncs,objectFuncs,{init:function(){this.addPts();this.makePts&&this.wall.addPts(this.ptIdxs[1],this.pts);var a=Math.min(this.ptIdxs[0],this.ptIdxs[1])+2;this.arrows=this.addArrows(this.pts[1].VTo(this.pts[2]).UV().perp("cw"));walls.setSubWallHandler(this.wallInfo,a,"outlet")},remove:function(){this.arrows.map(function(a){a.remove()})}});function ParticleEmitter(a){this.type="ParticleEmitter";this.pos=a.pos;this.handle=a.handle;this.dir=a.dir;this.parentList=a.parentList;this.width=a.width;this.col=a.col;this.dist=a.dist;this.onGenerate=a.onGenerate;this.onArrive=a.onArrive;this.onRemove=a.onRemove;this.rate=defaultTo(Math.round(0.1*this.width),a.rate);this.speed=defaultTo(5,a.speed);this.speedSpread=defaultTo(1,a.speedSpread);2*this.speedSpread>this.speed&&console.log("Uh-oh.  Making particle emitter with handle "+this.handle+" with speed spread such that particles will hit ~0 speed");
this.accel=defaultTo(0.5,a.accel);this.accelSpread=defaultTo(1,a.accelSpread);this.dirSpread=defaultTo(0,a.dirSpread);this.drawCanvas=defaultTo(c,a.drawCanvas);this.makeBounds();this.setupStd();this.particles=[];return this.init()}
_.extend(ParticleEmitter.prototype,objectFuncs,{init:function(){this.runListenerName=unique("particle"+this.handle,curLevel.updateListeners);addListener(curLevel,"update",this.runListenerName,this.run,this);return this},adjust:function(a){for(var d in a)this[d]=a[d];this.makeBounds()},makeBounds:function(){this.UV=angleToUV(this.dir);var a=this.pos.copy().movePt(this.UV.copy().rotate(-Math.PI/2).mult(this.width/2)),d=this.pos.copy().movePt(this.UV.copy().rotate(Math.PI/2).mult(this.width/2));this.prodPt=
a;this.prodV=a.VTo(d);this.finishPt=a.copy().movePt(this.UV.copy().mult(this.dist));this.finishV=this.finishPt.VTo(this.prodPt)},run:function(){this.generateNew();this.updateParticles();this.draw()},trickleOut:function(){this.updateParticles();this.draw();0==this.particles.length&&this.remove()},generateNew:function(){for(var a=Math.round(Math.random()*this.rate),d=0;d<a;d++)this.particles.push(this.newParticle()),this.onGenerate&&this.onGenerate.func.apply(this.onGenerate.obj)},newParticle:function(){var a=
this.prodPt.copy().movePt(this.prodV.copy().mult(Math.random())),d=Math.max(0.01,this.speed+this.speedSpread*(Math.random()-0.5)),b=Math.max(0,this.accel+this.accelSpread*(Math.random()-0.5)),e=angleToUV(this.dir+this.dirSpread*(Math.random()-0.5)),f=this.getlifespan(a,d,b,e);return{pos:a,V:e.copy().mult(d),accelV:e.copy().mult(b),age:0,lifespan:f}},getlifespan:function(a,d,b,e){a=e.dotProd(this.UV);b=0.5*b*a;d*=a;return(-d+Math.sqrt(d*d-4*b*-this.dist))/(2*b)},updateParticles:function(){for(var a=
this.particles.length-1;0<=a;a-=1){var d=this.particles[a];d.pos.movePt(d.V);d.V.add(d.accelV);d.age++;d.age>d.lifespan&&(this.particles.splice(a,1),this.onArrive&&this.onArrive.func.apply(this.onArrive.obj))}},draw:function(){this.drawCanvas.strokeStyle=this.col.hex;for(var a=0;a<this.particles.length;a++){var d=this.particles[a];c.beginPath();c.moveTo(d.pos.x,d.pos.y);c.lineTo(d.pos.x+2,d.pos.y+2);c.stroke()}},stopFlow:function(){removeListener(curLevel,"update",this.runListenerName);addListener(curLevel,
"update",this.runListenerName,this.trickleOut,this)},remove:function(){this.onRemove&&this.onRemove.func.apply(this.onRemove.obj);this.parentList&&this.parentList.splice(_.indexOf(this.parentList,this),1);removeListener(curLevel,"update",this.runListenerName);this.removed=!0}});function Piston(a){this.type="Piston";this.handle=a.handle;this.wallInfo=defaultTo(0,a.wallInfo);this.wall=walls[this.wallInfo];this.min=defaultTo(2,a.min);this.max=defaultTo(15,a.max);this.makeSlider=defaultTo(!1,a.makeSlider);this.drawCanvas=defaultTo(c,a.drawCanvas);this.slant=0.07;this.sliderWrapper=a.sliderWrapper;this.sliderTitleWrapper=a.sliderTitleWrapper;this.left=this.wall[0].x;this.width=this.wall[1].x-this.left;this.pistonPt=this.wall[0];var d=defaultTo(2,a.init);this.setPressure(d);this.height=
500;this.draw=this.makeDrawFunc(this.height,this.left,this.width);this.dataSlotFont="12pt Calibri";this.dataSlotFontCol=Col(255,255,255);this.pStep=0.05;var b=this.left+this.width*this.slant,e=this.left+this.width-this.width*this.slant,f=this.pistonBottom.pos.y-2+this.pistonPt.y,k=Col(255,255,255);this.readout=new Readout("pistonReadout"+this.handle.toCapitalCamelCase(),b,e,f,"12pt calibri",k,"center",curLevel);this.wall.moveInit();this.wall.recordPExt();this.wall.recordWork();this.wallHandler=defaultTo("cPAdiabaticDamped",
a.compMode);walls.setSubWallHandler(this.wallInfo,0,this.wallHandler);this.makeSlider&&(this.sliderSelector=this.addSlider("Pressure",{value:this.pToPercent(d)},[{eventType:"slide",obj:this,func:this.parseSlider}],this.sliderWrapper,this.sliderTitleWrapper),this.slider=$(this.sliderSelector));this.setupStd();return this.show()}
_.extend(Piston.prototype,objectFuncs,compressorFuncs,{makeDrawFunc:function(a,d,b){var e=a-45;this.pistonTop=this.makeTop(d,b,30,e,a,35,10);this.pistonBottom=this.makePlateBottom(P(d,-a+e+35),V(b,10));var f=this;return function(){f.readout&&f.setReadoutY();f.drawCanvas.save();f.drawCanvas.translate(0,f.pistonPt.y);draw.fillPts(f.pistonTop.pts,f.pistonTop.col,f.drawCanvas);draw.fillRect(f.pistonBottom.pos,f.pistonBottom.dims,f.pistonBottom.col,f.drawCanvas);f.drawCanvas.restore()}},makeTop:function(a,
d,b,e,f,k,h){var l=this.slant,m=1-l,n=Array(14);f=P(a+d/2-b/2,-f);var p=Col(150,150,150);d=V(d,k);a=f.copy().movePt({dy:e}).position({x:a});n[0]=P(a.x,a.y+d.dy+1);n[1]=P(a.x+d.dx*l,a.y);n[2]=P(f.x-d.dx*l,a.y);n[3]=P(f.x,a.y-5*d.dy*l);n[4]=P(f.x,f.y);n[5]=P(f.x+b,f.y);n[6]=P(f.x+b,a.y-5*d.dy*l);n[7]=P(f.x+b+d.dx*l,a.y);n[8]=P(a.x+d.dx*m,a.y);n[9]=P(a.x+d.dx,a.y+d.dy+1);n[10]=P(a.x+d.dx-h,a.y+d.dy+1);n[11]=P(a.x+d.dx*m-h,a.y+h);n[12]=P(a.x+d.dx*l+h,a.y+h);n[13]=P(a.x+h,a.y+d.dy+1);p=Col(150,150,150);
return{pts:n,col:p}},makePlateBottom:function(a,d){var b=Col(100,100,100);d.adjust(0,1);return{pos:a,dims:d,col:b}},enable:function(){this.slider&&this.slider.slider("option","disabled",!1);this.setMass(this.massStore);delete this.massStore;this.enabled=!0},disable:function(){this.slider&&this.slider.slider("option","disabled",!0);this.massStore=this.mass;this.setMass(0);this.enabled=!1},show:function(){addListener(curLevel,"update","drawPiston"+this.handle,this.draw,"");this.readout.show();return this},
pToPercent:function(a){return 100*(a-this.min)/(this.max-this.min)},hide:function(){removeListener(curLevel,"update","drawPiston"+this.handle);this.readout.hide()},parseSlider:function(a,d){this.setPressure(this.percentToVal(d.value))},setPressure:function(a){this.setMass(this.pressureToMass(a))},setMass:function(a){this.mass=a;this.wall.setMass("piston"+this.handle,this.mass)},setReadoutY:function(){this.readout.position({y:this.pistonBottom.pos.y-2+this.pistonPt.y})},remove:function(){this.wall.moveStop();
this.wall.unsetMass("piston"+this.handle);this.hide();this.sliderId&&this.removeSlider();this.hideSliderDivs();removeListener(curLevel,"update","moveWalls")}});function QArrowsAmmt(a){this.type="QArrowsAmmt";this.wallHandle=a.wallInfo;this.wall=walls[this.wallHandle];this.handle=a.handle;var d=this.wall;d.recordQ();var b=3*(1/a.scale);this.qArrowAmmtMax=isNaN(b)?3:b;this.qArrowAmmtMax=defaultTo(3,3*(1/a.scale));addListener(d,"cleanUp","qArrowsAmmt",function(){for(var a=0;a<this.qArrowsAmmt.length;a++)this.qArrowsAmmt[a].remove();removeListener(curLevel,"update",this.listenerName)},this);this.init(this.wall,this.qArrowAmmtMax);this.setupStd()}
_.extend(QArrowsAmmt.prototype,objectFuncs,{init:function(a,d){Col(175,0,0);var b=V(30,10),e=a[3].copy().fracMoveTo(a[2],0.25),f=a[3].copy().fracMoveTo(a[2],0.75),k=f.VTo(e).perp("cw").UV();e.movePt(k.copy().mult(5));f.movePt(k.copy().mult(5));var e=new ArrowStatic({pos:e,dims:b,fill:Col(175,0,0),stroke:Col(0,0,0),label:"Q",UV:k}),b=new ArrowStatic({pos:f,dims:b,fill:Col(175,0,0),stroke:Col(0,0,0),label:"Q",UV:k}),h=d/65;this.qArrowsAmmt=[e,b];var l="out";qLast=a.q;this.setAmmtArrowDims(this.qArrowsAmmt,
15,80,70,90,a.q,d);0<=a.q&&(l="in",this.flipAmmtArrows(this.qArrowsAmmt));this.listenerName=this.handle+"updateQAmmtArrows";addListener(curLevel,"update",this.listenerName,function(){Math.abs(a.q-qLast)>h&&(dir=0>a.q?"out":"in",this.setAmmtArrowDims(this.qArrowsAmmt,15,80,70,90,a.q,d),l!=dir&&(this.flipAmmtArrows(this.qArrowsAmmt),l=dir),qLast=a.q)},this)},flipAmmtArrows:function(a){for(var d=0;d<a.length;d++){var b=a[d],e=angleToUV(b.getAngle()).mult(1);b.move(e.mult(b.getDims().dx));b.rotate(Math.PI)}},
setAmmtArrowDims:function(a,d,b,e,f,k,h){for(var l=0;l<a.length;l++){var m=a[l],n=m.getDims(),p=Math.abs(k)/h,r=d+(b-d)*p;m.size(V(r,e+(f-e)*p));0<k&&m.move(V(0,r-n.dx))}},remove:function(){removeListener(curLevel,"update",this.listenerName)}});function RMSChanger(a){this.type="RMSChanger";this.info=a.info;this.min=defaultTo(1,a.min);this.val=dataHandler.RMS(this.info);this.max=defaultTo(15,a.max);this.handle=a.handle;this.totalDots=dataHandler.count(this.info);this.sliderPos=a.sliderPos;this.setupStd();return this.init()}
_.extend(RMSChanger.prototype,objectFuncs,{init:function(){this.sliderId=this.addSlider(1<this.totalDots?"Molecules' RMS":"Molecule's RMS",{value:this.valToPercent(this.val)},[{eventType:"slide",obj:this,func:this.parseSlider}],this.sliderPos)},parseSlider:function(a,d){changeRMS(this.info,this.percentToVal(d.value))},remove:function(){this.removeSlider()}});function Sandbox(a){this.type="Sandbox";this.handle=a.handle;this.emitterNum=0;a=defaultTo({},a);this.bin={};this.sand={};this.drawCanvas=defaultTo(c,a.drawCanvas);this.wallInfo=defaultTo(0,a.wallInfo);this.wall=walls[this.wallInfo];this.mass=this.pressureToMass(defaultTo(2,a.init));this.massMin=this.pressureToMass(defaultTo(0.5,a.min));this.massMax=this.pressureToMass(defaultTo(15,a.max));this.particleMass=defaultTo(0.01,a.partMass);this.buttonAddId="sandAdd"+this.handle;this.buttonRemoveId="sandRemove"+
this.handle;this.makeButtons();this.massChunkName="sandMass"+defaultTo("",this.handle);this.wall.setMass(this.massChunkName,this.mass);this.wall.recordPExt();this.wall.recordWork();this.wallHandler=defaultTo("cPAdiabaticDamped",a.compMode);walls.setSubWallHandler(this.wallInfo,0,this.wallHandler);this.trackingPts=[];this.wallPt=this.wall[0];this.emitters=[];this.binX=(this.wall[1].x+this.wall[0].x)/2;this.spcVol=70;this.sand.col=defaultTo(Col(224,165,75),a.sandCol);this.sand.pts=this.getSandPts();
this.sand.pos=P(this.binX,this.wall[0].y).track({pt:this.wallPt,noTrack:"x"});this.trackingPts.push(this.sand.pos);this.pistonPt=this.wall[0].y;this.setupStd();return this.init()}
_.extend(Sandbox.prototype,compressorFuncs,objectFuncs,{init:function(){this.drawListenerName=unique("drawSand"+this.handle,curLevel.updateListeners);addListener(curLevel,"update",this.drawListenerName,this.draw,this);this.wall.moveInit();this.wall.recordMass();this.wall.recordPExt();return this},makeButtons:function(){var a=this,d=this.handle+"SandButtons";buttonManager.addGroup(d,"Sand controls");buttonManager.addButton(d,"add","Add mass",{mousedown:function(){a.buttonAddDown()}});buttonManager.addButton(d,
"remove","Remove mass",{mousedown:function(){a.buttonRemoveDown()}})},removeButtons:function(){$("#"+this.buttonAddId).remove();$("#"+this.buttonRemoveId).remove()},draw:function(){this.drawCanvas.save();this.drawCanvas.translate(this.sand.pos.x,this.sand.pos.y);var a=Math.sqrt(0.4*this.mass);this.drawCanvas.scale(a,a);draw.fillPts(this.sand.pts,this.sand.col,this.drawCanvas);this.width=a*(this.sand.pts[this.sand.pts.length-1].x-this.sand.pts[0].x);this.drawCanvas.restore()},getSandPts:function(){var a=
Array(4);a[0]=P(-10,0);a[1]=P(-7,-2);a[2]=P(-3,-6);a[3]=P(0,-7);ptsRight=deepCopy(a).splice(0,a.length-1).reverse();mirrorPts(ptsRight,P(0,0),V(0,-10));return a=a.concat(ptsRight)},buttonAddDown:function(){this.mass<this.massMax&&(this.boundUpper(),this.addMass(),addListener(curLevel,"mouseup","mouseUpSandbox",this.buttonAddUp,this))},buttonAddUp:function(){this.boundUpperStop();this.addMassStop();removeListener(curLevel,"mouseup","mouseUpSandbox")},buttonRemoveDown:function(){this.mass>this.massMin&&
(this.boundLower(),this.removeMass(),addListener(curLevel,"mouseup","mouseUpSandbox",this.buttonRemoveUp,this))},buttonRemoveUp:function(){this.boundLowerStop();this.removeMassStop();removeListener(curLevel,"mouseup","mouseUpSandbox")},boundUpper:function(){var a=this.handle+"BoundUpper";curLevel.updateListeners[a]||addListener(curLevel,"update",a,function(){this.mass>this.massMax&&(this.stopAllEmitters(),removeListener(curLevel,"update",a))},this)},boundLower:function(){var a=this.handle+"BoundLower";
curLevel.updateListeners[a]||addListener(curLevel,"update",a,function(){this.mass<this.massMin&&(this.stopAllEmitters(),removeListener(curLevel,"update",a))},this)},boundUpperStop:function(){removeListener(curLevel,"update",this.handle+"BoundUpper")},boundLowerStop:function(){removeListener(curLevel,"update",this.handle+"BoundLower")},stopAllEmitters:function(){for(var a=0;a<this.emitters.length;a++)this.emitters[a].stopFlow()},addMass:function(){this.emitters.push(this.makeAddEmitter())},addMassStop:function(){this.emitters[this.emitters.length-
1].stopFlow()},removeMass:function(){this.emitters.push(this.makeRemoveEmitter())},removeMassStop:function(){this.emitters[this.emitters.length-1].stopFlow()},makeAddEmitter:function(){var a=this.handle+this.emitterNum;this.emitterNum++;var d={func:this.onArriveAdd,obj:this},b=this.emitters.length,e=Math.PI/2,f=this.sand.col,k=this.wall[0].y,h=new ParticleEmitter({pos:P((this.wall[0].x+this.wall[1].x)/2,0),width:this.width,dist:k,dir:e,col:f,onRemove:l,parentList:this.emitters,onArrive:d,handle:a});
h.adding=!0;moveListenerName=unique("adjustEmitter"+b,curLevel.updateListeners);addListener(curLevel,"update",moveListenerName,function(){h.adjust({dist:this.wallPt.y,width:this.width})},this);var l={func:function(){removeListener(curLevel,"update",moveListenerName)},obj:this};return h},makeRemoveEmitter:function(){var a=this.handle+this.emitterNum;this.emitterNum++;var d={func:this.onGenerateRemove,obj:this},b=this.emitters.length,e=-Math.PI/2,f=this.sand.col,k=(this.wall[0].x+this.wall[1].x)/2,
h=this.wall[0].y,l=new ParticleEmitter({pos:P(k,0),width:this.width,dist:h,dir:e,col:f,onRemove:n,parentList:this.emitters,onGenerate:d,handle:a});l.removing=!0;moveListenerName=unique("adjustEmitter"+b,curLevel.updateListeners);var m=this.wall[0];addListener(curLevel,"update",moveListenerName,function(){l.adjust({pos:P(k,m.y),dist:m.y,width:this.width})},this);var n={func:function(){removeListener(curLevel,"update",moveListenerName)},obj:this};return l},onGenerateRemove:function(){this.mass-=this.particleMass;
this.wall.setMass(this.massChunkName,this.mass)},onArriveAdd:function(){this.mass+=this.particleMass;this.wall.setMass(this.massChunkName,this.mass)},remove:function(){for(var a=0;a<this.emitters.length;a++)this.emitters[a].remove();this.emitters=[];this.trackingPts.map(function(a){a.trackStop()});this.trackingPts.splice(0,this.trackingPts.length);this.removeButtons();removeListener(curLevel,"update",this.drawListenerName);removeListener(curLevel,"data",this.cleanUpEmittersListenerName);this.wall.moveStop()}});function Stops(a){this.type="Stops";this.handle=a.handle;this.stopWidth=20;this.stopHeight=5;this.boundToSet=void 0;var d=a.stopPt;this.wallInfo=defaultTo(0,a.wallInfo);this.pts=this.wall=walls[this.wallInfo];if(d.vol){var b=this.pts[0].distTo(this.pts[1]);this.height=this.pts[2].y-d.vol/(vConst*b)}else d.y&&(this.height=d.height);if(this.willDraw=defaultTo(!0,a.draw))this.draw=this.makeDrawFunc(this.height);this.setupStd();return this.init()}
_.extend(Stops.prototype,objectFuncs,{makeDrawFunc:function(a){var d=this.pts[3].copy().position({y:a}),b=this.pts[2].copy().position({y:a}).movePt({dx:-this.stopWidth}),e=V(this.stopWidth,this.stopHeight),f=borderCol;return function(){draw.fillRect(d,e,f,c);draw.fillRect(b,e,f,c)}},init:function(){this.boundToSet=this.height>this.wall[0].y?"max":"min";this.yBoundSave=this.wall.bounds[this.boundToSet];"max"==this.boundToSet?walls[this.wallInfo].setBounds(void 0,this.height):"min"==this.boundToSet&&
walls[this.wallInfo].setBounds(this.height,void 0);this.willDraw&&addListener(curLevel,"update","drawStops"+this.wallInfo,this.draw,"");return this},remove:function(){window.walls&&!walls.removed&&("max"==this.boundToSet?walls[this.wallInfo].setBounds(void 0,this.yBoundSave):"min"==this.boundToSet&&walls[this.wallInfo].setBounds(this.yBoundSave,void 0));this.willDraw&&removeListener(curLevel,"update","drawStops"+this.wallInfo);return this}});function TempChanger(a){this.type="tempChanger";this.info=a.info;this.min=defaultTo(100,a.min);this.val=dataHandler.temp(this.info);this.max=defaultTo(1500,a.max);this.sliderPos=a.sliderPos;this.handle=a.handle;this.totalDots=dataHandler.count(this.info);this.setupStd();return this.init()}
_.extend(TempChanger.prototype,objectFuncs,{init:function(){this.sliderId=this.addSlider(1<this.totalDots?"System temperature":"Molecule's kinetic energy",{value:this.valToPercent(this.val)},[{eventType:"slide",obj:this,func:this.parseSlider}],this.sliderPos)},parseSlider:function(a,d){changeTemp(this.info,this.percentToVal(d.value))},remove:function(){this.removeSlider()}});function Tracer(a){this.handle=a.handle;this.type="Tracer";this.info=a.info;this.col=defaultTo(Col(175,175,175),a.col);this.lifespan=Math.round(1E3/updateInterval*defaultTo(5,a.lifespan));this.listenerHandle=this.type+this.handle+"Draw";this.listenerHandleSearch=this.type+this.handle+"Search";this.setupStd();this.drawCanvas=c;this.drawingTools=draw;this.init()}
_.extend(Tracer.prototype,objectFuncs,{init:function(){this.dot=this.getDot();this.pts=[];this.dot?(removeListener(curLevel,"update",this.listenerHandleSearch),addListener(curLevel,"update",this.listenerHandle,this.draw,this)):addListener(curLevel,"update",this.listenerHandleSearch,this.init,this)},getDot:function(){var a=dotManager.get(this.info);if(0<a.length)return this.info.idx&&this.info.idx<a.length?a[this.info.idx]:a[Math.floor(Math.random()*a.length)]},draw:function(){this.dot.active?(this.pts.push(P(this.dot.x,
this.dot.y)),this.pts.length>this.lifespan&&this.pts.splice(0,1),this.drawingTools.path(this.pts,this.col,this.drawCanvas)):this.init()},remove:function(){removeListener(curLevel,"update",this.listenerHandleSearch);removeListener(curLevel,"update",this.listenerHandle)}});function Trigger(a){this.type="Trigger";this.handle=a.handle;this.conditionFunc=this.wrapExpr(a.expr);this.checkOn=a.checkOn;this.requiredFor=!1===a.requiredFor?void 0:a.requiredFor||"now";this.message=a.message;this.priority=defaultTo(0,a.priorityUnsatisfied||a.priority);this.satisfyStore=defaultTo(void 0,a.satisfyStore);this.satisfyCmmds=defaultTo(void 0,a.satisfyCmmds);this.amSatisfied=!1;this.setupStd();this.init()}
_.extend(Trigger.prototype,objectFuncs,{init:function(){"conditions"==this.checkOn?this.initCheckOnConditions():this.initCheckOnInterval()},wrapExpr:function(a){with(DataGetFuncs)a=eval("(function() {return "+a+"})");return a},initCheckOnConditions:function(){this.requiredFor&&conditionManager.add(this)},initCheckOnInterval:function(){addListener(curLevel,"update",this.handle,function(){if(this.conditionFunc()){this.amSatisfied=!0;this.recordVals();if(this.satisfyCmmds)for(var a=0;a<this.satisfyCmmds.length;a++)eval(this.satisfyCmmds[a]);
removeListener(curLevel,"update",this.handle)}},this);this.requiredFor&&conditionManager.add(this)},recordVals:function(){with(DataGetFuncs)if(this.satisfyStore)for(var a=0;a<this.satisfyStore.length;a++){var d=this.satisfyStore[a],b=d.storeAs,d=eval(d.expr);store(b,d)}},isSatisfied:function(){return this.amSatisfied},remove:function(){removeListener(curLevel,"update",this.handle)}});function AuxImage(a){this.type="AuxImage";this.handle=a.handle;this.imgFunc=a.imgFunc;this.slotNum=a.slotNum;this.dims=this.getDims();this.bgCol=curLevel.bgCol;this.makeDiv(this.slotNum);this.addImage(this.imgFunc);curLevel.auxs[this.handle]=this;this.setupStd()}
_.extend(AuxImage.prototype,AuxFunctions,objectFuncs,{makeDiv:function(a){this.parentDiv=this.pickParentDiv("picture",a);this.parentDiv.html("");$(this.parentDiv).css({width:this.dims.dx,height:this.dims.dy,"background-color":this.bgCol.hex,"border-radius":20,padding:0})},addImage:function(a){var d=this;a=interpreter.parseImgFunc(a,!0);a.attrs||(a.attrs={});a.attrs.id=[this.type+this.handle];$(this.parentDiv).append(templater.img(a));var b=$("#"+a.attrs.id[0]);$(b).load(function(){var a=V(d.parentDiv.width(),
d.parentDiv.height()),f=V(b.width(),b.height()),k=Math.min(f.dx,a.dx)/f.dx,h=Math.min(f.dy,a.dy)/f.dy,k=Math.min(k,h),f=f.copy().mult(k),a=P(a.dx/2-f.dx/2,a.dy/2-f.dy/2);$(b).css({position:"absolute",left:a.x,top:a.y,width:f.dx,height:f.dy})})},clearHTML:function(){this.cleanUpParent()},restoreHTML:function(){$(this.parentDiv).css({width:this.dims.dx,height:this.dims.dy,"background-color":this.bgCol.hex,"border-radius":20,padding:0});this.addImage(this.imgFunc)},remove:function(){this.cleanUpParent();
delete curLevel.auxs[this.handle]}});function AnimText(a){this.drawCanvas=a}
AnimText.prototype={newAnim:function(a,d,b){var e=unique("animText",curLevel.updateListeners),f=b.text,k=new Boolean,h=new Boolean,l=new Boolean,m=new Boolean,k=void 0!==d.pos,h=void 0!==d.col,l=void 0!==d.rotation,m=void 0!==d.size,n;n=Col(255,255,255);var p=defaultTo("calibri",b.font),r=defaultTo("center",b.align);b=defaultTo(300,b.time);var s,v,t,x;a.size=defaultTo(13,a.size);a.rot=defaultTo(0,a.rot);a.col=defaultTo(n,a.col);s=a.size;v=a.rot;t=a.col;x=a.pos.copy();var w=Math.floor(b/updateInterval),
y=function(){},z=function(){},A=function(){},F=function(){},u,C,B,W,E,M;k&&(k=V(d.pos.x-a.pos.x,d.pos.y-a.pos.y),u=k.UV().mult(k.mag()/w),y=function(){x.x+=u.dx;x.y+=u.dy});h&&(C=Math.ceil((d.col.r-a.col.r)/w),B=Math.ceil((d.col.g-a.col.g)/w),W=Math.ceil((d.col.b-a.col.b)/w),z=function(){t.adjust(C,B,W)});l&&(h=d.rotation-a.rotation,E=h<=Math.PI?h/w:-h/w,A=function(){v+=E});m&&(M=(d.size-a.size)/w,F=function(){s+=M});var Y=0,ba=this.drawCanvas;addListener(curLevel,"update",e,function(){draw.text(f,
x,Math.floor(s)+"pt "+p,t,r,v,ba);y();z();A();F();Y==w&&removeListener(curLevel,"update",e);Y++},"")}};function Readout(a,d,b,e,f,k,h,l){this.handle=a;this.align=defaultTo("left",h);this.drawCanvas=c;this.font=defaultTo("13pt calibri",f);this.fontCol=defaultTo(Col(255,255,255),k);this.leftBound=d;this.width=b-d;this.y=e;this.entries=[];l.readouts[a]=this}
Readout.prototype={draw:function(){this.drawCanvas.save();this.drawCanvas.translate(this.leftBound,this.y);for(var a=0;a<this.entries.length;a++){var d=this.entries[a];window.draw.text(d.text,d.pos,this.font,this.fontCol,this.align,0,this.drawCanvas)}this.drawCanvas.restore()},update:function(a,d){var b=byAttr(this.entries,a,"name");b.val=round(d,b.decPlaces)},addEntry:function(a,d){var b=new this.Entry(a,"",this);d?this.entries.splice(d,0,b):this.entries.push(b);this.positionEntries();this.hide().show();
return b},removeEntry:function(a){for(var d=0;d<this.entries.length;d++)if(this.entries[d].handle==a)return this.entries.splice(d,1),this.positionEntries(),this;console.log("Tried to remove entry that does not exist: "+a)},entryExists:function(a){for(var d=0;d<this.entries.length;d++)if(this.entries[d].name==a)return!0;return!1},removeAllEntries:function(){this.entries=[]},positionEntries:function(){var a=this.entries.length,d;d=1<a?Math.floor(this.width/(a-1)):this.width;if("center"==this.align){d=
this.width/(a+1);for(var b=0;b<a;b++){var e=this.entries[b],f=d*(b+1),k=0;e.pos=P(f,k)}}else if("left"==this.align)for(b=0;b<a;b++)e=this.entries[b],f=d*b,k=0,e.pos=P(f,k)},getNumEntries:function(){var a=0,d;for(d in this.entries)a++;return a},reset:function(a){var d=byName(this.entries,a);this.tickReadout(d.curVal,d.setPt,a)},resetAll:function(){for(var a=0;a<this.entries.length;a++){var d=this.entries[a];this.hardUpdate(d.initVal,d.name)}},position:function(a){void 0!==a.x&&(this.leftBound=a.x);
void 0!==a.y&&(this.y=a.y)},show:function(){curLevel.readouts[this.handle]=this;addListener(curLevel,"update","drawReadout"+this.handle,this.draw,this);return this},hide:function(){delete curLevel.readouts[this.handle];removeListener(curLevel,"update","drawReadout"+this.handle);return this},Entry:function(a,d,b){this.handle=a;this.text=d;this.pos=void 0;this.readout=b}};Readout.prototype.Entry.prototype={setText:function(a){this.text=a},remove:function(){this.readout.removeEntry(this.handle)}};LevelTools={setStds:function(){this.graphs={};this.bgCol=Col(5,17,26);this.wallCol=Col(255,255,255);this.numUpdates=0;this.wallSpeed=defaultTo(1,this.wallSpeed);this.makeListenerHolders();this.auxs={};this.gravitying=this.attracting=!1;this.setUpdateRunListener();addListener(this,"data","run",this.dataRun,this)},addStoreAs:function(a){for(var d=0,b=0;b<a.length;b++)for(var e=a[b],f=0;f<e.prompts.length;f++){var k=e.prompts[f];if(k.quiz)for(var h=0;h<k.quiz.length;h++){var l=k.quiz[h];void 0===l.storeAs&&
(l.storeAs="questionAnswer"+String(d));d++}}},addImgsAndQuestionIds:function(a,d){for(var b=0;b<a.length;b++){var e=a[b];e.prompts||console.log("Section "+b+" has no prompts!  Sections must have at least one prompt.");for(var f=0;f<e.prompts.length;f++){var k=prompt.title,h=prompt.text,l=prompt.quiz;k&&(prompt.title=interpreter.interpImgs(k));h&&(prompt.text=interpreter.interpImgs(k));if(l)for(k=0;k<l.length;k++)if(h=l[k],h.storeAs||(h.storeAs="storeAs"+d),d++,h.options)for(optionIdx=0;optionIdx<
h.options.length;optionIdx++){var m=h.options[optionIdx];for(optionElement in m){var n=m[optionElement];"string"==typeof n&&(m[optionElement]=interpreter.interpImgs(n))}}}}return d},transferObjCleanUp:function(a){for(var d=0;d<a.length;d++){var b=a[d];b.sceneData&&this.transferObjDataCleanUp(b.sceneData.objs);for(var e=0;e<b.prompts.length;e++){var f=b.prompts[e];f.sceneData&&this.transferObjDataCleanUp(f.sceneData.objs)}}},transferObjDataCleanUp:function(a){if(a)for(var d=0;d<a.length;d++){var b=
a[d];b.attrs.cleanUpWith&&!b.cleanUpWith&&(b.cleanUpWith=b.attrs.cleanUpWith)}},addTriggerCleanUp:function(a){for(var d=0;d<a.length;d++){var b=a[d];b.sceneData&&this.addTriggerDataCleanUp(b.sceneData.triggers);for(var e=0;e<b.prompts.length;e++){var f=b.prompts[e];f.sceneData&&this.addTriggerDataCleanUp(f.sceneData.triggers)}}},addTriggerDataCleanUp:function(a){a=a||[];for(var d=0;d<a.length;d++){var b=a[d];!b.cleanUpWith&&(b.requiredFor&&"now"!=b.requiredFor)&&(b.cleanUpWith=b.requiredFor)}},setDefaultPromptVals:function(a){for(var d=
0;d<a.length;d++)for(var b=a[d],e=0;e<b.prompts.length;e++){var f=b.prompts[e];f.finished=!1;f.title=defaultTo("",f.title);f.text=defaultTo("",f.text)}},addUF298:function(a){for(var d=0;d<a.length;d++)a[d].uF298=a[d].hF298-298.15*R/1E3},addCp:function(a){for(var d=0;d<a.length;d++)a[d].cp=a[d].cv+R},addSpcs:function(a,d,b){for(var e=0;e<a.length;e++){var f=a[e],k=new Species(f.spcName,f.m,f.r,f.col,e,f.cv,f.hF298,f.hVap298,f.sF298,f.antoineCoeffs,f.cpLiq,f.spcVolLiq,b);d[f.spcName]=k}},move:function(){var a=
this.spcs,d;for(d in a)for(var b=a[d].dots,e=0;e<b.length;e++)b[e].x+=b[e].v.dx,b[e].y+=b[e].v.dy},cutSceneStart:function(a,d,b){this.inCutScene=!0;$("#intText").html("");a=defaultTo("",a);this.pause();$("#dashRunWrapper").hide();$("#buttonManager").hide();!0===d?($("#dashCutScene").show(),this.cutSceneText(a),$("#prompt").html("")):"intro"==d?($("#dashIntro").show(),$("#base").hide(),this.cutSceneText(a)):"outro"==d&&($("#dashOutro").show(),$("#base").hide(),this.cutSceneText(a));$("#canvasDiv").hide();
$("#display").show();this.cutSceneDivShow()},cutSceneDivShow:function(){$("#intText").show()},cutSceneText:function(a){$("#intText").html(a)},showRunDivs:function(){$("#intText").html("");$("#dashRunWrapper").show();$("#buttonManager").show();$("#dashRun").show();$("#dashOutro").hide();$("#dashIntro").hide();$("#dashCutScene").hide();$("#nextPrevDiv").show();$("#base").show();$("#canvasDiv").show();$("#display").hide();$("#intText").hide()},cutSceneEnd:function(){this.inCutScene=!1;this.resume();
this.showRunDivs();$("#intText").html("")},pause:function(){this.updateStore=this.update;this.updateDataStore=this.updateData;this.update=function(){};this.updateData=function(){}},resume:function(){this.updateStore&&(this.update=this.updateStore);this.updateDataStore&&(this.updateData=this.updateDataStore)},hideDash:function(){$("#dashIntro").hide();$("#dashRunWrapper").hide();$("#dashOutro").hide();$("#dashCutScene").hide()},update:function(){this.numUpdates++;turn++;this.updateRun();for(var a in this.updateListeners){var d=
this.updateListeners[a];d.func.apply(d.obj)}for(var b in this.wallMoveListeners)d=this.wallMoveListeners[b],d.func.apply(d.obj)},updateData:function(){for(var a in this.dataListeners){var d=this.dataListeners[a];d.func.apply(d.obj)}this.numUpdates=0},delayGraphs:function(){var a=this;window.setTimeout(function(){a.dataRunNoGraphs();addListener(curLevel,"data","run",a.dataRun,a)},50)},dataRunNoGraphs:function(){for(var a in this.recordListeners){var d=this.recordListeners[a];d.func.apply(d.obj)}},
dataRun:function(){for(var a in this.recordListeners){var d=this.recordListeners[a];d.func.apply(d.obj)}for(var b in this.graphs)this.graphs[b].active&&this.graphs[b].addLast()},setUpdateRunListener:function(){this.updateRun=this.attracting&&this.gravitying?this.updateRunAttractAndGravity:this.attracting?this.updateRunAttract:this.gravitying?this.updateRunGravity:this.updateRunBasic},gravity:function(a){this.gravitying=!0;for(a=0;a<walls.length;a++)walls[a].setHitMode("Gravity");this.setUpdateRunListener()},
gravityStop:function(){this.gravitying=!1;this.setUpdateRunListener()},doGravity:function(){for(var a in spcs)for(var d=spcs[a].dots,b=0;b<d.length;b++)d[b].v.dy+=gInternal,d[b].y+=0.5*gInternal},attract:function(a){this.attracting=!0;attractor.setup();attractor.assignELastAll();this.setUpdateRunListener()},attractStop:function(){this.attracting=!1;attractor.zeroAllEnergies();this.setUpdateRunListener()},updateRunBasic:function(){this.move();collide.check();walls.check();this.drawRun()},updateRunGravity:function(){this.move();
collide.check();this.doGravity();walls.check();this.drawRun()},updateRunAttract:function(){this.move();collide.check();attractor.attract();walls.check();this.drawRun()},updateRunAttractAndGravity:function(){this.move();collide.check();attractor.attract();this.doGravity();walls.check();this.drawRun()},drawRun:function(){draw.clear(this.bgCol);draw.dots();draw.walls(walls)},resetGraphs:function(){for(var a in this.graphs)this.graphs[a].reset()},removeGraph:function(a){this.graphs[a].remove();this.graphs[a]=
void 0},removeAllGraphs:function(){for(var a in this.graphs)this.removeGraph(a),delete this.graphs[a]},saveAllGraphs:function(){for(var a in this.graphs)this.graphs[a].save(a+"section"+sectionIdx+"prompt"+promptIdx)},disableAllGraphs:function(){for(var a in this.graphs)this.graphs[a].disable()},selectObj:function(a,d){return/^wall$/i.test(a)?walls[d]||console.log("Bad command wall handle "+d):this[this.key(a,d)]||console.log("Bad command data: Type "+a+" and handle "+d)},key:function(a,d){return a.toCamelCase()+
d.toCapitalCamelCase()},makeListenerHolders:function(){makeListenerHolder(this,"update");makeListenerHolder(this,"wallMove");makeListenerHolder(this,"data");makeListenerHolder(this,"mousedown");makeListenerHolder(this,"mouseup");makeListenerHolder(this,"mousemove");makeListenerHolder(this,"init");makeListenerHolder(this,"record");makeListenerHolder(this,"sectionCondition");makeListenerHolder(this,"promptCondition");makeListenerHolder(this,"setup")}};function LevelInstance(){this.readouts={};this.setStds()}_.extend(LevelInstance.prototype,LevelTools);function Timeline(a,d,b,e){this.parent=a;this.buttonManagerBlank=d||document.getElementById("buttonManager").outerHTML;this.isSectionsBranch=b||!1;this.isPromptsBranch=e||!1;this.sections=[];this.sectionIdx=void 0;this.curId=0;this.elems=[];this.suspended=!1}
Timeline.prototype={curSection:function(){return this.sections[this.sectionIdx]},curPrompt:function(){return this.sections[this.sectionIdx].curPrompt()},pushSection:function(a,d,b){this.sections.push(new Timeline.Section(this,a,this.buttonManagerBlank,void 0,d,b))},clearCurrentSection:function(){void 0!==this.sectionIdx&&this.sections[this.sectionIdx].clear()},now:function(){return{sectionIdx:this.sectionIdx,promptIdx:this.sections[this.sectionIdx].promptIdx}},nowTime:function(){return{sectionIdx:this.sectionIdx,
promptIdx:Math.floor(this.sections[this.sectionIdx].time)}},surface:function(a){var d=!1;a=defaultTo(!0,a);this.parent&&(this.isSectionsBranch?(d=this.curSection().cleanUpPrompt(a))||this.clearCurrentSection():this.isPromptsBranch&&(d=this.curSection().cleanUpPrompt(a)),d?this.curSection().promptIdx+=0.5:this.parent.catchSurface(this,a))},catchSurface:function(a,d){window.timeline=this;timeline.suspended=!1;this.curSection().pushToGlobal();d||(this.curSection().time-=1E-4);a.isSectionsBranch&&this.curSection().restoreHTML();
d?sceneNavigator.nextPrompt(!0,!1):sceneNavigator.prevPrompt()},findElemBoundsByHandle:function(a){var d=[],b,e,f,k,h,l;e=0;a:for(;e<this.sections.length;e++){k=this.sections[e].moments;for(f=0;f<k.length;f++){h=k[f].events;for(l=0;l<h.walls.length;l++)if(a==h.walls[l].elemDatum.handle&&(d.push(k[f].timestamp),b=e,2==d.length))break a;for(l=0;l<h.objs.length;l++)if(h.objs[l].elemDatum.handle){if(h.objs[l].elemDatum.handle==a&&(d.push(k[f].timestamp),b=e,2==d.length))break a}else if(h.objs[l].elemDatum.attrs&&
h.objs[l].elemDatum.attrs.handle==a&&(d.push(k[f].timestamp),b=e,2==d.length))break a;for(l=0;l<h.cmmds.length;l++)if(a==h.cmmds[l].elemDatum.handle&&(d.push(k[f].timestamp),b=e,2==d.length))break a}}d.push(b);return d},show:function(a,d,b,e){var f=this.sectionIdx!=a;e=f||d!=this.sections[a].promptIdx||e;f&&void 0!==this.sectionIdx&&this.sections[this.sectionIdx].cleanUpPrompt(a>this.sectionIdx);if(f||b)this.clearCurrentSection(),this.sectionIdx=a,this.sections[a].showSection();(e||b)&&this.sections[a].showPrompt(d)},
addOnce:function(a,d,b,e,f){a="now"==a?this.sectionIdx:a;this.sections[a].addOnce(d,b,e,f)},refresh:function(){var a=this.sections[this.sectionIdx],d=a.sectionData.prompts[a.promptIdx],b=a.motherSection,e=a.motherTimeline,a=new Timeline.Section(a.motherTimeline,b.sectionData,this.buttonManagerBlank,b.conditionManager);b.clear();a.copyBranchCmmds(b.moments);var f=e.sections.indexOf(b);e.sections.splice(f,1,a);a.showSection();a.deepStepTo(d,b.branches)},takeNumber:function(){return this.curId++}};
Timeline.Section=function(a,d,b,e,f,k){this.timeline=a;this.inited=!1;this.promptIdx=-1;this.time=-2;this.branches=[];this.sectionData=d;this.moments=[];this.populateMoments(a,a.elems,this.moments,this.sectionData);this.sortMoments();this.level=new LevelInstance;this.mainReadout=new Readout("mainReadout",30,myCanvas.width-125,25,"13pt calibri",Col(255,255,255),"left",this.level);this.dotManager=new DotManager;this.collide=new CollideHandler(this.dotManager);this.walls=WallHandler();this.dataHandler=
new DataHandler;this.dataDisplayer=new DataDisplayer;this.conditionManager=e?e.stripForInheritance():new ConditionManager;this.activationEnergySpcChanger=new ActivationEnergySpcChanger(this.collide);this.buttonManager=new ButtonManager("buttonManager");this.spcs={};LevelTools.addSpcs(LevelData.spcDefs,this.spcs,this.dotManager);this.sliderList=[];this.dataDisplayer.setReadouts(this.level.readouts);this.collide.setSpcs(this.spcs);this.level.spcs=this.spcs;this.level.dataHandler=this.dataHandler;this.buttonMangerClone;
this.buttonManagerBlank=b;this.dashRunId="dashRun"+window.dashRunId++;this.dashRun=$("#dashRunBlank").clone(!0).attr("id",this.dashRunId);$("#dashRunWrapper").append(this.dashRun);this.motherTimeline=f||this.timeline;this.motherSection=k||this};
Timeline.Section.prototype={showSection:function(){this.dashRun.show();this.dashRun.attr("id","dashRun");this.dashRun.addClass("active");this.replaceDiv($("#buttonManagerWrapper"),$("#buttonManager"),this.buttonManagerClone||this.buttonManagerBlank);this.pushToGlobal();this.inited?(this.restoreAuxs(),this.restoreGraphs()):(this.stepTo(-1),this.promptIdx=-1,this.inited=!0)},restoreHTML:function(){this.dashRun.show();this.dashRun.attr("id","dashRun");this.dashRun.addClass("active");this.replaceDiv($("#buttonManagerWrapper"),
$("#buttonManager"),this.buttonManagerClone||this.buttonManagerBlank);this.restoreGraphs();this.restoreAuxs()},showPrompt:function(a){var d=this.getTimestamp(a,"headHTML");this.stepTo(d)?(this.timeline.suspended=!0,this.promptIdx=Math.floor(this.time)+0.5):this.promptIdx=a},stepTo:function(a){var d=!1,b=!1,e=this.time;if(a>this.time||a<this.time&&!/headhtml/i.test(this.getTimestampType(a))){var f=this.momentAt(this.time);f&&f.fire(this.time,a);f&&(this.time+=a>this.time?1E-4:-1E-4);for(;a!=this.time;){f=
this.nextTowardsDest(this.time,a);if(!f)break;var k=this.getTimestamp(Math.floor(f.timestamp),"branchPreClean"),h=this.getTimestamp(Math.floor(f.timestamp),"branchPostClean");this.time=f.timestamp;f.fire(e,a);if(1E-5>Math.abs(f.timestamp-k)||1E-5>Math.abs(f.timestamp-h)){d=this.branches[Math.floor(this.time)].timeline;d=d.isSectionsBranch?"sections":d.isPromptsBranch?"prompts":void 0;break}}}else if(a<this.time){(f=this.momentAt(this.time))&&f.fire(this.time,a);f&&(this.time-=1E-4);for(var l=this.getTimestamp(Math.floor(a),
"branchPreClean");l!=this.time;){f=this.nextTowardsDest(this.time,l);if(!f)break;k=this.getTimestamp(Math.floor(f.timestamp),"branchPreClean");h=this.getTimestamp(Math.floor(f.timestamp),"branchPostClean");this.time=f.timestamp;f.fire(e,a);if(1E-5>Math.abs(f.timestamp-k)||1E-5>Math.abs(f.timestamp-h)){d=this.branches[Math.floor(this.time)].timeline;d=d.isSectionsBranch?"sections":d.isPromptsBranch?"prompts":void 0;b=!0;break}}if(!b)for(this.time=this.getTimestamp(Math.floor(a+1E-4),"setup")-1E-4;a!=
this.time;){f=this.nextMoment(this.time);if(!f)break;e=this.time;this.time=f.timestamp;f.fire(e,a)}}return d},deepStepTo:function(a,d){for(var b=-1,e=this.moments.indexOf(this.nextMoment(b));e<this.moments.length-1;e++){var f=this.moments[e],k;f.events.branchCmmd&&(k=f.events.branchCmmd,f.events.branchCmmd=void 0);var h=this.moments[e].timestamp;if(this.sectionData.prompts[Math.floor(f.timestamp)]==a)return this.stepTo(this.getTimestamp(f.timestamp,"headhtml")),this.promptIdx=Math.floor(f.timestamp),
!0;this.promptIdx=Math.floor(this.time);f.fire(b,h);if(k){f.events.branchCmmd=k;var l=Math.floor(this.time),b=d[l];if(b.timeline.isSectionsBranch)this.branches[l]=b;else if(b.timeline.isPromptsBranch){var m=b.timeline.sections[0].branches,n=new Timeline.Moment(f.timestamp);n.events.branchCmmd=k;n.fire(this.time,h);l=this.branches[l];l.timeline.sections[0].copyBranchCmmds(b.timeline.sections[0].moments);b=l.timeline.sections[0].deepStepTo(a,m);this.promptIdx=Math.floor(this.time)+0.5;this.time=f.timestamp;
if(b)return!0}}this.time=b=h}return!1},copyBranchCmmds:function(a){for(var d=0;d<a.length;d++){var b=a[d],e=b.events.branchCmmd;if(e){e.section=this;var f=this.momentAt(b.timestamp);f?f.events.branchCmmd=e:(f=new Timeline.Moment(b.timestamp),f.events.branchCmmd=e,this.spliceInMoment(f))}}},nextTowardsDest:function(a,d){var b=this.momentAt(a);if(b){b=this.moments.indexOf(b);d<a?b--:b++;var e=this.moments[b];if(e&&Math.abs(e.timestamp-a)<=Math.abs(d-a))return this.moments[b]}else if(a<d)for(b=0;b<this.moments.length;b++){if(e=
this.moments[b],e.timestamp>a){if(e.timestamp<=d)return e;break}}else if(d<a)for(b=this.moments.length-1;0<=b;b--)if(e=this.moments[b],e.timestamp<a){if(e.timestamp>=d)return e;break}},nextMoment:function(a){for(var d=0;d<this.moments.length;d++)if(this.moments[d].timestamp>a)return this.moments[d]},momentAt:function(a){for(var d=0;d<this.moments.length;d++)if(1E-5>Math.abs(this.moments[d].timestamp-a))return this.moments[d]},cleanUpPrompt:function(a){a=a?this.getTimestamp(this.sectionData.prompts.length-
1,"branchPostClean")+1E-4:this.getTimestamp(0,"head")-1E-4;var d=this.stepTo(a);this.time=a;return d},spliceInMoment:function(a){for(var d=0;d<this.moments.length;d++)if(this.moments[d].timestamp>a.timestamp){this.moments.splice(d,0,a);break}},branchPromptsPreClean:function(a){var d=this.getTimestamp(Math.floor(this.time),"branchPreClean");this.branchPrompts(a,d)},branchPromptsPostClean:function(a){var d=this.getTimestamp(Math.floor(this.time),"branchPostClean");this.branchPrompts(a,d)},branchPrompts:function(a,
d){this.killBranchMoments();var b=new Timeline.Moment(d),e=new Timeline.Command("point",function(b,e){var h=Math.floor(d);if(e.branches[h]&&e.branches[h].id==a.id)window.timeline=e.branches[h].timeline,timeline.sections[0].pushToGlobal(),h=timeline.now(),timeline.show(h.sectionIdx,h.promptIdx,!1,!0);else{var l=new Timeline(b,e.buttonManagerBlank,!1,!0);e.branches[h]=new Timeline.Branch(l,a.id);l.pushSection({prompts:a},e.motherTimeline,e.motherSection);l.sections[0].inheritState(e);l.sectionIdx=0;
l.inited=!0;window.timeline=l;l.sections[0].pushToGlobal();l.show(0,0)}},void 0,!1,!1,void 0);b.events.branchCmmd=new Timeline.Event.BranchCmmd(this,this.timeline.elems,e,Timeline.stateFuncs.cmmds.spawn,this.timeline.takeNumber(),b,!1);this.spliceInMoment(b)},branchSections:function(a){this.killBranchMoments();var d=this.getTimestamp(Math.floor(this.time),"branchPostClean"),d=new Timeline.Moment(d),b=new Timeline.Command("point",function(b,d){var k=Math.floor(d.time);if(d.branches[k]&&d.branches[k].id==
a.id)b.clearCurrentSection(),window.timeline=d.branches[k].timeline,timeline.sections[timeline.sectionIdx].pushToGlobal(),timeline.sections[timeline.sectionIdx].showSection(),k=timeline.now(),timeline.show(k.sectionIdx,k.promptIdx,!1,!0);else{for(var k=new Timeline(b,b.buttonManagerBlank,!0,!1),h=0;h<a.length;h++)k.pushSection(a[h]);d.branches[d.promptIdx]=new Timeline.Branch(k,a.id);d.timeline.clearCurrentSection();window.timeline=k;k.show(0,0)}},void 0,!1,!1,void 0);d.events.branchCmmd=new Timeline.Event.BranchCmmd(this,
this.timeline.elems,b,Timeline.stateFuncs.cmmds.spawn,this.timeline.takeNumber(),d,!0);this.spliceInMoment(d)},killBranches:function(){this.killBranchMoments();this.branches[this.promptIdx]=void 0},killBranchMoments:function(){var a=this.getTimestamp(Math.floor(this.time),"branchPreClean"),d=this.getTimestamp(Math.floor(this.time),"branchPostClean"),a=this.momentAt(a),d=this.momentAt(d);a&&this.moments.splice(this.moments.indexOf(a),1);d&&this.moments.splice(this.moments.indexOf(d),1)},curPrompt:function(){return this.sectionData.prompts[this.promptIdx]},
replaceDiv:function(a,d,b){d.length&&d.remove();a.append(b)},inheritState:function(a){this.level=a.level;this.collide=a.collide;this.walls=a.walls;this.dotManager=a.dotManager;this.spcs=a.spcs;this.dataDisplayer=a.dataDisplayer;this.sliderList=a.sliderList;this.buttonManager=a.buttonManager;this.dataHandler=a.dataHandler;this.activationEnergySpcChanger=a.activationEnergySpcChanger},pushToGlobal:function(){window.curLevel=this.level;window.collide=this.collide;window.walls=this.walls;window.dotManager=
this.dotManager;window.spcs=this.spcs;window.dataDisplayer=this.dataDisplayer;window.sliderList=this.sliderList;window.buttonManager=this.buttonManager;window.dataHandler=this.dataHandler;window.activationEnergySpcChanger=this.activationEnergySpcChanger;window.conditionManager=this.conditionManager},restoreAuxs:function(){for(var a in this.level.auxs)this.level.auxs[a].restoreHTML()},restoreGraphs:function(){for(var a in this.level.graphs){var d=this.level.graphs[a];d.setDataValid();d.restoreHTML();
d.drawAllData()}},clear:function(){if(this.inited){$("#prompt").html("");this.buttonManagerClone=$("#buttonManager").clone(!0);$("#buttonManager").html("");$("#baseHeader").html("");this.dashRun.attr("id",this.dashRunId);this.dashRun.removeClass("active");this.dashRun.hide();for(var a in this.level.graphs)this.level.graphs[a].clearHTML();for(var d in this.level.auxs)this.level.auxs[d].clearHTML()}},addCmmdSpan:function(a,d){promptIdx="now"==a?this.promptIdx:a;var b=this.getTimestamp(promptIdx,"setup"),
e=this.timeline.takeNumber();cmmd="string"==typeof d||"function"==typeof d?new Timeline.Command("span",d,void 0,!0,!1):new Timeline.Command("span",d.spawn,d.remove,!1,d.once,d.cleanUpWith);this.timeline.elems[e]=cmmd;this.applyCmmdSpan(this.timeline,this.moments,this.timeline.elems,cmmd,"cmmds",cmmd.once,b,e);this.sortMoments()},addCmmdPoint:function(a,d,b,e,f){promptIdx="now"==a?this.promptIdx:a;a=this.timeline.takeNumber();d=this.getTimestamp(promptIdx,d||"setup");b=new Timeline.Command("point",
b,void 0,e,f);this.timeline.elems[a]=b;this.applyCmmdPoint(this.timeline,this.moments,this.timeline.elems,b,"cmmds",f,d,a);this.sortMoments()},populateMoments:function(a,d,b,e){b.push(new Timeline.Moment(-2));this.addSceneDataToMoments(a,d,b,{cmmds:[{type:"point",spawn:'addListener(curLevel, "data", "pareWallsData", walls.pareData, walls)',oneWay:!1}]},-1,void 0);this.addSceneDataToMoments(a,d,b,e.sceneData,-1,void 0);for(var f=e.prompts,k=0;k<f.length;k++)f[k].sceneData&&this.addSceneDataToMoments(a,
d,b,f[k].sceneData,k);this.populateHTMLMoments(a,d,b,e)},populateHTMLMoments:function(a,d,b,e){e=e.prompts;for(var f=0;f<e.length;f++){var k=e[f],h=this.getTimestamp(f,"headHTML");this.populatePromptHTML(k,h,a,d,b,f)}},populatePromptHTML:function(a,d,b,e,f,k){var h=this,l,m,n;a.cutScene?(m=b.takeNumber(),l=function(){var b=interpreter.interp(a.text);h.level.cutSceneStart(b,a.cutScene)},n=function(){h.level.cutSceneEnd()},a.quiz&&(l=extend(l,function(){$("#base").hide();h.level.quiz=quizRenderer.render(a.quiz,
$("#intText"))}),n=extend(n,function(){$("#base").show();h.level.quiz=void 0}))):(m=b.takeNumber(),l=function(){var b=interpreter.interp(a.text);$("#prompt").html(defaultTo("",templater.div({innerHTML:b})));a.quiz&&(h.level.quiz=quizRenderer.render(a.quiz,$("#prompt")))},n=function(){$("#prompt").html("");h.level.quiz=void 0});n=new Timeline.Command("span",l,n);l=this.getTimestamp(k,"tailHTML");this.pushSpan(e,n,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,m,f,d,l,!1,"cmmds");
a.quiz&&(m=b.takeNumber(),n=new Timeline.Command("span",function(){$("#nextPrevDiv").hide()},function(){$("#nextPrevDiv").show()}),l=this.getTimestamp(k,"tailHTML"),this.pushSpan(e,n,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,m,f,d,l,!1,"cmmds"));a.title&&(m=b.takeNumber(),n=new Timeline.Command("span",function(){$("#baseHeader").html(a.title)},function(){$("#baseHeader").html("")}),l=this.getTimestamp(k,"tailHTML"),this.pushSpan(e,n,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,
m,f,d,l,!1,"cmmds"));k=new Timeline.Command("point",function(){interpreter.renderMath();h.buttonManager.arrangeGroupWrappers();h.buttonManager.arrangeAllGroups();h.buttonManager.setButtonWidth()},void 0,!0);this.pushPoint(f,e,b.takeNumber(),k,Timeline.stateFuncs.cmmds.spawn,!0,"cmmds",!1,d)},addSceneDataToMoments:function(a,d,b,e,f){this.getOrCreateMoment(b,f);e&&(this.applySpanToMoments(a,b,d,e.walls,"walls",f,Timeline.stateFuncs.walls.spawn,Timeline.stateFuncs.walls.remove),this.applySpanToMoments(a,
b,d,e.dots,"dots",f,Timeline.stateFuncs.dots.spawn,Timeline.stateFuncs.dots.remove),this.applySpanToMoments(a,b,d,e.objs,"objs",f,Timeline.stateFuncs.objs.spawn,Timeline.stateFuncs.objs.remove),this.applySpanToMoments(a,b,d,e.dataRecord,"objs",f,Timeline.stateFuncs.dataRecord.spawn,Timeline.stateFuncs.dataRecord.remove),this.applySpanToMoments(a,b,d,e.dataReadouts,"objs",f,Timeline.stateFuncs.dataReadouts.spawn,Timeline.stateFuncs.dataReadouts.remove),this.applySpanToMoments(a,b,d,e.triggers,"objs",
f,Timeline.stateFuncs.triggers.spawn,Timeline.stateFuncs.triggers.remove),this.applySpanToMoments(a,b,d,e.graphs,"objs",f,Timeline.stateFuncs.graphs.spawn,Timeline.stateFuncs.graphs.remove),this.applySpanToMoments(a,b,d,e.rxns,"objs",f,Timeline.stateFuncs.rxns.spawn,Timeline.stateFuncs.rxns.remove),this.applySpanToMoments(a,b,d,e.buttonGroups,"objs",f,Timeline.stateFuncs.buttonGrps.spawn,Timeline.stateFuncs.buttonGrps.remove),this.applyCmmdsToMoments(a,b,d,e.cmmds,"cmmds",f))},applySpanToMoments:function(a,
d,b,e,f,k,h,l){e=e?e:[];for(var m=0;m<e.length;m++){var n=a.takeNumber(),p=e[m],r=this.getTimestamp(p.cleanUpWith||k,"tail");this.pushSpan(b,p,h,l,n,d,k,r,!1,f)}},applyCmmdsToMoments:function(a,d,b,e,f,k){var h;e=e?e:[];for(var l=0;l<e.length;l++)h=e[l],h="string"==typeof h||"function"==typeof h?new Timeline.Command("point",h,void 0,!0,!1):new Timeline.Command(h.type,h.spawn,h.remove,defaultTo(!0,h.oneWay),h.once),/span/i.test(h.type)?this.applyCmmdSpan(a,d,b,h,f,h.once,k):/point/i.test(h.type)?this.applyCmmdPoint(a,
d,b,h,f,h.once,k):(console.log("Bad command"),console.log(h),console.log('Must be string or have type of "span" or "point"'))},applyCmmdSpan:function(a,d,b,e,f,k,h,l){l=void 0===l?a.takeNumber():l;a=Timeline.stateFuncs.cmmds.spawn;f=Timeline.stateFuncs.cmmds.remove;var m=this.getTimestamp(e.cleanUpWith||h,"tail");this.pushSpan(b,e,a,f,l,d,h,m,k,"cmmds")},applyCmmdPoint:function(a,d,b,e,f,k,h,l){l=void 0===l?a.takeNumber():l;a=Timeline.stateFuncs.cmmds.spawn;var m=defaultTo(!0,e.oneWay);this.pushPoint(d,
b,l,e,a,m,f,k,h)},pushSpan:function(a,d,b,e,f,k,h,l,m,n){h=this.getOrCreateMoment(k,h);k=this.getOrCreateMoment(k,l);l=new Timeline.Event.Span(this,a,d,b,e,f,"head",m,h);a=new Timeline.Event.Span(this,a,d,b,e,f,"tail",m,k);l.partner=a;a.partner=l;h.events[n].push(l);k.events[n].push(a)},pushPoint:function(a,d,b,e,f,k,h,l,m){a=this.getOrCreateMoment(a,m);d=new Timeline.Event.Point(this,d,e,f,b,k,l,a);a.events[h].push(d)},getTimestamp:function(a,d){var b;/tailhtml/i.test(d)?b=0.8:/tail/i.test(d)?b=
0.9:/setup/i.test(d)?b=0.1:/headhtml/i.test(d)?b=0.2:/head/i.test(d)?b=0:/branchPreClean/i.test(d)?b=0.85:/branchPostClean/i.test(d)&&(b=0.95);var e=this.parseIntegerTimeIdx(a);return-1==e&&"tail"==d?Infinity:e+b},getTimestampType:function(a){if(0.8==a%1)return"tailhtml";if(1E-5>Math.abs(a%1-0.9))return"tail";if(1E-5>Math.abs(a%1-0.1))return"setup";if(1E-5>Math.abs(a%1-0.2))return"headhtml";if(1E-5>Math.abs(a%1-0))return"head";1E-5>Math.abs(a%1-0.85)?"branchPreClean":1E-5>Math.abs(a%1-0.95)&&"branchPostClean"},
parseIntegerTimeIdx:function(a){if("string"==typeof a){if(/section/i.test(a))return-1;var d=/[0-9]+/.exec(a);if(""!==d)return Number(d);console.log("Bad time code: "+a)}else return Math.floor(a)},sortMoments:function(){this.moments=_.sortBy(this.moments,function(a){return a.timestamp})},getOrCreateMoment:function(a,d){for(var b=0;b<a.length;b++)if(a[b].timestamp==d)return a[b];a.push(new Timeline.Moment(d));return a[a.length-1]}};
Timeline.stateFuncs={walls:{spawn:function(a,d,b,e){d[b]=a.walls.addWall(e)},remove:function(a,d,b){var e=d[b];e&&a.walls.removeWall(e.handle);d[b]=void 0}},dots:{spawn:function(a,d,b,e){a.spcs[e.spcName].populate(e.pos,e.dims,e.count,e.temp,e.tag,b,e.returnTo);d[b]="dots"},remove:function(a,d,b){a.dotManager.removeByAttr("elemId",b);d[b]=void 0}},objs:{spawn:function(a,d,b,e){(a=window[e.type])||console.log("Bad object type "+e.type);d[b]=new a(e.attrs)},remove:function(a,d,b){(a=d[b])&&a.remove();
d[b]=void 0}},dataRecord:{spawn:function(a,d,b,e){if(/collisions/i.test(e.data))a.collide.recordCollisions();else a.walls[e.wallInfo]["record"+e.data.toCapitalCamelCase()](e.attrs);d[b]=e},remove:function(a,d,b){var e=d[b];if(/collisions/i.test(e.data))a.collide.recordCollisionsStop();else a.walls[e.wallInfo]["record"+e.data.toCapitalCamelCase()+"Stop"](e.attrs);d[b]=void 0}},dataReadouts:{spawn:function(a,d,b,e){a=a.dataDisplayer.addEntry(e);d[b]=a},remove:function(a,d,b){d[b].remove();d[b]=void 0}},
triggers:{spawn:function(a,d,b,e){d[b]=new window.Trigger(e)},remove:function(a,d,b){d[b].remove();d[b]=void 0}},graphs:{spawn:function(a,d,b,e){var f;/^load$/i.test(e.type)?((f=window.storedGraphs[e.handle])?(f.initDrawLayers(),f.restoreHTML()):console.log("Tried to load graph with bad handle "+e.handle),f.setDataValid()):f=new window.Graphs[e.type](e);f.drawAllData();if(e.sets)for(var k=0;k<e.sets.length;k++)f.addSet(e.sets[k]);a.level.graphs[e.handle]=f;d[b]=f},remove:function(a,d,b){var e=d[b],
f;for(f in e.data)e.data[f].recording=!1;delete a.level.graphs[e.handle];e.remove();d[b]=void 0}},rxns:{spawn:function(a,d,b,e){a=a.collide.addReaction(e);d[b]=a},remove:function(a,d,b){d[b].remove();d[b]=void 0}},buttonGrps:{spawn:function(a,d,b,e){a.buttonManager.addGroup(e.handle,e.label,e.prefIdx,e.isRadio,e.isToggle);if(e.buttons)for(var f=0;f<e.buttons.length;f++){var k=e.buttons[f];a.buttonManager.addButton(e.handle,k.handle,k.label,k.exprs,k.prefIdx,k.isDown)}else console.log("Button group "+
e.handle+" has no buttons.  Just thought you should know.  This object is logged below."),console.log(e);d[b]=e},remove:function(a,d,b){a.buttonManager.removeGroup(d[b].handle);d[b]=void 0}},cmmds:{spawn:function(a,d,b,e){var f=e.spawn;d[b]=e;if(f)with(DataGetFuncs)"function"==typeof f?f(a.timeline,a):"string"==typeof f?eval("("+f+")"):f instanceof Array&&(a=f.join(";")+";",eval("("+a+")"))},remove:function(a,d,b){a=d[b];d[b]=void 0;if(d=a.remove)with(DataGetFuncs)"function"==typeof d?d():"string"==
typeof d?eval("("+d+")"):d instanceof Array&&(d=d.join(";")+";",eval("("+d+")"))}}};Timeline.Moment=function(a){this.timestamp=a;this.events=new Timeline.EventClassHolder};
Timeline.Moment.prototype={fire:function(a,d){this.fireSpans(this.events.dots,a,d);this.fireSpans(this.events.walls,a,d);this.fireSpans(this.events.objs,a,d);this.fireCmmds(this.events.cmmds,a,d);this.fireCmmds([this.events.branchCmmd],a,d)},fireSpans:function(a,d,b){for(var e=0;e<a.length;e++)this.fireSpan(a[e],d,b)},fireSpan:function(a,d,b){if(a.active){var e=getAndEval(a.elemDatum);"head"==a.boundType?d<b&&d<this.timestamp&&b<a.partner.moment.timestamp?a.spawn(a.section,a.timelineElems,a.id,e):
b<d&&(b<this.timestamp&&d<=a.partner.moment.timestamp)&&(a.remove(a.section,a.timelineElems,a.id),a.once&&(a.active=!1,a.partner.active=!1)):"tail"==a.boundType&&(b>d&&d>=a.partner.moment.timestamp&&d<this.timestamp?(a.remove(a.section,a.timelineElems,a.id),a.once&&(a.active=!1)):b<d&&b>=a.partner.moment.timestamp&&a.spawn(a.section,a.timelineElems,a.id,e))}},fireCmmds:function(a,d,b){for(var e,f=0;f<a.length;f++){var k=a[f];if(k instanceof Timeline.Event.Span)this.fireSpans([k],d,b);else if(k instanceof
Timeline.Event.Point||k instanceof Timeline.Event.BranchCmmd)if((d<this.timestamp&&this.timestamp<=b||b<=this.timestamp&&this.timestamp<d)&&(k.elemDatum.oneWay?d<b:1)&&k.active)e=getAndEval(k.elemDatum),k.spawn(k.section,k.timelineElems,k.id,e),k.once&&(k.active=!1)}}};Timeline.Command=function(a,d,b,e,f,k){this.type=a;this.spawn=d;this.remove=b;this.oneWay=e;this.once=f;this.cleanUpWith=k};
Timeline.EventClassHolder=function(){this.walls=[];this.dots=[];this.objs=[];this.cmmds=[];this.branchCmmd=void 0};
Timeline.Event={Span:function(a,d,b,e,f,k,h,l,m){this.section=a;this.timelineElems=d;this.elemDatum=b;this.spawn=e;this.remove=f;this.id=k;this.boundType=h;this.moment=m;this.once=l;this.active=!0;this.parnter},Point:function(a,d,b,e,f,k,h,l){this.section=a;this.timelineElems=d;this.elemDatum=b;this.spawn=e;this.id=f;this.oneWay=k;this.moment=l;this.once=h;this.active=!0},BranchCmmd:function(a,d,b,e,f,k,h){this.section=this.section=a;this.timelineElems=d;this.elemDatum=b;this.spawn=e;this.id=f;this.oneWay=
!1;this.moment=k;this.once=!1;this.active=!0;this.isSectionsBranch=h;this.isPromptsBranch=!h}};Timeline.Branch=function(a,d){this.timeline=a;this.id=d};window.R=8.314;
$(function(){window.IMGPATHPREFIX="";window.simHost=window.simHost||"";"CW"==window.simHost&&(window.IMGPATHPREFIX="content/sims/levels/");$("#resetExp").append("<img src='"+IMGPATHPREFIX+"img/refresh.gif'></img>");MathJax.Hub.Config({tex2jax:{inlineMath:[["##","##"],["\\(","\\)"]],displayMath:[["$$","$$"]]}});_.extend(Array.prototype,toInherit.ArrayExtenders);_.extend(Math,toInherit.MathExtenders);_.extend(String.prototype,toInherit.StringExtenders);templater=new Templater;globalHTMLClass="sim";
dotManager=new DotManager;turn=0;window.Graphs={Scatter:GraphScatter,Hist:GraphHist,PhaseTwoComp:GraphPhaseTwoComp};$("#mainHeader").html(LevelData.levelTitle);$("#canvasDiv").hide();$("#base").hide();$("#dashIntro").hide();$("#dashOutro").hide();$("#dashCutScene").hide();$("#display").hide();$("#intText").hide();canvas=document.getElementById("myCanvas");c=canvas.getContext("2d");N=1E3;R=8.314;KB=R/N;extraIntervals={};vConst=1E-4;pConst=16.3562;tConst=20;LtoM3=0.001;ATMtoPA=101325;PUNITTOPA=BARTOPA=
1E5;MMHGTOBAR=0.0013332237;JtoKJ=0.001;pxToE=Math.sqrt(tConst);ACTUALN=6.022E23;g=1.75;gInternal=0.01;updateInterval=30;dataInterval=1250;borderCol=Col(155,155,155);pxToMS=19.33821;auxHolderDivs=["aux1","aux2"];stored={};storedGraphs={};addJQueryElems($("button"),"button");draw=new DrawingTools;turnUpdater=setInterval("curLevel.update()",updateInterval);dataUpdater=setInterval("curLevel.updateData()",dataInterval);attractor=new Attractor;animText=new AnimText(c);phaseEquilGenerator=new PhaseEquilGenerator;
dotMigrator=new DotMigrator;quizRenderer=new QuizRenderer;sceneNavigator=new SceneNavigator;interpreter=new ExpressionInterpreter;$("#resetExp").click(function(){sceneNavigator.refresh()});$("#toSim").click(function(){sceneNavigator.nextPrompt()});$("#toLastStep").click(function(){sceneNavigator.prevPrompt()});$("#previous").click(function(){sceneNavigator.prevPrompt()});$("#next").click(function(){sceneNavigator.nextPrompt()});window.dashRunId=0;timeline=new Timeline;canvasHeight=450;myCanvas.width=
$("#main").width();myCanvas.height=canvasHeight;var a=0;LevelTools.addUF298(LevelData.spcDefs);LevelTools.addCp(LevelData.spcDefs);a=LevelTools.addImgsAndQuestionIds(LevelData.mainSequence,a);LevelTools.setDefaultPromptVals(LevelData.mainSequence);LevelTools.addTriggerCleanUp(LevelData.mainSequence);LevelTools.addStoreAs(LevelData.mainSequence);LevelTools.transferObjCleanUp(LevelData.mainSequence);LevelTools.showRunDivs();var d=0,b;for(b in LevelData.auxSections){var e=LevelData.auxSections[b],e=
e instanceof Array?e:[e],a=LevelTools.addImgsAndQuestionIds(e,a);e.id=d;d++;LevelTools.setDefaultPromptVals(e);LevelTools.addTriggerCleanUp(e);LevelTools.addStoreAs(e);LevelTools.transferObjCleanUp(e)}for(var f in LevelData.auxPrompts)b=LevelData.auxPrompts[f],b=b instanceof Array?b:[b],e={prompts:b},a=LevelTools.addImgsAndQuestionIds(e,a),b.id=d,d++,LevelTools.setDefaultPromptVals(e),LevelTools.addTriggerCleanUp(e),LevelTools.addStoreAs(e),LevelTools.transferObjCleanUp(e);for(a=0;a<LevelData.mainSequence.length;a++)timeline.pushSection(LevelData.mainSequence[a]);
timeline.show(0,0)});
