(function(){function d(e,f,h){if(e===f)return 0!==e||1/e==1/f;if(null==e||null==f)return e===f;e._chain&&(e=e._wrapped);f._chain&&(f=f._wrapped);if(e.isEqual&&w.isFunction(e.isEqual))return e.isEqual(f);if(f.isEqual&&w.isFunction(f.isEqual))return f.isEqual(e);var k=p.call(e);if(k!=p.call(f))return!1;switch(k){case "[object String]":return e==""+f;case "[object Number]":return e!=+e?f!=+f:0==e?1/e==1/f:e==+f;case "[object Date]":case "[object Boolean]":return+e==+f;case "[object RegExp]":return e.source==
f.source&&e.global==f.global&&e.multiline==f.multiline&&e.ignoreCase==f.ignoreCase}if("object"!=typeof e||"object"!=typeof f)return!1;for(var l=h.length;l--;)if(h[l]==e)return!0;h.push(e);var l=0,m=!0;if("[object Array]"==k){if(l=e.length,m=l==f.length)for(;l--&&(m=l in e==l in f&&d(e[l],f[l],h)););}else{if("constructor"in e!="constructor"in f||e.constructor!=f.constructor)return!1;for(var n in e)if(w.has(e,n)&&(l++,!(m=w.has(f,n)&&d(e[n],f[n],h))))break;if(m){for(n in f)if(w.has(f,n)&&!l--)break;
m=!l}}h.pop();return m}var f=this,e=f._,h={},k=Array.prototype,l=Object.prototype,m=k.slice,n=k.unshift,p=l.toString,q=l.hasOwnProperty,r=k.forEach,t=k.map,u=k.reduce,x=k.reduceRight,v=k.filter,z=k.every,y=k.some,A=k.indexOf,B=k.lastIndexOf,l=Array.isArray,C=Object.keys,H=Function.prototype.bind,w=function(d){return new ia(d)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=w),exports._=w):f._=w;w.VERSION="1.3.3";var F=w.each=w.forEach=function(d,
e,f){if(null!=d)if(r&&d.forEach===r)d.forEach(e,f);else if(d.length===+d.length)for(var k=0,l=d.length;k<l&&!(k in d&&e.call(f,d[k],k,d)===h);k++);else for(k in d)if(w.has(d,k)&&e.call(f,d[k],k,d)===h)break};w.map=w.collect=function(d,e,f){var h=[];if(null==d)return h;if(t&&d.map===t)return d.map(e,f);F(d,function(d,k,l){h[h.length]=e.call(f,d,k,l)});d.length===+d.length&&(h.length=d.length);return h};w.reduce=w.foldl=w.inject=function(d,e,f,h){var k=2<arguments.length;null==d&&(d=[]);if(u&&d.reduce===
u)return h&&(e=w.bind(e,h)),k?d.reduce(e,f):d.reduce(e);F(d,function(d,l,m){k?f=e.call(h,f,d,l,m):(f=d,k=!0)});if(!k)throw new TypeError("Reduce of empty array with no initial value");return f};w.reduceRight=w.foldr=function(d,e,f,h){var k=2<arguments.length;null==d&&(d=[]);if(x&&d.reduceRight===x)return h&&(e=w.bind(e,h)),k?d.reduceRight(e,f):d.reduceRight(e);var l=w.toArray(d).reverse();h&&!k&&(e=w.bind(e,h));return k?w.reduce(l,e,f,h):w.reduce(l,e)};w.find=w.detect=function(d,e,f){var h;E(d,function(d,
k,l){if(e.call(f,d,k,l))return h=d,!0});return h};w.filter=w.select=function(d,e,f){var h=[];if(null==d)return h;if(v&&d.filter===v)return d.filter(e,f);F(d,function(d,k,l){e.call(f,d,k,l)&&(h[h.length]=d)});return h};w.reject=function(d,e,f){var h=[];if(null==d)return h;F(d,function(d,k,l){e.call(f,d,k,l)||(h[h.length]=d)});return h};w.every=w.all=function(d,e,f){var k=!0;if(null==d)return k;if(z&&d.every===z)return d.every(e,f);F(d,function(d,l,m){if(!(k=k&&e.call(f,d,l,m)))return h});return!!k};
var E=w.some=w.any=function(d,e,f){e||(e=w.identity);var k=!1;if(null==d)return k;if(y&&d.some===y)return d.some(e,f);F(d,function(d,l,m){if(k||(k=e.call(f,d,l,m)))return h});return!!k};w.include=w.contains=function(d,e){return null==d?!1:A&&d.indexOf===A?-1!=d.indexOf(e):E(d,function(d){return d===e})};w.invoke=function(d,e){var f=m.call(arguments,2);return w.map(d,function(d){return(w.isFunction(e)?e||d:d[e]).apply(d,f)})};w.pluck=function(d,e){return w.map(d,function(d){return d[e]})};w.max=function(d,
e,f){if(!e&&w.isArray(d)&&d[0]===+d[0])return Math.max.apply(Math,d);if(!e&&w.isEmpty(d))return-Infinity;var h={computed:-Infinity};F(d,function(d,k,l){k=e?e.call(f,d,k,l):d;k>=h.computed&&(h={value:d,computed:k})});return h.value};w.min=function(d,e,f){if(!e&&w.isArray(d)&&d[0]===+d[0])return Math.min.apply(Math,d);if(!e&&w.isEmpty(d))return Infinity;var h={computed:Infinity};F(d,function(d,k,l){k=e?e.call(f,d,k,l):d;k<h.computed&&(h={value:d,computed:k})});return h.value};w.shuffle=function(d){var e=
[],f;F(d,function(d,h){f=Math.floor(Math.random()*(h+1));e[h]=e[f];e[f]=d});return e};w.sortBy=function(d,e,f){var h=w.isFunction(e)?e:function(d){return d[e]};return w.pluck(w.map(d,function(d,e,k){return{value:d,criteria:h.call(f,d,e,k)}}).sort(function(d,e){var f=d.criteria,h=e.criteria;return void 0===f?1:void 0===h?-1:f<h?-1:f>h?1:0}),"value")};w.groupBy=function(d,e){var f={},h=w.isFunction(e)?e:function(d){return d[e]};F(d,function(d,e){var k=h(d,e);(f[k]||(f[k]=[])).push(d)});return f};w.sortedIndex=
function(d,e,f){f||(f=w.identity);for(var h=0,k=d.length;h<k;){var l=h+k>>1;f(d[l])<f(e)?h=l+1:k=l}return h};w.toArray=function(d){return!d?[]:w.isArray(d)||w.isArguments(d)?m.call(d):d.toArray&&w.isFunction(d.toArray)?d.toArray():w.values(d)};w.size=function(d){return w.isArray(d)?d.length:w.keys(d).length};w.first=w.head=w.take=function(d,e,f){return null!=e&&!f?m.call(d,0,e):d[0]};w.initial=function(d,e,f){return m.call(d,0,d.length-(null==e||f?1:e))};w.last=function(d,e,f){return null!=e&&!f?
m.call(d,Math.max(d.length-e,0)):d[d.length-1]};w.rest=w.tail=function(d,e,f){return m.call(d,null==e||f?1:e)};w.compact=function(d){return w.filter(d,function(d){return!!d})};w.flatten=function(d,e){return w.reduce(d,function(d,f){if(w.isArray(f))return d.concat(e?f:w.flatten(f));d[d.length]=f;return d},[])};w.without=function(d){return w.difference(d,m.call(arguments,1))};w.uniq=w.unique=function(d,e,f){f=f?w.map(d,f):d;var h=[];3>d.length&&(e=!0);w.reduce(f,function(f,k,l){if(e?w.last(f)!==k||
!f.length:!w.include(f,k))f.push(k),h.push(d[l]);return f},[]);return h};w.union=function(){return w.uniq(w.flatten(arguments,!0))};w.intersection=w.intersect=function(d){var e=m.call(arguments,1);return w.filter(w.uniq(d),function(d){return w.every(e,function(e){return 0<=w.indexOf(e,d)})})};w.difference=function(d){var e=w.flatten(m.call(arguments,1),!0);return w.filter(d,function(d){return!w.include(e,d)})};w.zip=function(){for(var d=m.call(arguments),e=w.max(w.pluck(d,"length")),f=Array(e),h=
0;h<e;h++)f[h]=w.pluck(d,""+h);return f};w.indexOf=function(d,e,f){if(null==d)return-1;var h;if(f)return f=w.sortedIndex(d,e),d[f]===e?f:-1;if(A&&d.indexOf===A)return d.indexOf(e);f=0;for(h=d.length;f<h;f++)if(f in d&&d[f]===e)return f;return-1};w.lastIndexOf=function(d,e){if(null==d)return-1;if(B&&d.lastIndexOf===B)return d.lastIndexOf(e);for(var f=d.length;f--;)if(f in d&&d[f]===e)return f;return-1};w.range=function(d,e,f){1>=arguments.length&&(e=d||0,d=0);f=arguments[2]||1;for(var h=Math.max(Math.ceil((e-
d)/f),0),k=0,l=Array(h);k<h;)l[k++]=d,d+=f;return l};var Y=function(){};w.bind=function(d,e){var f,h;if(d.bind===H&&H)return H.apply(d,m.call(arguments,1));if(!w.isFunction(d))throw new TypeError;h=m.call(arguments,2);return f=function(){if(!(this instanceof f))return d.apply(e,h.concat(m.call(arguments)));Y.prototype=d.prototype;var k=new Y,l=d.apply(k,h.concat(m.call(arguments)));return Object(l)===l?l:k}};w.bindAll=function(d){var e=m.call(arguments,1);0==e.length&&(e=w.functions(d));F(e,function(e){d[e]=
w.bind(d[e],d)});return d};w.memoize=function(d,e){var f={};e||(e=w.identity);return function(){var h=e.apply(this,arguments);return w.has(f,h)?f[h]:f[h]=d.apply(this,arguments)}};w.delay=function(d,e){var f=m.call(arguments,2);return setTimeout(function(){return d.apply(null,f)},e)};w.defer=function(d){return w.delay.apply(w,[d,1].concat(m.call(arguments,1)))};w.throttle=function(d,e){var f,h,k,l,m,n,p=w.debounce(function(){m=l=!1},e);return function(){f=this;h=arguments;k||(k=setTimeout(function(){k=
null;m&&d.apply(f,h);p()},e));l?m=!0:n=d.apply(f,h);p();l=!0;return n}};w.debounce=function(d,e,f){var h;return function(){var k=this,l=arguments;f&&!h&&d.apply(k,l);clearTimeout(h);h=setTimeout(function(){h=null;f||d.apply(k,l)},e)}};w.once=function(d){var e=!1,f;return function(){if(e)return f;e=!0;return f=d.apply(this,arguments)}};w.wrap=function(d,e){return function(){var f=[d].concat(m.call(arguments,0));return e.apply(this,f)}};w.compose=function(){var d=arguments;return function(){for(var e=
arguments,f=d.length-1;0<=f;f--)e=[d[f].apply(this,e)];return e[0]}};w.after=function(d,e){return 0>=d?e():function(){if(1>--d)return e.apply(this,arguments)}};w.keys=C||function(d){if(d!==Object(d))throw new TypeError("Invalid object");var e=[],f;for(f in d)w.has(d,f)&&(e[e.length]=f);return e};w.values=function(d){return w.map(d,w.identity)};w.functions=w.methods=function(d){var e=[],f;for(f in d)w.isFunction(d[f])&&e.push(f);return e.sort()};w.extend=function(d){F(m.call(arguments,1),function(e){for(var f in e)d[f]=
e[f]});return d};w.pick=function(d){var e={};F(w.flatten(m.call(arguments,1)),function(f){f in d&&(e[f]=d[f])});return e};w.defaults=function(d){F(m.call(arguments,1),function(e){for(var f in e)null==d[f]&&(d[f]=e[f])});return d};w.clone=function(d){return!w.isObject(d)?d:w.isArray(d)?d.slice():w.extend({},d)};w.tap=function(d,e){e(d);return d};w.isEqual=function(e,f){return d(e,f,[])};w.isEmpty=function(d){if(null==d)return!0;if(w.isArray(d)||w.isString(d))return 0===d.length;for(var e in d)if(w.has(d,
e))return!1;return!0};w.isElement=function(d){return!!(d&&1==d.nodeType)};w.isArray=l||function(d){return"[object Array]"==p.call(d)};w.isObject=function(d){return d===Object(d)};w.isArguments=function(d){return"[object Arguments]"==p.call(d)};w.isArguments(arguments)||(w.isArguments=function(d){return!(!d||!w.has(d,"callee"))});w.isFunction=function(d){return"[object Function]"==p.call(d)};w.isString=function(d){return"[object String]"==p.call(d)};w.isNumber=function(d){return"[object Number]"==
p.call(d)};w.isFinite=function(d){return w.isNumber(d)&&isFinite(d)};w.isNaN=function(d){return d!==d};w.isBoolean=function(d){return!0===d||!1===d||"[object Boolean]"==p.call(d)};w.isDate=function(d){return"[object Date]"==p.call(d)};w.isRegExp=function(d){return"[object RegExp]"==p.call(d)};w.isNull=function(d){return null===d};w.isUndefined=function(d){return void 0===d};w.has=function(d,e){return q.call(d,e)};w.noConflict=function(){f._=e;return this};w.identity=function(d){return d};w.times=
function(d,e,f){for(var h=0;h<d;h++)e.call(f,h)};w.escape=function(d){return(""+d).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};w.result=function(d,e){if(null==d)return null;var f=d[e];return w.isFunction(f)?f.call(d):f};w.mixin=function(d){F(w.functions(d),function(e){L(e,w[e]=d[e])})};var G=0;w.uniqueId=function(d){var e=G++;return d?d+e:e};w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,
escape:/<%-([\s\S]+?)%>/g};var Q=/.^/,aa={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},da;for(da in aa)aa[aa[da]]=da;var O=/\\|'|\r|\n|\t|\u2028|\u2029/g,ea=/\\(\\|'|r|n|t|u2028|u2029)/g,ca=function(d){return d.replace(ea,function(d,e){return aa[e]})};w.template=function(d,e,f){f=w.defaults(f||{},w.templateSettings);d="__p+='"+d.replace(O,function(d){return"\\"+aa[d]}).replace(f.escape||Q,function(d,e){return"'+\n_.escape("+ca(e)+")+\n'"}).replace(f.interpolate||Q,function(d,
e){return"'+\n("+ca(e)+")+\n'"}).replace(f.evaluate||Q,function(d,e){return"';\n"+ca(e)+"\n;__p+='"})+"';\n";f.variable||(d="with(obj||{}){\n"+d+"}\n");d="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+d+"return __p;\n";var h=new Function(f.variable||"obj","_",d);if(e)return h(e,w);e=function(d){return h.call(this,d,w)};e.source="function("+(f.variable||"obj")+"){\n"+d+"}";return e};w.chain=function(d){return w(d).chain()};var ia=function(d){this._wrapped=d};w.prototype=
ia.prototype;var W=function(d,e){return e?w(d).chain():d},L=function(d,e){ia.prototype[d]=function(){var d=m.call(arguments);n.call(d,this._wrapped);return W(e.apply(w,d),this._chain)}};w.mixin(w);F("pop push reverse shift sort splice unshift".split(" "),function(d){var e=k[d];ia.prototype[d]=function(){var f=this._wrapped;e.apply(f,arguments);var h=f.length;("shift"==d||"splice"==d)&&0===h&&delete f[0];return W(f,this._chain)}});F(["concat","join","slice"],function(d){var e=k[d];ia.prototype[d]=
function(){return W(e.apply(this._wrapped,arguments),this._chain)}});ia.prototype.chain=function(){this._chain=!0;return this};ia.prototype.value=function(){return this._wrapped}}).call(this);(function(d,f){function e(d){var e=d.length,f=s.type(d);return s.isWindow(d)?!1:1===d.nodeType&&e?!0:"array"===f||"function"!==f&&(0===e||"number"==typeof e&&0<e&&e-1 in d)}function h(d){var e=Ta[d]={};return s.each(d.match(ma)||[],function(d,f){e[f]=!0}),e}function k(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});this.expando=s.expando+Math.random()}function l(d,e,h){var k;if(h===f&&1===d.nodeType)if(k="data-"+e.replace(pb,"-$1").toLowerCase(),h=d.getAttribute(k),"string"==typeof h){try{h=
"true"===h?!0:"false"===h?!1:"null"===h?null:+h+""===h?+h:qb.test(h)?JSON.parse(h):h}catch(l){}ga.set(d,e,h)}else h=f;return h}function m(){return!0}function n(){return!1}function p(){try{return J.activeElement}catch(d){}}function q(d,e){for(;(d=d[e])&&1!==d.nodeType;);return d}function r(d,e,f){if(s.isFunction(e))return s.grep(d,function(d,h){return!!e.call(d,h,d)!==f});if(e.nodeType)return s.grep(d,function(d){return d===e!==f});if("string"==typeof e){if(rb.test(e))return s.filter(e,d,f);e=s.filter(e,
d)}return s.grep(d,function(d){return 0<=za.call(e,d)!==f})}function t(d,e){return s.nodeName(d,"table")&&s.nodeName(1===e.nodeType?e:e.firstChild,"tr")?d.getElementsByTagName("tbody")[0]||d.appendChild(d.ownerDocument.createElement("tbody")):d}function u(d){return d.type=(null!==d.getAttribute("type"))+"/"+d.type,d}function x(d){var e=sb.exec(d.type);return e?d.type=e[1]:d.removeAttribute("type"),d}function v(d,e){for(var f=d.length,h=0;f>h;h++)K.set(d[h],"globalEval",!e||K.get(e[h],"globalEval"))}
function z(d,e){var f,h,k,l,m,n;if(1===e.nodeType){if(K.hasData(d)&&(f=K.access(d),h=s.extend({},f),n=f.events,K.set(e,h),n))for(k in delete h.handle,h.events={},n){f=0;for(h=n[k].length;h>f;f++)s.event.add(e,k,n[k][f])}ga.hasData(d)&&(l=ga.access(d),m=s.extend({},l),ga.set(e,m))}}function y(d,e){var h=d.getElementsByTagName?d.getElementsByTagName(e||"*"):d.querySelectorAll?d.querySelectorAll(e||"*"):[];return e===f||e&&s.nodeName(d,e)?s.merge([d],h):h}function A(d,e){if(e in d)return e;for(var f=
e.charAt(0).toUpperCase()+e.slice(1),h=e,k=Va.length;k--;)if(e=Va[k]+f,e in d)return e;return h}function B(d,e){return d=e||d,"none"===s.css(d,"display")||!s.contains(d.ownerDocument,d)}function C(d,e){for(var f,h,k,l=[],m=0,n=d.length;n>m;m++)h=d[m],h.style&&(l[m]=K.get(h,"olddisplay"),f=h.style.display,e?(l[m]||"none"!==f||(h.style.display=""),""===h.style.display&&B(h)&&(l[m]=K.access(h,"olddisplay",E(h.nodeName)))):l[m]||(k=B(h),(f&&"none"!==f||!k)&&K.set(h,"olddisplay",k?f:s.css(h,"display"))));
for(m=0;n>m;m++)h=d[m],h.style&&(e&&"none"!==h.style.display&&""!==h.style.display||(h.style.display=e?l[m]||"":"none"));return d}function H(d,e,f){return(d=tb.exec(e))?Math.max(0,d[1]-(f||0))+(d[2]||"px"):e}function w(d,e,f,h,k){e=f===(h?"border":"content")?4:"width"===e?1:0;for(var l=0;4>e;e+=2)"margin"===f&&(l+=s.css(d,f+ta[e],!0,k)),h?("content"===f&&(l-=s.css(d,"padding"+ta[e],!0,k)),"margin"!==f&&(l-=s.css(d,"border"+ta[e]+"Width",!0,k))):(l+=s.css(d,"padding"+ta[e],!0,k),"padding"!==f&&(l+=
s.css(d,"border"+ta[e]+"Width",!0,k)));return l}function F(e,f,h){var k=!0,l="width"===f?e.offsetWidth:e.offsetHeight,m=d.getComputedStyle(e,null),n=s.support.boxSizing&&"border-box"===s.css(e,"boxSizing",!1,m);if(0>=l||null==l){if(l=ua(e,f,m),(0>l||null==l)&&(l=e.style[f]),La.test(l))return l;k=n&&(s.support.boxSizingReliable||l===e.style[f]);l=parseFloat(l)||0}return l+w(e,f,h||(n?"border":"content"),k,m)+"px"}function E(d){var e=J,f=Wa[d];return f||(f=Y(d,e),"none"!==f&&f||(va=(va||s("<iframe frameborder='0' width='0' height='0'/>").css("cssText",
"display:block !important")).appendTo(e.documentElement),e=(va[0].contentWindow||va[0].contentDocument).document,e.write("<!doctype html><html><body>"),e.close(),f=Y(d,e),va.detach()),Wa[d]=f),f}function Y(d,e){var f=s(e.createElement(d)).appendTo(e.body),h=s.css(f[0],"display");return f.remove(),h}function G(d,e,f,h){var k;if(s.isArray(e))s.each(e,function(e,k){f||ub.test(d)?h(d,k):G(d+"["+("object"==typeof k?e:"")+"]",k,f,h)});else if(f||"object"!==s.type(e))h(d,e);else for(k in e)G(d+"["+k+"]",
e[k],f,h)}function Q(d){return function(e,f){"string"!=typeof e&&(f=e,e="*");var h,k=0,l=e.toLowerCase().match(ma)||[];if(s.isFunction(f))for(;h=l[k++];)"+"===h[0]?(h=h.slice(1)||"*",(d[h]=d[h]||[]).unshift(f)):(d[h]=d[h]||[]).push(f)}}function aa(d,e,h,k){function l(p){var q;return m[p]=!0,s.each(d[p]||[],function(d,p){var I=p(e,h,k);return"string"!=typeof I||n||m[I]?n?!(q=I):f:(e.dataTypes.unshift(I),l(I),!1)}),q}var m={},n=d===Ma;return l(e.dataTypes[0])||!m["*"]&&l("*")}function da(d,e){var h,
k,l=s.ajaxSettings.flatOptions||{};for(h in e)e[h]!==f&&((l[h]?d:k||(k={}))[h]=e[h]);return k&&s.extend(!0,d,k),d}function O(){return setTimeout(function(){wa=f}),wa=s.now()}function ea(d,e){s.each(e,function(e,f){for(var h=(pa[e]||[]).concat(pa["*"]),k=0,l=h.length;l>k&&!h[k].call(d,e,f);k++);})}function ca(d,e,f){var h,k=0,l=Ha.length,m=s.Deferred().always(function(){delete n.elem}),n=function(){if(h)return!1;for(var e=wa||O(),e=Math.max(0,p.startTime+p.duration-e),f=1-(e/p.duration||0),k=0,l=p.tweens.length;l>
k;k++)p.tweens[k].run(f);return m.notifyWith(d,[p,f,e]),1>f&&l?e:(m.resolveWith(d,[p]),!1)},p=m.promise({elem:d,props:s.extend({},e),opts:s.extend(!0,{specialEasing:{}},f),originalProperties:e,originalOptions:f,startTime:wa||O(),duration:f.duration,tweens:[],createTween:function(e,f){var h=s.Tween(d,p.opts,e,f,p.opts.specialEasing[e]||p.opts.easing);return p.tweens.push(h),h},stop:function(e){var f=0,k=e?p.tweens.length:0;if(h)return this;for(h=!0;k>f;f++)p.tweens[f].run(1);return e?m.resolveWith(d,
[p,e]):m.rejectWith(d,[p,e]),this}});f=p.props;for(ia(f,p.opts.specialEasing);l>k;k++)if(e=Ha[k].call(p,d,f,p.opts))return e;return ea(p,f),s.isFunction(p.opts.start)&&p.opts.start.call(d,p),s.fx.timer(s.extend(n,{elem:d,anim:p,queue:p.opts.queue})),p.progress(p.opts.progress).done(p.opts.done,p.opts.complete).fail(p.opts.fail).always(p.opts.always)}function ia(d,e){var f,h,k,l,m;for(f in d)if(h=s.camelCase(f),k=e[h],l=d[f],s.isArray(l)&&(k=l[1],l=d[f]=l[0]),f!==h&&(d[h]=l,delete d[f]),m=s.cssHooks[h],
m&&"expand"in m)for(f in l=m.expand(l),delete d[h],l)f in d||(d[f]=l[f],e[f]=k);else e[h]=k}function W(d,e,f,h,k){return new W.prototype.init(d,e,f,h,k)}function L(d,e){var f,h={height:d},k=0;for(e=e?1:0;4>k;k+=2-e)f=ta[k],h["margin"+f]=h["padding"+f]=d;return e&&(h.opacity=h.width=d),h}var X,M,Z=typeof f,U=d.location,J=d.document,na=J.documentElement,ra=d.jQuery,ka=d.$,oa={},Ia=[],Xa=Ia.concat,Na=Ia.push,xa=Ia.slice,za=Ia.indexOf,vb=oa.toString,Oa=oa.hasOwnProperty,wb="2.0.0".trim,s=function(d,e){return new s.fn.init(d,
e,X)},Ja=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ma=/\S+/g,xb=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,Ya=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,yb=/^-ms-/,zb=/-([\da-z])/gi,Ab=function(d,e){return e.toUpperCase()},ya=function(){J.removeEventListener("DOMContentLoaded",ya,!1);d.removeEventListener("load",ya,!1);s.ready()};s.fn=s.prototype={jquery:"2.0.0",constructor:s,init:function(d,e,h){var k,l;if(!d)return this;if("string"==typeof d){if(k="<"===d.charAt(0)&&">"===d.charAt(d.length-1)&&3<=d.length?[null,d,
null]:xb.exec(d),!k||!k[1]&&e)return!e||e.jquery?(e||h).find(d):this.constructor(e).find(d);if(k[1]){if(e=e instanceof s?e[0]:e,s.merge(this,s.parseHTML(k[1],e&&e.nodeType?e.ownerDocument||e:J,!0)),Ya.test(k[1])&&s.isPlainObject(e))for(k in e)s.isFunction(this[k])?this[k](e[k]):this.attr(k,e[k]);return this}return l=J.getElementById(k[2]),l&&l.parentNode&&(this.length=1,this[0]=l),this.context=J,this.selector=d,this}return d.nodeType?(this.context=this[0]=d,this.length=1,this):s.isFunction(d)?h.ready(d):
(d.selector!==f&&(this.selector=d.selector,this.context=d.context),s.makeArray(d,this))},selector:"",length:0,toArray:function(){return xa.call(this)},get:function(d){return null==d?this.toArray():0>d?this[this.length+d]:this[d]},pushStack:function(d){d=s.merge(this.constructor(),d);return d.prevObject=this,d.context=this.context,d},each:function(d,e){return s.each(this,d,e)},ready:function(d){return s.ready.promise().done(d),this},slice:function(){return this.pushStack(xa.apply(this,arguments))},
first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(d){var e=this.length;d=+d+(0>d?e:0);return this.pushStack(0<=d&&e>d?[this[d]]:[])},map:function(d){return this.pushStack(s.map(this,function(e,f){return d.call(e,f,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:Na,sort:[].sort,splice:[].splice};s.fn.init.prototype=s.fn;s.extend=s.fn.extend=function(){var d,e,h,k,l,m,n=arguments[0]||{},p=1,q=arguments.length,r=!1;"boolean"==typeof n&&(r=
n,n=arguments[1]||{},p=2);"object"==typeof n||s.isFunction(n)||(n={});for(q===p&&(n=this,--p);q>p;p++)if(null!=(d=arguments[p]))for(e in d)h=n[e],k=d[e],n!==k&&(r&&k&&(s.isPlainObject(k)||(l=s.isArray(k)))?(l?(l=!1,m=h&&s.isArray(h)?h:[]):m=h&&s.isPlainObject(h)?h:{},n[e]=s.extend(r,m,k)):k!==f&&(n[e]=k));return n};s.extend({expando:"jQuery"+("2.0.0"+Math.random()).replace(/\D/g,""),noConflict:function(e){return d.$===s&&(d.$=ka),e&&d.jQuery===s&&(d.jQuery=ra),s},isReady:!1,readyWait:1,holdReady:function(d){d?
s.readyWait++:s.ready(!0)},ready:function(d){(!0===d?--s.readyWait:s.isReady)||(s.isReady=!0,!0!==d&&0<--s.readyWait||(M.resolveWith(J,[s]),s.fn.trigger&&s(J).trigger("ready").off("ready")))},isFunction:function(d){return"function"===s.type(d)},isArray:Array.isArray,isWindow:function(d){return null!=d&&d===d.window},isNumeric:function(d){return!isNaN(parseFloat(d))&&isFinite(d)},type:function(d){return null==d?d+"":"object"==typeof d||"function"==typeof d?oa[vb.call(d)]||"object":typeof d},isPlainObject:function(d){if("object"!==
s.type(d)||d.nodeType||s.isWindow(d))return!1;try{if(d.constructor&&!Oa.call(d.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},isEmptyObject:function(d){for(var e in d)return!1;return!0},error:function(d){throw Error(d);},parseHTML:function(d,e,f){if(!d||"string"!=typeof d)return null;"boolean"==typeof e&&(f=e,e=!1);e=e||J;var h=Ya.exec(d);f=!f&&[];return h?[e.createElement(h[1])]:(h=s.buildFragment([d],e,f),f&&s(f).remove(),s.merge([],h.childNodes))},parseJSON:JSON.parse,
parseXML:function(d){var e,h;if(!d||"string"!=typeof d)return null;try{h=new DOMParser,e=h.parseFromString(d,"text/xml")}catch(k){e=f}return(!e||e.getElementsByTagName("parsererror").length)&&s.error("Invalid XML: "+d),e},noop:function(){},globalEval:function(d){var e,f=eval;(d=s.trim(d))&&(1===d.indexOf("use strict")?(e=J.createElement("script"),e.text=d,J.head.appendChild(e).parentNode.removeChild(e)):f(d))},camelCase:function(d){return d.replace(yb,"ms-").replace(zb,Ab)},nodeName:function(d,e){return d.nodeName&&
d.nodeName.toLowerCase()===e.toLowerCase()},each:function(d,f,h){var k,l=0,m=d.length,n=e(d);if(h)if(n)for(;m>l&&!(k=f.apply(d[l],h),!1===k);l++);else for(l in d){if(k=f.apply(d[l],h),!1===k)break}else if(n)for(;m>l&&!(k=f.call(d[l],l,d[l]),!1===k);l++);else for(l in d)if(k=f.call(d[l],l,d[l]),!1===k)break;return d},trim:function(d){return null==d?"":wb.call(d)},makeArray:function(d,f){var h=f||[];return null!=d&&(e(Object(d))?s.merge(h,"string"==typeof d?[d]:d):Na.call(h,d)),h},inArray:function(d,
e,f){return null==e?-1:za.call(e,d,f)},merge:function(d,e){var h=e.length,k=d.length,l=0;if("number"==typeof h)for(;h>l;l++)d[k++]=e[l];else for(;e[l]!==f;)d[k++]=e[l++];return d.length=k,d},grep:function(d,e,f){var h,k=[],l=0,m=d.length;for(f=!!f;m>l;l++)h=!!e(d[l],l),f!==h&&k.push(d[l]);return k},map:function(d,f,h){var k,l=0,m=d.length,n=[];if(e(d))for(;m>l;l++)k=f(d[l],l,h),null!=k&&(n[n.length]=k);else for(l in d)k=f(d[l],l,h),null!=k&&(n[n.length]=k);return Xa.apply([],n)},guid:1,proxy:function(d,
e){var h,k,l;return"string"==typeof e&&(h=d[e],e=d,d=h),s.isFunction(d)?(k=xa.call(arguments,2),l=function(){return d.apply(e||this,k.concat(xa.call(arguments)))},l.guid=d.guid=d.guid||s.guid++,l):f},access:function(d,e,h,k,l,m,n){var p=0,q=d.length,r=null==h;if("object"===s.type(h))for(p in l=!0,h)s.access(d,e,p,h[p],!0,m,n);else if(k!==f&&(l=!0,s.isFunction(k)||(n=!0),r&&(n?(e.call(d,k),e=null):(r=e,e=function(d,e,f){return r.call(s(d),f)})),e))for(;q>p;p++)e(d[p],h,n?k:k.call(d[p],p,e(d[p],h)));
return l?d:r?e.call(d):q?e(d[0],h):m},now:Date.now,swap:function(d,e,f,h){var k,l={};for(k in e)l[k]=d.style[k],d.style[k]=e[k];f=f.apply(d,h||[]);for(k in e)d.style[k]=l[k];return f}});s.ready.promise=function(e){return M||(M=s.Deferred(),"complete"===J.readyState?setTimeout(s.ready):(J.addEventListener("DOMContentLoaded",ya,!1),d.addEventListener("load",ya,!1))),M.promise(e)};s.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(d,e){oa["[object "+e+"]"]=e.toLowerCase()});
X=s(J);(function(d,e){function f(d){return Ka.test(d+"")}function h(){var d,e=[];return d=function(f,h){return e.push(f+=" ")>G.cacheLength&&delete d[e.shift()],d[f]=h}}function k(d){return d[ha]=!0,d}function l(d){var e=O.createElement("div");try{return!!d(e)}catch(f){return!1}finally{e.parentNode&&e.parentNode.removeChild(e)}}function m(d,e,f,h){var k,l,n,p,q;if((e?e.ownerDocument||e:Z)!==O&&K(e),e=e||O,f=f||[],!d||"string"!=typeof d)return f;if(1!==(p=e.nodeType)&&9!==p)return[];if(ea&&!h){if(k=
La.exec(d))if(n=k[1])if(9===p){if(l=e.getElementById(n),!l||!l.parentNode)return f;if(l.id===n)return f.push(l),f}else{if(e.ownerDocument&&(l=e.ownerDocument.getElementById(n))&&W(e,l)&&l.id===n)return f.push(l),f}else{if(k[2])return Aa.apply(f,e.getElementsByTagName(d)),f;if((n=k[3])&&fa.getElementsByClassName&&e.getElementsByClassName)return Aa.apply(f,e.getElementsByClassName(n)),f}if(fa.qsa&&(!M||!M.test(d))){if(l=k=ha,n=e,q=9===p&&d,1===p&&"object"!==e.nodeName.toLowerCase()){p=x(d);(k=e.getAttribute("id"))?
l=k.replace(Oa,"\\$&"):e.setAttribute("id",l);l="[id='"+l+"'] ";for(n=p.length;n--;)p[n]=l+v(p[n]);n=za.test(d)&&e.parentNode||e;q=p.join(",")}if(q)try{return Aa.apply(f,n.querySelectorAll(q)),f}catch(I){}finally{k||e.removeAttribute("id")}}}var r;a:{d=d.replace(pa,"$1");var s,ba;l=x(d);if(!h&&1===l.length){if(r=l[0]=l[0].slice(0),2<r.length&&"ID"===(s=r[0]).type&&9===e.nodeType&&ea&&G.relative[r[1].type]){if(e=(G.find.ID(s.matches[0].replace(Ba,Ca),e)||[])[0],!e){r=f;break a}d=d.slice(r.shift().value.length)}for(p=
ya.needsContext.test(d)?0:r.length;p--&&!(s=r[p],G.relative[k=s.type]);)if((ba=G.find[k])&&(h=ba(s.matches[0].replace(Ba,Ca),za.test(r[0].type)&&e.parentNode||e))){if(r.splice(p,1),d=h.length&&v(r),!d){r=(Aa.apply(f,h),f);break a}break}}r=(aa(d,l)(h,e,!ea,f,za.test(d)),f)}return r}function n(d,e){var f=e&&d,h=f&&(~e.sourceIndex||oa)-(~d.sourceIndex||oa);if(h)return h;if(f)for(;f=f.nextSibling;)if(f===e)return-1;return d?1:-1}function p(d,f,h){var k;return h?e:(k=d.getAttributeNode(f))&&k.specified?
k.value:!0===d[f]?f.toLowerCase():null}function q(d,f,h){return h?e:d.getAttribute(f,"type"===f.toLowerCase()?1:2)}function r(d){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===d}}function t(d){return function(e){var f=e.nodeName.toLowerCase();return("input"===f||"button"===f)&&e.type===d}}function u(d){return k(function(e){return e=+e,k(function(f,h){for(var k,l=d([],f.length,e),m=l.length;m--;)f[k=l[m]]&&(f[k]=!(h[k]=f[k]))})})}function x(d,e){var f,h,k,l,n,p,q;if(n=la[d+" "])return e?
0:n.slice(0);n=d;p=[];for(q=G.preFilter;n;){(!f||(h=Ea.exec(n)))&&(h&&(n=n.slice(h[0].length)||n),p.push(k=[]));f=!1;(h=Fa.exec(n))&&(f=h.shift(),k.push({value:f,type:h[0].replace(pa," ")}),n=n.slice(f.length));for(l in G.filter)!(h=ya[l].exec(n))||q[l]&&!(h=q[l](h))||(f=h.shift(),k.push({value:f,type:l,matches:h}),n=n.slice(f.length));if(!f)break}return e?n.length:n?m.error(d):la(d,p).slice(0)}function v(d){for(var e=0,f=d.length,h="";f>e;e++)h+=d[e].value;return h}function w(d,e,f){var h=e.dir,
k=f&&"parentNode"===h,l=ia++;return e.first?function(e,f,l){for(;e=e[h];)if(1===e.nodeType||k)return d(e,f,l)}:function(e,f,m){var n,p,q,I=ca+" "+l;if(m)for(;e=e[h];){if((1===e.nodeType||k)&&d(e,f,m))return!0}else for(;e=e[h];)if(1===e.nodeType||k)if(q=e[ha]||(e[ha]={}),(p=q[h])&&p[0]===I){if(!0===(n=p[1])||n===F)return!0===n}else if(p=q[h]=[I],p[1]=d(e,f,m)||F,!0===p[1])return!0}}function A(d){return 1<d.length?function(e,f,h){for(var k=d.length;k--;)if(!d[k](e,f,h))return!1;return!0}:d[0]}function z(d,
e,f,h,k){for(var l,m=[],n=0,p=d.length,q=null!=e;p>n;n++)(l=d[n])&&(!f||f(l,h,k))&&(m.push(l),q&&e.push(n));return m}function y(d,e,f,h,l,n){return h&&!h[ha]&&(h=y(h)),l&&!l[ha]&&(l=y(l,n)),k(function(k,n,p,q){var I,r,s=[],ba=[],t=n.length,T;if(!(T=k)){T=e||"*";for(var u=p.nodeType?[p]:p,x=[],Ga=0,v=u.length;v>Ga;Ga++)m(T,u[Ga],x);T=x}T=!d||!k&&e?T:z(T,s,d,p,q);u=f?l||(k?d:t||h)?[]:n:T;if(f&&f(T,u,p,q),h){I=z(u,ba);h(I,[],p,q);for(p=I.length;p--;)(r=I[p])&&(u[ba[p]]=!(T[ba[p]]=r))}if(k){if(l||d){if(l){I=
[];for(p=u.length;p--;)(r=u[p])&&I.push(T[p]=r);l(null,u=[],I,q)}for(p=u.length;p--;)(r=u[p])&&-1<(I=l?Da.call(k,r):s[p])&&(k[I]=!(n[I]=r))}}else u=z(u===n?u.splice(t,u.length):u),l?l(null,n,u,q):Aa.apply(n,u)})}function B(d){var e,f,h,k=d.length,l=G.relative[d[0].type];f=l||G.relative[" "];for(var m=l?1:0,n=w(function(d){return d===e},f,!0),p=w(function(d){return-1<Da.call(e,d)},f,!0),q=[function(d,f,h){return!l&&(h||f!==da)||((e=f).nodeType?n(d,f,h):p(d,f,h))}];k>m;m++)if(f=G.relative[d[m].type])q=
[w(A(q),f)];else{if(f=G.filter[d[m].type].apply(null,d[m].matches),f[ha]){for(h=++m;k>h&&!G.relative[d[h].type];h++);return y(1<m&&A(q),1<m&&v(d.slice(0,m-1)).replace(pa,"$1"),f,h>m&&B(d.slice(m,h)),k>h&&B(d=d.slice(h)),k>h&&v(d))}q.push(f)}return A(q)}function C(d,e){var f=0,h=0<e.length,l=0<d.length,n=function(k,n,p,q,I){var r,s,ba=[],t=0,T="0",u=k&&[],x=null!=I,Ga=da,v=k||l&&G.find.TAG("*",I&&n.parentNode||n),Ua=ca+=null==Ga?1:Math.random()||0.1;for(x&&(da=n!==O&&n,F=f);null!=(I=v[T]);T++){if(l&&
I){for(r=0;s=d[r++];)if(s(I,n,p)){q.push(I);break}x&&(ca=Ua,F=++f)}h&&((I=!s&&I)&&t--,k&&u.push(I))}if(t+=T,h&&T!==t){for(r=0;s=e[r++];)s(u,ba,n,p);if(k){if(0<t)for(;T--;)u[T]||ba[T]||(ba[T]=ta.call(q));ba=z(ba)}Aa.apply(q,ba);x&&!k&&0<ba.length&&1<t+e.length&&m.uniqueSort(q)}return x&&(ca=Ua,da=Ga),u};return h?k(n):n}function H(){}var E,F,G,Q,Y,aa,da,J,K,O,L,ea,M,U,X,W,ha="sizzle"+-new Date,Z=d.document,fa={},ca=0,ia=0,ga=h(),la=h(),ra=h(),na=!1,ma=function(){return 0},ka=typeof e,oa=-2147483648,
ja=[],ta=ja.pop,xa=ja.push,Aa=ja.push,qa=ja.slice,Da=ja.indexOf||function(d){for(var e=0,f=this.length;f>e;e++)if(this[e]===d)return e;return-1},ua="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),wa="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ua+")|)|)[\\x20\\t\\r\\n\\f]*\\]",va=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+wa.replace(3,
8)+")*)|.*)\\)|)",pa=/^[\x20\t\r\n\f]+|((?:^|[^\\])(?:\\.)*)[\x20\t\r\n\f]+$/g,Ea=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Fa=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,za=/[\x20\t\r\n\f]*[+~]/,Ha=/=[\x20\t\r\n\f]*([^\]'"]*)[\x20\t\r\n\f]*\]/g,Ia=RegExp(va),Ja=RegExp("^"+ua+"$"),ya={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+wa),PSEUDO:RegExp("^"+va),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)",
"i"),"boolean":RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Ka=/^[^{]+\{\s*\[native \w/,La=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Ma=/^(?:input|select|textarea|button)$/i,Na=/^h\d$/i,Oa=/'|\\/g,Ba=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,Ca=
function(d,e){var f="0x"+e-65536;return f!==f?e:0>f?String.fromCharCode(f+65536):String.fromCharCode(55296|f>>10,56320|1023&f)};try{Aa.apply(ja=qa.call(Z.childNodes),Z.childNodes),ja[Z.childNodes.length].nodeType}catch(Pa){Aa={apply:ja.length?function(d,e){xa.apply(d,qa.call(e))}:function(d,e){for(var f=d.length,h=0;d[f++]=e[h++];);d.length=f-1}}}Y=m.isXML=function(d){return(d=d&&(d.ownerDocument||d).documentElement)?"HTML"!==d.nodeName:!1};K=m.setDocument=function(d){var h=d?d.ownerDocument||d:Z;
return h!==O&&9===h.nodeType&&h.documentElement?(O=h,L=h.documentElement,ea=!Y(h),fa.getElementsByTagName=l(function(d){return d.appendChild(h.createComment("")),!d.getElementsByTagName("*").length}),fa.attributes=l(function(d){return d.className="i",!d.getAttribute("className")}),fa.getElementsByClassName=l(function(d){return d.innerHTML="<div class='a'></div><div class='a i'></div>",d.firstChild.className="i",2===d.getElementsByClassName("i").length}),fa.sortDetached=l(function(d){return 1&d.compareDocumentPosition(O.createElement("div"))}),
fa.getById=l(function(d){return L.appendChild(d).id=ha,!h.getElementsByName||!h.getElementsByName(ha).length}),fa.getById?(G.find.ID=function(d,e){if(typeof e.getElementById!==ka&&ea){var f=e.getElementById(d);return f&&f.parentNode?[f]:[]}},G.filter.ID=function(d){var e=d.replace(Ba,Ca);return function(d){return d.getAttribute("id")===e}}):(G.find.ID=function(d,f){if(typeof f.getElementById!==ka&&ea){var h=f.getElementById(d);return h?h.id===d||typeof h.getAttributeNode!==ka&&h.getAttributeNode("id").value===
d?[h]:e:[]}},G.filter.ID=function(d){var e=d.replace(Ba,Ca);return function(d){return(d=typeof d.getAttributeNode!==ka&&d.getAttributeNode("id"))&&d.value===e}}),G.find.TAG=fa.getElementsByTagName?function(d,f){return typeof f.getElementsByTagName!==ka?f.getElementsByTagName(d):e}:function(d,e){var f,h=[],k=0,l=e.getElementsByTagName(d);if("*"===d){for(;f=l[k++];)1===f.nodeType&&h.push(f);return h}return l},G.find.CLASS=fa.getElementsByClassName&&function(d,f){return typeof f.getElementsByClassName!==
ka&&ea?f.getElementsByClassName(d):e},U=[],M=[],(fa.qsa=f(h.querySelectorAll))&&(l(function(d){d.innerHTML="<select><option selected=''></option></select>";d.querySelectorAll("[selected]").length||M.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");d.querySelectorAll(":checked").length||M.push(":checked")}),l(function(d){var e=O.createElement("input");e.setAttribute("type","hidden");d.appendChild(e).setAttribute("t",
"");d.querySelectorAll("[t^='']").length&&M.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");d.querySelectorAll(":enabled").length||M.push(":enabled",":disabled");d.querySelectorAll("*,:x");M.push(",.*:")})),(fa.matchesSelector=f(X=L.webkitMatchesSelector||L.mozMatchesSelector||L.oMatchesSelector||L.msMatchesSelector))&&l(function(d){fa.disconnectedMatch=X.call(d,"div");X.call(d,"[s!='']:x");U.push("!=",va)}),M=M.length&&RegExp(M.join("|")),U=U.length&&RegExp(U.join("|")),W=f(L.contains)||L.compareDocumentPosition?
function(d,e){var f=9===d.nodeType?d.documentElement:d,h=e&&e.parentNode;return d===h||!(!h||1!==h.nodeType||!(f.contains?f.contains(h):d.compareDocumentPosition&&16&d.compareDocumentPosition(h)))}:function(d,e){if(e)for(;e=e.parentNode;)if(e===d)return!0;return!1},ma=L.compareDocumentPosition?function(d,e){if(d===e)return na=!0,0;var f=e.compareDocumentPosition&&d.compareDocumentPosition&&d.compareDocumentPosition(e);return f?1&f||!fa.sortDetached&&e.compareDocumentPosition(d)===f?d===h||W(Z,d)?
-1:e===h||W(Z,e)?1:J?Da.call(J,d)-Da.call(J,e):0:4&f?-1:1:d.compareDocumentPosition?-1:1}:function(d,e){var f,k=0;f=d.parentNode;var l=e.parentNode,m=[d],p=[e];if(d===e)return na=!0,0;if(!f||!l)return d===h?-1:e===h?1:f?-1:l?1:J?Da.call(J,d)-Da.call(J,e):0;if(f===l)return n(d,e);for(f=d;f=f.parentNode;)m.unshift(f);for(f=e;f=f.parentNode;)p.unshift(f);for(;m[k]===p[k];)k++;return k?n(m[k],p[k]):m[k]===Z?-1:p[k]===Z?1:0},O):O};m.matches=function(d,e){return m(d,null,null,e)};m.matchesSelector=function(d,
e){if((d.ownerDocument||d)!==O&&K(d),e=e.replace(Ha,"='$1']"),!(!fa.matchesSelector||!ea||U&&U.test(e)||M&&M.test(e)))try{var f=X.call(d,e);if(f||fa.disconnectedMatch||d.document&&11!==d.document.nodeType)return f}catch(h){}return 0<m(e,O,null,[d]).length};m.contains=function(d,e){return(d.ownerDocument||d)!==O&&K(d),W(d,e)};m.attr=function(d,f){(d.ownerDocument||d)!==O&&K(d);var h=G.attrHandle[f.toLowerCase()],h=h&&h(d,f,!ea);return h===e?fa.attributes||!ea?d.getAttribute(f):(h=d.getAttributeNode(f))&&
h.specified?h.value:null:h};m.error=function(d){throw Error("Syntax error, unrecognized expression: "+d);};m.uniqueSort=function(d){var e,f=[],h=0,k=0;if(na=!fa.detectDuplicates,J=!fa.sortStable&&d.slice(0),d.sort(ma),na){for(;e=d[k++];)e===d[k]&&(h=f.push(k));for(;h--;)d.splice(f[h],1)}return d};Q=m.getText=function(d){var e,f="",h=0;if(e=d.nodeType)if(1===e||9===e||11===e){if("string"==typeof d.textContent)return d.textContent;for(d=d.firstChild;d;d=d.nextSibling)f+=Q(d)}else{if(3===e||4===e)return d.nodeValue}else for(;e=
d[h];h++)f+=Q(e);return f};G=m.selectors={cacheLength:50,createPseudo:k,match:ya,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(d){return d[1]=d[1].replace(Ba,Ca),d[3]=(d[4]||d[5]||"").replace(Ba,Ca),"~="===d[2]&&(d[3]=" "+d[3]+" "),d.slice(0,4)},CHILD:function(d){return d[1]=d[1].toLowerCase(),"nth"===d[1].slice(0,3)?(d[3]||m.error(d[0]),d[4]=+(d[4]?d[5]+(d[6]||1):2*
("even"===d[3]||"odd"===d[3])),d[5]=+(d[7]+d[8]||"odd"===d[3])):d[3]&&m.error(d[0]),d},PSEUDO:function(d){var e,f=!d[5]&&d[2];return ya.CHILD.test(d[0])?null:(d[4]?d[2]=d[4]:f&&Ia.test(f)&&(e=x(f,!0))&&(e=f.indexOf(")",f.length-e)-f.length)&&(d[0]=d[0].slice(0,e),d[2]=f.slice(0,e)),d.slice(0,3))}},filter:{TAG:function(d){var e=d.replace(Ba,Ca).toLowerCase();return"*"===d?function(){return!0}:function(d){return d.nodeName&&d.nodeName.toLowerCase()===e}},CLASS:function(d){var e=ga[d+" "];return e||
(e=RegExp("(^|[\\x20\\t\\r\\n\\f])"+d+"([\\x20\\t\\r\\n\\f]|$)"))&&ga(d,function(d){return e.test("string"==typeof d.className&&d.className||typeof d.getAttribute!==ka&&d.getAttribute("class")||"")})},ATTR:function(d,e,f){return function(h){h=m.attr(h,d);return null==h?"!="===e:e?(h+="","="===e?h===f:"!="===e?h!==f:"^="===e?f&&0===h.indexOf(f):"*="===e?f&&-1<h.indexOf(f):"$="===e?f&&h.slice(-f.length)===f:"~="===e?-1<(" "+h+" ").indexOf(f):"|="===e?h===f||h.slice(0,f.length+1)===f+"-":!1):!0}},CHILD:function(d,
e,f,h,k){var l="nth"!==d.slice(0,3),m="last"!==d.slice(-4),n="of-type"===e;return 1===h&&0===k?function(d){return!!d.parentNode}:function(e,f,p){var q,I,r,s,ba;f=l!==m?"nextSibling":"previousSibling";var t=e.parentNode,T=n&&e.nodeName.toLowerCase();p=!p&&!n;if(t){if(l){for(;f;){for(I=e;I=I[f];)if(n?I.nodeName.toLowerCase()===T:1===I.nodeType)return!1;ba=f="only"===d&&!ba&&"nextSibling"}return!0}if(ba=[m?t.firstChild:t.lastChild],m&&p){p=t[ha]||(t[ha]={});q=p[d]||[];s=q[0]===ca&&q[1];r=q[0]===ca&&
q[2];for(I=s&&t.childNodes[s];I=++s&&I&&I[f]||(r=s=0)||ba.pop();)if(1===I.nodeType&&++r&&I===e){p[d]=[ca,s,r];break}}else if(p&&(q=(e[ha]||(e[ha]={}))[d])&&q[0]===ca)r=q[1];else for(;(I=++s&&I&&I[f]||(r=s=0)||ba.pop())&&(!(n?I.nodeName.toLowerCase()===T:1===I.nodeType)||!++r||!(p&&((I[ha]||(I[ha]={}))[d]=[ca,r]),I===e)););return r-=k,r===h||0===r%h&&0<=r/h}}},PSEUDO:function(d,e){var f,h=G.pseudos[d]||G.setFilters[d.toLowerCase()]||m.error("unsupported pseudo: "+d);return h[ha]?h(e):1<h.length?(f=
[d,d,"",e],G.setFilters.hasOwnProperty(d.toLowerCase())?k(function(d,f){for(var k,l=h(d,e),m=l.length;m--;)k=Da.call(d,l[m]),d[k]=!(f[k]=l[m])}):function(d){return h(d,0,f)}):h}},pseudos:{not:k(function(d){var e=[],f=[],h=aa(d.replace(pa,"$1"));return h[ha]?k(function(d,e,f,k){var l;f=h(d,null,k,[]);for(k=d.length;k--;)(l=f[k])&&(d[k]=!(e[k]=l))}):function(d,k,l){return e[0]=d,h(e,null,l,f),!f.pop()}}),has:k(function(d){return function(e){return 0<m(d,e).length}}),contains:k(function(d){return function(e){return-1<
(e.textContent||e.innerText||Q(e)).indexOf(d)}}),lang:k(function(d){return Ja.test(d||"")||m.error("unsupported lang: "+d),d=d.replace(Ba,Ca).toLowerCase(),function(e){var f;do if(f=ea?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return f=f.toLowerCase(),f===d||0===f.indexOf(d+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var f=d.location&&d.location.hash;return f&&f.slice(1)===e.id},root:function(d){return d===L},focus:function(d){return d===O.activeElement&&
(!O.hasFocus||O.hasFocus())&&!(!d.type&&!d.href&&!~d.tabIndex)},enabled:function(d){return!1===d.disabled},disabled:function(d){return!0===d.disabled},checked:function(d){var e=d.nodeName.toLowerCase();return"input"===e&&!!d.checked||"option"===e&&!!d.selected},selected:function(d){return d.parentNode&&d.parentNode.selectedIndex,!0===d.selected},empty:function(d){for(d=d.firstChild;d;d=d.nextSibling)if("@"<d.nodeName||3===d.nodeType||4===d.nodeType)return!1;return!0},parent:function(d){return!G.pseudos.empty(d)},
header:function(d){return Na.test(d.nodeName)},input:function(d){return Ma.test(d.nodeName)},button:function(d){var e=d.nodeName.toLowerCase();return"input"===e&&"button"===d.type||"button"===e},text:function(d){var e;return"input"===d.nodeName.toLowerCase()&&"text"===d.type&&(null==(e=d.getAttribute("type"))||e.toLowerCase()===d.type)},first:u(function(){return[0]}),last:u(function(d,e){return[e-1]}),eq:u(function(d,e,f){return[0>f?f+e:f]}),even:u(function(d,e){for(var f=0;e>f;f+=2)d.push(f);return d}),
odd:u(function(d,e){for(var f=1;e>f;f+=2)d.push(f);return d}),lt:u(function(d,e,f){for(e=0>f?f+e:f;0<=--e;)d.push(e);return d}),gt:u(function(d,e,f){for(f=0>f?f+e:f;e>++f;)d.push(f);return d})}};for(E in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})G.pseudos[E]=r(E);for(E in{submit:!0,reset:!0})G.pseudos[E]=t(E);aa=m.compile=function(d,e){var f,h=[],k=[],l=ra[d+" "];if(!l){e||(e=x(d));for(f=e.length;f--;)l=B(e[f]),l[ha]?h.push(l):k.push(l);l=ra(d,C(k,h))}return l};G.pseudos.nth=G.pseudos.eq;
H.prototype=G.filters=G.pseudos;G.setFilters=new H;fa.sortStable=ha.split("").sort(ma).join("")===ha;K();[0,0].sort(ma);fa.detectDuplicates=na;l(function(d){if(d.innerHTML="<a href='#'></a>","#"!==d.firstChild.getAttribute("href")){d=["type","href","height","width"];for(var e=d.length;e--;)G.attrHandle[d[e]]=q}});l(function(d){if(null!=d.getAttribute("disabled")){d="checked selected async autofocus autoplay controls defer disabled hidden ismap loop multiple open readonly required scoped".split(" ");
for(var e=d.length;e--;)G.attrHandle[d[e]]=p}});s.find=m;s.expr=m.selectors;s.expr[":"]=s.expr.pseudos;s.unique=m.uniqueSort;s.text=m.getText;s.isXMLDoc=m.isXML;s.contains=m.contains})(d);var Ta={};s.Callbacks=function(d){d="string"==typeof d?Ta[d]||h(d):s.extend({},d);var e,k,l,m,n,p,q=[],r=!d.once&&[],t=function(f){e=d.memory&&f;k=!0;p=m||0;m=0;n=q.length;for(l=!0;q&&n>p;p++)if(!1===q[p].apply(f[0],f[1])&&d.stopOnFalse){e=!1;break}l=!1;q&&(r?r.length&&t(r.shift()):e?q=[]:u.disable())},u={add:function(){if(q){var f=
q.length;(function Bb(e){s.each(e,function(e,f){var h=s.type(f);"function"===h?d.unique&&u.has(f)||q.push(f):f&&f.length&&"string"!==h&&Bb(f)})})(arguments);l?n=q.length:e&&(m=f,t(e))}return this},remove:function(){return q&&s.each(arguments,function(d,e){for(var f;-1<(f=s.inArray(e,q,f));)q.splice(f,1),l&&(n>=f&&n--,p>=f&&p--)}),this},has:function(d){return d?-1<s.inArray(d,q):!(!q||!q.length)},empty:function(){return q=[],n=0,this},disable:function(){return q=r=e=f,this},disabled:function(){return!q},
lock:function(){return r=f,e||u.disable(),this},locked:function(){return!r},fireWith:function(d,e){return e=e||[],e=[d,e.slice?e.slice():e],!q||k&&!r||(l?r.push(e):t(e)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!k}};return u};s.extend({Deferred:function(d){var e=[["resolve","done",s.Callbacks("once memory"),"resolved"],["reject","fail",s.Callbacks("once memory"),"rejected"],["notify","progress",s.Callbacks("memory")]],f="pending",h={state:function(){return f},
always:function(){return k.done(arguments).fail(arguments),this},then:function(){var d=arguments;return s.Deferred(function(f){s.each(e,function(e,l){var m=l[0],n=s.isFunction(d[e])&&d[e];k[l[1]](function(){var d=n&&n.apply(this,arguments);d&&s.isFunction(d.promise)?d.promise().done(f.resolve).fail(f.reject).progress(f.notify):f[m+"With"](this===h?f.promise():this,n?[d]:arguments)})});d=null}).promise()},promise:function(d){return null!=d?s.extend(d,h):h}},k={};return h.pipe=h.then,s.each(e,function(d,
l){var m=l[2],n=l[3];h[l[1]]=m.add;n&&m.add(function(){f=n},e[1^d][2].disable,e[2][2].lock);k[l[0]]=function(){return k[l[0]+"With"](this===k?h:this,arguments),this};k[l[0]+"With"]=m.fireWith}),h.promise(k),d&&d.call(k,k),k},when:function(d){var e=0,f=xa.call(arguments),h=f.length,k=1!==h||d&&s.isFunction(d.promise)?h:0,l=1===k?d:s.Deferred(),m=function(d,e,f){return function(h){e[d]=this;f[d]=1<arguments.length?xa.call(arguments):h;f===n?l.notifyWith(e,f):--k||l.resolveWith(e,f)}},n,p,q;if(1<h){n=
Array(h);p=Array(h);for(q=Array(h);h>e;e++)f[e]&&s.isFunction(f[e].promise)?f[e].promise().done(m(e,q,f)).fail(l.reject).progress(m(e,p,n)):--k}return k||l.resolveWith(q,f),l.promise()}});s.support=function(e){var f=J.createElement("input"),h=J.createDocumentFragment(),k=J.createElement("div"),l=J.createElement("select"),m=l.appendChild(J.createElement("option"));return f.type?(f.type="checkbox",e.checkOn=""!==f.value,e.optSelected=m.selected,e.reliableMarginRight=!0,e.boxSizingReliable=!0,e.pixelPosition=
!1,f.checked=!0,e.noCloneChecked=f.cloneNode(!0).checked,l.disabled=!0,e.optDisabled=!m.disabled,f=J.createElement("input"),f.value="t",f.type="radio",e.radioValue="t"===f.value,f.setAttribute("checked","t"),f.setAttribute("name","t"),h.appendChild(f),e.checkClone=h.cloneNode(!0).cloneNode(!0).lastChild.checked,e.focusinBubbles="onfocusin"in d,k.style.backgroundClip="content-box",k.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle="content-box"===k.style.backgroundClip,s(function(){var f,h,
l=J.getElementsByTagName("body")[0];l&&(f=J.createElement("div"),f.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",l.appendChild(f).appendChild(k),k.innerHTML="",k.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",s.swap(l,null!=l.style.zoom?{zoom:1}:{},function(){e.boxSizing=4===k.offsetWidth}),d.getComputedStyle&&(e.pixelPosition=
"1%"!==(d.getComputedStyle(k,null)||{}).top,e.boxSizingReliable="4px"===(d.getComputedStyle(k,null)||{width:"4px"}).width,h=k.appendChild(J.createElement("div")),h.style.cssText=k.style.cssText="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",h.style.marginRight=h.style.width="0",k.style.width="1px",e.reliableMarginRight=!parseFloat((d.getComputedStyle(h,null)||{}).marginRight)),l.removeChild(f))}),e):e}({});var ga,K,qb=
/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,pb=/([A-Z])/g;k.uid=1;k.accepts=function(d){return d.nodeType?1===d.nodeType||9===d.nodeType:!0};k.prototype={key:function(d){if(!k.accepts(d))return 0;var e={},f=d[this.expando];if(!f){f=k.uid++;try{e[this.expando]={value:f},Object.defineProperties(d,e)}catch(h){e[this.expando]=f,s.extend(d,e)}}return this.cache[f]||(this.cache[f]={}),f},set:function(d,e,f){var h;d=this.key(d);var k=this.cache[d];if("string"==typeof e)k[e]=f;else if(s.isEmptyObject(k))this.cache[d]=
e;else for(h in e)k[h]=e[h]},get:function(d,e){var h=this.cache[this.key(d)];return e===f?h:h[e]},access:function(d,e,h){return e===f||e&&"string"==typeof e&&h===f?this.get(d,e):(this.set(d,e,h),h!==f?h:e)},remove:function(d,e){var h,k;h=this.key(d);var l=this.cache[h];if(e===f)this.cache[h]={};else{s.isArray(e)?k=e.concat(e.map(s.camelCase)):e in l?k=[e]:(k=s.camelCase(e),k=k in l?[k]:k.match(ma)||[]);for(h=k.length;h--;)delete l[k[h]]}},hasData:function(d){return!s.isEmptyObject(this.cache[d[this.expando]]||
{})},discard:function(d){delete this.cache[this.key(d)]}};ga=new k;K=new k;s.extend({acceptData:k.accepts,hasData:function(d){return ga.hasData(d)||K.hasData(d)},data:function(d,e,f){return ga.access(d,e,f)},removeData:function(d,e){ga.remove(d,e)},_data:function(d,e,f){return K.access(d,e,f)},_removeData:function(d,e){K.remove(d,e)}});s.fn.extend({data:function(d,e){var h,k,m=this[0],n=0,p=null;if(d===f){if(this.length&&(p=ga.get(m),1===m.nodeType&&!K.get(m,"hasDataAttrs"))){for(h=m.attributes;h.length>
n;n++)k=h[n].name,0===k.indexOf("data-")&&(k=s.camelCase(k.substring(5)),l(m,k,p[k]));K.set(m,"hasDataAttrs",!0)}return p}return"object"==typeof d?this.each(function(){ga.set(this,d)}):s.access(this,function(e){var h,k=s.camelCase(d);if(m&&e===f){if((h=ga.get(m,d),h!==f)||(h=ga.get(m,k),h!==f)||(h=l(m,k,f),h!==f))return h}else this.each(function(){var h=ga.get(this,k);ga.set(this,k,e);-1!==d.indexOf("-")&&h!==f&&ga.set(this,d,e)})},null,e,1<arguments.length,null,!0)},removeData:function(d){return this.each(function(){ga.remove(this,
d)})}});s.extend({queue:function(d,e,h){var k;return d?(e=(e||"fx")+"queue",k=K.get(d,e),h&&(!k||s.isArray(h)?k=K.access(d,e,s.makeArray(h)):k.push(h)),k||[]):f},dequeue:function(d,e){e=e||"fx";var f=s.queue(d,e),h=f.length,k=f.shift(),l=s._queueHooks(d,e),m=function(){s.dequeue(d,e)};"inprogress"===k&&(k=f.shift(),h--);(l.cur=k)&&("fx"===e&&f.unshift("inprogress"),delete l.stop,k.call(d,m,l));!h&&l&&l.empty.fire()},_queueHooks:function(d,e){var f=e+"queueHooks";return K.get(d,f)||K.access(d,f,{empty:s.Callbacks("once memory").add(function(){K.remove(d,
[e+"queue",f])})})}});s.fn.extend({queue:function(d,e){var h=2;return"string"!=typeof d&&(e=d,d="fx",h--),h>arguments.length?s.queue(this[0],d):e===f?this:this.each(function(){var f=s.queue(this,d,e);s._queueHooks(this,d);"fx"===d&&"inprogress"!==f[0]&&s.dequeue(this,d)})},dequeue:function(d){return this.each(function(){s.dequeue(this,d)})},delay:function(d,e){return d=s.fx?s.fx.speeds[d]||d:d,e=e||"fx",this.queue(e,function(e,f){var h=setTimeout(e,d);f.stop=function(){clearTimeout(h)}})},clearQueue:function(d){return this.queue(d||
"fx",[])},promise:function(d,e){var h,k=1,l=s.Deferred(),m=this,n=this.length,p=function(){--k||l.resolveWith(m,[m])};"string"!=typeof d&&(e=d,d=f);for(d=d||"fx";n--;)(h=K.get(m[n],d+"queueHooks"))&&h.empty&&(k++,h.empty.add(p));return p(),l.promise(e)}});var Za,Pa=/[\t\r\n]/g,Cb=/\r/g,Db=/^(?:input|select|textarea|button)$/i;s.fn.extend({attr:function(d,e){return s.access(this,s.attr,d,e,1<arguments.length)},removeAttr:function(d){return this.each(function(){s.removeAttr(this,d)})},prop:function(d,
e){return s.access(this,s.prop,d,e,1<arguments.length)},removeProp:function(d){return this.each(function(){delete this[s.propFix[d]||d]})},addClass:function(d){var e,f,h,k,l,m=0,n=this.length;e="string"==typeof d&&d;if(s.isFunction(d))return this.each(function(e){s(this).addClass(d.call(this,e,this.className))});if(e)for(e=(d||"").match(ma)||[];n>m;m++)if(f=this[m],h=1===f.nodeType&&(f.className?(" "+f.className+" ").replace(Pa," "):" ")){for(l=0;k=e[l++];)0>h.indexOf(" "+k+" ")&&(h+=k+" ");f.className=
s.trim(h)}return this},removeClass:function(d){var e,f,h,k,l,m=0,n=this.length;e=0===arguments.length||"string"==typeof d&&d;if(s.isFunction(d))return this.each(function(e){s(this).removeClass(d.call(this,e,this.className))});if(e)for(e=(d||"").match(ma)||[];n>m;m++)if(f=this[m],h=1===f.nodeType&&(f.className?(" "+f.className+" ").replace(Pa," "):"")){for(l=0;k=e[l++];)for(;0<=h.indexOf(" "+k+" ");)h=h.replace(" "+k+" "," ");f.className=d?s.trim(h):""}return this},toggleClass:function(d,e){var f=
typeof d,h="boolean"==typeof e;return s.isFunction(d)?this.each(function(f){s(this).toggleClass(d.call(this,f,this.className,e),e)}):this.each(function(){if("string"===f)for(var k,l=0,m=s(this),n=e,p=d.match(ma)||[];k=p[l++];)n=h?n:!m.hasClass(k),m[n?"addClass":"removeClass"](k);else(f===Z||"boolean"===f)&&(this.className&&K.set(this,"__className__",this.className),this.className=this.className||!1===d?"":K.get(this,"__className__")||"")})},hasClass:function(d){d=" "+d+" ";for(var e=0,f=this.length;f>
e;e++)if(1===this[e].nodeType&&0<=(" "+this[e].className+" ").replace(Pa," ").indexOf(d))return!0;return!1},val:function(d){var e,h,k,l=this[0];if(arguments.length)return k=s.isFunction(d),this.each(function(h){var l,m=s(this);1===this.nodeType&&(l=k?d.call(this,h,m.val()):d,null==l?l="":"number"==typeof l?l+="":s.isArray(l)&&(l=s.map(l,function(d){return null==d?"":d+""})),e=s.valHooks[this.type]||s.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&e.set(this,l,"value")!==f||(this.value=l))});
if(l)return e=s.valHooks[l.type]||s.valHooks[l.nodeName.toLowerCase()],e&&"get"in e&&(h=e.get(l,"value"))!==f?h:(h=l.value,"string"==typeof h?h.replace(Cb,""):null==h?"":h)}});s.extend({valHooks:{option:{get:function(d){var e=d.attributes.value;return!e||e.specified?d.value:d.text}},select:{get:function(d){for(var e,f=d.options,h=d.selectedIndex,k="select-one"===d.type||0>h,l=k?null:[],m=k?h+1:f.length,n=0>h?m:k?h:0;m>n;n++)if(e=f[n],!(!e.selected&&n!==h||(s.support.optDisabled?e.disabled:null!==
e.getAttribute("disabled"))||e.parentNode.disabled&&s.nodeName(e.parentNode,"optgroup"))){if(d=s(e).val(),k)return d;l.push(d)}return l},set:function(d,e){for(var f,h,k=d.options,l=s.makeArray(e),m=k.length;m--;)h=k[m],(h.selected=0<=s.inArray(s(h).val(),l))&&(f=!0);return f||(d.selectedIndex=-1),l}}},attr:function(d,e,h){var k,l,m=d.nodeType;if(d&&3!==m&&8!==m&&2!==m)return typeof d.getAttribute===Z?s.prop(d,e,h):(1===m&&s.isXMLDoc(d)||(e=e.toLowerCase(),k=s.attrHooks[e]||(s.expr.match.boolean.test(e)?
Za:void 0)),h===f?k&&"get"in k&&null!==(l=k.get(d,e))?l:(l=s.find.attr(d,e),null==l?f:l):null!==h?k&&"set"in k&&(l=k.set(d,h,e))!==f?l:(d.setAttribute(e,h+""),h):(s.removeAttr(d,e),f))},removeAttr:function(d,e){var f,h,k=0,l=e&&e.match(ma);if(l&&1===d.nodeType)for(;f=l[k++];)h=s.propFix[f]||f,s.expr.match.boolean.test(f)&&(d[h]=!1),d.removeAttribute(f)},attrHooks:{type:{set:function(d,e){if(!s.support.radioValue&&"radio"===e&&s.nodeName(d,"input")){var f=d.value;return d.setAttribute("type",e),f&&
(d.value=f),e}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(d,e,h){var k,l,m,n=d.nodeType;if(d&&3!==n&&8!==n&&2!==n)return m=1!==n||!s.isXMLDoc(d),m&&(e=s.propFix[e]||e,l=s.propHooks[e]),h!==f?l&&"set"in l&&(k=l.set(d,h,e))!==f?k:d[e]=h:l&&"get"in l&&null!==(k=l.get(d,e))?k:d[e]},propHooks:{tabIndex:{get:function(d){return d.hasAttribute("tabindex")||Db.test(d.nodeName)||d.href?d.tabIndex:-1}}}});Za={set:function(d,e,f){return!1===e?s.removeAttr(d,f):d.setAttribute(f,f),f}};s.each(s.expr.match.boolean.source.match(/\w+/g),
function(d,e){var h=s.expr.attrHandle[e]||s.find.attr;s.expr.attrHandle[e]=function(d,e,k){var l=s.expr.attrHandle[e];d=k?f:(s.expr.attrHandle[e]=f)!=h(d,e,k)?e.toLowerCase():null;return s.expr.attrHandle[e]=l,d}});s.support.optSelected||(s.propHooks.selected={get:function(d){d=d.parentNode;return d&&d.parentNode&&d.parentNode.selectedIndex,null}});s.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){s.propFix[this.toLowerCase()]=
this});s.each(["radio","checkbox"],function(){s.valHooks[this]={set:function(d,e){return s.isArray(e)?d.checked=0<=s.inArray(s(d).val(),e):f}};s.support.checkOn||(s.valHooks[this].get=function(d){return null===d.getAttribute("value")?"on":d.value})});var Eb=/^key/,Fb=/^(?:mouse|contextmenu)|click/,$a=/^(?:focusinfocus|focusoutblur)$/,ab=/^([^.]*)(?:\.(.+)|)$/;s.event={global:{},add:function(d,e,h,k,l){var m,n,p,q,r,t,u,x,v,w;if(r=K.get(d)){h.handler&&(m=h,h=m.handler,l=m.selector);h.guid||(h.guid=
s.guid++);(q=r.events)||(q=r.events={});(n=r.handle)||(n=r.handle=function(d){return typeof s===Z||d&&s.event.triggered===d.type?f:s.event.dispatch.apply(n.elem,arguments)},n.elem=d);e=(e||"").match(ma)||[""];for(r=e.length;r--;)p=ab.exec(e[r])||[],v=w=p[1],p=(p[2]||"").split(".").sort(),v&&(u=s.event.special[v]||{},v=(l?u.delegateType:u.bindType)||v,u=s.event.special[v]||{},t=s.extend({type:v,origType:w,data:k,handler:h,guid:h.guid,selector:l,needsContext:l&&s.expr.match.needsContext.test(l),namespace:p.join(".")},
m),(x=q[v])||(x=q[v]=[],x.delegateCount=0,u.setup&&!1!==u.setup.call(d,k,p,n)||d.addEventListener&&d.addEventListener(v,n,!1)),u.add&&(u.add.call(d,t),t.handler.guid||(t.handler.guid=h.guid)),l?x.splice(x.delegateCount++,0,t):x.push(t),s.event.global[v]=!0);d=null}},remove:function(d,e,f,h,k){var l,m,n,p,q,r,t,u,x,v,w,A=K.hasData(d)&&K.get(d);if(A&&(p=A.events)){e=(e||"").match(ma)||[""];for(q=e.length;q--;)if(n=ab.exec(e[q])||[],x=w=n[1],v=(n[2]||"").split(".").sort(),x){t=s.event.special[x]||{};
x=(h?t.delegateType:t.bindType)||x;u=p[x]||[];n=n[2]&&RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)");for(m=l=u.length;l--;)r=u[l],!k&&w!==r.origType||f&&f.guid!==r.guid||n&&!n.test(r.namespace)||h&&h!==r.selector&&("**"!==h||!r.selector)||(u.splice(l,1),r.selector&&u.delegateCount--,t.remove&&t.remove.call(d,r));m&&!u.length&&(t.teardown&&!1!==t.teardown.call(d,v,A.handle)||s.removeEvent(d,x,A.handle),delete p[x])}else for(x in p)s.event.remove(d,x+e[q],f,h,!0);s.isEmptyObject(p)&&(delete A.handle,
K.remove(d,"events"))}},trigger:function(e,h,k,l){var m,n,p,q,r,t,u,x=[k||J],v=Oa.call(e,"type")?e.type:e;m=Oa.call(e,"namespace")?e.namespace.split("."):[];if(n=p=k=k||J,3!==k.nodeType&&8!==k.nodeType&&!$a.test(v+s.event.triggered)&&(0<=v.indexOf(".")&&(m=v.split("."),v=m.shift(),m.sort()),r=0>v.indexOf(":")&&"on"+v,e=e[s.expando]?e:new s.Event(v,"object"==typeof e&&e),e.isTrigger=l?2:3,e.namespace=m.join("."),e.namespace_re=e.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=
f,e.target||(e.target=k),h=null==h?[e]:s.makeArray(h,[e]),u=s.event.special[v]||{},l||!u.trigger||!1!==u.trigger.apply(k,h))){if(!l&&!u.noBubble&&!s.isWindow(k)){q=u.delegateType||v;for($a.test(q+v)||(n=n.parentNode);n;n=n.parentNode)x.push(n),p=n;p===(k.ownerDocument||J)&&x.push(p.defaultView||p.parentWindow||d)}for(m=0;(n=x[m++])&&!e.isPropagationStopped();)e.type=1<m?q:u.bindType||v,(t=(K.get(n,"events")||{})[e.type]&&K.get(n,"handle"))&&t.apply(n,h),(t=r&&n[r])&&s.acceptData(n)&&t.apply&&!1===
t.apply(n,h)&&e.preventDefault();return e.type=v,l||e.isDefaultPrevented()||u._default&&!1!==u._default.apply(x.pop(),h)||!s.acceptData(k)||r&&s.isFunction(k[v])&&!s.isWindow(k)&&(p=k[r],p&&(k[r]=null),s.event.triggered=v,k[v](),s.event.triggered=f,p&&(k[r]=p)),e.result}},dispatch:function(d){d=s.event.fix(d);var e,h,k,l,m,n=[],p=xa.call(arguments);e=(K.get(this,"events")||{})[d.type]||[];var q=s.event.special[d.type]||{};if(p[0]=d,d.delegateTarget=this,!q.preDispatch||!1!==q.preDispatch.call(this,
d)){n=s.event.handlers.call(this,d,e);for(e=0;(l=n[e++])&&!d.isPropagationStopped();){d.currentTarget=l.elem;for(h=0;(m=l.handlers[h++])&&!d.isImmediatePropagationStopped();)(!d.namespace_re||d.namespace_re.test(m.namespace))&&(d.handleObj=m,d.data=m.data,k=((s.event.special[m.origType]||{}).handle||m.handler).apply(l.elem,p),k!==f&&!1===(d.result=k)&&(d.preventDefault(),d.stopPropagation()))}return q.postDispatch&&q.postDispatch.call(this,d),d.result}},handlers:function(d,e){var h,k,l,m,n=[],p=e.delegateCount,
q=d.target;if(p&&q.nodeType&&(!d.button||"click"!==d.type))for(;q!==this;q=q.parentNode||this)if(!0!==q.disabled||"click"!==d.type){k=[];for(h=0;p>h;h++)m=e[h],l=m.selector+" ",k[l]===f&&(k[l]=m.needsContext?0<=s(l,this).index(q):s.find(l,this,null,[q]).length),k[l]&&k.push(m);k.length&&n.push({elem:q,handlers:k})}return e.length>p&&n.push({elem:this,handlers:e.slice(p)}),n},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(d,e){return null==d.which&&(d.which=null!=e.charCode?e.charCode:e.keyCode),d}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(d,e){var h,k,l,m=e.button;return null==d.pageX&&null!=e.clientX&&(h=d.target.ownerDocument||J,k=h.documentElement,l=h.body,d.pageX=e.clientX+(k&&k.scrollLeft||l&&l.scrollLeft||0)-(k&&k.clientLeft||l&&l.clientLeft||
0),d.pageY=e.clientY+(k&&k.scrollTop||l&&l.scrollTop||0)-(k&&k.clientTop||l&&l.clientTop||0)),d.which||m===f||(d.which=1&m?1:2&m?3:4&m?2:0),d}},fix:function(d){if(d[s.expando])return d;var e,f,h;e=d.type;var k=d,l=this.fixHooks[e];l||(this.fixHooks[e]=l=Fb.test(e)?this.mouseHooks:Eb.test(e)?this.keyHooks:{});h=l.props?this.props.concat(l.props):this.props;d=new s.Event(k);for(e=h.length;e--;)f=h[e],d[f]=k[f];return 3===d.target.nodeType&&(d.target=d.target.parentNode),l.filter?l.filter(d,k):d},special:{load:{noBubble:!0},
focus:{trigger:function(){return this!==p()&&this.focus?(this.focus(),!1):f},delegateType:"focusin"},blur:{trigger:function(){return this===p()&&this.blur?(this.blur(),!1):f},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&s.nodeName(this,"input")?(this.click(),!1):f},_default:function(d){return s.nodeName(d.target,"a")}},beforeunload:{postDispatch:function(d){d.result!==f&&(d.originalEvent.returnValue=d.result)}}},simulate:function(d,e,f,h){d=s.extend(new s.Event,
f,{type:d,isSimulated:!0,originalEvent:{}});h?s.event.trigger(d,null,e):s.event.dispatch.call(e,d);d.isDefaultPrevented()&&f.preventDefault()}};s.removeEvent=function(d,e,f){d.removeEventListener&&d.removeEventListener(e,f,!1)};s.Event=function(d,e){return this instanceof s.Event?(d&&d.type?(this.originalEvent=d,this.type=d.type,this.isDefaultPrevented=d.defaultPrevented||d.getPreventDefault&&d.getPreventDefault()?m:n):this.type=d,e&&s.extend(this,e),this.timeStamp=d&&d.timeStamp||s.now(),this[s.expando]=
!0,f):new s.Event(d,e)};s.Event.prototype={isDefaultPrevented:n,isPropagationStopped:n,isImmediatePropagationStopped:n,preventDefault:function(){var d=this.originalEvent;this.isDefaultPrevented=m;d&&d.preventDefault&&d.preventDefault()},stopPropagation:function(){var d=this.originalEvent;this.isPropagationStopped=m;d&&d.stopPropagation&&d.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=m;this.stopPropagation()}};s.each({mouseenter:"mouseover",mouseleave:"mouseout"},
function(d,e){s.event.special[d]={delegateType:e,bindType:e,handle:function(d){var f,h=d.relatedTarget,k=d.handleObj;return(!h||h!==this&&!s.contains(this,h))&&(d.type=k.origType,f=k.handler.apply(this,arguments),d.type=e),f}}});s.support.focusinBubbles||s.each({focus:"focusin",blur:"focusout"},function(d,e){var f=0,h=function(d){s.event.simulate(e,d.target,s.event.fix(d),!0)};s.event.special[e]={setup:function(){0===f++&&J.addEventListener(d,h,!0)},teardown:function(){0===--f&&J.removeEventListener(d,
h,!0)}}});s.fn.extend({on:function(d,e,h,k,l){var m,p;if("object"==typeof d){"string"!=typeof e&&(h=h||e,e=f);for(p in d)this.on(p,e,h,d[p],l);return this}if(null==h&&null==k?(k=e,h=e=f):null==k&&("string"==typeof e?(k=h,h=f):(k=h,h=e,e=f)),!1===k)k=n;else if(!k)return this;return 1===l&&(m=k,k=function(d){return s().off(d),m.apply(this,arguments)},k.guid=m.guid||(m.guid=s.guid++)),this.each(function(){s.event.add(this,d,k,h,e)})},one:function(d,e,f,h){return this.on(d,e,f,h,1)},off:function(d,e,
h){var k,l;if(d&&d.preventDefault&&d.handleObj)return k=d.handleObj,s(d.delegateTarget).off(k.namespace?k.origType+"."+k.namespace:k.origType,k.selector,k.handler),this;if("object"==typeof d){for(l in d)this.off(l,e,d[l]);return this}return(!1===e||"function"==typeof e)&&(h=e,e=f),!1===h&&(h=n),this.each(function(){s.event.remove(this,d,h,e)})},trigger:function(d,e){return this.each(function(){s.event.trigger(d,e,this)})},triggerHandler:function(d,e){var h=this[0];return h?s.event.trigger(d,e,h,!0):
f}});var rb=/^.[^:#\[\.,]*$/,bb=s.expr.match.needsContext,Gb={children:!0,contents:!0,next:!0,prev:!0};s.fn.extend({find:function(d){var e,f,h,k=this.length;if("string"!=typeof d)return e=this,this.pushStack(s(d).filter(function(){for(h=0;k>h;h++)if(s.contains(e[h],this))return!0}));f=[];for(h=0;k>h;h++)s.find(d,this[h],f);return f=this.pushStack(1<k?s.unique(f):f),f.selector=(this.selector?this.selector+" ":"")+d,f},has:function(d){var e=s(d,this),f=e.length;return this.filter(function(){for(var d=
0;f>d;d++)if(s.contains(this,e[d]))return!0})},not:function(d){return this.pushStack(r(this,d||[],!0))},filter:function(d){return this.pushStack(r(this,d||[],!1))},is:function(d){return!!d&&("string"==typeof d?bb.test(d)?0<=s(d,this.context).index(this[0]):0<s.filter(d,this).length:0<this.filter(d).length)},closest:function(d,e){for(var f,h=0,k=this.length,l=[],m=bb.test(d)||"string"!=typeof d?s(d,e||this.context):0;k>h;h++)for(f=this[h];f&&f!==e;f=f.parentNode)if(11>f.nodeType&&(m?-1<m.index(f):
1===f.nodeType&&s.find.matchesSelector(f,d))){l.push(f);break}return this.pushStack(1<l.length?s.unique(l):l)},index:function(d){return d?"string"==typeof d?za.call(s(d),this[0]):za.call(this,d.jquery?d[0]:d):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(d,e){var f="string"==typeof d?s(d,e):s.makeArray(d&&d.nodeType?[d]:d),f=s.merge(this.get(),f);return this.pushStack(s.unique(f))},addBack:function(d){return this.add(null==d?this.prevObject:this.prevObject.filter(d))}});
s.each({parent:function(d){return(d=d.parentNode)&&11!==d.nodeType?d:null},parents:function(d){return s.dir(d,"parentNode")},parentsUntil:function(d,e,f){return s.dir(d,"parentNode",f)},next:function(d){return q(d,"nextSibling")},prev:function(d){return q(d,"previousSibling")},nextAll:function(d){return s.dir(d,"nextSibling")},prevAll:function(d){return s.dir(d,"previousSibling")},nextUntil:function(d,e,f){return s.dir(d,"nextSibling",f)},prevUntil:function(d,e,f){return s.dir(d,"previousSibling",
f)},siblings:function(d){return s.sibling((d.parentNode||{}).firstChild,d)},children:function(d){return s.sibling(d.firstChild)},contents:function(d){return s.nodeName(d,"iframe")?d.contentDocument||d.contentWindow.document:s.merge([],d.childNodes)}},function(d,e){s.fn[d]=function(f,h){var k=s.map(this,e,f);return"Until"!==d.slice(-5)&&(h=f),h&&"string"==typeof h&&(k=s.filter(h,k)),1<this.length&&(Gb[d]||s.unique(k),"p"===d[0]&&k.reverse()),this.pushStack(k)}});s.extend({filter:function(d,e,f){var h=
e[0];return f&&(d=":not("+d+")"),1===e.length&&1===h.nodeType?s.find.matchesSelector(h,d)?[h]:[]:s.find.matches(d,s.grep(e,function(d){return 1===d.nodeType}))},dir:function(d,e,h){for(var k=[],l=h!==f;(d=d[e])&&9!==d.nodeType;)if(1===d.nodeType){if(l&&s(d).is(h))break;k.push(d)}return k},sibling:function(d,e){for(var f=[];d;d=d.nextSibling)1===d.nodeType&&d!==e&&f.push(d);return f}});var cb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,db=/<([\w:]+)/,Hb=/<|&#?\w+;/,Ib=
/<(?:script|style|link)/i,eb=/^(?:checkbox|radio)$/i,Jb=/checked\s*(?:[^=]|=\s*.checked.)/i,fb=/^$|\/(?:java|ecma)script/i,sb=/^true\/(.*)/,Kb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,la={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};la.optgroup=la.option;la.tbody=la.tfoot=la.colgroup=la.caption=la.col=la.thead;la.th=la.td;s.fn.extend({text:function(d){return s.access(this,
function(d){return d===f?s.text(this):this.empty().append((this[0]&&this[0].ownerDocument||J).createTextNode(d))},null,d,arguments.length)},append:function(){return this.domManip(arguments,function(d){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&t(this,d).appendChild(d)})},prepend:function(){return this.domManip(arguments,function(d){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=t(this,d);e.insertBefore(d,e.firstChild)}})},before:function(){return this.domManip(arguments,
function(d){this.parentNode&&this.parentNode.insertBefore(d,this)})},after:function(){return this.domManip(arguments,function(d){this.parentNode&&this.parentNode.insertBefore(d,this.nextSibling)})},remove:function(d,e){for(var f,h=d?s.filter(d,this):this,k=0;null!=(f=h[k]);k++)e||1!==f.nodeType||s.cleanData(y(f)),f.parentNode&&(e&&s.contains(f.ownerDocument,f)&&v(y(f,"script")),f.parentNode.removeChild(f));return this},empty:function(){for(var d,e=0;null!=(d=this[e]);e++)1===d.nodeType&&(s.cleanData(y(d,
!1)),d.textContent="");return this},clone:function(d,e){return d=null==d?!1:d,e=null==e?d:e,this.map(function(){return s.clone(this,d,e)})},html:function(d){return s.access(this,function(d){var e=this[0]||{},h=0,k=this.length;if(d===f&&1===e.nodeType)return e.innerHTML;if("string"==typeof d&&!Ib.test(d)&&!la[(db.exec(d)||["",""])[1].toLowerCase()]){d=d.replace(cb,"<$1></$2>");try{for(;k>h;h++)e=this[h]||{},1===e.nodeType&&(s.cleanData(y(e,!1)),e.innerHTML=d);e=0}catch(l){}}e&&this.empty().append(d)},
null,d,arguments.length)},replaceWith:function(){var d=s.map(this,function(d){return[d.nextSibling,d.parentNode]}),e=0;return this.domManip(arguments,function(f){var h=d[e++],k=d[e++];k&&(s(this).remove(),k.insertBefore(f,h))},!0),e?this:this.remove()},detach:function(d){return this.remove(d,!0)},domManip:function(d,e,f){d=Xa.apply([],d);var h,k,l,m,n=0,p=this.length,q=this,r=p-1,t=d[0],v=s.isFunction(t);if(v||!(1>=p||"string"!=typeof t||s.support.checkClone)&&Jb.test(t))return this.each(function(h){var k=
q.eq(h);v&&(d[0]=t.call(this,h,k.html()));k.domManip(d,e,f)});if(p&&(h=s.buildFragment(d,this[0].ownerDocument,!1,!f&&this),k=h.firstChild,1===h.childNodes.length&&(h=k),k)){k=s.map(y(h,"script"),u);for(l=k.length;p>n;n++)m=h,n!==r&&(m=s.clone(m,!0,!0),l&&s.merge(k,y(m,"script"))),e.call(this[n],m,n);if(l){h=k[k.length-1].ownerDocument;s.map(k,x);for(n=0;l>n;n++)m=k[n],fb.test(m.type||"")&&!K.access(m,"globalEval")&&s.contains(h,m)&&(m.src?s._evalUrl(m.src):s.globalEval(m.textContent.replace(Kb,"")))}}return this}});
s.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(d,e){s.fn[d]=function(d){for(var f=[],h=s(d),k=h.length-1,l=0;k>=l;l++)d=l===k?this:this.clone(!0),s(h[l])[e](d),Na.apply(f,d.get());return this.pushStack(f)}});s.extend({clone:function(d,e,f){var h,k,l,m,n=d.cloneNode(!0),p=s.contains(d.ownerDocument,d);if(!s.support.noCloneChecked&&!(1!==d.nodeType&&11!==d.nodeType||s.isXMLDoc(d))){m=y(n);l=y(d);h=0;for(k=l.length;k>h;h++){var q=
l[h],r=m[h],t=r.nodeName.toLowerCase();"input"===t&&eb.test(q.type)?r.checked=q.checked:("input"===t||"textarea"===t)&&(r.defaultValue=q.defaultValue)}}if(e)if(f){l=l||y(d);m=m||y(n);h=0;for(k=l.length;k>h;h++)z(l[h],m[h])}else z(d,n);return m=y(n,"script"),0<m.length&&v(m,!p&&y(d,"script")),n},buildFragment:function(d,e,f,h){for(var k,l,m,n,p=0,q=d.length,r=e.createDocumentFragment(),t=[];q>p;p++)if(k=d[p],k||0===k)if("object"===s.type(k))s.merge(t,k.nodeType?[k]:k);else if(Hb.test(k)){l=l||r.appendChild(e.createElement("div"));
m=(db.exec(k)||["",""])[1].toLowerCase();m=la[m]||la._default;l.innerHTML=m[1]+k.replace(cb,"<$1></$2>")+m[2];for(m=m[0];m--;)l=l.firstChild;s.merge(t,l.childNodes);l=r.firstChild;l.textContent=""}else t.push(e.createTextNode(k));r.textContent="";for(p=0;k=t[p++];)if((!h||-1===s.inArray(k,h))&&(n=s.contains(k.ownerDocument,k),l=y(r.appendChild(k),"script"),n&&v(l),f))for(m=0;k=l[m++];)fb.test(k.type||"")&&f.push(k);return r},cleanData:function(d){for(var e,f,h,k=d.length,l=0,m=s.event.special;k>l;l++){if(f=
d[l],s.acceptData(f)&&(e=K.access(f)))for(h in e.events)m[h]?s.event.remove(f,h):s.removeEvent(f,h,e.handle);ga.discard(f);K.discard(f)}},_evalUrl:function(d){return s.ajax({url:d,type:"GET",dataType:"text",async:!1,global:!1,success:s.globalEval})}});s.fn.extend({wrapAll:function(d){var e;return s.isFunction(d)?this.each(function(e){s(this).wrapAll(d.call(this,e))}):(this[0]&&(e=s(d,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var d=this;d.firstElementChild;)d=
d.firstElementChild;return d}).append(this)),this)},wrapInner:function(d){return s.isFunction(d)?this.each(function(e){s(this).wrapInner(d.call(this,e))}):this.each(function(){var e=s(this),f=e.contents();f.length?f.wrapAll(d):e.append(d)})},wrap:function(d){var e=s.isFunction(d);return this.each(function(f){s(this).wrapAll(e?d.call(this,f):d)})},unwrap:function(){return this.parent().each(function(){s.nodeName(this,"body")||s(this).replaceWith(this.childNodes)}).end()}});var ua,va,Lb=/^(none|table(?!-c[ea]).+)/,
gb=/^margin/,tb=RegExp("^("+Ja+")(.*)$","i"),La=RegExp("^("+Ja+")(?!px)[a-z%]+$","i"),Mb=RegExp("^([+-])=("+Ja+")","i"),Wa={BODY:"block"},Nb={position:"absolute",visibility:"hidden",display:"block"},hb={letterSpacing:0,fontWeight:400},ta=["Top","Right","Bottom","Left"],Va=["Webkit","O","Moz","ms"];s.fn.extend({css:function(e,h){return s.access(this,function(e,h,k){var l,m={},n=0;if(s.isArray(h)){k=d.getComputedStyle(e,null);for(l=h.length;l>n;n++)m[h[n]]=s.css(e,h[n],!1,k);return m}return k!==f?s.style(e,
h,k):s.css(e,h)},e,h,1<arguments.length)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(d){var e="boolean"==typeof d;return this.each(function(){(e?d:B(this))?s(this).show():s(this).hide()})}});s.extend({cssHooks:{opacity:{get:function(d,e){if(e){var f=ua(d,"opacity");return""===f?"1":f}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(d,e,h,k){if(d&&
3!==d.nodeType&&8!==d.nodeType&&d.style){var l,m,n,p=s.camelCase(e),q=d.style;return e=s.cssProps[p]||(s.cssProps[p]=A(q,p)),n=s.cssHooks[e]||s.cssHooks[p],h===f?n&&"get"in n&&(l=n.get(d,!1,k))!==f?l:q[e]:(m=typeof h,"string"===m&&(l=Mb.exec(h))&&(h=(l[1]+1)*l[2]+parseFloat(s.css(d,e)),m="number"),null==h||"number"===m&&isNaN(h)||("number"!==m||s.cssNumber[p]||(h+="px"),s.support.clearCloneStyle||""!==h||0!==e.indexOf("background")||(q[e]="inherit"),n&&"set"in n&&(h=n.set(d,h,k))===f||(q[e]=h)),f)}},
css:function(d,e,h,k){var l,m,n,p=s.camelCase(e);return e=s.cssProps[p]||(s.cssProps[p]=A(d.style,p)),n=s.cssHooks[e]||s.cssHooks[p],n&&"get"in n&&(l=n.get(d,!0,h)),l===f&&(l=ua(d,e,k)),"normal"===l&&e in hb&&(l=hb[e]),""===h||h?(m=parseFloat(l),!0===h||s.isNumeric(m)?m||0:l):l}});ua=function(e,h,k){var l,m,n,p=(k=k||d.getComputedStyle(e,null))?k.getPropertyValue(h)||k[h]:f,q=e.style;return k&&(""!==p||s.contains(e.ownerDocument,e)||(p=s.style(e,h)),La.test(p)&&gb.test(h)&&(l=q.width,m=q.minWidth,
n=q.maxWidth,q.minWidth=q.maxWidth=q.width=p,p=k.width,q.width=l,q.minWidth=m,q.maxWidth=n)),p};s.each(["height","width"],function(e,h){s.cssHooks[h]={get:function(d,e,k){return e?0===d.offsetWidth&&Lb.test(s.css(d,"display"))?s.swap(d,Nb,function(){return F(d,h,k)}):F(d,h,k):f},set:function(e,f,k){var l=k&&d.getComputedStyle(e,null);return H(e,f,k?w(e,h,k,s.support.boxSizing&&"border-box"===s.css(e,"boxSizing",!1,l),l):0)}}});s(function(){s.support.reliableMarginRight||(s.cssHooks.marginRight={get:function(d,
e){return e?s.swap(d,{display:"inline-block"},ua,[d,"marginRight"]):f}});!s.support.pixelPosition&&s.fn.position&&s.each(["top","left"],function(d,e){s.cssHooks[e]={get:function(d,h){return h?(h=ua(d,e),La.test(h)?s(d).position()[e]+"px":h):f}}})});s.expr&&s.expr.filters&&(s.expr.filters.hidden=function(d){return 0>=d.offsetWidth&&0>=d.offsetHeight},s.expr.filters.visible=function(d){return!s.expr.filters.hidden(d)});s.each({margin:"",padding:"",border:"Width"},function(d,e){s.cssHooks[d+e]={expand:function(f){var h=
0,k={};for(f="string"==typeof f?f.split(" "):[f];4>h;h++)k[d+ta[h]+e]=f[h]||f[h-2]||f[0];return k}};gb.test(d)||(s.cssHooks[d+e].set=H)});var Ob=/%20/g,ub=/\[\]$/,ib=/\r?\n/g,Pb=/^(?:submit|button|image|reset|file)$/i,Qb=/^(?:input|select|textarea|keygen)/i;s.fn.extend({serialize:function(){return s.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var d=s.prop(this,"elements");return d?s.makeArray(d):this}).filter(function(){var d=this.type;return this.name&&!s(this).is(":disabled")&&
Qb.test(this.nodeName)&&!Pb.test(d)&&(this.checked||!eb.test(d))}).map(function(d,e){var f=s(this).val();return null==f?null:s.isArray(f)?s.map(f,function(d){return{name:e.name,value:d.replace(ib,"\r\n")}}):{name:e.name,value:f.replace(ib,"\r\n")}}).get()}});s.param=function(d,e){var h,k=[],l=function(d,e){e=s.isFunction(e)?e():null==e?"":e;k[k.length]=encodeURIComponent(d)+"="+encodeURIComponent(e)};if(e===f&&(e=s.ajaxSettings&&s.ajaxSettings.traditional),s.isArray(d)||d.jquery&&!s.isPlainObject(d))s.each(d,
function(){l(this.name,this.value)});else for(h in d)G(h,d[h],e,l);return k.join("&").replace(Ob,"+")};s.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(d,e){s.fn[e]=function(d,f){return 0<arguments.length?this.on(e,null,d,f):this.trigger(e)}});s.fn.extend({hover:function(d,e){return this.mouseenter(d).mouseleave(e||d)},
bind:function(d,e,f){return this.on(d,null,e,f)},unbind:function(d,e){return this.off(d,null,e)},delegate:function(d,e,f,h){return this.on(e,d,f,h)},undelegate:function(d,e,f){return 1===arguments.length?this.off(d,"**"):this.off(e,d||"**",f)}});var qa,ja,Qa=s.now(),Ra=/\?/,Rb=/#.*$/,jb=/([?&])_=[^&]*/,Sb=/^(.*?):[ \t]*([^\r\n]*)$/gm,Tb=/^(?:GET|HEAD)$/,Ub=/^\/\//,kb=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,lb=s.fn.load,mb={},Ma={},nb="*/".concat("*");try{ja=U.href}catch($b){ja=J.createElement("a"),
ja.href="",ja=ja.href}qa=kb.exec(ja.toLowerCase())||[];s.fn.load=function(d,e,h){if("string"!=typeof d&&lb)return lb.apply(this,arguments);var k,l,m,n=this,p=d.indexOf(" ");return 0<=p&&(k=d.slice(p),d=d.slice(0,p)),s.isFunction(e)?(h=e,e=f):e&&"object"==typeof e&&(l="POST"),0<n.length&&s.ajax({url:d,type:l,dataType:"html",data:e}).done(function(d){m=arguments;n.html(k?s("<div>").append(s.parseHTML(d)).find(k):d)}).complete(h&&function(d,e){n.each(h,m||[d.responseText,e,d])}),this};s.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),
function(d,e){s.fn[e]=function(d){return this.on(e,d)}});s.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ja,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(qa[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":nb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",
text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":s.parseJSON,"text xml":s.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(d,e){return e?da(da(d,s.ajaxSettings),e):da(s.ajaxSettings,d)},ajaxPrefilter:Q(mb),ajaxTransport:Q(Ma),ajax:function(d,e){function h(d,e,n,q){var t,I,y,B,H=e;if(2!==C){C=2;p&&clearTimeout(p);k=f;m=q||"";E.readyState=0<d?4:0;q=200<=d&&300>d||304===d;if(n){y=u;for(var ba=E,G,F,T,Q,Y=y.contents,sa=y.dataTypes;"*"===sa[0];)sa.shift(),
G===f&&(G=y.mimeType||ba.getResponseHeader("Content-Type"));if(G)for(F in Y)if(Y[F]&&Y[F].test(G)){sa.unshift(F);break}if(sa[0]in n)T=sa[0];else{for(F in n){if(!sa[0]||y.converters[F+" "+sa[0]]){T=F;break}Q||(Q=F)}T=T||Q}y=T?(T!==sa[0]&&sa.unshift(T),n[T]):f}var aa;a:{n=u;G=y;F=E;T=q;var O,J,da;y={};ba=n.dataTypes.slice();if(ba[1])for(O in n.converters)y[O.toLowerCase()]=n.converters[O];for(Q=ba.shift();Q;)if(n.responseFields[Q]&&(F[n.responseFields[Q]]=G),!da&&T&&n.dataFilter&&(G=n.dataFilter(G,
n.dataType)),da=Q,Q=ba.shift())if("*"===Q)Q=da;else if("*"!==da&&da!==Q){if(O=y[da+" "+Q]||y["* "+Q],!O)for(aa in y)if(J=aa.split(" "),J[1]===Q&&(O=y[da+" "+J[0]]||y["* "+J[0]])){!0===O?O=y[aa]:!0!==y[aa]&&(Q=J[0],ba.unshift(J[1]));break}if(!0!==O)if(O&&n["throws"])G=O(G);else try{G=O(G)}catch(K){aa={state:"parsererror",error:O?K:"No conversion from "+da+" to "+Q};break a}}aa={state:"success",data:G}}y=aa;q?(u.ifModified&&(B=E.getResponseHeader("Last-Modified"),B&&(s.lastModified[l]=B),B=E.getResponseHeader("etag"),
B&&(s.etag[l]=B)),204===d?H="nocontent":304===d?H="notmodified":(H=y.state,t=y.data,I=y.error,q=!I)):(I=H,(d||!H)&&(H="error",0>d&&(d=0)));E.status=d;E.statusText=(e||H)+"";q?w.resolveWith(x,[t,H,E]):w.rejectWith(x,[E,H,I]);E.statusCode(z);z=f;r&&v.trigger(q?"ajaxSuccess":"ajaxError",[E,u,q?t:I]);A.fireWith(x,[E,H]);r&&(v.trigger("ajaxComplete",[E,u]),--s.active||s.event.trigger("ajaxStop"))}}"object"==typeof d&&(e=d,d=f);e=e||{};var k,l,m,n,p,q,r,t,u=s.ajaxSetup({},e),x=u.context||u,v=u.context&&
(x.nodeType||x.jquery)?s(x):s.event,w=s.Deferred(),A=s.Callbacks("once memory"),z=u.statusCode||{},y={},B={},C=0,H="canceled",E={readyState:0,getResponseHeader:function(d){var e;if(2===C){if(!n)for(n={};e=Sb.exec(m);)n[e[1].toLowerCase()]=e[2];e=n[d.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===C?m:null},setRequestHeader:function(d,e){var f=d.toLowerCase();return C||(d=B[f]=B[f]||d,y[d]=e),this},overrideMimeType:function(d){return C||(u.mimeType=d),this},statusCode:function(d){var e;
if(d)if(2>C)for(e in d)z[e]=[z[e],d[e]];else E.always(d[E.status]);return this},abort:function(d){d=d||H;return k&&k.abort(d),h(0,d),this}};if(w.promise(E).complete=A.add,E.success=E.done,E.error=E.fail,u.url=((d||u.url||ja)+"").replace(Rb,"").replace(Ub,qa[1]+"//"),u.type=e.method||e.type||u.method||u.type,u.dataTypes=s.trim(u.dataType||"*").toLowerCase().match(ma)||[""],null==u.crossDomain&&(q=kb.exec(u.url.toLowerCase()),u.crossDomain=!(!q||q[1]===qa[1]&&q[2]===qa[2]&&(q[3]||("http:"===q[1]?"80":
"443"))===(qa[3]||("http:"===qa[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=s.param(u.data,u.traditional)),aa(mb,u,e,E),2===C)return E;(r=u.global)&&0===s.active++&&s.event.trigger("ajaxStart");u.type=u.type.toUpperCase();u.hasContent=!Tb.test(u.type);l=u.url;u.hasContent||(u.data&&(l=u.url+=(Ra.test(l)?"&":"?")+u.data,delete u.data),!1===u.cache&&(u.url=jb.test(l)?l.replace(jb,"$1_="+Qa++):l+(Ra.test(l)?"&":"?")+"_="+Qa++));u.ifModified&&(s.lastModified[l]&&E.setRequestHeader("If-Modified-Since",
s.lastModified[l]),s.etag[l]&&E.setRequestHeader("If-None-Match",s.etag[l]));(u.data&&u.hasContent&&!1!==u.contentType||e.contentType)&&E.setRequestHeader("Content-Type",u.contentType);E.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+nb+"; q=0.01":""):u.accepts["*"]);for(t in u.headers)E.setRequestHeader(t,u.headers[t]);if(u.beforeSend&&(!1===u.beforeSend.call(x,E,u)||2===C))return E.abort();H="abort";for(t in{success:1,error:1,
complete:1})E[t](u[t]);if(k=aa(Ma,u,e,E)){E.readyState=1;r&&v.trigger("ajaxSend",[E,u]);u.async&&0<u.timeout&&(p=setTimeout(function(){E.abort("timeout")},u.timeout));try{C=1,k.send(y,h)}catch(G){if(!(2>C))throw G;h(-1,G)}}else h(-1,"No Transport");return E},getJSON:function(d,e,f){return s.get(d,e,f,"json")},getScript:function(d,e){return s.get(d,f,e,"script")}});s.each(["get","post"],function(d,e){s[e]=function(d,h,k,l){return s.isFunction(h)&&(l=l||k,k=h,h=f),s.ajax({url:d,type:e,dataType:l,data:h,
success:k})}});s.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(d){return s.globalEval(d),d}}});s.ajaxPrefilter("script",function(d){d.cache===f&&(d.cache=!1);d.crossDomain&&(d.type="GET")});s.ajaxTransport("script",function(d){if(d.crossDomain){var e,f;return{send:function(h,k){e=s("<script>").prop({async:!0,charset:d.scriptCharset,src:d.url}).on("load error",
f=function(d){e.remove();f=null;d&&k("error"===d.type?404:200,d.type)});J.head.appendChild(e[0])},abort:function(){f&&f()}}}});var ob=[],Sa=/(=)\?(?=&|$)|\?\?/;s.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var d=ob.pop()||s.expando+"_"+Qa++;return this[d]=!0,d}});s.ajaxPrefilter("json jsonp",function(e,h,k){var l,m,n,p=!1!==e.jsonp&&(Sa.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Sa.test(e.data)&&"data");return p||"jsonp"===
e.dataTypes[0]?(l=e.jsonpCallback=s.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,p?e[p]=e[p].replace(Sa,"$1"+l):!1!==e.jsonp&&(e.url+=(Ra.test(e.url)?"&":"?")+e.jsonp+"="+l),e.converters["script json"]=function(){return n||s.error(l+" was not called"),n[0]},e.dataTypes[0]="json",m=d[l],d[l]=function(){n=arguments},k.always(function(){d[l]=m;e[l]&&(e.jsonpCallback=h.jsonpCallback,ob.push(l));n&&s.isFunction(m)&&m(n[0]);n=m=f}),"script"):f});s.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(d){}};
var Ea=s.ajaxSettings.xhr(),Vb={0:200,1223:204},Wb=0,Fa={};d.ActiveXObject&&s(d).on("unload",function(){for(var d in Fa)Fa[d]();Fa=f});s.support.cors=!!Ea&&"withCredentials"in Ea;s.support.ajax=Ea=!!Ea;s.ajaxTransport(function(d){var e;return s.support.cors||Ea&&!d.crossDomain?{send:function(h,k){var l,m,n=d.xhr();if(n.open(d.type,d.url,d.async,d.username,d.password),d.xhrFields)for(l in d.xhrFields)n[l]=d.xhrFields[l];d.mimeType&&n.overrideMimeType&&n.overrideMimeType(d.mimeType);d.crossDomain||
h["X-Requested-With"]||(h["X-Requested-With"]="XMLHttpRequest");for(l in h)n.setRequestHeader(l,h[l]);e=function(d){return function(){e&&(delete Fa[m],e=n.onload=n.onerror=null,"abort"===d?n.abort():"error"===d?k(n.status||404,n.statusText):k(Vb[n.status]||n.status,n.statusText,"string"==typeof n.responseText?{text:n.responseText}:f,n.getAllResponseHeaders()))}};n.onload=e();n.onerror=e("error");e=Fa[m=Wb++]=e("abort");n.send(d.hasContent&&d.data||null)},abort:function(){e&&e()}}:f});var wa,Ka,Xb=
/^(?:toggle|show|hide)$/,Yb=RegExp("^(?:([+-])=|)("+Ja+")([a-z%]*)$","i"),Zb=/queueHooks$/,Ha=[function(d,e,h){var k,l,m,n,p,q,r=this,t=d.style,u={},x=[],v=d.nodeType&&B(d);h.queue||(p=s._queueHooks(d,"fx"),null==p.unqueued&&(p.unqueued=0,q=p.empty.fire,p.empty.fire=function(){p.unqueued||q()}),p.unqueued++,r.always(function(){r.always(function(){p.unqueued--;s.queue(d,"fx").length||p.empty.fire()})}));1===d.nodeType&&("height"in e||"width"in e)&&(h.overflow=[t.overflow,t.overflowX,t.overflowY],"inline"===
s.css(d,"display")&&"none"===s.css(d,"float")&&(t.display="inline-block"));h.overflow&&(t.overflow="hidden",r.always(function(){t.overflow=h.overflow[0];t.overflowX=h.overflow[1];t.overflowY=h.overflow[2]}));n=K.get(d,"fxshow");for(k in e)if(m=e[k],Xb.exec(m)){if(delete e[k],l=l||"toggle"===m,m===(v?"hide":"show")){if("show"!==m||n===f||n[k]===f)continue;v=!0}x.push(k)}if(e=x.length){n=K.get(d,"fxshow")||K.access(d,"fxshow",{});"hidden"in n&&(v=n.hidden);l&&(n.hidden=!v);v?s(d).show():r.done(function(){s(d).hide()});
r.done(function(){var e;K.remove(d,"fxshow");for(e in u)s.style(d,e,u[e])});for(k=0;e>k;k++)l=x[k],m=r.createTween(l,v?n[l]:0),u[l]=n[l]||s.style(d,l),l in n||(n[l]=m.start,v&&(m.end=m.start,m.start="width"===l||"height"===l?1:0))}}],pa={"*":[function(d,e){var f,h,k=this.createTween(d,e),l=Yb.exec(e),m=k.cur(),n=+m||0,p=1,q=20;if(l){if(f=+l[2],h=l[3]||(s.cssNumber[d]?"":"px"),"px"!==h&&n){n=s.css(k.elem,d,!0)||f||1;do p=p||".5",n/=p,s.style(k.elem,d,n+h);while(p!==(p=k.cur()/m)&&1!==p&&--q)}k.unit=
h;k.start=n;k.end=l[1]?n+(l[1]+1)*f:f}return k}]};s.Animation=s.extend(ca,{tweener:function(d,e){s.isFunction(d)?(e=d,d=["*"]):d=d.split(" ");for(var f,h=0,k=d.length;k>h;h++)f=d[h],pa[f]=pa[f]||[],pa[f].unshift(e)},prefilter:function(d,e){e?Ha.unshift(d):Ha.push(d)}});s.Tween=W;W.prototype={constructor:W,init:function(d,e,f,h,k,l){this.elem=d;this.prop=f;this.easing=k||"swing";this.options=e;this.start=this.now=this.cur();this.end=h;this.unit=l||(s.cssNumber[f]?"":"px")},cur:function(){var d=W.propHooks[this.prop];
return d&&d.get?d.get(this):W.propHooks._default.get(this)},run:function(d){var e,f=W.propHooks[this.prop];return this.pos=e=this.options.duration?s.easing[this.easing](d,this.options.duration*d,0,1,this.options.duration):d,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),f&&f.set?f.set(this):W.propHooks._default.set(this),this}};W.prototype.init.prototype=W.prototype;W.propHooks={_default:{get:function(d){var e;return null==d.elem[d.prop]||
d.elem.style&&null!=d.elem.style[d.prop]?(e=s.css(d.elem,d.prop,""),e&&"auto"!==e?e:0):d.elem[d.prop]},set:function(d){s.fx.step[d.prop]?s.fx.step[d.prop](d):d.elem.style&&(null!=d.elem.style[s.cssProps[d.prop]]||s.cssHooks[d.prop])?s.style(d.elem,d.prop,d.now+d.unit):d.elem[d.prop]=d.now}}};W.propHooks.scrollTop=W.propHooks.scrollLeft={set:function(d){d.elem.nodeType&&d.elem.parentNode&&(d.elem[d.prop]=d.now)}};s.each(["toggle","show","hide"],function(d,e){var f=s.fn[e];s.fn[e]=function(d,h,k){return null==
d||"boolean"==typeof d?f.apply(this,arguments):this.animate(L(e,!0),d,h,k)}});s.fn.extend({fadeTo:function(d,e,f,h){return this.filter(B).css("opacity",0).show().end().animate({opacity:e},d,f,h)},animate:function(d,e,f,h){var k=s.isEmptyObject(d),l=s.speed(e,f,h),m=function(){var e=ca(this,s.extend({},d),l);m.finish=function(){e.stop(!0)};(k||K.get(this,"finish"))&&e.stop(!0)};return m.finish=m,k||!1===l.queue?this.each(m):this.queue(l.queue,m)},stop:function(d,e,h){var k=function(d){var e=d.stop;
delete d.stop;e(h)};return"string"!=typeof d&&(h=e,e=d,d=f),e&&!1!==d&&this.queue(d||"fx",[]),this.each(function(){var e=!0,f=null!=d&&d+"queueHooks",l=s.timers,m=K.get(this);if(f)m[f]&&m[f].stop&&k(m[f]);else for(f in m)m[f]&&m[f].stop&&Zb.test(f)&&k(m[f]);for(f=l.length;f--;)l[f].elem!==this||null!=d&&l[f].queue!==d||(l[f].anim.stop(h),e=!1,l.splice(f,1));(e||!h)&&s.dequeue(this,d)})},finish:function(d){return!1!==d&&(d=d||"fx"),this.each(function(){var e,f=K.get(this),h=f[d+"queue"];e=f[d+"queueHooks"];
var k=s.timers,l=h?h.length:0;f.finish=!0;s.queue(this,d,[]);e&&e.cur&&e.cur.finish&&e.cur.finish.call(this);for(e=k.length;e--;)k[e].elem===this&&k[e].queue===d&&(k[e].anim.stop(!0),k.splice(e,1));for(e=0;l>e;e++)h[e]&&h[e].finish&&h[e].finish.call(this);delete f.finish})}});s.each({slideDown:L("show"),slideUp:L("hide"),slideToggle:L("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(d,e){s.fn[d]=function(d,f,h){return this.animate(e,d,f,h)}});s.speed=
function(d,e,f){var h=d&&"object"==typeof d?s.extend({},d):{complete:f||!f&&e||s.isFunction(d)&&d,duration:d,easing:f&&e||e&&!s.isFunction(e)&&e};return h.duration=s.fx.off?0:"number"==typeof h.duration?h.duration:h.duration in s.fx.speeds?s.fx.speeds[h.duration]:s.fx.speeds._default,(null==h.queue||!0===h.queue)&&(h.queue="fx"),h.old=h.complete,h.complete=function(){s.isFunction(h.old)&&h.old.call(this);h.queue&&s.dequeue(this,h.queue)},h};s.easing={linear:function(d){return d},swing:function(d){return 0.5-
Math.cos(d*Math.PI)/2}};s.timers=[];s.fx=W.prototype.init;s.fx.tick=function(){var d,e=s.timers,h=0;for(wa=s.now();e.length>h;h++)d=e[h],d()||e[h]!==d||e.splice(h--,1);e.length||s.fx.stop();wa=f};s.fx.timer=function(d){d()&&s.timers.push(d)&&s.fx.start()};s.fx.interval=13;s.fx.start=function(){Ka||(Ka=setInterval(s.fx.tick,s.fx.interval))};s.fx.stop=function(){clearInterval(Ka);Ka=null};s.fx.speeds={slow:600,fast:200,_default:400};s.fx.step={};s.expr&&s.expr.filters&&(s.expr.filters.animated=function(d){return s.grep(s.timers,
function(e){return d===e.elem}).length});s.fn.offset=function(d){if(arguments.length)return d===f?this:this.each(function(e){s.offset.setOffset(this,d,e)});var e,h,k=this[0],l={top:0,left:0},m=k&&k.ownerDocument;if(m)return e=m.documentElement,s.contains(e,k)?(typeof k.getBoundingClientRect!==Z&&(l=k.getBoundingClientRect()),h=s.isWindow(m)?m:9===m.nodeType&&m.defaultView,{top:l.top+h.pageYOffset-e.clientTop,left:l.left+h.pageXOffset-e.clientLeft}):l};s.offset={setOffset:function(d,e,f){var h,k,l,
m,n,p,q=s.css(d,"position"),r=s(d),t={};"static"===q&&(d.style.position="relative");n=r.offset();l=s.css(d,"top");p=s.css(d,"left");("absolute"===q||"fixed"===q)&&-1<(l+p).indexOf("auto")?(h=r.position(),m=h.top,k=h.left):(m=parseFloat(l)||0,k=parseFloat(p)||0);s.isFunction(e)&&(e=e.call(d,f,n));null!=e.top&&(t.top=e.top-n.top+m);null!=e.left&&(t.left=e.left-n.left+k);"using"in e?e.using.call(d,t):r.css(t)}};s.fn.extend({position:function(){if(this[0]){var d,e,f=this[0],h={top:0,left:0};return"fixed"===
s.css(f,"position")?e=f.getBoundingClientRect():(d=this.offsetParent(),e=this.offset(),s.nodeName(d[0],"html")||(h=d.offset()),h.top+=s.css(d[0],"borderTopWidth",!0),h.left+=s.css(d[0],"borderLeftWidth",!0)),{top:e.top-h.top-s.css(f,"marginTop",!0),left:e.left-h.left-s.css(f,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var d=this.offsetParent||na;d&&!s.nodeName(d,"html")&&"static"===s.css(d,"position");)d=d.offsetParent;return d||na})}});s.each({scrollLeft:"pageXOffset",
scrollTop:"pageYOffset"},function(e,h){var k="pageYOffset"===h;s.fn[e]=function(l){return s.access(this,function(e,l,m){var n=s.isWindow(e)?e:9===e.nodeType&&e.defaultView;return m===f?n?n[h]:e[l]:(n?n.scrollTo(k?d.pageXOffset:m,k?m:d.pageYOffset):e[l]=m,f)},e,l,arguments.length,null)}});s.each({Height:"height",Width:"width"},function(d,e){s.each({padding:"inner"+d,content:e,"":"outer"+d},function(h,k){s.fn[k]=function(k,l){var m=arguments.length&&(h||"boolean"!=typeof k),n=h||(!0===k||!0===l?"margin":
"border");return s.access(this,function(e,h,k){var l;return s.isWindow(e)?e.document.documentElement["client"+d]:9===e.nodeType?(l=e.documentElement,Math.max(e.body["scroll"+d],l["scroll"+d],e.body["offset"+d],l["offset"+d],l["client"+d])):k===f?s.css(e,h,n):s.style(e,h,k,n)},e,m?k:f,m,null)}})});s.fn.size=function(){return this.length};s.fn.andSelf=s.fn.addBack;"object"==typeof module&&"object"==typeof module.exports?module.exports=s:"function"==typeof define&&define.amd&&define("jquery",[],function(){return s});
"object"==typeof d&&"object"==typeof d.document&&(d.jQuery=d.$=s)})(window);(function(d,f){function e(e,f){var k,l,r,t=e.nodeName.toLowerCase();return"area"===t?(k=e.parentNode,l=k.name,!e.href||!l||"map"!==k.nodeName.toLowerCase()?!1:(r=d("img[usemap=#"+l+"]")[0],!!r&&h(r))):(/input|select|textarea|button|object/.test(t)?!e.disabled:"a"===t?e.href||f:f)&&h(e)}function h(e){return d.expr.filters.visible(e)&&!d(e).parents().andSelf().filter(function(){return"hidden"===d.css(this,"visibility")}).length}var k=0,l=/^ui-id-\d+$/;d.ui=d.ui||{};d.ui.version||(d.extend(d.ui,{version:"1.9.2",
keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),d.fn.extend({_focus:d.fn.focus,focus:function(e,f){return"number"==typeof e?this.each(function(){var h=this;setTimeout(function(){d(h).focus();f&&f.call(h)},e)}):this._focus.apply(this,arguments)},scrollParent:function(){var e;return d.ui.ie&&
/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?e=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(d.css(this,"position"))&&/(auto|scroll)/.test(d.css(this,"overflow")+d.css(this,"overflow-y")+d.css(this,"overflow-x"))}).eq(0):e=this.parents().filter(function(){return/(auto|scroll)/.test(d.css(this,"overflow")+d.css(this,"overflow-y")+d.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?d(document):e},zIndex:function(e){if(e!==
f)return this.css("zIndex",e);if(this.length){e=d(this[0]);for(var h;e.length&&e[0]!==document;){h=e.css("position");if("absolute"===h||"relative"===h||"fixed"===h)if(h=parseInt(e.css("zIndex"),10),!isNaN(h)&&0!==h)return h;e=e.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++k)})},removeUniqueId:function(){return this.each(function(){l.test(this.id)&&d(this).removeAttr("id")})}}),d.extend(d.expr[":"],{data:d.expr.createPseudo?d.expr.createPseudo(function(e){return function(f){return!!d.data(f,
e)}}):function(e,f,h){return!!d.data(e,h[3])},focusable:function(f){return e(f,!isNaN(d.attr(f,"tabindex")))},tabbable:function(f){var h=d.attr(f,"tabindex"),k=isNaN(h);return(k||0<=h)&&e(f,!k)}}),d(function(){var e=document.body,f=e.appendChild(f=document.createElement("div"));f.offsetHeight;d.extend(f.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});d.support.minHeight=100===f.offsetHeight;d.support.selectstart="onselectstart"in f;e.removeChild(f).style.display="none"}),d("<a>").outerWidth(1).jquery||
d.each(["Width","Height"],function(e,h){function k(e,f,h,m){return d.each(l,function(){f-=parseFloat(d.css(e,"padding"+this))||0;h&&(f-=parseFloat(d.css(e,"border"+this+"Width"))||0);m&&(f-=parseFloat(d.css(e,"margin"+this))||0)}),f}var l="Width"===h?["Left","Right"]:["Top","Bottom"],r=h.toLowerCase(),t={innerWidth:d.fn.innerWidth,innerHeight:d.fn.innerHeight,outerWidth:d.fn.outerWidth,outerHeight:d.fn.outerHeight};d.fn["inner"+h]=function(e){return e===f?t["inner"+h].call(this):this.each(function(){d(this).css(r,
k(this,e)+"px")})};d.fn["outer"+h]=function(e,f){return"number"!=typeof e?t["outer"+h].call(this,e):this.each(function(){d(this).css(r,k(this,e,!0,f)+"px")})}}),d("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(d.fn.removeData=function(e){return function(f){return arguments.length?e.call(this,d.camelCase(f)):e.call(this)}}(d.fn.removeData)),function(){var e=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];d.ui.ie=e.length?!0:!1;d.ui.ie6=6===parseFloat(e[1],10)}(),d.fn.extend({disableSelection:function(){return this.bind((d.support.selectstart?
"selectstart":"mousedown")+".ui-disableSelection",function(d){d.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),d.extend(d.ui,{plugin:{add:function(e,f,h){var k;e=d.ui[e].prototype;for(k in h)e.plugins[k]=e.plugins[k]||[],e.plugins[k].push([f,h[k]])},call:function(d,e,f){var h=d.plugins[e];if(h&&d.element[0].parentNode&&11!==d.element[0].parentNode.nodeType)for(e=0;e<h.length;e++)d.options[h[e][0]]&&h[e][1].apply(d.element,f)}},contains:d.contains,hasScroll:function(e,
f){if("hidden"===d(e).css("overflow"))return!1;var h=f&&"left"===f?"scrollLeft":"scrollTop";return 0<e[h]?!0:(e[h]=1,e[h]=0,!1)},isOverAxis:function(d,e,f){return d>e&&d<e+f},isOver:function(e,f,h,k,l,t){return d.ui.isOverAxis(e,h,l)&&d.ui.isOverAxis(f,k,t)}}))})(jQuery);
(function(d,f){var e=0,h=Array.prototype.slice,k=d.cleanData;d.cleanData=function(e){for(var f=0,h;null!=(h=e[f]);f++)try{d(h).triggerHandler("remove")}catch(p){}k(e)};d.widget=function(e,f,h){var k,q,r,t,u=e.split(".")[0];e=e.split(".")[1];k=u+"-"+e;h||(h=f,f=d.Widget);d.expr[":"][k.toLowerCase()]=function(e){return!!d.data(e,k)};d[u]=d[u]||{};q=d[u][e];r=d[u][e]=function(d,e){if(!this._createWidget)return new r(d,e);arguments.length&&this._createWidget(d,e)};d.extend(r,q,{version:h.version,_proto:d.extend({},
h),_childConstructors:[]});t=new f;t.options=d.widget.extend({},t.options);d.each(h,function(e,k){d.isFunction(k)&&(h[e]=function(){var d=function(){return f.prototype[e].apply(this,arguments)},h=function(d){return f.prototype[e].apply(this,d)};return function(){var e=this._super,f=this._superApply,l;return this._super=d,this._superApply=h,l=k.apply(this,arguments),this._super=e,this._superApply=f,l}}())});r.prototype=d.widget.extend(t,{widgetEventPrefix:q?t.widgetEventPrefix:e},h,{constructor:r,
namespace:u,widgetName:e,widgetBaseClass:k,widgetFullName:k});q?(d.each(q._childConstructors,function(e,f){var h=f.prototype;d.widget(h.namespace+"."+h.widgetName,r,f._proto)}),delete q._childConstructors):f._childConstructors.push(r);d.widget.bridge(e,r)};d.widget.extend=function(e){for(var k=h.call(arguments,1),n=0,p=k.length,q,r;n<p;n++)for(q in k[n])r=k[n][q],k[n].hasOwnProperty(q)&&r!==f&&(d.isPlainObject(r)?e[q]=d.isPlainObject(e[q])?d.widget.extend({},e[q],r):d.widget.extend({},r):e[q]=r);
return e};d.widget.bridge=function(e,k){var n=k.prototype.widgetFullName||e;d.fn[e]=function(p){var q="string"==typeof p,r=h.call(arguments,1),t=this;return p=!q&&r.length?d.widget.extend.apply(null,[p].concat(r)):p,q?this.each(function(){var h,k=d.data(this,n);if(!k)return d.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+p+"'");if(!d.isFunction(k[p])||"_"===p.charAt(0))return d.error("no such method '"+p+"' for "+e+" widget instance");h=k[p].apply(k,r);if(h!==
k&&h!==f)return t=h&&h.jquery?t.pushStack(h.get()):h,!1}):this.each(function(){var e=d.data(this,n);e?e.option(p||{})._init():d.data(this,n,new k(p,this))}),t}};d.Widget=function(){};d.Widget._childConstructors=[];d.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(f,h){h=d(h||this.defaultElement||this)[0];this.element=d(h);this.uuid=e++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=d.widget.extend({},
this.options,this._getCreateOptions(),f);this.bindings=d();this.hoverable=d();this.focusable=d();h!==this&&(d.data(h,this.widgetName,this),d.data(h,this.widgetFullName,this),this._on(!0,this.element,{remove:function(d){d.target===h&&this.destroy()}}),this.document=d(h.style?h.ownerDocument:h.document||h),this.window=d(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:d.noop,_getCreateEventData:d.noop,
_create:d.noop,_init:d.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(d.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:d.noop,widget:function(){return this.element},
option:function(e,h){var k=e,p,q,r;if(0===arguments.length)return d.widget.extend({},this.options);if("string"==typeof e)if(k={},p=e.split("."),e=p.shift(),p.length){q=k[e]=d.widget.extend({},this.options[e]);for(r=0;r<p.length-1;r++)q[p[r]]=q[p[r]]||{},q=q[p[r]];e=p.pop();if(h===f)return q[e]===f?null:q[e];q[e]=h}else{if(h===f)return this.options[e]===f?null:this.options[e];k[e]=h}return this._setOptions(k),this},_setOptions:function(d){for(var e in d)this._setOption(e,d[e]);return this},_setOption:function(d,
e){return this.options[d]=e,"disabled"===d&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,f,h){var k,q=this;"boolean"!=typeof e&&(h=f,f=e,e=!1);h?(f=k=d(f),this.bindings=this.bindings.add(f)):(h=f,f=this.element,k=
this.widget());d.each(h,function(h,n){function u(){if(e||!(!0===q.options.disabled||d(this).hasClass("ui-state-disabled")))return("string"==typeof n?q[n]:n).apply(q,arguments)}"string"!=typeof n&&(u.guid=n.guid=n.guid||u.guid||d.guid++);var x=h.match(/^(\w+)\s*(.*)$/),v=x[1]+q.eventNamespace;(x=x[2])?k.delegate(x,v,u):f.bind(v,u)})},_off:function(d,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;d.unbind(e).undelegate(e)},_delay:function(d,e){var f=this;return setTimeout(function(){return("string"==
typeof d?f[d]:d).apply(f,arguments)},e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e);this._on(e,{mouseenter:function(e){d(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){d(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e);this._on(e,{focusin:function(e){d(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){d(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,f,h){var k,
q=this.options[e];h=h||{};f=d.Event(f);f.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase();f.target=this.element[0];if(e=f.originalEvent)for(k in e)k in f||(f[k]=e[k]);return this.element.trigger(f,h),!(d.isFunction(q)&&!1===q.apply(this.element[0],[f].concat(h))||f.isDefaultPrevented())}};d.each({show:"fadeIn",hide:"fadeOut"},function(e,f){d.Widget.prototype["_"+e]=function(h,k,q){"string"==typeof k&&(k={effect:k});var r,t=k?!0===k||"number"==typeof k?f:k.effect||f:e;k=k||
{};"number"==typeof k&&(k={duration:k});r=!d.isEmptyObject(k);k.complete=q;k.delay&&h.delay(k.delay);r&&d.effects&&(d.effects.effect[t]||!1!==d.uiBackCompat&&d.effects[t])?h[e](k):t!==e&&h[t]?h[t](k.duration,k.easing,q):h.queue(function(f){d(this)[e]();q&&q.call(h[0]);f()})}});!1!==d.uiBackCompat&&(d.Widget.prototype._getCreateOptions=function(){return d.metadata&&d.metadata.get(this.element[0])[this.widgetName]})})(jQuery);
(function(d,f){var e=!1;d(document).mouseup(function(d){e=!1});d.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(d){return e._mouseDown(d)}).bind("click."+this.widgetName,function(f){if(!0===d.data(f.target,e.widgetName+".preventClickEvent"))return d.removeData(f.target,e.widgetName+".preventClickEvent"),f.stopImmediatePropagation(),!1});this.started=
!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&d(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(f){if(!e){this._mouseStarted&&this._mouseUp(f);this._mouseDownEvent=f;var k=this,l=1===f.which,m="string"==typeof this.options.cancel&&f.target.nodeName?d(f.target).closest(this.options.cancel).length:!1;if(!l||m||!this._mouseCapture(f))return!0;(this.mouseDelayMet=
!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){k.mouseDelayMet=!0},this.options.delay));return this._mouseDistanceMet(f)&&this._mouseDelayMet(f)&&(this._mouseStarted=!1!==this._mouseStart(f),!this._mouseStarted)?(f.preventDefault(),!0):(!0===d.data(f.target,this.widgetName+".preventClickEvent")&&d.removeData(f.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(d){return k._mouseMove(d)},this._mouseUpDelegate=function(d){return k._mouseUp(d)},d(document).bind("mousemove."+
this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),f.preventDefault(),e=!0,!0)}},_mouseMove:function(e){return!d.ui.ie||9<=document.documentMode||e.button?this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted):this._mouseUp(e)},_mouseUp:function(e){return d(document).unbind("mousemove."+
this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&d.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(d){return Math.max(Math.abs(this._mouseDownEvent.pageX-d.pageX),Math.abs(this._mouseDownEvent.pageY-d.pageY))>=this.options.distance},_mouseDelayMet:function(d){return this.mouseDelayMet},_mouseStart:function(d){},
_mouseDrag:function(d){},_mouseStop:function(d){},_mouseCapture:function(d){return!0}})})(jQuery);
(function(d,f){function e(d,e,f){return[parseInt(d[0],10)*(t.test(d[0])?e/100:1),parseInt(d[1],10)*(t.test(d[1])?f/100:1)]}d.ui=d.ui||{};var h,k=Math.max,l=Math.abs,m=Math.round,n=/left|center|right/,p=/top|center|bottom/,q=/[\+\-]\d+%?/,r=/^\w+/,t=/%$/,u=d.fn.position;d.position={scrollbarWidth:function(){if(h!==f)return h;var e,k,l=d("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),m=l.children()[0];return d("body").append(l),
e=m.offsetWidth,l.css("overflow","scroll"),k=m.offsetWidth,e===k&&(k=l[0].clientWidth),l.remove(),h=e-k},getScrollInfo:function(e){var f=e.isWindow?"":e.element.css("overflow-x"),h=e.isWindow?"":e.element.css("overflow-y"),h="scroll"===h||"auto"===h&&e.height<e.element[0].scrollHeight;return{width:"scroll"===f||"auto"===f&&e.width<e.element[0].scrollWidth?d.position.scrollbarWidth():0,height:h?d.position.scrollbarWidth():0}},getWithinInfo:function(e){e=d(e||window);var f=d.isWindow(e[0]);return{element:e,
isWindow:f,offset:e.offset()||{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:f?e.width():e.outerWidth(),height:f?e.height():e.outerHeight()}}};d.fn.position=function(f){if(!f||!f.of)return u.apply(this,arguments);f=d.extend({},f);var h,t,y,A,B,C=d(f.of),H=d.position.getWithinInfo(f.within),w=d.position.getScrollInfo(H),F=C[0],E=(f.collision||"flip").split(" "),Y={};return 9===F.nodeType?(t=C.width(),y=C.height(),A={top:0,left:0}):d.isWindow(F)?(t=C.width(),y=C.height(),A={top:C.scrollTop(),
left:C.scrollLeft()}):F.preventDefault?(f.at="left top",t=y=0,A={top:F.pageY,left:F.pageX}):(t=C.outerWidth(),y=C.outerHeight(),A=C.offset()),B=d.extend({},A),d.each(["my","at"],function(){var d=(f[this]||"").split(" "),e,h;1===d.length&&(d=n.test(d[0])?d.concat(["center"]):p.test(d[0])?["center"].concat(d):["center","center"]);d[0]=n.test(d[0])?d[0]:"center";d[1]=p.test(d[1])?d[1]:"center";e=q.exec(d[0]);h=q.exec(d[1]);Y[this]=[e?e[0]:0,h?h[0]:0];f[this]=[r.exec(d[0])[0],r.exec(d[1])[0]]}),1===E.length&&
(E[1]=E[0]),"right"===f.at[0]?B.left+=t:"center"===f.at[0]&&(B.left+=t/2),"bottom"===f.at[1]?B.top+=y:"center"===f.at[1]&&(B.top+=y/2),h=e(Y.at,t,y),B.left+=h[0],B.top+=h[1],this.each(function(){var n,p,q=d(this),r=q.outerWidth(),u=q.outerHeight(),F=parseInt(d.css(this,"marginLeft"),10)||0,ca=parseInt(d.css(this,"marginTop"),10)||0,ia=r+F+(parseInt(d.css(this,"marginRight"),10)||0)+w.width,W=u+ca+(parseInt(d.css(this,"marginBottom"),10)||0)+w.height,L=d.extend({},B),X=e(Y.my,q.outerWidth(),q.outerHeight());
"right"===f.my[0]?L.left-=r:"center"===f.my[0]&&(L.left-=r/2);"bottom"===f.my[1]?L.top-=u:"center"===f.my[1]&&(L.top-=u/2);L.left+=X[0];L.top+=X[1];d.support.offsetFractions||(L.left=m(L.left),L.top=m(L.top));n={marginLeft:F,marginTop:ca};d.each(["left","top"],function(e,k){d.ui.position[E[e]]&&d.ui.position[E[e]][k](L,{targetWidth:t,targetHeight:y,elemWidth:r,elemHeight:u,collisionPosition:n,collisionWidth:ia,collisionHeight:W,offset:[h[0]+X[0],h[1]+X[1]],my:f.my,at:f.at,within:H,elem:q})});d.fn.bgiframe&&
q.bgiframe();f.using&&(p=function(d){var e=A.left-L.left,h=e+t-r,m=A.top-L.top,n=m+y-u,p={target:{element:C,left:A.left,top:A.top,width:t,height:y},element:{element:q,left:L.left,top:L.top,width:r,height:u},horizontal:0>h?"left":0<e?"right":"center",vertical:0>n?"top":0<m?"bottom":"middle"};t<r&&l(e+h)<t&&(p.horizontal="center");y<u&&l(m+n)<y&&(p.vertical="middle");k(l(e),l(h))>k(l(m),l(n))?p.important="horizontal":p.important="vertical";f.using.call(this,d,p)});q.offset(d.extend(L,{using:p}))})};
d.ui.position={fit:{left:function(d,e){var f=e.within,h=f.isWindow?f.scrollLeft:f.offset.left,f=f.width,l=d.left-e.collisionPosition.marginLeft,m=h-l,n=l+e.collisionWidth-f-h,p;e.collisionWidth>f?0<m&&0>=n?(p=d.left+m+e.collisionWidth-f-h,d.left+=m-p):0<n&&0>=m?d.left=h:m>n?d.left=h+f-e.collisionWidth:d.left=h:0<m?d.left+=m:0<n?d.left-=n:d.left=k(d.left-l,d.left)},top:function(d,e){var f=e.within,f=f.isWindow?f.scrollTop:f.offset.top,h=e.within.height,l=d.top-e.collisionPosition.marginTop,m=f-l,n=
l+e.collisionHeight-h-f,p;e.collisionHeight>h?0<m&&0>=n?(p=d.top+m+e.collisionHeight-h-f,d.top+=m-p):0<n&&0>=m?d.top=f:m>n?d.top=f+h-e.collisionHeight:d.top=f:0<m?d.top+=m:0<n?d.top-=n:d.top=k(d.top-l,d.top)}},flip:{left:function(d,e){var f=e.within,h=f.offset.left+f.scrollLeft,k=f.width,m=f.isWindow?f.scrollLeft:f.offset.left,n=d.left-e.collisionPosition.marginLeft,f=n-m,p=n+e.collisionWidth-k-m,n="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,q="left"===e.at[0]?e.targetWidth:"right"===
e.at[0]?-e.targetWidth:0,r=-2*e.offset[0];if(0>f){if(h=d.left+n+q+r+e.collisionWidth-k-h,0>h||h<l(f))d.left+=n+q+r}else if(0<p&&(h=d.left-e.collisionPosition.marginLeft+n+q+r-m,0<h||l(h)<p))d.left+=n+q+r},top:function(d,e){var f=e.within,h=f.offset.top+f.scrollTop,k=f.height,f=f.isWindow?f.scrollTop:f.offset.top,m=d.top-e.collisionPosition.marginTop,n=m-f,m=m+e.collisionHeight-k-f,p="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,q="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?
-e.targetHeight:0,r=-2*e.offset[1],t,u;0>n?(u=d.top+p+q+r+e.collisionHeight-k-h,d.top+p+q+r>n&&(0>u||u<l(n))&&(d.top+=p+q+r)):0<m&&(t=d.top-e.collisionPosition.marginTop+p+q+r-f,d.top+p+q+r>m&&(0<t||l(t)<m)&&(d.top+=p+q+r))}},flipfit:{left:function(){d.ui.position.flip.left.apply(this,arguments);d.ui.position.fit.left.apply(this,arguments)},top:function(){d.ui.position.flip.top.apply(this,arguments);d.ui.position.fit.top.apply(this,arguments)}}};(function(){var e,f,h,k,l=document.getElementsByTagName("body")[0];
h=document.createElement("div");e=document.createElement(l?"div":"body");f={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};l&&d.extend(f,{position:"absolute",left:"-1000px",top:"-1000px"});for(k in f)e.style[k]=f[k];e.appendChild(h);f=l||document.documentElement;f.insertBefore(e,f.firstChild);h.style.cssText="position: absolute; left: 10.7432222px;";h=d(h).offset().left;d.support.offsetFractions=10<h&&11>h;e.innerHTML="";f.removeChild(e)})();!1!==d.uiBackCompat&&function(d){var e=
d.fn.position;d.fn.position=function(h){if(!h||!h.offset)return e.call(this,h);var k=h.offset.split(" "),l=h.at.split(" ");return 1===k.length&&(k[1]=k[0]),/^\d/.test(k[0])&&(k[0]="+"+k[0]),/^\d/.test(k[1])&&(k[1]="+"+k[1]),1===l.length&&(/left|center|right/.test(l[0])?l[1]="center":(l[1]=l[0],l[0]="center")),e.call(this,d.extend(h,{at:l[0]+k[0]+" "+l[1]+k[1],offset:f}))}}(jQuery)})(jQuery);
(function(d,f){d.widget("ui.draggable",d.ui.mouse,{version:"1.9.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&
(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(e){var f=this.options;return this.helper||f.disabled||d(e.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(e),this.handle?(d(!0===f.iframeFix?
"iframe":f.iframeFix).each(function(){d('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(d(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var f=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),d.ui.ddmanager&&(d.ui.ddmanager.current=this),this._cacheMargins(),
this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},d.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,
f.cursorAt&&this._adjustOffsetFromHelper(f.cursorAt),f.containment&&this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),d.ui.ddmanager&&!f.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),d.ui.ddmanager&&d.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,f){this.position=this._generatePosition(e);this.positionAbs=this._convertPositionTo("absolute");if(!f){var k=this._uiHash();if(!1===this._trigger("drag",e,k))return this._mouseUp({}),
!1;this.position=k.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";return d.ui.ddmanager&&d.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var f=!1;d.ui.ddmanager&&!this.options.dropBehaviour&&(f=d.ui.ddmanager.drop(this,e));this.dropped&&(f=this.dropped,this.dropped=!1);for(var k=this.element[0],l=!1;k&&(k=k.parentNode);)k==document&&(l=!0);
if(!l&&"original"===this.options.helper)return!1;if("invalid"==this.options.revert&&!f||"valid"==this.options.revert&&f||!0===this.options.revert||d.isFunction(this.options.revert)&&this.options.revert.call(this.element,f)){var m=this;d(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==m._trigger("stop",e)&&m._clear()})}else!1!==this._trigger("stop",e)&&this._clear();return!1},_mouseUp:function(e){return d("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),
d.ui.ddmanager&&d.ui.ddmanager.dragStop(this,e),d.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){var f=!this.options.handle||!d(this.options.handle,this.element).length?!0:!1;return d(this.options.handle,this.element).find("*").andSelf().each(function(){this==e.target&&(f=!0)}),f},_createHelper:function(e){var f=this.options;e=d.isFunction(f.helper)?d(f.helper.apply(this.element[0],
[e])):"clone"==f.helper?this.element.clone().removeAttr("id"):this.element;return e.parents("body").length||e.appendTo("parent"==f.appendTo?this.element[0].parentNode:f.appendTo),e[0]!=this.element[0]&&!/(fixed|absolute)/.test(e.css("position"))&&e.css("position","absolute"),e},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" "));d.isArray(e)&&(e={left:+e[0],top:+e[1]||0});"left"in e&&(this.offset.click.left=e.left+this.margins.left);"right"in e&&(this.offset.click.left=this.helperProportions.width-
e.right+this.margins.left);"top"in e&&(this.offset.click.top=e.top+this.margins.top);"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&d.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==
document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&d.ui.ie)e={top:0,left:0};return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var d=this.element.position();return{top:d.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:d.left-(parseInt(this.helper.css("left"),10)||
0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e=this.options;"parent"==e.containment&&
(e.containment=this.helper[0].parentNode);if("document"==e.containment||"window"==e.containment)this.containment=["document"==e.containment?0:d(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==e.containment?0:d(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==e.containment?0:d(window).scrollLeft())+d("document"==e.containment?document:window).width()-this.helperProportions.width-this.margins.left,("document"==e.containment?0:d(window).scrollTop())+
(d("document"==e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(e.containment)&&e.containment.constructor!=Array){var e=d(e.containment),f=e[0];if(f){e.offset();var k="hidden"!=d(f).css("overflow");this.containment=[(parseInt(d(f).css("borderLeftWidth"),10)||0)+(parseInt(d(f).css("paddingLeft"),10)||0),(parseInt(d(f).css("borderTopWidth"),10)||0)+(parseInt(d(f).css("paddingTop"),10)||
0),(k?Math.max(f.scrollWidth,f.offsetWidth):f.offsetWidth)-(parseInt(d(f).css("borderLeftWidth"),10)||0)-(parseInt(d(f).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(k?Math.max(f.scrollHeight,f.offsetHeight):f.offsetHeight)-(parseInt(d(f).css("borderTopWidth"),10)||0)-(parseInt(d(f).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=e}}else e.containment.constructor==Array&&(this.containment=
e.containment)},_convertPositionTo:function(e,f){f||(f=this.position);var k="absolute"==e?1:-1,l="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&d.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,m=/(html|body)/i.test(l[0].tagName);return{top:f.top+this.offset.relative.top*k+this.offset.parent.top*k-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():m?0:l.scrollTop())*k,left:f.left+this.offset.relative.left*k+this.offset.parent.left*k-("fixed"==
this.cssPosition?-this.scrollParent.scrollLeft():m?0:l.scrollLeft())*k}},_generatePosition:function(e){var f=this.options,k="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&d.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(k[0].tagName),m=e.pageX,n=e.pageY;if(this.originalPosition){var p;this.containment&&(this.relative_container?(p=this.relative_container.offset(),p=[this.containment[0]+p.left,this.containment[1]+p.top,this.containment[2]+
p.left,this.containment[3]+p.top]):p=this.containment,e.pageX-this.offset.click.left<p[0]&&(m=p[0]+this.offset.click.left),e.pageY-this.offset.click.top<p[1]&&(n=p[1]+this.offset.click.top),e.pageX-this.offset.click.left>p[2]&&(m=p[2]+this.offset.click.left),e.pageY-this.offset.click.top>p[3]&&(n=p[3]+this.offset.click.top));f.grid&&(n=f.grid[1]?this.originalPageY+Math.round((n-this.originalPageY)/f.grid[1])*f.grid[1]:this.originalPageY,n=p?n-this.offset.click.top<p[1]||n-this.offset.click.top>p[3]?
n-this.offset.click.top<p[1]?n+f.grid[1]:n-f.grid[1]:n:n,m=f.grid[0]?this.originalPageX+Math.round((m-this.originalPageX)/f.grid[0])*f.grid[0]:this.originalPageX,m=p?m-this.offset.click.left<p[0]||m-this.offset.click.left>p[2]?m-this.offset.click.left<p[0]?m+f.grid[0]:m-f.grid[0]:m:m)}return{top:n-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():l?0:k.scrollTop()),left:m-this.offset.click.left-this.offset.relative.left-
this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():l?0:k.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(e,f,k){return k=k||this._uiHash(),d.ui.plugin.call(this,e,[f,k]),"drag"==e&&(this.positionAbs=this._convertPositionTo("absolute")),d.Widget.prototype._trigger.call(this,e,f,k)},plugins:{},
_uiHash:function(d){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});d.ui.plugin.add("draggable","connectToSortable",{start:function(e,f){var k=d(this).data("draggable"),l=k.options,m=d.extend({},f,{item:k.element});k.sortables=[];d(l.connectToSortable).each(function(){var f=d.data(this,"sortable");f&&!f.options.disabled&&(k.sortables.push({instance:f,shouldRevert:f.options.revert}),f.refreshPositions(),f._trigger("activate",e,m))})},
stop:function(e,f){var k=d(this).data("draggable"),l=d.extend({},f,{item:k.element});d.each(k.sortables,function(){this.instance.isOver?(this.instance.isOver=0,k.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"==k.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",
e,l))})},drag:function(e,f){var k=d(this).data("draggable"),l=this;d.each(k.sortables,function(m){var n=!1,p=this;this.instance.positionAbs=k.positionAbs;this.instance.helperProportions=k.helperProportions;this.instance.offset.click=k.offset.click;this.instance._intersectsWith(this.instance.containerCache)&&(n=!0,d.each(k.sortables,function(){return this.instance.positionAbs=k.positionAbs,this.instance.helperProportions=k.helperProportions,this.instance.offset.click=k.offset.click,this!=p&&this.instance._intersectsWith(this.instance.containerCache)&&
d.ui.contains(p.instance.element[0],this.instance.element[0])&&(n=!1),n}));n?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=d(l).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return f.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=k.offset.click.top,
this.instance.offset.click.left=k.offset.click.left,this.instance.offset.parent.left-=k.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=k.offset.parent.top-this.instance.offset.parent.top,k._trigger("toSortable",e),k.dropped=this.instance.element,k.currentItem=k.element,this.instance.fromOutside=k),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=
!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),k._trigger("fromSortable",e),k.dropped=!1)})}});d.ui.plugin.add("draggable","cursor",{start:function(e,f){var k=d("body"),l=d(this).data("draggable").options;k.css("cursor")&&(l._cursor=k.css("cursor"));k.css("cursor",l.cursor)},stop:function(e,
f){var k=d(this).data("draggable").options;k._cursor&&d("body").css("cursor",k._cursor)}});d.ui.plugin.add("draggable","opacity",{start:function(e,f){var k=d(f.helper),l=d(this).data("draggable").options;k.css("opacity")&&(l._opacity=k.css("opacity"));k.css("opacity",l.opacity)},stop:function(e,f){var k=d(this).data("draggable").options;k._opacity&&d(f.helper).css("opacity",k._opacity)}});d.ui.plugin.add("draggable","scroll",{start:function(e,f){var k=d(this).data("draggable");k.scrollParent[0]!=
document&&"HTML"!=k.scrollParent[0].tagName&&(k.overflowOffset=k.scrollParent.offset())},drag:function(e,f){var k=d(this).data("draggable"),l=k.options,m=!1;if(k.scrollParent[0]!=document&&"HTML"!=k.scrollParent[0].tagName){if(!l.axis||"x"!=l.axis)k.overflowOffset.top+k.scrollParent[0].offsetHeight-e.pageY<l.scrollSensitivity?k.scrollParent[0].scrollTop=m=k.scrollParent[0].scrollTop+l.scrollSpeed:e.pageY-k.overflowOffset.top<l.scrollSensitivity&&(k.scrollParent[0].scrollTop=m=k.scrollParent[0].scrollTop-
l.scrollSpeed);if(!l.axis||"y"!=l.axis)k.overflowOffset.left+k.scrollParent[0].offsetWidth-e.pageX<l.scrollSensitivity?k.scrollParent[0].scrollLeft=m=k.scrollParent[0].scrollLeft+l.scrollSpeed:e.pageX-k.overflowOffset.left<l.scrollSensitivity&&(k.scrollParent[0].scrollLeft=m=k.scrollParent[0].scrollLeft-l.scrollSpeed)}else{if(!l.axis||"x"!=l.axis)e.pageY-d(document).scrollTop()<l.scrollSensitivity?m=d(document).scrollTop(d(document).scrollTop()-l.scrollSpeed):d(window).height()-(e.pageY-d(document).scrollTop())<
l.scrollSensitivity&&(m=d(document).scrollTop(d(document).scrollTop()+l.scrollSpeed));if(!l.axis||"y"!=l.axis)e.pageX-d(document).scrollLeft()<l.scrollSensitivity?m=d(document).scrollLeft(d(document).scrollLeft()-l.scrollSpeed):d(window).width()-(e.pageX-d(document).scrollLeft())<l.scrollSensitivity&&(m=d(document).scrollLeft(d(document).scrollLeft()+l.scrollSpeed))}!1!==m&&d.ui.ddmanager&&!l.dropBehaviour&&d.ui.ddmanager.prepareOffsets(k,e)}});d.ui.plugin.add("draggable","snap",{start:function(e,
f){var k=d(this).data("draggable"),l=k.options;k.snapElements=[];d(l.snap.constructor!=String?l.snap.items||":data(draggable)":l.snap).each(function(){var e=d(this),f=e.offset();this!=k.element[0]&&k.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:f.top,left:f.left})})},drag:function(e,f){for(var k=d(this).data("draggable"),l=k.options,m=l.snapTolerance,n=f.offset.left,p=n+k.helperProportions.width,q=f.offset.top,r=q+k.helperProportions.height,t=k.snapElements.length-
1;0<=t;t--){var u=k.snapElements[t].left,x=u+k.snapElements[t].width,v=k.snapElements[t].top,z=v+k.snapElements[t].height;if(u-m<n&&n<x+m&&v-m<q&&q<z+m||u-m<n&&n<x+m&&v-m<r&&r<z+m||u-m<p&&p<x+m&&v-m<q&&q<z+m||u-m<p&&p<x+m&&v-m<r&&r<z+m){if("inner"!=l.snapMode){var y=Math.abs(v-r)<=m,A=Math.abs(z-q)<=m,B=Math.abs(u-p)<=m,C=Math.abs(x-n)<=m;y&&(f.position.top=k._convertPositionTo("relative",{top:v-k.helperProportions.height,left:0}).top-k.margins.top);A&&(f.position.top=k._convertPositionTo("relative",
{top:z,left:0}).top-k.margins.top);B&&(f.position.left=k._convertPositionTo("relative",{top:0,left:u-k.helperProportions.width}).left-k.margins.left);C&&(f.position.left=k._convertPositionTo("relative",{top:0,left:x}).left-k.margins.left)}var H=y||A||B||C;"outer"!=l.snapMode&&(y=Math.abs(v-q)<=m,A=Math.abs(z-r)<=m,B=Math.abs(u-n)<=m,C=Math.abs(x-p)<=m,y&&(f.position.top=k._convertPositionTo("relative",{top:v,left:0}).top-k.margins.top),A&&(f.position.top=k._convertPositionTo("relative",{top:z-k.helperProportions.height,
left:0}).top-k.margins.top),B&&(f.position.left=k._convertPositionTo("relative",{top:0,left:u}).left-k.margins.left),C&&(f.position.left=k._convertPositionTo("relative",{top:0,left:x-k.helperProportions.width}).left-k.margins.left));!k.snapElements[t].snapping&&(y||A||B||C||H)&&k.options.snap.snap&&k.options.snap.snap.call(k.element,e,d.extend(k._uiHash(),{snapItem:k.snapElements[t].item}));k.snapElements[t].snapping=y||A||B||C||H}else k.snapElements[t].snapping&&k.options.snap.release&&k.options.snap.release.call(k.element,
e,d.extend(k._uiHash(),{snapItem:k.snapElements[t].item})),k.snapElements[t].snapping=!1}}});d.ui.plugin.add("draggable","stack",{start:function(e,f){var k=d(this).data("draggable").options,k=d.makeArray(d(k.stack)).sort(function(e,f){return(parseInt(d(e).css("zIndex"),10)||0)-(parseInt(d(f).css("zIndex"),10)||0)});if(k.length){var l=parseInt(k[0].style.zIndex)||0;d(k).each(function(d){this.style.zIndex=l+d});this[0].style.zIndex=l+k.length}}});d.ui.plugin.add("draggable","zIndex",{start:function(e,
f){var k=d(f.helper),l=d(this).data("draggable").options;k.css("zIndex")&&(l._zIndex=k.css("zIndex"));k.css("zIndex",l.zIndex)},stop:function(e,f){var k=d(this).data("draggable").options;k._zIndex&&d(f.helper).css("zIndex",k._zIndex)}})})(jQuery);
(function(d,f){d.widget("ui.droppable",{version:"1.9.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var e=this.options,f=e.accept;this.isover=0;this.isout=1;this.accept=d.isFunction(f)?f:function(d){return d.is(f)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};d.ui.ddmanager.droppables[e.scope]=d.ui.ddmanager.droppables[e.scope]||[];d.ui.ddmanager.droppables[e.scope].push(this);
e.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var e=d.ui.ddmanager.droppables[this.options.scope],f=0;f<e.length;f++)e[f]==this&&e.splice(f,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,f){"accept"==e&&(this.accept=d.isFunction(f)?f:function(d){return d.is(f)});d.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var f=d.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass);
f&&this._trigger("activate",e,this.ui(f))},_deactivate:function(e){var f=d.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);f&&this._trigger("deactivate",e,this.ui(f))},_over:function(e){var f=d.ui.ddmanager.current;if(f&&(f.currentItem||f.element)[0]!=this.element[0])this.accept.call(this.element[0],f.currentItem||f.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(f)))},_out:function(e){var f=
d.ui.ddmanager.current;if(f&&(f.currentItem||f.element)[0]!=this.element[0])this.accept.call(this.element[0],f.currentItem||f.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(f)))},_drop:function(e,f){var k=f||d.ui.ddmanager.current;if(!k||(k.currentItem||k.element)[0]==this.element[0])return!1;var l=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var e=d.data(this,"droppable");if(e.options.greedy&&
!e.options.disabled&&e.options.scope==k.options.scope&&e.accept.call(e.element[0],k.currentItem||k.element)&&d.ui.intersect(k,d.extend(e,{offset:e.element.offset()}),e.options.tolerance))return l=!0,!1}),l?!1:this.accept.call(this.element[0],k.currentItem||k.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(k)),this.element):!1},ui:function(d){return{draggable:d.currentItem||
d.element,helper:d.helper,position:d.position,offset:d.positionAbs}}});d.ui.intersect=function(e,f,k){if(!f.offset)return!1;var l=(e.positionAbs||e.position.absolute).left,m=l+e.helperProportions.width,n=(e.positionAbs||e.position.absolute).top,p=n+e.helperProportions.height,q=f.offset.left,r=q+f.proportions.width,t=f.offset.top,u=t+f.proportions.height;switch(k){case "fit":return q<=l&&m<=r&&t<=n&&p<=u;case "intersect":return q<l+e.helperProportions.width/2&&m-e.helperProportions.width/2<r&&t<n+
e.helperProportions.height/2&&p-e.helperProportions.height/2<u;case "pointer":return d.ui.isOver((e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top,(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,t,q,f.proportions.height,f.proportions.width);case "touch":return(n>=t&&n<=u||p>=t&&p<=u||n<t&&p>u)&&(l>=q&&l<=r||m>=q&&m<=r||l<q&&m>r);default:return!1}};d.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,f){var k=d.ui.ddmanager.droppables[e.options.scope]||
[],l=f?f.type:null,m=(e.currentItem||e.element).find(":data(droppable)").andSelf(),n=0;a:for(;n<k.length;n++)if(!(k[n].options.disabled||e&&!k[n].accept.call(k[n].element[0],e.currentItem||e.element))){for(var p=0;p<m.length;p++)if(m[p]==k[n].element[0]){k[n].proportions.height=0;continue a}k[n].visible="none"!=k[n].element.css("display");k[n].visible&&("mousedown"==l&&k[n]._activate.call(k[n],f),k[n].offset=k[n].element.offset(),k[n].proportions={width:k[n].element[0].offsetWidth,height:k[n].element[0].offsetHeight})}},
drop:function(e,f){var k=!1;return d.each(d.ui.ddmanager.droppables[e.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&d.ui.intersect(e,this,this.options.tolerance)&&(k=this._drop.call(this,f)||k),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,f)))}),k},dragStart:function(e,f){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||
d.ui.ddmanager.prepareOffsets(e,f)})},drag:function(e,f){e.options.refreshPositions&&d.ui.ddmanager.prepareOffsets(e,f);d.each(d.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var k=d.ui.intersect(e,this,this.options.tolerance);if(k=!k&&1==this.isover?"isout":k&&0==this.isover?"isover":null){var l;if(this.options.greedy){var m=this.options.scope,n=this.element.parents(":data(droppable)").filter(function(){return d.data(this,"droppable").options.scope===
m});n.length&&(l=d.data(n[0],"droppable"),l.greedyChild="isover"==k?1:0)}l&&"isover"==k&&(l.isover=0,l.isout=1,l._out.call(l,f));this[k]=1;this["isout"==k?"isover":"isout"]=0;this["isover"==k?"_over":"_out"].call(this,f);l&&"isout"==k&&(l.isout=0,l.isover=1,l._over.call(l,f))}}})},dragStop:function(e,f){e.element.parentsUntil("body").unbind("scroll.droppable");e.options.refreshPositions||d.ui.ddmanager.prepareOffsets(e,f)}}})(jQuery);
(function(d,f){d.widget("ui.resizable",d.ui.mouse,{version:"1.9.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1E3},_create:function(){var e=this,f=this.options;this.element.addClass("ui-resizable");d.extend(this,{_aspectRatio:!!f.aspectRatio,aspectRatio:f.aspectRatio,originalElement:this.element,
_proportionallyResizeElements:[],_helper:f.helper||f.ghost||f.animate?f.helper||"ui-resizable-helper":null});this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(d('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),
this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",
zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize());this.handles=f.handles||(d(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var h=this.handles.split(",");
this.handles={};for(var n=0;n<h.length;n++){var p=d.trim(h[n]),q=d('<div class="ui-resizable-handle ui-resizable-'+p+'"></div>');q.css({zIndex:f.zIndex});"se"==p&&q.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[p]=".ui-resizable-"+p;this.element.append(q)}}this._renderAxis=function(e){e=e||this.element;for(var f in this.handles){this.handles[f].constructor==String&&(this.handles[f]=d(this.handles[f],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var h=
d(this.handles[f],this.element),k=0,k=/sw|ne|nw|se|n|s/.test(f)?h.outerHeight():h.outerWidth(),h=["padding",/ne|nw|n/.test(f)?"Top":/se|sw|s/.test(f)?"Bottom":/^e$/.test(f)?"Right":"Left"].join("");e.css(h,k);this._proportionallyResize()}d(this.handles[f])}};this._renderAxis(this.element);this._handles=d(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!e.resizing){if(this.className)var d=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);e.axis=
d&&d[1]?d[1]:"se"}});f.autoHide&&(this._handles.hide(),d(this.element).addClass("ui-resizable-autohide").mouseenter(function(){f.disabled||(d(this).removeClass("ui-resizable-autohide"),e._handles.show())}).mouseleave(function(){f.disabled||e.resizing||(d(this).addClass("ui-resizable-autohide"),e._handles.hide())}));this._mouseInit()},_destroy:function(){this._mouseDestroy();var e=function(e){d(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};
if(this.elementIsWrapper){e(this.element);var f=this.element;this.originalElement.css({position:f.css("position"),width:f.outerWidth(),height:f.outerHeight(),top:f.css("top"),left:f.css("left")}).insertAfter(f);f.remove()}return this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement),this},_mouseCapture:function(e){var f=!1,h;for(h in this.handles)d(this.handles[h])[0]==e.target&&(f=!0);return!this.options.disabled&&f},_mouseStart:function(f){var h=this.options,m=this.element.position(),
n=this.element;this.resizing=!0;this.documentScroll={top:d(document).scrollTop(),left:d(document).scrollLeft()};(n.is(".ui-draggable")||/absolute/.test(n.css("position")))&&n.css({position:"absolute",top:m.top,left:m.left});this._renderProxy();var m=e(this.helper.css("left")),p=e(this.helper.css("top"));h.containment&&(m+=d(h.containment).scrollLeft()||0,p+=d(h.containment).scrollTop()||0);this.offset=this.helper.offset();this.position={left:m,top:p};this.size=this._helper?{width:n.outerWidth(),height:n.outerHeight()}:
{width:n.width(),height:n.height()};this.originalSize=this._helper?{width:n.outerWidth(),height:n.outerHeight()}:{width:n.width(),height:n.height()};this.originalPosition={left:m,top:p};this.sizeDiff={width:n.outerWidth()-n.width(),height:n.outerHeight()-n.height()};this.originalMousePosition={left:f.pageX,top:f.pageY};this.aspectRatio="number"==typeof h.aspectRatio?h.aspectRatio:this.originalSize.width/this.originalSize.height||1;h=d(".ui-resizable-"+this.axis).css("cursor");return d("body").css("cursor",
"auto"==h?this.axis+"-resize":h),n.addClass("ui-resizable-resizing"),this._propagate("start",f),!0},_mouseDrag:function(d){var e=this.helper,f=this.originalMousePosition,h=this._change[this.axis];if(!h)return!1;f=h.apply(this,[d,d.pageX-f.left||0,d.pageY-f.top||0]);this._updateVirtualBoundaries(d.shiftKey);if(this._aspectRatio||d.shiftKey)f=this._updateRatio(f,d);return f=this._respectSize(f,d),this._propagate("resize",d),e.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+
"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(f),this._trigger("resize",d,this.ui()),!1},_mouseStop:function(e){this.resizing=!1;var f=this.options;if(this._helper){var h=this._proportionallyResizeElements,n=h.length&&/textarea/i.test(h[0].nodeName),h=n&&d.ui.hasScroll(h[0],"left")?0:this.sizeDiff.height,n=n?0:this.sizeDiff.width,n={width:this.helper.width()-n,height:this.helper.height()-h},h=parseInt(this.element.css("left"),
10)+(this.position.left-this.originalPosition.left)||null,p=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null;f.animate||this.element.css(d.extend(n,{top:p,left:h}));this.helper.height(this.size.height);this.helper.width(this.size.width);this._helper&&!f.animate&&this._proportionallyResize()}return d("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(d){var e=
this.options,f,n,p,e={minWidth:h(e.minWidth)?e.minWidth:0,maxWidth:h(e.maxWidth)?e.maxWidth:Infinity,minHeight:h(e.minHeight)?e.minHeight:0,maxHeight:h(e.maxHeight)?e.maxHeight:Infinity};if(this._aspectRatio||d)d=e.minHeight*this.aspectRatio,n=e.minWidth/this.aspectRatio,f=e.maxHeight*this.aspectRatio,p=e.maxWidth/this.aspectRatio,d>e.minWidth&&(e.minWidth=d),n>e.minHeight&&(e.minHeight=n),f<e.maxWidth&&(e.maxWidth=f),p<e.maxHeight&&(e.maxHeight=p);this._vBoundaries=e},_updateCache:function(d){this.offset=
this.helper.offset();h(d.left)&&(this.position.left=d.left);h(d.top)&&(this.position.top=d.top);h(d.height)&&(this.size.height=d.height);h(d.width)&&(this.size.width=d.width)},_updateRatio:function(d,e){var f=this.position,n=this.size,p=this.axis;return h(d.height)?d.width=d.height*this.aspectRatio:h(d.width)&&(d.height=d.width/this.aspectRatio),"sw"==p&&(d.left=f.left+(n.width-d.width),d.top=null),"nw"==p&&(d.top=f.top+(n.height-d.height),d.left=f.left+(n.width-d.width)),d},_respectSize:function(d,
e){var f=this._vBoundaries,n=this.axis,p=h(d.width)&&f.maxWidth&&f.maxWidth<d.width,q=h(d.height)&&f.maxHeight&&f.maxHeight<d.height,r=h(d.width)&&f.minWidth&&f.minWidth>d.width,t=h(d.height)&&f.minHeight&&f.minHeight>d.height;r&&(d.width=f.minWidth);t&&(d.height=f.minHeight);p&&(d.width=f.maxWidth);q&&(d.height=f.maxHeight);var u=this.originalPosition.left+this.originalSize.width,x=this.position.top+this.size.height,v=/sw|nw|w/.test(n),n=/nw|ne|n/.test(n);r&&v&&(d.left=u-f.minWidth);p&&v&&(d.left=
u-f.maxWidth);t&&n&&(d.top=x-f.minHeight);q&&n&&(d.top=x-f.maxHeight);f=!d.width&&!d.height;return f&&!d.left&&d.top?d.top=null:f&&!d.top&&d.left&&(d.left=null),d},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e=this.helper||this.element,f=0;f<this._proportionallyResizeElements.length;f++){var h=this._proportionallyResizeElements[f];if(!this.borderDif){var n=[h.css("borderTopWidth"),h.css("borderRightWidth"),h.css("borderBottomWidth"),h.css("borderLeftWidth")],
p=[h.css("paddingTop"),h.css("paddingRight"),h.css("paddingBottom"),h.css("paddingLeft")];this.borderDif=d.map(n,function(d,e){var f=parseInt(d,10)||0,h=parseInt(p[e],10)||0;return f+h})}h.css({height:e.height()-this.borderDif[0]-this.borderDif[2]||0,width:e.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var e=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||d('<div style="overflow:hidden;"></div>');var f=d.ui.ie6?1:0,h=d.ui.ie6?
2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+h,height:this.element.outerHeight()+h,position:"absolute",left:this.elementOffset.left-f+"px",top:this.elementOffset.top-f+"px",zIndex:++e.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(d,e,f){return{width:this.originalSize.width+e}},w:function(d,e,f){return{left:this.originalPosition.left+e,width:this.originalSize.width-e}},n:function(d,e,f){return{top:this.originalPosition.top+
f,height:this.originalSize.height-f}},s:function(d,e,f){return{height:this.originalSize.height+f}},se:function(e,f,h){return d.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,f,h]))},sw:function(e,f,h){return d.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,f,h]))},ne:function(e,f,h){return d.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,f,h]))},nw:function(e,f,h){return d.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,
[e,f,h]))}},_propagate:function(e,f){d.ui.plugin.call(this,e,[f,this.ui()]);"resize"!=e&&this._trigger(e,f,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});d.ui.plugin.add("resizable","alsoResize",{start:function(e,f){var h=d(this).data("resizable").options,n=function(e){d(e).each(function(){var e=d(this);e.data("resizable-alsoresize",
{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})};"object"==typeof h.alsoResize&&!h.alsoResize.parentNode?h.alsoResize.length?(h.alsoResize=h.alsoResize[0],n(h.alsoResize)):d.each(h.alsoResize,function(d){n(d)}):n(h.alsoResize)},resize:function(e,f){var h=d(this).data("resizable"),n=h.options,p=h.originalSize,q=h.originalPosition,r={height:h.size.height-p.height||0,width:h.size.width-p.width||0,top:h.position.top-q.top||
0,left:h.position.left-q.left||0},t=function(e,h){d(e).each(function(){var e=d(this),k=d(this).data("resizable-alsoresize"),n={},m=h&&h.length?h:e.parents(f.originalElement[0]).length?["width","height"]:["width","height","top","left"];d.each(m,function(d,e){var f=(k[e]||0)+(r[e]||0);f&&0<=f&&(n[e]=f||null)});e.css(n)})};"object"==typeof n.alsoResize&&!n.alsoResize.nodeType?d.each(n.alsoResize,function(d,e){t(d,e)}):t(n.alsoResize)},stop:function(e,f){d(this).removeData("resizable-alsoresize")}});
d.ui.plugin.add("resizable","animate",{stop:function(e,f){var h=d(this).data("resizable"),n=h.options,p=h._proportionallyResizeElements,q=p.length&&/textarea/i.test(p[0].nodeName),r=q&&d.ui.hasScroll(p[0],"left")?0:h.sizeDiff.height,q={width:h.size.width-(q?0:h.sizeDiff.width),height:h.size.height-r},r=parseInt(h.element.css("left"),10)+(h.position.left-h.originalPosition.left)||null,t=parseInt(h.element.css("top"),10)+(h.position.top-h.originalPosition.top)||null;h.element.animate(d.extend(q,t&&
r?{top:t,left:r}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var f={width:parseInt(h.element.css("width"),10),height:parseInt(h.element.css("height"),10),top:parseInt(h.element.css("top"),10),left:parseInt(h.element.css("left"),10)};p&&p.length&&d(p[0]).css({width:f.width,height:f.height});h._updateCache(f);h._propagate("resize",e)}})}});d.ui.plugin.add("resizable","containment",{start:function(f,h){var m=d(this).data("resizable"),n=m.element,p=m.options.containment;if(n=
p instanceof d?p.get(0):/parent/.test(p)?n.parent().get(0):p)if(m.containerElement=d(n),/document/.test(p)||p==document)m.containerOffset={left:0,top:0},m.containerPosition={left:0,top:0},m.parentData={element:d(document),left:0,top:0,width:d(document).width(),height:d(document).height()||document.body.parentNode.scrollHeight};else{var q=d(n),r=[];d(["Top","Right","Left","Bottom"]).each(function(d,f){r[d]=e(q.css("padding"+f))});m.containerOffset=q.offset();m.containerPosition=q.position();m.containerSize=
{height:q.innerHeight()-r[3],width:q.innerWidth()-r[1]};var p=m.containerOffset,t=m.containerSize.height,u=m.containerSize.width,u=d.ui.hasScroll(n,"left")?n.scrollWidth:u,t=d.ui.hasScroll(n)?n.scrollHeight:t;m.parentData={element:n,left:p.left,top:p.top,width:u,height:t}}},resize:function(e,f){var h=d(this).data("resizable"),n=h.options,p=h.containerOffset,q=h.position,r=h._aspectRatio||e.shiftKey,t={top:0,left:0},u=h.containerElement;u[0]!=document&&/static/.test(u.css("position"))&&(t=p);q.left<
(h._helper?p.left:0)&&(h.size.width+=h._helper?h.position.left-p.left:h.position.left-t.left,r&&(h.size.height=h.size.width/h.aspectRatio),h.position.left=n.helper?p.left:0);q.top<(h._helper?p.top:0)&&(h.size.height+=h._helper?h.position.top-p.top:h.position.top,r&&(h.size.width=h.size.height*h.aspectRatio),h.position.top=h._helper?p.top:0);h.offset.left=h.parentData.left+h.position.left;h.offset.top=h.parentData.top+h.position.top;n=Math.abs(h.offset.left-t.left+h.sizeDiff.width);p=Math.abs((h._helper?
h.offset.top-t.top:h.offset.top-p.top)+h.sizeDiff.height);t=h.containerElement.get(0)==h.element.parent().get(0);q=/relative|absolute/.test(h.containerElement.css("position"));t&&q&&(n-=h.parentData.left);n+h.size.width>=h.parentData.width&&(h.size.width=h.parentData.width-n,r&&(h.size.height=h.size.width/h.aspectRatio));p+h.size.height>=h.parentData.height&&(h.size.height=h.parentData.height-p,r&&(h.size.width=h.size.height*h.aspectRatio))},stop:function(e,f){var h=d(this).data("resizable"),n=h.options,
p=h.containerOffset,q=h.containerPosition,r=h.containerElement,t=d(h.helper),u=t.offset(),x=t.outerWidth()-h.sizeDiff.width,t=t.outerHeight()-h.sizeDiff.height;h._helper&&!n.animate&&/relative/.test(r.css("position"))&&d(this).css({left:u.left-q.left-p.left,width:x,height:t});h._helper&&!n.animate&&/static/.test(r.css("position"))&&d(this).css({left:u.left-q.left-p.left,width:x,height:t})}});d.ui.plugin.add("resizable","ghost",{start:function(e,f){var h=d(this).data("resizable"),n=h.options,p=h.size;
h.ghost=h.originalElement.clone();h.ghost.css({opacity:0.25,display:"block",position:"relative",height:p.height,width:p.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof n.ghost?n.ghost:"");h.ghost.appendTo(h.helper)},resize:function(e,f){var h=d(this).data("resizable");h.ghost&&h.ghost.css({position:"relative",height:h.size.height,width:h.size.width})},stop:function(e,f){var h=d(this).data("resizable");h.ghost&&h.helper&&h.helper.get(0).removeChild(h.ghost.get(0))}});
d.ui.plugin.add("resizable","grid",{resize:function(e,f){var h=d(this).data("resizable"),n=h.options,p=h.size,q=h.originalSize,r=h.originalPosition,t=h.axis;n.grid="number"==typeof n.grid?[n.grid,n.grid]:n.grid;var u=Math.round((p.width-q.width)/(n.grid[0]||1))*(n.grid[0]||1),n=Math.round((p.height-q.height)/(n.grid[1]||1))*(n.grid[1]||1);/^(se|s|e)$/.test(t)?(h.size.width=q.width+u,h.size.height=q.height+n):/^(ne)$/.test(t)?(h.size.width=q.width+u,h.size.height=q.height+n,h.position.top=r.top-n):
/^(sw)$/.test(t)?(h.size.width=q.width+u,h.size.height=q.height+n,h.position.left=r.left-u):(h.size.width=q.width+u,h.size.height=q.height+n,h.position.top=r.top-n,h.position.left=r.left-u)}});var e=function(d){return parseInt(d,10)||0},h=function(d){return!isNaN(parseInt(d,10))}})(jQuery);
(function(d,f){d.widget("ui.selectable",d.ui.mouse,{version:"1.9.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var e=this;this.element.addClass("ui-selectable");this.dragged=!1;var f;this.refresh=function(){f=d(e.options.filter,e.element[0]);f.addClass("ui-selectee");f.each(function(){var e=d(this),f=e.offset();d.data(this,"selectable-item",{element:this,$element:e,left:f.left,top:f.top,right:f.left+e.outerWidth(),bottom:f.top+e.outerHeight(),
startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})};this.refresh();this.selectees=f.addClass("ui-selectee");this._mouseInit();this.helper=d("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");this._mouseDestroy()},_mouseStart:function(e){var f=this;this.opos=[e.pageX,
e.pageY];if(!this.options.disabled){var k=this.options;this.selectees=d(k.filter,this.element[0]);this._trigger("start",e);d(k.appendTo).append(this.helper);this.helper.css({left:e.clientX,top:e.clientY,width:0,height:0});k.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var k=d.data(this,"selectable-item");k.startselected=!0;!e.metaKey&&!e.ctrlKey&&(k.$element.removeClass("ui-selected"),k.selected=!1,k.$element.addClass("ui-unselecting"),k.unselecting=!0,f._trigger("unselecting",
e,{unselecting:k.element}))});d(e.target).parents().andSelf().each(function(){var k=d.data(this,"selectable-item");if(k){var m=!e.metaKey&&!e.ctrlKey||!k.$element.hasClass("ui-selected");return k.$element.removeClass(m?"ui-unselecting":"ui-selected").addClass(m?"ui-selecting":"ui-unselecting"),k.unselecting=!m,k.selecting=m,k.selected=m,m?f._trigger("selecting",e,{selecting:k.element}):f._trigger("unselecting",e,{unselecting:k.element}),!1}})}},_mouseDrag:function(e){var f=this;this.dragged=!0;if(!this.options.disabled){var k=
this.options,l=this.opos[0],m=this.opos[1],n=e.pageX,p=e.pageY;if(l>n)var q=n,n=l,l=q;m>p&&(q=p,p=m,m=q);return this.helper.css({left:l,top:m,width:n-l,height:p-m}),this.selectees.each(function(){var q=d.data(this,"selectable-item");if(q&&q.element!=f.element[0]){var t=!1;"touch"==k.tolerance?t=!(q.left>n||q.right<l||q.top>p||q.bottom<m):"fit"==k.tolerance&&(t=q.left>l&&q.right<n&&q.top>m&&q.bottom<p);t?(q.selected&&(q.$element.removeClass("ui-selected"),q.selected=!1),q.unselecting&&(q.$element.removeClass("ui-unselecting"),
q.unselecting=!1),q.selecting||(q.$element.addClass("ui-selecting"),q.selecting=!0,f._trigger("selecting",e,{selecting:q.element}))):(q.selecting&&((e.metaKey||e.ctrlKey)&&q.startselected?(q.$element.removeClass("ui-selecting"),q.selecting=!1,q.$element.addClass("ui-selected"),q.selected=!0):(q.$element.removeClass("ui-selecting"),q.selecting=!1,q.startselected&&(q.$element.addClass("ui-unselecting"),q.unselecting=!0),f._trigger("unselecting",e,{unselecting:q.element}))),q.selected&&!e.metaKey&&!e.ctrlKey&&
!q.startselected&&(q.$element.removeClass("ui-selected"),q.selected=!1,q.$element.addClass("ui-unselecting"),q.unselecting=!0,f._trigger("unselecting",e,{unselecting:q.element})))}}),!1}},_mouseStop:function(e){var f=this;this.dragged=!1;return d(".ui-unselecting",this.element[0]).each(function(){var k=d.data(this,"selectable-item");k.$element.removeClass("ui-unselecting");k.unselecting=!1;k.startselected=!1;f._trigger("unselected",e,{unselected:k.element})}),d(".ui-selecting",this.element[0]).each(function(){var k=
d.data(this,"selectable-item");k.$element.removeClass("ui-selecting").addClass("ui-selected");k.selecting=!1;k.selected=!0;k.startselected=!0;f._trigger("selected",e,{selected:k.element})}),this._trigger("stop",e),this.helper.remove(),!1}})})(jQuery);
(function(d,f){d.widget("ui.sortable",d.ui.mouse,{version:"1.9.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){var d=this.options;this.containerCache={};this.element.addClass("ui-sortable");
this.refresh();this.floating=this.items.length?"x"===d.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1;this.offset=this.element.offset();this._mouseInit();this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var d=this.items.length-1;0<=d;d--)this.items[d].item.removeData(this.widgetName+"-item");return this},_setOption:function(e,f){"disabled"===e?(this.options[e]=
f,this.widget().toggleClass("ui-sortable-disabled",!!f)):d.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(e,f){var k=this;if(this.reverting||this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(e);var l=null;d(e.target).parents().each(function(){if(d.data(this,k.widgetName+"-item")==k)return l=d(this),!1});d.data(e.target,k.widgetName+"-item")==k&&(l=d(e.target));if(!l)return!1;if(this.options.handle&&!f){var m=!1;d(this.options.handle,l).find("*").andSelf().each(function(){this==
e.target&&(m=!0)});if(!m)return!1}return this.currentItem=l,this._removeCurrentsFromItems(),!0},_mouseStart:function(e,f,k){f=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(e);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};d.extend(this.offset,{click:{left:e.pageX-this.offset.left,
top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(e);this.originalPageX=e.pageX;this.originalPageY=e.pageY;f.cursorAt&&this._adjustOffsetFromHelper(f.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();
f.containment&&this._setContainment();f.cursor&&(d("body").css("cursor")&&(this._storedCursor=d("body").css("cursor")),d("body").css("cursor",f.cursor));f.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",f.opacity));f.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",f.zIndex));this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset());
this._trigger("start",e,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!k)for(k=this.containers.length-1;0<=k;k--)this.containers[k]._trigger("activate",e,this._uiHash(this));return d.ui.ddmanager&&(d.ui.ddmanager.current=this),d.ui.ddmanager&&!f.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){this.position=this._generatePosition(e);this.positionAbs=this._convertPositionTo("absolute");
this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var f=this.options,k=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<f.scrollSensitivity?this.scrollParent[0].scrollTop=k=this.scrollParent[0].scrollTop+f.scrollSpeed:e.pageY-this.overflowOffset.top<f.scrollSensitivity&&(this.scrollParent[0].scrollTop=k=this.scrollParent[0].scrollTop-f.scrollSpeed),this.overflowOffset.left+
this.scrollParent[0].offsetWidth-e.pageX<f.scrollSensitivity?this.scrollParent[0].scrollLeft=k=this.scrollParent[0].scrollLeft+f.scrollSpeed:e.pageX-this.overflowOffset.left<f.scrollSensitivity&&(this.scrollParent[0].scrollLeft=k=this.scrollParent[0].scrollLeft-f.scrollSpeed)):(e.pageY-d(document).scrollTop()<f.scrollSensitivity?k=d(document).scrollTop(d(document).scrollTop()-f.scrollSpeed):d(window).height()-(e.pageY-d(document).scrollTop())<f.scrollSensitivity&&(k=d(document).scrollTop(d(document).scrollTop()+
f.scrollSpeed)),e.pageX-d(document).scrollLeft()<f.scrollSensitivity?k=d(document).scrollLeft(d(document).scrollLeft()-f.scrollSpeed):d(window).width()-(e.pageX-d(document).scrollLeft())<f.scrollSensitivity&&(k=d(document).scrollLeft(d(document).scrollLeft()+f.scrollSpeed)));!1!==k&&d.ui.ddmanager&&!f.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,e)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";
if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";for(f=this.items.length-1;0<=f;f--){var k=this.items[f],l=k.item[0],m=this._intersectsWithPointer(k);if(m&&k.instance===this.currentContainer&&l!=this.currentItem[0]&&this.placeholder[1==m?"next":"prev"]()[0]!=l&&!d.contains(this.placeholder[0],l)&&("semi-dynamic"==this.options.type?!d.contains(this.element[0],l):1)){this.direction=1==m?"down":"up";if("pointer"!=this.options.tolerance&&!this._intersectsWithSides(k))break;
this._rearrange(e,k);this._trigger("change",e,this._uiHash());break}}return this._contactContainers(e),d.ui.ddmanager&&d.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,f){if(e){d.ui.ddmanager&&!this.options.dropBehaviour&&d.ui.ddmanager.drop(this,e);if(this.options.revert){var k=this,l=this.placeholder.offset();this.reverting=!0;d(this.helper).animate({left:l.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==
document.body?0:this.offsetParent[0].scrollLeft),top:l.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){k._clear(e)})}else this._clear(e,f);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;0<=e;e--)this.containers[e]._trigger("deactivate",
null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),d.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?d(this.domPosition.prev).after(this.currentItem):
d(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var f=this._getItemsAsjQuery(e&&e.connected),k=[];return e=e||{},d(f).each(function(){var f=(d(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[-=_](.+)/);f&&k.push((e.key||f[1]+"[]")+"="+(e.key&&e.expression?f[1]:f[2]))}),!k.length&&e.key&&k.push(e.key+"="),k.join("&")},toArray:function(e){var f=this._getItemsAsjQuery(e&&e.connected),k=[];return e=e||{},f.each(function(){k.push(d(e.item||this).attr(e.attribute||
"id")||"")}),k},_intersectsWith:function(d){var f=this.positionAbs.left,k=f+this.helperProportions.width,l=this.positionAbs.top,m=l+this.helperProportions.height,n=d.left,p=n+d.width,q=d.top,r=q+d.height,t=this.offset.click.top,u=this.offset.click.left;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>d[this.floating?"width":"height"]?l+t>q&&l+t<r&&f+u>n&&f+u<p:n<f+this.helperProportions.width/
2&&k-this.helperProportions.width/2<p&&q<l+this.helperProportions.height/2&&m-this.helperProportions.height/2<r},_intersectsWithPointer:function(e){var f="x"===this.options.axis||d.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height);e="y"===this.options.axis||d.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width);f=f&&e;e=this._getDragVerticalDirection();var k=this._getDragHorizontalDirection();return f?this.floating?k&&"right"==k||"down"==e?2:1:e&&("down"==
e?2:1):!1},_intersectsWithSides:function(e){var f=d.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height);e=d.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width);var k=this._getDragVerticalDirection(),l=this._getDragHorizontalDirection();return this.floating&&l?"right"==l&&e||"left"==l&&!e:k&&("down"==k&&f||"up"==k&&!f)},_getDragVerticalDirection:function(){var d=this.positionAbs.top-this.lastPositionAbs.top;return 0!=d&&(0<d?"down":"up")},
_getDragHorizontalDirection:function(){var d=this.positionAbs.left-this.lastPositionAbs.left;return 0!=d&&(0<d?"right":"left")},refresh:function(d){return this._refreshItems(d),this.refreshPositions(),this},_connectWith:function(){var d=this.options;return d.connectWith.constructor==String?[d.connectWith]:d.connectWith},_getItemsAsjQuery:function(e){var f=[],k=[],l=this._connectWith();if(l&&e)for(e=l.length-1;0<=e;e--)for(var m=d(l[e]),n=m.length-1;0<=n;n--){var p=d.data(m[n],this.widgetName);p&&
p!=this&&!p.options.disabled&&k.push([d.isFunction(p.options.items)?p.options.items.call(p.element):d(p.options.items,p.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),p])}k.push([d.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):d(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(e=k.length-1;0<=e;e--)k[e][0].each(function(){f.push(this)});return d(f)},_removeCurrentsFromItems:function(){var e=
this.currentItem.find(":data("+this.widgetName+"-item)");this.items=d.grep(this.items,function(d){for(var f=0;f<e.length;f++)if(e[f]==d.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[];this.containers=[this];var f=this.items,k=[[d.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):d(this.options.items,this.element),this]],l=this._connectWith();if(l&&this.ready)for(var m=l.length-1;0<=m;m--)for(var n=d(l[m]),p=n.length-1;0<=p;p--){var q=
d.data(n[p],this.widgetName);q&&q!=this&&!q.options.disabled&&(k.push([d.isFunction(q.options.items)?q.options.items.call(q.element[0],e,{item:this.currentItem}):d(q.options.items,q.element),q]),this.containers.push(q))}for(m=k.length-1;0<=m;m--){e=k[m][1];l=k[m][0];p=0;for(n=l.length;p<n;p++)q=d(l[p]),q.data(this.widgetName+"-item",e),f.push({item:q,instance:e,width:0,height:0,left:0,top:0})}},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());
for(var f=this.items.length-1;0<=f;f--){var k=this.items[f];if(!(k.instance!=this.currentContainer&&this.currentContainer&&k.item[0]!=this.currentItem[0])){var l=this.options.toleranceElement?d(this.options.toleranceElement,k.item):k.item;e||(k.width=l.outerWidth(),k.height=l.outerHeight());l=l.offset();k.left=l.left;k.top=l.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(f=this.containers.length-1;0<=f;f--)l=this.containers[f].element.offset(),
this.containers[f].containerCache.left=l.left,this.containers[f].containerCache.top=l.top,this.containers[f].containerCache.width=this.containers[f].element.outerWidth(),this.containers[f].containerCache.height=this.containers[f].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var f=e.options;if(!f.placeholder||f.placeholder.constructor==String){var k=f.placeholder;f.placeholder={element:function(){var f=d(document.createElement(e.currentItem[0].nodeName)).addClass(k||
e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return k||(f.style.visibility="hidden"),f},update:function(d,m){if(!k||f.forcePlaceholderSize)m.height()||m.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),m.width()||m.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10))}}}e.placeholder=d(f.placeholder.element.call(e.element,
e.currentItem));e.currentItem.after(e.placeholder);f.placeholder.update(e,e.placeholder)},_contactContainers:function(e){for(var f=null,k=null,l=this.containers.length-1;0<=l;l--)if(!d.contains(this.currentItem[0],this.containers[l].element[0]))if(this._intersectsWith(this.containers[l].containerCache)){if(!f||!d.contains(this.containers[l].element[0],f.element[0]))f=this.containers[l],k=l}else this.containers[l].containerCache.over&&(this.containers[l]._trigger("out",e,this._uiHash(this)),this.containers[l].containerCache.over=
0);if(f)if(1===this.containers.length)this.containers[k]._trigger("over",e,this._uiHash(this)),this.containers[k].containerCache.over=1;else{for(var f=1E4,l=null,m=this.containers[k].floating?"left":"top",n=this.containers[k].floating?"width":"height",p=this.positionAbs[m]+this.offset.click[m],q=this.items.length-1;0<=q;q--)if(d.contains(this.containers[k].element[0],this.items[q].item[0])&&this.items[q].item[0]!=this.currentItem[0]){var r=this.items[q].item.offset()[m],t=!1;Math.abs(r-p)>Math.abs(r+
this.items[q][n]-p)&&(t=!0,r+=this.items[q][n]);Math.abs(r-p)<f&&(f=Math.abs(r-p),l=this.items[q],this.direction=t?"up":"down")}if(l||this.options.dropOnEmpty)this.currentContainer=this.containers[k],l?this._rearrange(e,l,null,!0):this._rearrange(e,null,this.containers[k].element,!0),this._trigger("change",e,this._uiHash()),this.containers[k]._trigger("change",e,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[k]._trigger("over",e,this._uiHash(this)),
this.containers[k].containerCache.over=1}},_createHelper:function(e){var f=this.options;e=d.isFunction(f.helper)?d(f.helper.apply(this.element[0],[e,this.currentItem])):"clone"==f.helper?this.currentItem.clone():this.currentItem;return e.parents("body").length||d("parent"!=f.appendTo?f.appendTo:this.currentItem[0].parentNode)[0].appendChild(e[0]),e[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),
top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(""==e[0].style.width||f.forceHelperSize)&&e.width(this.currentItem.width()),(""==e[0].style.height||f.forceHelperSize)&&e.height(this.currentItem.height()),e},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" "));d.isArray(e)&&(e={left:+e[0],top:+e[1]||0});"left"in e&&(this.offset.click.left=e.left+this.margins.left);"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left);"top"in
e&&(this.offset.click.top=e.top+this.margins.top);"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&d.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&
"html"==this.offsetParent[0].tagName.toLowerCase()&&d.ui.ie)e={top:0,left:0};return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var d=this.currentItem.position();return{top:d.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:d.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,
left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e=this.options;"parent"==e.containment&&(e.containment=this.helper[0].parentNode);if("document"==e.containment||"window"==e.containment)this.containment=[0-this.offset.relative.left-this.offset.parent.left,
0-this.offset.relative.top-this.offset.parent.top,d("document"==e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(d("document"==e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(e.containment)){var f=d(e.containment)[0],e=d(e.containment).offset(),k="hidden"!=d(f).css("overflow");this.containment=[e.left+(parseInt(d(f).css("borderLeftWidth"),10)||
0)+(parseInt(d(f).css("paddingLeft"),10)||0)-this.margins.left,e.top+(parseInt(d(f).css("borderTopWidth"),10)||0)+(parseInt(d(f).css("paddingTop"),10)||0)-this.margins.top,e.left+(k?Math.max(f.scrollWidth,f.offsetWidth):f.offsetWidth)-(parseInt(d(f).css("borderLeftWidth"),10)||0)-(parseInt(d(f).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,e.top+(k?Math.max(f.scrollHeight,f.offsetHeight):f.offsetHeight)-(parseInt(d(f).css("borderTopWidth"),10)||0)-(parseInt(d(f).css("paddingBottom"),
10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(e,f){f||(f=this.position);var k="absolute"==e?1:-1,l="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&d.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,m=/(html|body)/i.test(l[0].tagName);return{top:f.top+this.offset.relative.top*k+this.offset.parent.top*k-("fixed"==this.cssPosition?-this.scrollParent.scrollTop():m?0:l.scrollTop())*k,left:f.left+this.offset.relative.left*
k+this.offset.parent.left*k-("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():m?0:l.scrollLeft())*k}},_generatePosition:function(e){var f=this.options,k="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&d.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(k[0].tagName);"relative"==this.cssPosition&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());
var m=e.pageX,n=e.pageY;this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(m=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(n=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(m=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(n=this.containment[3]+this.offset.click.top)),f.grid&&(n=this.originalPageY+Math.round((n-
this.originalPageY)/f.grid[1])*f.grid[1],n=this.containment?n-this.offset.click.top<this.containment[1]||n-this.offset.click.top>this.containment[3]?n-this.offset.click.top<this.containment[1]?n+f.grid[1]:n-f.grid[1]:n:n,m=this.originalPageX+Math.round((m-this.originalPageX)/f.grid[0])*f.grid[0],m=this.containment?m-this.offset.click.left<this.containment[0]||m-this.offset.click.left>this.containment[2]?m-this.offset.click.left<this.containment[0]?m+f.grid[0]:m-f.grid[0]:m:m));return{top:n-this.offset.click.top-
this.offset.relative.top-this.offset.parent.top+("fixed"==this.cssPosition?-this.scrollParent.scrollTop():l?0:k.scrollTop()),left:m-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():l?0:k.scrollLeft())}},_rearrange:function(d,f,k,l){k?k[0].appendChild(this.placeholder[0]):f.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?f.item[0]:f.item[0].nextSibling);var m=this.counter=this.counter?++this.counter:
1;this._delay(function(){m==this.counter&&this.refreshPositions(!l)})},_clear:function(e,f){this.reverting=!1;var k=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var l in this._storedCSS)if("auto"==this._storedCSS[l]||"static"==this._storedCSS[l])this._storedCSS[l]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&
!f&&k.push(function(d){this._trigger("receive",d,this._uiHash(this.fromOutside))});(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!f&&k.push(function(d){this._trigger("update",d,this._uiHash())});this!==this.currentContainer&&(f||(k.push(function(d){this._trigger("remove",d,this._uiHash())}),k.push(function(d){return function(e){d._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),
k.push(function(d){return function(e){d._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer))));for(l=this.containers.length-1;0<=l;l--)f||k.push(function(d){return function(e){d._trigger("deactivate",e,this._uiHash(this))}}.call(this,this.containers[l])),this.containers[l].containerCache.over&&(k.push(function(d){return function(e){d._trigger("out",e,this._uiHash(this))}}.call(this,this.containers[l])),this.containers[l].containerCache.over=0);this._storedCursor&&d("body").css("cursor",
this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!f){this._trigger("beforeStop",e,this._uiHash());for(l=0;l<k.length;l++)k[l].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}f||this._trigger("beforeStop",e,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);
this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!f){for(l=0;l<k.length;l++)k[l].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){!1===d.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var f=e||this;return{helper:f.helper,placeholder:f.placeholder||d([]),position:f.position,originalPosition:f.originalPosition,offset:f.positionAbs,item:f.currentItem,sender:e?e.element:null}}})})(jQuery);
(function(d,f){var e=0,h={},k={};h.height=h.paddingTop=h.paddingBottom=h.borderTopWidth=h.borderBottomWidth="hide";k.height=k.paddingTop=k.paddingBottom=k.borderTopWidth=k.borderBottomWidth="show";d.widget("ui.accordion",{version:"1.9.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var f=this.accordionId=
"ui-accordion-"+(this.element.attr("id")||++e),h=this.options;this.prevShow=this.prevHide=d();this.element.addClass("ui-accordion ui-widget ui-helper-reset");this.headers=this.element.find(h.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");this._hoverable(this.headers);this._focusable(this.headers);this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide();!h.collapsible&&(!1===h.active||null==h.active)&&(h.active=
0);0>h.active&&(h.active+=this.headers.length);this.active=this._findActive(h.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top");this.active.next().addClass("ui-accordion-content-active").show();this._createIcons();this.refresh();this.element.attr("role","tablist");this.headers.attr("role","tab").each(function(e){var h=d(this),k=h.attr("id"),m=h.next(),t=m.attr("id");k||(k=f+"-header-"+e,h.attr("id",k));t||(t=f+"-panel-"+e,m.attr("id",t));h.attr("aria-controls",
t);m.attr("aria-labelledby",k)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide();this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0);this._on(this.headers,{keydown:"_keydown"});this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._setupEvents(h.event)},
_getCreateEventData:function(){return{header:this.active,content:this.active.length?this.active.next():d()}},_createIcons:function(){var e=this.options.icons;e&&(d("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},
_destroy:function(){var d;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")});this._destroyIcons();d=this.headers.next().css("display",
"").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")});"content"!==this.options.heightStyle&&d.css("height","")},_setOption:function(d,e){"active"===d?this._activate(e):("event"===d&&(this.options.event&&this._off(this.headers,this.options.event),
this._setupEvents(e)),this._super(d,e),"collapsible"===d&&!e&&!1===this.options.active&&this._activate(0),"icons"===d&&(this._destroyIcons(),e&&this._createIcons()),"disabled"===d&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e))},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var f=d.ui.keyCode,h=this.headers.length,k=this.headers.index(e.target),q=!1;switch(e.keyCode){case f.RIGHT:case f.DOWN:q=this.headers[(k+1)%h];break;case f.LEFT:case f.UP:q=this.headers[(k-1+h)%h];
break;case f.SPACE:case f.ENTER:this._eventHandler(e);break;case f.HOME:q=this.headers[0];break;case f.END:q=this.headers[h-1]}q&&(d(e.target).attr("tabIndex",-1),d(q).attr("tabIndex",0),q.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===d.ui.keyCode.UP&&e.ctrlKey&&d(e.currentTarget).prev().focus()},refresh:function(){var e,f,h=this.options.heightStyle,k=this.element.parent();"fill"===h?(d.support.minHeight||(f=k.css("overflow"),k.css("overflow","hidden")),e=k.height(),this.element.siblings(":visible").each(function(){var f=
d(this),h=f.css("position");"absolute"===h||"fixed"===h||(e-=f.outerHeight(!0))}),f&&k.css("overflow",f),this.headers.each(function(){e-=d(this).outerHeight(!0)}),this.headers.next().each(function(){d(this).height(Math.max(0,e-d(this).innerHeight()+d(this).height()))}).css("overflow","auto")):"auto"===h&&(e=0,this.headers.next().each(function(){e=Math.max(e,d(this).css("height","").height())}).height(e))},_activate:function(e){e=this._findActive(e)[0];e!==this.active[0]&&(e=e||this.active[0],this._eventHandler({target:e,
currentTarget:e,preventDefault:d.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):d()},_setupEvents:function(e){var f={};e&&(d.each(e.split(" "),function(d,e){f[e]="_eventHandler"}),this._on(this.headers,f))},_eventHandler:function(e){var f=this.options,h=this.active,k=d(e.currentTarget),q=k[0]===h[0],r=q&&f.collapsible,t=r?d():k.next(),u=h.next(),t={oldHeader:h,oldPanel:u,newHeader:r?d():k,newPanel:t};e.preventDefault();q&&!f.collapsible||!1===this._trigger("beforeActivate",
e,t)||(f.active=r?!1:this.headers.index(k),this.active=q?d():k,this._toggle(t),h.removeClass("ui-accordion-header-active ui-state-active"),f.icons&&h.children(".ui-accordion-header-icon").removeClass(f.icons.activeHeader).addClass(f.icons.header),q||(k.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),f.icons&&k.children(".ui-accordion-header-icon").removeClass(f.icons.header).addClass(f.icons.activeHeader),k.next().addClass("ui-accordion-content-active")))},
_toggle:function(e){var f=e.newPanel,h=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0);this.prevShow=f;this.prevHide=h;this.options.animate?this._animate(f,h,e):(h.hide(),f.show(),this._toggleComplete(e));h.attr({"aria-expanded":"false","aria-hidden":"true"});h.prev().attr("aria-selected","false");f.length&&h.length?h.prev().attr("tabIndex",-1):f.length&&this.headers.filter(function(){return 0===d(this).attr("tabIndex")}).attr("tabIndex",-1);f.attr({"aria-expanded":"true",
"aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(d,e,f){var p,q,r,t=this,u=0,x=d.length&&(!e.length||d.index()<e.index()),v=this.options.animate||{},x=x&&v.down||v,z=function(){t._toggleComplete(f)};"number"==typeof x&&(r=x);"string"==typeof x&&(q=x);q=q||x.easing||v.easing;r=r||x.duration||v.duration;if(!e.length)return d.animate(k,r,q,z);if(!d.length)return e.animate(h,r,q,z);p=d.show().outerHeight();e.animate(h,{duration:r,easing:q,step:function(d,e){e.now=
Math.round(d)}});d.hide().animate(k,{duration:r,easing:q,complete:z,step:function(d,f){f.now=Math.round(d);"height"!==f.prop?u+=f.now:"content"!==t.options.heightStyle&&(f.now=Math.round(p-e.outerHeight()-u),u=0)}})},_toggleComplete:function(d){var e=d.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");e.length&&(e.parent()[0].className=e.parent()[0].className);this._trigger("activate",null,d)}});!1!==d.uiBackCompat&&(function(d,e){d.extend(e.options,
{navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var f=e._create;e._create=function(){if(this.options.navigation){var e=this,h=this.element.find(this.options.header),k=h.next(),m=h.add(k).find("a").filter(this.options.navigationFilter)[0];m&&h.add(k).each(function(f){if(d.contains(this,m))return e.options.active=Math.floor(f/2),!1})}f.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(d,e){d.extend(e.options,{heightStyle:null,autoHeight:!0,
clearStyle:!1,fillSpace:!1});var f=e._create,h=e._setOption;d.extend(e,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle();f.call(this)},_setOption:function(d){if("autoHeight"===d||"clearStyle"===d||"fillSpace"===d)this.options.heightStyle=this._mergeHeightStyle();h.apply(this,arguments)},_mergeHeightStyle:function(){var d=this.options;if(d.fillSpace)return"fill";if(d.clearStyle)return"content";if(d.autoHeight)return"auto"}})}(jQuery,jQuery.ui.accordion.prototype),
function(d,e){d.extend(e.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var f=e._createIcons;e._createIcons=function(){this.options.icons&&(this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected);f.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(d,e){e.activate=e._activate;var f=e._findActive;e._findActive=function(d){return-1===d&&(d=!1),d&&"number"!=typeof d&&(d=this.headers.index(this.headers.filter(d)),-1===d&&(d=
!1)),f.call(this,d)}}(jQuery,jQuery.ui.accordion.prototype),jQuery.ui.accordion.prototype.resize=jQuery.ui.accordion.prototype.refresh,function(d,e){d.extend(e.options,{change:null,changestart:null});var f=e._trigger;e._trigger=function(d,e,h){var k=f.apply(this,arguments);return k?("beforeActivate"===d?k=f.call(this,"changestart",e,{oldHeader:h.oldHeader,oldContent:h.oldPanel,newHeader:h.newHeader,newContent:h.newPanel}):"activate"===d&&(k=f.call(this,"change",e,{oldHeader:h.oldHeader,oldContent:h.oldPanel,
newHeader:h.newHeader,newContent:h.newPanel})),k):!1}}(jQuery,jQuery.ui.accordion.prototype),function(d,e){d.extend(e.options,{animate:null,animated:"slide"});var f=e._create;e._create=function(){var d=this.options;null===d.animate&&(d.animated?"slide"===d.animated?d.animate=300:"bounceslide"===d.animated?d.animate={duration:200,down:{easing:"easeOutBounce",duration:1E3}}:d.animate=d.animated:d.animate=!1);f.call(this)}}(jQuery,jQuery.ui.accordion.prototype))})(jQuery);
(function(d,f){var e=0;d.widget("ui.autocomplete",{version:"1.9.2",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var e,f,l;this.isMultiLine=this._isMultiLine();this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"];this.isNewMenu=!0;this.element.addClass("ui-autocomplete-input").attr("autocomplete",
"off");this._on(this.element,{keydown:function(m){if(this.element.prop("readOnly"))f=l=e=!0;else{f=l=e=!1;var n=d.ui.keyCode;switch(m.keyCode){case n.PAGE_UP:e=!0;this._move("previousPage",m);break;case n.PAGE_DOWN:e=!0;this._move("nextPage",m);break;case n.UP:e=!0;this._keyEvent("previous",m);break;case n.DOWN:e=!0;this._keyEvent("next",m);break;case n.ENTER:case n.NUMPAD_ENTER:this.menu.active&&(e=!0,m.preventDefault(),this.menu.select(m));break;case n.TAB:this.menu.active&&this.menu.select(m);
break;case n.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(m),m.preventDefault());break;default:f=!0,this._searchTimeout(m)}}},keypress:function(l){if(e)e=!1,l.preventDefault();else if(!f){var n=d.ui.keyCode;switch(l.keyCode){case n.PAGE_UP:this._move("previousPage",l);break;case n.PAGE_DOWN:this._move("nextPage",l);break;case n.UP:this._keyEvent("previous",l);break;case n.DOWN:this._keyEvent("next",l)}}},input:function(d){l?(l=!1,d.preventDefault()):this._searchTimeout(d)},
focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(d){this.cancelBlur?delete this.cancelBlur:(clearTimeout(this.searching),this.close(d),this._change(d))}});this._initSource();this.menu=d("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:d(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu");this._on(this.menu.element,{mousedown:function(e){e.preventDefault();this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur});
var f=this.menu.element[0];d(e.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(h){h.target!==e.element[0]&&h.target!==f&&!d.contains(f,h.target)&&e.close()})})},menufocus:function(e,f){if(this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))){this.menu.blur();this.document.one("mousemove",function(){d(e.target).trigger(e.originalEvent)});return}var h=f.item.data("ui-autocomplete-item")||f.item.data("item.autocomplete");
!1!==this._trigger("focus",e,{item:h})?e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(h.value):this.liveRegion.text(h.value)},menuselect:function(d,e){var f=e.item.data("ui-autocomplete-item")||e.item.data("item.autocomplete"),h=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=h,this._delay(function(){this.previous=h;this.selectedItem=f}));!1!==this._trigger("select",d,{item:f})&&this._value(f.value);this.term=this._value();this.close(d);
this.selectedItem=f}});this.liveRegion=d("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element);d.fn.bgiframe&&this.menu.element.bgiframe();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},_setOption:function(d,e){this._super(d,
e);"source"===d&&this._initSource();"appendTo"===d&&this.menu.element.appendTo(this.document.find(e||"body")[0]);"disabled"===d&&e&&this.xhr&&this.xhr.abort()},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var e,f,l=this;d.isArray(this.options.source)?(e=this.options.source,this.source=function(f,k){k(d.ui.autocomplete.filter(e,f.term))}):"string"==typeof this.options.source?(f=this.options.source,
this.source=function(e,h){l.xhr&&l.xhr.abort();l.xhr=d.ajax({url:f,data:e,dataType:"json",success:function(d){h(d)},error:function(){h([])}})}):this.source=this.options.source},_searchTimeout:function(d){clearTimeout(this.searching);this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,d))},this.options.delay)},search:function(d,e){d=null!=d?d:this._value();this.term=this._value();if(d.length<this.options.minLength)return this.close(e);if(!1!==this._trigger("search",
e))return this._search(d)},_search:function(d){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=!1;this.source({term:d},this._response())},_response:function(){var d=this,f=++e;return function(l){f===e&&d.__response(l);d.pending--;d.pending||d.element.removeClass("ui-autocomplete-loading")}},__response:function(d){d&&(d=this._normalize(d));this._trigger("response",null,{content:d});!this.options.disabled&&d&&d.length&&!this.cancelSearch?(this._suggest(d),this._trigger("open")):
this._close()},close:function(d){this.cancelSearch=!0;this._close(d)},_close:function(d){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",d))},_change:function(d){this.previous!==this._value()&&this._trigger("change",d,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:d.map(e,function(e){return"string"==typeof e?{label:e,value:e}:d.extend({label:e.label||e.value,value:e.value||e.label},e)})},
_suggest:function(e){var f=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(f,e);this.menu.refresh();f.show();this._resizeMenu();f.position(d.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var d=this.menu.element;d.outerWidth(Math.max(d.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,f){var l=this;d.each(f,function(d,f){l._renderItemData(e,f)})},_renderItemData:function(d,e){return this._renderItem(d,
e).data("ui-autocomplete-item",e)},_renderItem:function(e,f){return d("<li>").append(d("<a>").text(f.label)).appendTo(e)},_move:function(d,e){if(this.menu.element.is(":visible"))if(this.menu.isFirstItem()&&/^previous/.test(d)||this.menu.isLastItem()&&/^next/.test(d))this._value(this.term),this.menu.blur();else this.menu[d](e);else this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(d,e){if(!this.isMultiLine||
this.menu.element.is(":visible"))this._move(d,e),e.preventDefault()}});d.extend(d.ui.autocomplete,{escapeRegex:function(d){return d.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,f){var l=RegExp(d.ui.autocomplete.escapeRegex(f),"i");return d.grep(e,function(d){return l.test(d.label||d.value||d)})}});d.widget("ui.autocomplete",d.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(d){return d+(1<d?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},
__response:function(d){var e;this._superApply(arguments);!this.options.disabled&&!this.cancelSearch&&(d&&d.length?e=this.options.messages.results(d.length):e=this.options.messages.noResults,this.liveRegion.text(e))}})})(jQuery);
(function(d,f){var e,h,k,l,m=function(){var e=d(this).find(":ui-button");setTimeout(function(){e.button("refresh")},1)},n=function(e){var f=e.name,h=e.form,k=d([]);return f&&(h?k=d(h).find("[name='"+f+"']"):k=d("[name='"+f+"']",e.ownerDocument).filter(function(){return!this.form})),k};d.widget("ui.button",{version:"1.9.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+
this.eventNamespace,m);"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled);this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var f=this,q=this.options,r="checkbox"===this.type||"radio"===this.type,t=r?"":"ui-state-active";null===q.label&&(q.label="input"===this.type?this.buttonElement.val():this.buttonElement.html());this._hoverable(this.buttonElement);this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role",
"button").bind("mouseenter"+this.eventNamespace,function(){q.disabled||this===e&&d(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){q.disabled||d(this).removeClass(t)}).bind("click"+this.eventNamespace,function(d){q.disabled&&(d.preventDefault(),d.stopImmediatePropagation())});this.element.bind("focus"+this.eventNamespace,function(){f.buttonElement.addClass("ui-state-focus")}).bind("blur"+this.eventNamespace,function(){f.buttonElement.removeClass("ui-state-focus")});
r&&(this.element.bind("change"+this.eventNamespace,function(){l||f.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(d){q.disabled||(l=!1,h=d.pageX,k=d.pageY)}).bind("mouseup"+this.eventNamespace,function(d){if(!q.disabled&&(h!==d.pageX||k!==d.pageY))l=!0}));"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(q.disabled||l)return!1;d(this).toggleClass("ui-state-active");f.buttonElement.attr("aria-pressed",f.element[0].checked)}):"radio"===
this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(q.disabled||l)return!1;d(this).addClass("ui-state-active");f.buttonElement.attr("aria-pressed","true");var e=f.element[0];n(e).not(e).map(function(){return d(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(q.disabled)return!1;d(this).addClass("ui-state-active");e=this;f.document.one("mouseup",function(){e=null})}).bind("mouseup"+
this.eventNamespace,function(){if(q.disabled)return!1;d(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(e){if(q.disabled)return!1;(e.keyCode===d.ui.keyCode.SPACE||e.keyCode===d.ui.keyCode.ENTER)&&d(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace,function(){d(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===d.ui.keyCode.SPACE&&d(this).click()}));this._setOption("disabled",q.disabled);
this._resetButton()},_determineButtonType:function(){var d,e,f;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button";"checkbox"===this.type||"radio"===this.type?(d=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=d.find(e),this.buttonElement.length||(d=d.length?d.siblings():this.element.siblings(),this.buttonElement=d.filter(e),this.buttonElement.length||
(this.buttonElement=d.find(e))),this.element.addClass("ui-helper-hidden-accessible"),f=this.element.is(":checked"),f&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",f)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());
this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(d,e){this._super(d,e);"disabled"===d?e?this.element.prop("disabled",!0):this.element.prop("disabled",!1):this._resetButton()},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e);"radio"===this.type?n(this.element[0]).each(function(){d(this).is(":checked")?d(this).button("widget").addClass("ui-state-active").attr("aria-pressed",
"true"):d(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)this.options.label&&this.element.val(this.options.label);else{var e=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
f=d("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),h=this.options.icons,k=h.primary&&h.secondary,l=[];h.primary||h.secondary?(this.options.text&&l.push("ui-button-text-icon"+(k?"s":h.primary?"-primary":"-secondary")),h.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+h.primary+"'></span>"),h.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+h.secondary+"'></span>"),this.options.text||(l.push(k?"ui-button-icons-only":
"ui-button-icon-only"),this.hasTitle||e.attr("title",d.trim(f)))):l.push("ui-button-text-only");e.addClass(l.join(" "))}}});d.widget("ui.buttonset",{version:"1.9.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(d,e){"disabled"===d&&this.buttons.button("option",d,e);this._super(d,e)},refresh:function(){var e=
"rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return d(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return d(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})})(jQuery);
(function(d,f){function e(){this.debug=!1;this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._inDialog=this._datepickerShowing=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass=
"ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),
weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,
beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};d.extend(this._defaults,this.regional[""]);this.dpDiv=h(d('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function h(e){return e.delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a",
"mouseout",function(){d(this).removeClass("ui-state-hover");-1!=this.className.indexOf("ui-datepicker-prev")&&d(this).removeClass("ui-datepicker-prev-hover");-1!=this.className.indexOf("ui-datepicker-next")&&d(this).removeClass("ui-datepicker-next-hover")}).delegate("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a","mouseover",function(){d.datepicker._isDisabledDatepicker(m.inline?e.parent()[0]:m.input[0])||(d(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),
d(this).addClass("ui-state-hover"),-1!=this.className.indexOf("ui-datepicker-prev")&&d(this).addClass("ui-datepicker-prev-hover"),-1!=this.className.indexOf("ui-datepicker-next")&&d(this).addClass("ui-datepicker-next-hover"))})}function k(e,h){d.extend(e,h);for(var k in h)if(null==h[k]||h[k]==f)e[k]=h[k];return e}d.extend(d.ui,{datepicker:{version:"1.9.2"}});var l=(new Date).getTime(),m;d.extend(e.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",
arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(d){return k(this._defaults,d||{}),this},_attachDatepicker:function(e,f){var h=null,k;for(k in this._defaults){var l=e.getAttribute("date:"+k);if(l){h=h||{};try{h[k]=eval(l)}catch(m){h[k]=l}}}k=e.nodeName.toLowerCase();l="div"==k||"span"==k;e.id||(this.uuid+=1,e.id="dp"+this.uuid);var x=this._newInst(d(e),l);x.settings=d.extend({},f||{},h||{});"input"==k?this._connectDatepicker(e,x):l&&this._inlineDatepicker(e,x)},_newInst:function(e,
f){return{id:e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:f,dpDiv:f?h(d('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(e,f){var h=d(e);f.append=d([]);f.trigger=d([]);h.hasClass(this.markerClassName)||(this._attachments(h,f),h.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",
function(d,e,h){f.settings[e]=h}).bind("getData.datepicker",function(d,e){return this._get(f,e)}),this._autoSize(f),d.data(e,"datepicker",f),f.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,f){var h=this._get(f,"appendText"),k=this._get(f,"isRTL");f.append&&f.append.remove();h&&(f.append=d('<span class="'+this._appendClass+'">'+h+"</span>"),e[k?"before":"after"](f.append));e.unbind("focus",this._showDatepicker);f.trigger&&f.trigger.remove();h=this._get(f,"showOn");("focus"==
h||"both"==h)&&e.focus(this._showDatepicker);if("button"==h||"both"==h){var h=this._get(f,"buttonText"),l=this._get(f,"buttonImage");f.trigger=d(this._get(f,"buttonImageOnly")?d("<img/>").addClass(this._triggerClass).attr({src:l,alt:h,title:h}):d('<button type="button"></button>').addClass(this._triggerClass).html(""==l?h:d("<img/>").attr({src:l,alt:h,title:h})));e[k?"before":"after"](f.trigger);f.trigger.click(function(){return d.datepicker._datepickerShowing&&d.datepicker._lastInput==e[0]?d.datepicker._hideDatepicker():
d.datepicker._datepickerShowing&&d.datepicker._lastInput!=e[0]?(d.datepicker._hideDatepicker(),d.datepicker._showDatepicker(e[0])):d.datepicker._showDatepicker(e[0]),!1})}},_autoSize:function(d){if(this._get(d,"autoSize")&&!d.inline){var e=new Date(2009,11,20),f=this._get(d,"dateFormat");if(f.match(/[DM]/)){var h=function(d){for(var e=0,f=0,h=0;h<d.length;h++)d[h].length>e&&(e=d[h].length,f=h);return f};e.setMonth(h(this._get(d,f.match(/MM/)?"monthNames":"monthNamesShort")));e.setDate(h(this._get(d,
f.match(/DD/)?"dayNames":"dayNamesShort"))+20-e.getDay())}d.input.attr("size",this._formatDate(d,e).length)}},_inlineDatepicker:function(e,f){var h=d(e);h.hasClass(this.markerClassName)||(h.addClass(this.markerClassName).append(f.dpDiv).bind("setData.datepicker",function(d,e,h){f.settings[e]=h}).bind("getData.datepicker",function(d,e){return this._get(f,e)}),d.data(e,"datepicker",f),this._setDate(f,this._getDefaultDate(f),!0),this._updateDatepicker(f),this._updateAlternate(f),f.settings.disabled&&
this._disableDatepicker(e),f.dpDiv.css("display","block"))},_dialogDatepicker:function(e,f,h,l,m){e=this._dialogInst;e||(this.uuid+=1,this._dialogInput=d('<input type="text" id="dp'+this.uuid+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),d("body").append(this._dialogInput),e=this._dialogInst=this._newInst(this._dialogInput,!1),e.settings={},d.data(this._dialogInput[0],"datepicker",e));k(e.settings,l||{});f=f&&f.constructor==Date?this._formatDate(e,
f):f;this._dialogInput.val(f);this._pos=m?m.length?m:[m.pageX,m.pageY]:null;this._pos||(this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]);return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),e.settings.onSelect=h,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),
d.blockUI&&d.blockUI(this.dpDiv),d.data(this._dialogInput[0],"datepicker",e),this},_destroyDatepicker:function(e){var f=d(e),h=d.data(e,"datepicker");if(f.hasClass(this.markerClassName)){var k=e.nodeName.toLowerCase();d.removeData(e,"datepicker");"input"==k?(h.append.remove(),h.trigger.remove(),f.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==k||"span"==k)&&f.removeClass(this.markerClassName).empty()}},
_enableDatepicker:function(e){var f=d(e),h=d.data(e,"datepicker");if(f.hasClass(this.markerClassName)){var k=e.nodeName.toLowerCase();if("input"==k)e.disabled=!1,h.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==k||"span"==k)f=f.children("."+this._inlineClass),f.children().removeClass("ui-state-disabled"),f.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1);this._disabledInputs=d.map(this._disabledInputs,
function(d){return d==e?null:d})}},_disableDatepicker:function(e){var f=d(e),h=d.data(e,"datepicker");if(f.hasClass(this.markerClassName)){var k=e.nodeName.toLowerCase();if("input"==k)e.disabled=!0,h.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==k||"span"==k)f=f.children("."+this._inlineClass),f.children().addClass("ui-state-disabled"),f.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",
!0);this._disabledInputs=d.map(this._disabledInputs,function(d){return d==e?null:d});this._disabledInputs[this._disabledInputs.length]=e}},_isDisabledDatepicker:function(d){if(!d)return!1;for(var e=0;e<this._disabledInputs.length;e++)if(this._disabledInputs[e]==d)return!0;return!1},_getInst:function(e){try{return d.data(e,"datepicker")}catch(f){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(e,h,l){var m=this._getInst(e);if(2==arguments.length&&"string"==typeof h)return"defaults"==
h?d.extend({},d.datepicker._defaults):m?"all"==h?d.extend({},m.settings):this._get(m,h):null;var t=h||{};"string"==typeof h&&(t={},t[h]=l);if(m){this._curInst==m&&this._hideDatepicker();var u=this._getDateDatepicker(e,!0),x=this._getMinMaxDate(m,"min"),v=this._getMinMaxDate(m,"max");k(m.settings,t);null!==x&&t.dateFormat!==f&&t.minDate===f&&(m.settings.minDate=this._formatDate(m,x));null!==v&&t.dateFormat!==f&&t.maxDate===f&&(m.settings.maxDate=this._formatDate(m,v));this._attachments(d(e),m);this._autoSize(m);
this._setDate(m,u);this._updateAlternate(m);this._updateDatepicker(m)}},_changeDatepicker:function(d,e,f){this._optionDatepicker(d,e,f)},_refreshDatepicker:function(d){(d=this._getInst(d))&&this._updateDatepicker(d)},_setDateDatepicker:function(d,e){var f=this._getInst(d);f&&(this._setDate(f,e),this._updateDatepicker(f),this._updateAlternate(f))},_getDateDatepicker:function(d,e){var f=this._getInst(d);return f&&!f.inline&&this._setDateFromField(f,e),f?this._getDate(f):null},_doKeyDown:function(e){var f=
d.datepicker._getInst(e.target),h=!0,k=f.dpDiv.is(".ui-datepicker-rtl");f._keyEvent=!0;if(d.datepicker._datepickerShowing)switch(e.keyCode){case 9:d.datepicker._hideDatepicker();h=!1;break;case 13:return h=d("td."+d.datepicker._dayOverClass+":not(."+d.datepicker._currentClass+")",f.dpDiv),h[0]&&d.datepicker._selectDay(e.target,f.selectedMonth,f.selectedYear,h[0]),(e=d.datepicker._get(f,"onSelect"))?(h=d.datepicker._formatDate(f),e.apply(f.input?f.input[0]:null,[h,f])):d.datepicker._hideDatepicker(),
!1;case 27:d.datepicker._hideDatepicker();break;case 33:d.datepicker._adjustDate(e.target,e.ctrlKey?-d.datepicker._get(f,"stepBigMonths"):-d.datepicker._get(f,"stepMonths"),"M");break;case 34:d.datepicker._adjustDate(e.target,e.ctrlKey?+d.datepicker._get(f,"stepBigMonths"):+d.datepicker._get(f,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&d.datepicker._clearDate(e.target);h=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&d.datepicker._gotoToday(e.target);h=e.ctrlKey||e.metaKey;
break;case 37:(e.ctrlKey||e.metaKey)&&d.datepicker._adjustDate(e.target,k?1:-1,"D");h=e.ctrlKey||e.metaKey;e.originalEvent.altKey&&d.datepicker._adjustDate(e.target,e.ctrlKey?-d.datepicker._get(f,"stepBigMonths"):-d.datepicker._get(f,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&d.datepicker._adjustDate(e.target,-7,"D");h=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&d.datepicker._adjustDate(e.target,k?-1:1,"D");h=e.ctrlKey||e.metaKey;e.originalEvent.altKey&&d.datepicker._adjustDate(e.target,
e.ctrlKey?+d.datepicker._get(f,"stepBigMonths"):+d.datepicker._get(f,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&d.datepicker._adjustDate(e.target,7,"D");h=e.ctrlKey||e.metaKey;break;default:h=!1}else 36==e.keyCode&&e.ctrlKey?d.datepicker._showDatepicker(this):h=!1;h&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var h=d.datepicker._getInst(e.target);if(d.datepicker._get(h,"constrainInput")){var h=d.datepicker._possibleChars(d.datepicker._get(h,"dateFormat")),k=String.fromCharCode(e.charCode==
f?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||" ">k||!h||-1<h.indexOf(k)}},_doKeyUp:function(e){e=d.datepicker._getInst(e.target);if(e.input.val()!=e.lastVal)try{d.datepicker.parseDate(d.datepicker._get(e,"dateFormat"),e.input?e.input.val():null,d.datepicker._getFormatConfig(e))&&(d.datepicker._setDateFromField(e),d.datepicker._updateAlternate(e),d.datepicker._updateDatepicker(e))}catch(f){d.datepicker.log(f)}return!0},_showDatepicker:function(e){e=e.target||e;"input"!=e.nodeName.toLowerCase()&&
(e=d("input",e.parentNode)[0]);if(!(d.datepicker._isDisabledDatepicker(e)||d.datepicker._lastInput==e)){var f=d.datepicker._getInst(e);d.datepicker._curInst&&d.datepicker._curInst!=f&&(d.datepicker._curInst.dpDiv.stop(!0,!0),f&&d.datepicker._datepickerShowing&&d.datepicker._hideDatepicker(d.datepicker._curInst.input[0]));var h=d.datepicker._get(f,"beforeShow"),h=h?h.apply(e,[e,f]):{};if(!1!==h){k(f.settings,h);f.lastVal=null;d.datepicker._lastInput=e;d.datepicker._setDateFromField(f);d.datepicker._inDialog&&
(e.value="");d.datepicker._pos||(d.datepicker._pos=d.datepicker._findPos(e),d.datepicker._pos[1]+=e.offsetHeight);var l=!1;d(e).parents().each(function(){return l|="fixed"==d(this).css("position"),!l});h={left:d.datepicker._pos[0],top:d.datepicker._pos[1]};d.datepicker._pos=null;f.dpDiv.empty();f.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});d.datepicker._updateDatepicker(f);h=d.datepicker._checkOffset(f,h,l);f.dpDiv.css({position:d.datepicker._inDialog&&d.blockUI?"static":l?"fixed":
"absolute",display:"none",left:h.left+"px",top:h.top+"px"});if(!f.inline){var h=d.datepicker._get(f,"showAnim"),m=d.datepicker._get(f,"duration"),u=function(){var e=f.dpDiv.find("iframe.ui-datepicker-cover");if(e.length){var h=d.datepicker._getBorders(f.dpDiv);e.css({left:-h[0],top:-h[1],width:f.dpDiv.outerWidth(),height:f.dpDiv.outerHeight()})}};f.dpDiv.zIndex(d(e).zIndex()+1);d.datepicker._datepickerShowing=!0;d.effects&&(d.effects.effect[h]||d.effects[h])?f.dpDiv.show(h,d.datepicker._get(f,"showOptions"),
m,u):f.dpDiv[h||"show"](h?m:null,u);(!h||!m)&&u();f.input.is(":visible")&&!f.input.is(":disabled")&&f.input.focus();d.datepicker._curInst=f}}}},_updateDatepicker:function(e){this.maxRows=4;var f=d.datepicker._getBorders(e.dpDiv);m=e;e.dpDiv.empty().append(this._generateHTML(e));this._attachHandlers(e);var h=e.dpDiv.find("iframe.ui-datepicker-cover");!h.length||h.css({left:-f[0],top:-f[1],width:e.dpDiv.outerWidth(),height:e.dpDiv.outerHeight()});e.dpDiv.find("."+this._dayOverClass+" a").mouseover();
f=this._getNumberOfMonths(e);h=f[1];e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");1<h&&e.dpDiv.addClass("ui-datepicker-multi-"+h).css("width",17*h+"em");e.dpDiv[(1!=f[0]||1!=f[1]?"add":"remove")+"Class"]("ui-datepicker-multi");e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");e==d.datepicker._curInst&&d.datepicker._datepickerShowing&&e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&e.input[0]!=document.activeElement&&
e.input.focus();if(e.yearshtml){var k=e.yearshtml;setTimeout(function(){k===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml);k=e.yearshtml=null},0)}},_getBorders:function(d){var e=function(d){return{thin:1,medium:2,thick:3}[d]||d};return[parseFloat(e(d.css("border-left-width"))),parseFloat(e(d.css("border-top-width")))]},_checkOffset:function(e,f,h){var k=e.dpDiv.outerWidth(),l=e.dpDiv.outerHeight(),m=e.input?e.input.outerWidth():0,x=e.input?e.input.outerHeight():
0,v=document.documentElement.clientWidth+(h?0:d(document).scrollLeft()),z=document.documentElement.clientHeight+(h?0:d(document).scrollTop());return f.left-=this._get(e,"isRTL")?k-m:0,f.left-=h&&f.left==e.input.offset().left?d(document).scrollLeft():0,f.top-=h&&f.top==e.input.offset().top+x?d(document).scrollTop():0,f.left-=Math.min(f.left,f.left+k>v&&v>k?Math.abs(f.left+k-v):0),f.top-=Math.min(f.top,f.top+l>z&&z>l?Math.abs(l+x):0),f},_findPos:function(e){for(var f=this._getInst(e),f=this._get(f,
"isRTL");e&&("hidden"==e.type||1!=e.nodeType||d.expr.filters.hidden(e));)e=e[f?"previousSibling":"nextSibling"];e=d(e).offset();return[e.left,e.top]},_hideDatepicker:function(e){var f=this._curInst;if(f&&!(e&&f!=d.data(e,"datepicker"))&&this._datepickerShowing){e=this._get(f,"showAnim");var h=this._get(f,"duration"),k=function(){d.datepicker._tidyDialog(f)};d.effects&&(d.effects.effect[e]||d.effects[e])?f.dpDiv.hide(e,d.datepicker._get(f,"showOptions"),h,k):f.dpDiv["slideDown"==e?"slideUp":"fadeIn"==
e?"fadeOut":"hide"](e?h:null,k);e||k();this._datepickerShowing=!1;(e=this._get(f,"onClose"))&&e.apply(f.input?f.input[0]:null,[f.input?f.input.val():"",f]);this._lastInput=null;this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),d.blockUI&&(d.unblockUI(),d("body").append(this.dpDiv)));this._inDialog=!1}},_tidyDialog:function(d){d.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(d.datepicker._curInst){e=d(e.target);
var f=d.datepicker._getInst(e[0]);(e[0].id!=d.datepicker._mainDivId&&0==e.parents("#"+d.datepicker._mainDivId).length&&!e.hasClass(d.datepicker.markerClassName)&&!e.closest("."+d.datepicker._triggerClass).length&&d.datepicker._datepickerShowing&&(!d.datepicker._inDialog||!d.blockUI)||e.hasClass(d.datepicker.markerClassName)&&d.datepicker._curInst!=f)&&d.datepicker._hideDatepicker()}},_adjustDate:function(e,f,h){e=d(e);var k=this._getInst(e[0]);this._isDisabledDatepicker(e[0])||(this._adjustInstDate(k,
f+("M"==h?this._get(k,"showCurrentAtPos"):0),h),this._updateDatepicker(k))},_gotoToday:function(e){e=d(e);var f=this._getInst(e[0]);if(this._get(f,"gotoCurrent")&&f.currentDay)f.selectedDay=f.currentDay,f.drawMonth=f.selectedMonth=f.currentMonth,f.drawYear=f.selectedYear=f.currentYear;else{var h=new Date;f.selectedDay=h.getDate();f.drawMonth=f.selectedMonth=h.getMonth();f.drawYear=f.selectedYear=h.getFullYear()}this._notifyChange(f);this._adjustDate(e)},_selectMonthYear:function(e,f,h){e=d(e);var k=
this._getInst(e[0]);k["selected"+("M"==h?"Month":"Year")]=k["draw"+("M"==h?"Month":"Year")]=parseInt(f.options[f.selectedIndex].value,10);this._notifyChange(k);this._adjustDate(e)},_selectDay:function(e,f,h,k){var l=d(e);!d(k).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(l[0])&&(l=this._getInst(l[0]),l.selectedDay=l.currentDay=d("a",k).html(),l.selectedMonth=l.currentMonth=f,l.selectedYear=l.currentYear=h,this._selectDate(e,this._formatDate(l,l.currentDay,l.currentMonth,l.currentYear)))},
_clearDate:function(e){e=d(e);this._getInst(e[0]);this._selectDate(e,"")},_selectDate:function(e,f){var h=d(e),h=this._getInst(h[0]);f=null!=f?f:this._formatDate(h);h.input&&h.input.val(f);this._updateAlternate(h);var k=this._get(h,"onSelect");k?k.apply(h.input?h.input[0]:null,[f,h]):h.input&&h.input.trigger("change");h.inline?this._updateDatepicker(h):(this._hideDatepicker(),this._lastInput=h.input[0],"object"!=typeof h.input[0]&&h.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var f=
this._get(e,"altField");if(f){var h=this._get(e,"altFormat")||this._get(e,"dateFormat"),k=this._getDate(e),l=this.formatDate(h,k,this._getFormatConfig(e));d(f).each(function(){d(this).val(l)})}},noWeekends:function(d){d=d.getDay();return[0<d&&6>d,""]},iso8601Week:function(d){d=new Date(d.getTime());d.setDate(d.getDate()+4-(d.getDay()||7));var e=d.getTime();return d.setMonth(0),d.setDate(1),Math.floor(Math.round((e-d)/864E5)/7)+1},parseDate:function(e,f,h){if(null==e||null==f)throw"Invalid arguments";
f="object"==typeof f?f.toString():f+"";if(""==f)return null;for(var k=(h?h.shortYearCutoff:null)||this._defaults.shortYearCutoff,k="string"!=typeof k?k:(new Date).getFullYear()%100+parseInt(k,10),l=(h?h.dayNamesShort:null)||this._defaults.dayNamesShort,m=(h?h.dayNames:null)||this._defaults.dayNames,x=(h?h.monthNamesShort:null)||this._defaults.monthNamesShort,v=(h?h.monthNames:null)||this._defaults.monthNames,z=h=-1,y=-1,A=-1,B=!1,C=function(d){d=Y+1<e.length&&e.charAt(Y+1)==d;return d&&Y++,d},H=function(d){var e=
C(d);d=RegExp("^\\d{1,"+("@"==d?14:"!"==d?20:"y"==d&&e?4:"o"==d?3:2)+"}");d=f.substring(E).match(d);if(!d)throw"Missing number at position "+E;return E+=d[0].length,parseInt(d[0],10)},w=function(e,h,k){e=d.map(C(e)?k:h,function(d,e){return[[e,d]]}).sort(function(d,e){return-(d[1].length-e[1].length)});var l=-1;d.each(e,function(d,e){var h=e[1];if(f.substr(E,h.length).toLowerCase()==h.toLowerCase())return l=e[0],E+=h.length,!1});if(-1!=l)return l+1;throw"Unknown name at position "+E;},F=function(){if(f.charAt(E)!=
e.charAt(Y))throw"Unexpected literal at position "+E;E++},E=0,Y=0;Y<e.length;Y++)if(B)"'"==e.charAt(Y)&&!C("'")?B=!1:F();else switch(e.charAt(Y)){case "d":y=H("d");break;case "D":w("D",l,m);break;case "o":A=H("o");break;case "m":z=H("m");break;case "M":z=w("M",x,v);break;case "y":h=H("y");break;case "@":var G=new Date(H("@"));h=G.getFullYear();z=G.getMonth()+1;y=G.getDate();break;case "!":G=new Date((H("!")-this._ticksTo1970)/1E4);h=G.getFullYear();z=G.getMonth()+1;y=G.getDate();break;case "'":C("'")?
F():B=!0;break;default:F()}if(E<f.length&&(l=f.substr(E),!/^\s+/.test(l)))throw"Extra/unparsed characters found in date: "+l;-1==h?h=(new Date).getFullYear():100>h&&(h+=(new Date).getFullYear()-(new Date).getFullYear()%100+(h<=k?0:-100));if(-1<A){z=1;y=A;do{k=this._getDaysInMonth(h,z-1);if(y<=k)break;z++;y-=k}while(1)}G=this._daylightSavingAdjust(new Date(h,z-1,y));if(G.getFullYear()!=h||G.getMonth()+1!=z||G.getDate()!=y)throw"Invalid date";return G},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",
RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864E9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(d,e,f){if(!e)return"";var h=(f?f.dayNamesShort:null)||this._defaults.dayNamesShort,k=(f?f.dayNames:null)||this._defaults.dayNames,l=(f?f.monthNamesShort:null)||this._defaults.monthNamesShort;f=(f?f.monthNames:null)||this._defaults.monthNames;var m=
function(e){e=B+1<d.length&&d.charAt(B+1)==e;return e&&B++,e},v=function(d,e,f){e=""+e;if(m(d))for(;e.length<f;)e="0"+e;return e},z=function(d,e,f,h){return m(d)?h[e]:f[e]},y="",A=!1;if(e)for(var B=0;B<d.length;B++)if(A)"'"==d.charAt(B)&&!m("'")?A=!1:y+=d.charAt(B);else switch(d.charAt(B)){case "d":y+=v("d",e.getDate(),2);break;case "D":y+=z("D",e.getDay(),h,k);break;case "o":y+=v("o",Math.round(((new Date(e.getFullYear(),e.getMonth(),e.getDate())).getTime()-(new Date(e.getFullYear(),0,0)).getTime())/
864E5),3);break;case "m":y+=v("m",e.getMonth()+1,2);break;case "M":y+=z("M",e.getMonth(),l,f);break;case "y":y+=m("y")?e.getFullYear():(10>e.getYear()%100?"0":"")+e.getYear()%100;break;case "@":y+=e.getTime();break;case "!":y+=1E4*e.getTime()+this._ticksTo1970;break;case "'":m("'")?y+="'":A=!0;break;default:y+=d.charAt(B)}return y},_possibleChars:function(d){for(var e="",f=!1,h=function(e){e=k+1<d.length&&d.charAt(k+1)==e;return e&&k++,e},k=0;k<d.length;k++)if(f)"'"==d.charAt(k)&&!h("'")?f=!1:e+=
d.charAt(k);else switch(d.charAt(k)){case "d":case "m":case "y":case "@":e+="0123456789";break;case "D":case "M":return null;case "'":h("'")?e+="'":f=!0;break;default:e+=d.charAt(k)}return e},_get:function(d,e){return d.settings[e]!==f?d.settings[e]:this._defaults[e]},_setDateFromField:function(d,e){if(d.input.val()!=d.lastVal){var f=this._get(d,"dateFormat"),h=d.lastVal=d.input?d.input.val():null,k,l;k=l=this._getDefaultDate(d);var m=this._getFormatConfig(d);try{k=this.parseDate(f,h,m)||l}catch(v){this.log(v),
h=e?"":h}d.selectedDay=k.getDate();d.drawMonth=d.selectedMonth=k.getMonth();d.drawYear=d.selectedYear=k.getFullYear();d.currentDay=h?k.getDate():0;d.currentMonth=h?k.getMonth():0;d.currentYear=h?k.getFullYear():0;this._adjustInstDate(d)}},_getDefaultDate:function(d){return this._restrictMinMax(d,this._determineDate(d,this._get(d,"defaultDate"),new Date))},_determineDate:function(e,f,h){var k=function(d){var e=new Date;return e.setDate(e.getDate()+d),e},l=function(f){try{return d.datepicker.parseDate(d.datepicker._get(e,
"dateFormat"),f,d.datepicker._getFormatConfig(e))}catch(h){}for(var k=(f.toLowerCase().match(/^c/)?d.datepicker._getDate(e):null)||new Date,l=k.getFullYear(),m=k.getMonth(),k=k.getDate(),p=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,q=p.exec(f);q;){switch(q[2]||"d"){case "d":case "D":k+=parseInt(q[1],10);break;case "w":case "W":k+=7*parseInt(q[1],10);break;case "m":case "M":m+=parseInt(q[1],10);k=Math.min(k,d.datepicker._getDaysInMonth(l,m));break;case "y":case "Y":l+=parseInt(q[1],10),k=Math.min(k,d.datepicker._getDaysInMonth(l,
m))}q=p.exec(f)}return new Date(l,m,k)};f=null==f||""===f?h:"string"==typeof f?l(f):"number"==typeof f?isNaN(f)?h:k(f):new Date(f.getTime());return f=f&&"Invalid Date"==f.toString()?h:f,f&&(f.setHours(0),f.setMinutes(0),f.setSeconds(0),f.setMilliseconds(0)),this._daylightSavingAdjust(f)},_daylightSavingAdjust:function(d){return d?(d.setHours(12<d.getHours()?d.getHours()+2:0),d):null},_setDate:function(d,e,f){var h=!e,k=d.selectedMonth,l=d.selectedYear;e=this._restrictMinMax(d,this._determineDate(d,
e,new Date));d.selectedDay=d.currentDay=e.getDate();d.drawMonth=d.selectedMonth=d.currentMonth=e.getMonth();d.drawYear=d.selectedYear=d.currentYear=e.getFullYear();(k!=d.selectedMonth||l!=d.selectedYear)&&!f&&this._notifyChange(d);this._adjustInstDate(d);d.input&&d.input.val(h?"":this._formatDate(d))},_getDate:function(d){return!d.currentYear||d.input&&""==d.input.val()?null:this._daylightSavingAdjust(new Date(d.currentYear,d.currentMonth,d.currentDay))},_attachHandlers:function(e){var f=this._get(e,
"stepMonths"),h="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){d(this).bind(this.getAttribute("data-event"),{prev:function(){window["DP_jQuery_"+l].datepicker._adjustDate(h,-f,"M")},next:function(){window["DP_jQuery_"+l].datepicker._adjustDate(h,+f,"M")},hide:function(){window["DP_jQuery_"+l].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+l].datepicker._gotoToday(h)},selectDay:function(){return window["DP_jQuery_"+l].datepicker._selectDay(h,+this.getAttribute("data-month"),
+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+l].datepicker._selectMonthYear(h,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+l].datepicker._selectMonthYear(h,this,"Y"),!1}}[this.getAttribute("data-handler")])})},_generateHTML:function(e){var f=new Date,f=this._daylightSavingAdjust(new Date(f.getFullYear(),f.getMonth(),f.getDate())),h=this._get(e,"isRTL"),k=this._get(e,"showButtonPanel"),l=this._get(e,"hideIfNoPrevNext"),m=this._get(e,
"navigationAsDateFormat"),x=this._getNumberOfMonths(e),v=this._get(e,"showCurrentAtPos"),z=this._get(e,"stepMonths"),y=1!=x[0]||1!=x[1],A=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),B=this._getMinMaxDate(e,"min"),C=this._getMinMaxDate(e,"max"),v=e.drawMonth-v,H=e.drawYear;0>v&&(v+=12,H--);if(C)for(var w=this._daylightSavingAdjust(new Date(C.getFullYear(),C.getMonth()-x[0]*x[1]+1,C.getDate())),w=B&&w<B?B:w;this._daylightSavingAdjust(new Date(H,
v,1))>w;)v--,0>v&&(v=11,H--);e.drawMonth=v;e.drawYear=H;var w=this._get(e,"prevText"),w=m?this.formatDate(w,this._daylightSavingAdjust(new Date(H,v-z,1)),this._getFormatConfig(e)):w,w=this._canAdjustMonth(e,-1,H,v)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+w+'"><span class="ui-icon ui-icon-circle-triangle-'+(h?"e":"w")+'">'+w+"</span></a>":l?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+w+'"><span class="ui-icon ui-icon-circle-triangle-'+
(h?"e":"w")+'">'+w+"</span></a>",F=this._get(e,"nextText"),F=m?this.formatDate(F,this._daylightSavingAdjust(new Date(H,v+z,1)),this._getFormatConfig(e)):F,l=this._canAdjustMonth(e,1,H,v)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+F+'"><span class="ui-icon ui-icon-circle-triangle-'+(h?"w":"e")+'">'+F+"</span></a>":l?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+F+'"><span class="ui-icon ui-icon-circle-triangle-'+(h?"w":
"e")+'">'+F+"</span></a>",z=this._get(e,"currentText"),F=this._get(e,"gotoCurrent")&&e.currentDay?A:f,z=m?this.formatDate(z,F,this._getFormatConfig(e)):z,m=e.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(e,"closeText")+"</button>",k=k?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(h?m:"")+(this._isInRange(e,F)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+
z+"</button>":"")+(h?"":m)+"</div>":"",m=parseInt(this._get(e,"firstDay"),10),m=isNaN(m)?0:m,z=this._get(e,"showWeek"),F=this._get(e,"dayNames");this._get(e,"dayNamesShort");var E=this._get(e,"dayNamesMin"),Y=this._get(e,"monthNames"),G=this._get(e,"monthNamesShort"),Q=this._get(e,"beforeShowDay"),aa=this._get(e,"showOtherMonths"),da=this._get(e,"selectOtherMonths");this._get(e,"calculateWeek");for(var O=this._getDefaultDate(e),ea="",ca=0;ca<x[0];ca++){var ia="";this.maxRows=4;for(var W=0;W<x[1];W++){var L=
this._daylightSavingAdjust(new Date(H,v,e.selectedDay)),X=" ui-corner-all",M="";if(y){M+='<div class="ui-datepicker-group';if(1<x[1])switch(W){case 0:M+=" ui-datepicker-group-first";X=" ui-corner-"+(h?"right":"left");break;case x[1]-1:M+=" ui-datepicker-group-last";X=" ui-corner-"+(h?"left":"right");break;default:M+=" ui-datepicker-group-middle",X=""}M+='">'}for(var M=M+('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+X+'">'+(/all|left/.test(X)&&0==ca?h?l:w:"")+(/all|right/.test(X)&&
0==ca?h?w:l:"")+this._generateMonthYearHeader(e,v,H,B,C,0<ca||0<W,Y,G)+'</div><table class="ui-datepicker-calendar"><thead><tr>'),Z=z?'<th class="ui-datepicker-week-col">'+this._get(e,"weekHeader")+"</th>":"",X=0;7>X;X++)var U=(X+m)%7,Z=Z+("<th"+(5<=(X+m+6)%7?' class="ui-datepicker-week-end"':"")+'><span title="'+F[U]+'">'+E[U]+"</span></th>");M+=Z+"</tr></thead><tbody>";Z=this._getDaysInMonth(H,v);H==e.selectedYear&&v==e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,Z));X=(this._getFirstDayOfMonth(H,
v)-m+7)%7;Z=Math.ceil((X+Z)/7);this.maxRows=Z=y?this.maxRows>Z?this.maxRows:Z:Z;for(var U=this._daylightSavingAdjust(new Date(H,v,1-X)),J=0;J<Z;J++){for(var M=M+"<tr>",na=z?'<td class="ui-datepicker-week-col">'+this._get(e,"calculateWeek")(U)+"</td>":"",X=0;7>X;X++){var ra=Q?Q.apply(e.input?e.input[0]:null,[U]):[!0,""],ka=U.getMonth()!=v,oa=ka&&!da||!ra[0]||B&&U<B||C&&U>C,na=na+('<td class="'+(5<=(X+m+6)%7?" ui-datepicker-week-end":"")+(ka?" ui-datepicker-other-month":"")+(U.getTime()==L.getTime()&&
v==e.selectedMonth&&e._keyEvent||O.getTime()==U.getTime()&&O.getTime()==L.getTime()?" "+this._dayOverClass:"")+(oa?" "+this._unselectableClass+" ui-state-disabled":"")+(ka&&!aa?"":" "+ra[1]+(U.getTime()==A.getTime()?" "+this._currentClass:"")+(U.getTime()==f.getTime()?" ui-datepicker-today":""))+'"'+((!ka||aa)&&ra[2]?' title="'+ra[2]+'"':"")+(oa?"":' data-handler="selectDay" data-event="click" data-month="'+U.getMonth()+'" data-year="'+U.getFullYear()+'"')+">"+(ka&&!aa?"&#xa0;":oa?'<span class="ui-state-default">'+
U.getDate()+"</span>":'<a class="ui-state-default'+(U.getTime()==f.getTime()?" ui-state-highlight":"")+(U.getTime()==A.getTime()?" ui-state-active":"")+(ka?" ui-priority-secondary":"")+'" href="#">'+U.getDate()+"</a>")+"</td>");U.setDate(U.getDate()+1);U=this._daylightSavingAdjust(U)}M+=na+"</tr>"}v++;11<v&&(v=0,H++);M+="</tbody></table>"+(y?"</div>"+(0<x[0]&&W==x[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");ia+=M}ea+=ia}return ea+=k+(d.ui.ie6&&!e.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':
""),e._keyEvent=!1,ea},_generateMonthYearHeader:function(d,e,f,h,k,l,m,v){var z=this._get(d,"changeMonth"),y=this._get(d,"changeYear"),A=this._get(d,"showMonthAfterYear"),B='<div class="ui-datepicker-title">',C="";if(l||!z)C+='<span class="ui-datepicker-month">'+m[e]+"</span>";else{m=h&&h.getFullYear()==f;for(var H=k&&k.getFullYear()==f,C=C+'<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">',w=0;12>w;w++)(!m||w>=h.getMonth())&&(!H||w<=k.getMonth())&&(C+='<option value="'+
w+'"'+(w==e?' selected="selected"':"")+">"+v[w]+"</option>");C+="</select>"}A||(B+=C+(l||!z||!y?"&#xa0;":""));if(!d.yearshtml)if(d.yearshtml="",l||!y)B+='<span class="ui-datepicker-year">'+f+"</span>";else{v=this._get(d,"yearRange").split(":");var F=(new Date).getFullYear();m=function(d){d=d.match(/c[+-].*/)?f+parseInt(d.substring(1),10):d.match(/[+-].*/)?F+parseInt(d,10):parseInt(d,10);return isNaN(d)?F:d};e=m(v[0]);v=Math.max(e,m(v[1]||""));e=h?Math.max(e,h.getFullYear()):e;v=k?Math.min(v,k.getFullYear()):
v;for(d.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';e<=v;e++)d.yearshtml+='<option value="'+e+'"'+(e==f?' selected="selected"':"")+">"+e+"</option>";d.yearshtml+="</select>";B+=d.yearshtml;d.yearshtml=null}return B+=this._get(d,"yearSuffix"),A&&(B+=(l||!z||!y?"&#xa0;":"")+C),B+="</div>",B},_adjustInstDate:function(d,e,f){var h=d.drawYear+("Y"==f?e:0),k=d.drawMonth+("M"==f?e:0);e=Math.min(d.selectedDay,this._getDaysInMonth(h,k))+("D"==f?e:0);h=this._restrictMinMax(d,
this._daylightSavingAdjust(new Date(h,k,e)));d.selectedDay=h.getDate();d.drawMonth=d.selectedMonth=h.getMonth();d.drawYear=d.selectedYear=h.getFullYear();("M"==f||"Y"==f)&&this._notifyChange(d)},_restrictMinMax:function(d,e){var f=this._getMinMaxDate(d,"min"),h=this._getMinMaxDate(d,"max"),f=f&&e<f?f:e;return f=h&&f>h?h:f,f},_notifyChange:function(d){var e=this._get(d,"onChangeMonthYear");e&&e.apply(d.input?d.input[0]:null,[d.selectedYear,d.selectedMonth+1,d])},_getNumberOfMonths:function(d){d=this._get(d,
"numberOfMonths");return null==d?[1,1]:"number"==typeof d?[1,d]:d},_getMinMaxDate:function(d,e){return this._determineDate(d,this._get(d,e+"Date"),null)},_getDaysInMonth:function(d,e){return 32-this._daylightSavingAdjust(new Date(d,e,32)).getDate()},_getFirstDayOfMonth:function(d,e){return(new Date(d,e,1)).getDay()},_canAdjustMonth:function(d,e,f,h){var k=this._getNumberOfMonths(d);f=this._daylightSavingAdjust(new Date(f,h+(0>e?e:k[0]*k[1]),1));return 0>e&&f.setDate(this._getDaysInMonth(f.getFullYear(),
f.getMonth())),this._isInRange(d,f)},_isInRange:function(d,e){var f=this._getMinMaxDate(d,"min"),h=this._getMinMaxDate(d,"max");return(!f||e.getTime()>=f.getTime())&&(!h||e.getTime()<=h.getTime())},_getFormatConfig:function(d){var e=this._get(d,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(d,"dayNamesShort"),dayNames:this._get(d,"dayNames"),monthNamesShort:this._get(d,"monthNamesShort"),monthNames:this._get(d,
"monthNames")}},_formatDate:function(d,e,f,h){e||(d.currentDay=d.selectedDay,d.currentMonth=d.selectedMonth,d.currentYear=d.selectedYear);e=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(h,f,e)):this._daylightSavingAdjust(new Date(d.currentYear,d.currentMonth,d.currentDay));return this.formatDate(this._get(d,"dateFormat"),e,this._getFormatConfig(d))}});d.fn.datepicker=function(e){if(!this.length)return this;d.datepicker.initialized||(d(document).mousedown(d.datepicker._checkExternalClick).find(document.body).append(d.datepicker.dpDiv),
d.datepicker.initialized=!0);var f=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!=e&&"getDate"!=e&&"widget"!=e?"option"==e&&2==arguments.length&&"string"==typeof arguments[1]?d.datepicker["_"+e+"Datepicker"].apply(d.datepicker,[this[0]].concat(f)):this.each(function(){"string"==typeof e?d.datepicker["_"+e+"Datepicker"].apply(d.datepicker,[this].concat(f)):d.datepicker._attachDatepicker(this,e)}):d.datepicker["_"+e+"Datepicker"].apply(d.datepicker,[this[0]].concat(f))};
d.datepicker=new e;d.datepicker.initialized=!1;d.datepicker.uuid=(new Date).getTime();d.datepicker.version="1.9.2";window["DP_jQuery_"+l]=d})(jQuery);
(function(d,f){var e={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},h={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};d.widget("ui.dialog",{version:"1.9.2",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var f=d(this).css(e).offset().top;0>f&&d(this).css("top",
e.top-f)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");"string"!=typeof this.originalTitle&&(this.originalTitle="");this.oldPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.options.title=this.options.title||this.originalTitle;var e=this,f=this.options,h=f.title||"&#160;",n,p,q,r;n=(this.uiDialog=d("<div>")).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+
f.dialogClass).css({display:"none",outline:0,zIndex:f.zIndex}).attr("tabIndex",-1).keydown(function(h){f.closeOnEscape&&!h.isDefaultPrevented()&&h.keyCode&&h.keyCode===d.ui.keyCode.ESCAPE&&(e.close(h),h.preventDefault())}).mousedown(function(d){e.moveToTop(!1,d)}).appendTo("body");this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(n);p=(this.uiDialogTitlebar=d("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").bind("mousedown",
function(){n.focus()}).prependTo(n);q=d("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(d){d.preventDefault();e.close(d)}).appendTo(p);(this.uiDialogTitlebarCloseText=d("<span>")).addClass("ui-icon ui-icon-closethick").text(f.closeText).appendTo(q);h=d("<span>").uniqueId().addClass("ui-dialog-title").html(h).prependTo(p);r=(this.uiDialogButtonPane=d("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");(this.uiButtonSet=
d("<div>")).addClass("ui-dialog-buttonset").appendTo(r);n.attr({role:"dialog","aria-labelledby":h.attr("id")});p.find("*").add(p).disableSelection();this._hoverable(q);this._focusable(q);f.draggable&&d.fn.draggable&&this._makeDraggable();f.resizable&&d.fn.resizable&&this._makeResizable();this._createButtons(f.buttons);this._isOpen=!1;d.fn.bgiframe&&n.bgiframe();this._on(n,{keydown:function(e){if(f.modal&&e.keyCode===d.ui.keyCode.TAB){var h=d(":tabbable",n),k=h.filter(":first"),h=h.filter(":last");
if(e.target===h[0]&&!e.shiftKey)return k.focus(1),!1;if(e.target===k[0]&&e.shiftKey)return h.focus(1),!1}}})},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){var d,e=this.oldPosition;this.overlay&&this.overlay.destroy();this.uiDialog.hide();this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");this.uiDialog.remove();this.originalTitle&&this.element.attr("title",this.originalTitle);d=e.parent.children().eq(e.index);d.length&&d[0]!==this.element[0]?
d.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},close:function(e){var f=this,h,n;if(this._isOpen&&!1!==this._trigger("beforeClose",e))return this._isOpen=!1,this.overlay&&this.overlay.destroy(),this.options.hide?this._hide(this.uiDialog,this.options.hide,function(){f._trigger("close",e)}):(this.uiDialog.hide(),this._trigger("close",e)),d.ui.dialog.overlay.resize(),this.options.modal&&(h=0,d(".ui-dialog").each(function(){this!==f.uiDialog[0]&&(n=d(this).css("z-index"),
isNaN(n)||(h=Math.max(h,n)))}),d.ui.dialog.maxZ=h),this},isOpen:function(){return this._isOpen},moveToTop:function(e,f){var h=this.options,n;return h.modal&&!e||!h.stack&&!h.modal?this._trigger("focus",f):(h.zIndex>d.ui.dialog.maxZ&&(d.ui.dialog.maxZ=h.zIndex),this.overlay&&(d.ui.dialog.maxZ+=1,d.ui.dialog.overlay.maxZ=d.ui.dialog.maxZ,this.overlay.$el.css("z-index",d.ui.dialog.overlay.maxZ)),n={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()},d.ui.dialog.maxZ+=1,this.uiDialog.css("z-index",
d.ui.dialog.maxZ),this.element.attr(n),this._trigger("focus",f),this)},open:function(){if(!this._isOpen){var e,f=this.options,h=this.uiDialog;return this._size(),this._position(f.position),h.show(f.show),this.overlay=f.modal?new d.ui.dialog.overlay(this):null,this.moveToTop(!0),e=this.element.find(":tabbable"),e.length||(e=this.uiDialogButtonPane.find(":tabbable"),e.length||(e=h)),e.eq(0).focus(),this._isOpen=!0,this._trigger("open"),this}},_createButtons:function(e){var f=this,h=!1;this.uiDialogButtonPane.remove();
this.uiButtonSet.empty();"object"==typeof e&&null!==e&&d.each(e,function(){return!(h=!0)});h?(d.each(e,function(e,h){var k,m;h=d.isFunction(h)?{click:h,text:e}:h;h=d.extend({type:"button"},h);m=h.click;h.click=function(){m.apply(f.element[0],arguments)};k=d("<button></button>",h).appendTo(f.uiButtonSet);d.fn.button&&k.button()}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)):this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function e(d){return{position:d.position,
offset:d.offset}}var f=this,h=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(h,m){d(this).addClass("ui-dialog-dragging");f._trigger("dragStart",h,e(m))},drag:function(d,h){f._trigger("drag",d,e(h))},stop:function(n,p){h.position=[p.position.left-f.document.scrollLeft(),p.position.top-f.document.scrollTop()];d(this).removeClass("ui-dialog-dragging");f._trigger("dragStop",n,e(p));d.ui.dialog.overlay.resize()}})},
_makeResizable:function(e){function h(d){return{originalPosition:d.originalPosition,originalSize:d.originalSize,position:d.position,size:d.size}}e=e===f?this.options.resizable:e;var m=this,n=this.options,p=this.uiDialog.css("position");e="string"==typeof e?e:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:n.maxWidth,maxHeight:n.maxHeight,minWidth:n.minWidth,minHeight:this._minHeight(),handles:e,start:function(e,f){d(this).addClass("ui-dialog-resizing");
m._trigger("resizeStart",e,h(f))},resize:function(d,e){m._trigger("resize",d,h(e))},stop:function(e,f){d(this).removeClass("ui-dialog-resizing");n.height=d(this).height();n.width=d(this).width();m._trigger("resizeStop",e,h(f));d.ui.dialog.overlay.resize()}}).css("position",p).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var d=this.options;return"auto"===d.height?d.minHeight:Math.min(d.minHeight,d.height)},_position:function(e){var f=[],h=[0,0],n;if(e){if("string"==
typeof e||"object"==typeof e&&"0"in e)f=e.split?e.split(" "):[e[0],e[1]],1===f.length&&(f[1]=f[0]),d.each(["left","top"],function(d,e){+f[d]===f[d]&&(h[d]=f[d],f[d]=e)}),e={my:f[0]+(0>h[0]?h[0]:"+"+h[0])+" "+f[1]+(0>h[1]?h[1]:"+"+h[1]),at:f.join(" ")};e=d.extend({},d.ui.dialog.prototype.options.position,e)}else e=d.ui.dialog.prototype.options.position;(n=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.position(e);n||this.uiDialog.hide()},_setOptions:function(f){var l=this,m={},n=
!1;d.each(f,function(d,f){l._setOption(d,f);d in e&&(n=!0);d in h&&(m[d]=f)});n&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",m)},_setOption:function(e,f){var h,n=this.uiDialog;switch(e){case "buttons":this._createButtons(f);break;case "closeText":this.uiDialogTitlebarCloseText.text(""+f);break;case "dialogClass":n.removeClass(this.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+f);break;case "disabled":f?n.addClass("ui-dialog-disabled"):
n.removeClass("ui-dialog-disabled");break;case "draggable":(h=n.is(":data(draggable)"))&&!f&&n.draggable("destroy");!h&&f&&this._makeDraggable();break;case "position":this._position(f);break;case "resizable":(h=n.is(":data(resizable)"))&&!f&&n.resizable("destroy");h&&"string"==typeof f&&n.resizable("option","handles",f);!h&&!1!==f&&this._makeResizable(f);break;case "title":d(".ui-dialog-title",this.uiDialogTitlebar).html(""+(f||"&#160;"))}this._super(e,f)},_size:function(){var e,f,h,n=this.options,
p=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});n.minWidth>n.width&&(n.width=n.minWidth);e=this.uiDialog.css({height:"auto",width:n.width}).outerHeight();f=Math.max(0,n.minHeight-e);"auto"===n.height?d.support.minHeight?this.element.css({minHeight:f,height:"auto"}):(this.uiDialog.show(),h=this.element.css("height","auto").height(),p||this.uiDialog.hide(),this.element.height(Math.max(h,f))):this.element.height(Math.max(n.height-e,0));this.uiDialog.is(":data(resizable)")&&
this.uiDialog.resizable("option","minHeight",this._minHeight())}});d.extend(d.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(d){d=d.attr("id");return d||(this.uuid+=1,d=this.uuid),"ui-dialog-title-"+d},overlay:function(e){this.$el=d.ui.dialog.overlay.create(e)}});d.extend(d.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:d.map("focus mousedown mouseup keydown keypress click".split(" "),function(d){return d+".dialog-overlay"}).join(" "),create:function(e){0===this.instances.length&&(setTimeout(function(){d.ui.dialog.overlay.instances.length&&
d(document).bind(d.ui.dialog.overlay.events,function(e){if(d(e.target).zIndex()<d.ui.dialog.overlay.maxZ)return!1})},1),d(window).bind("resize.dialog-overlay",d.ui.dialog.overlay.resize));var f=this.oldInstances.pop()||d("<div>").addClass("ui-widget-overlay");return d(document).bind("keydown.dialog-overlay",function(h){var n=d.ui.dialog.overlay.instances;0!==n.length&&n[n.length-1]===f&&e.options.closeOnEscape&&!h.isDefaultPrevented()&&h.keyCode&&h.keyCode===d.ui.keyCode.ESCAPE&&(e.close(h),h.preventDefault())}),
f.appendTo(document.body).css({width:this.width(),height:this.height()}),d.fn.bgiframe&&f.bgiframe(),this.instances.push(f),f},destroy:function(e){var f=d.inArray(e,this.instances),h=0;-1!==f&&this.oldInstances.push(this.instances.splice(f,1)[0]);0===this.instances.length&&d([document,window]).unbind(".dialog-overlay");e.height(0).width(0).remove();d.each(this.instances,function(){h=Math.max(h,this.css("z-index"))});this.maxZ=h},height:function(){var e,f;return d.ui.ie?(e=Math.max(document.documentElement.scrollHeight,
document.body.scrollHeight),f=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),e<f?d(window).height()+"px":e+"px"):d(document).height()+"px"},width:function(){var e,f;return d.ui.ie?(e=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),f=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),e<f?d(window).width()+"px":e+"px"):d(document).width()+"px"},resize:function(){var e=d([]);d.each(d.ui.dialog.overlay.instances,function(){e=e.add(this)});
e.css({width:0,height:0}).css({width:d.ui.dialog.overlay.width(),height:d.ui.dialog.overlay.height()})}});d.extend(d.ui.dialog.overlay.prototype,{destroy:function(){d.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
(function(d,f){var e=!1;d.widget("ui.menu",{version:"1.9.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,
d.proxy(function(d){this.options.disabled&&d.preventDefault()},this));this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true");this._on({"mousedown .ui-menu-item > a":function(d){d.preventDefault()},"click .ui-state-disabled > a":function(d){d.preventDefault()},"click .ui-menu-item:has(a)":function(f){var k=d(f.target).closest(".ui-menu-item");!e&&k.not(".ui-state-disabled").length&&(e=!0,this.select(f),k.has(".ui-menu").length?this.expand(f):this.element.is(":focus")||
(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){var f=d(e.currentTarget);f.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(e,f)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(d,e){var f=this.active||this.element.children(".ui-menu-item").eq(0);e||this.focus(d,f)},blur:function(e){this._delay(function(){d.contains(this.element[0],
this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(f){d(f.target).closest(".ui-menu").length||this.collapseAll(f);e=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();
this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=d(this);e.data("ui-menu-submenu-carat")&&e.remove()});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){function f(d){return d.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,
"\\$&")}var l,m,n,p,q=!0;switch(e.keyCode){case d.ui.keyCode.PAGE_UP:this.previousPage(e);break;case d.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case d.ui.keyCode.HOME:this._move("first","first",e);break;case d.ui.keyCode.END:this._move("last","last",e);break;case d.ui.keyCode.UP:this.previous(e);break;case d.ui.keyCode.DOWN:this.next(e);break;case d.ui.keyCode.LEFT:this.collapse(e);break;case d.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case d.ui.keyCode.ENTER:case d.ui.keyCode.SPACE:this._activate(e);
break;case d.ui.keyCode.ESCAPE:this.collapse(e);break;default:q=!1,l=this.previousFilter||"",m=String.fromCharCode(e.keyCode),n=!1,clearTimeout(this.filterTimer),m===l?n=!0:m=l+m,p=RegExp("^"+f(m),"i"),l=this.activeMenu.children(".ui-menu-item").filter(function(){return p.test(d(this).children("a").text())}),l=n&&-1!==l.index(this.active.next())?this.active.nextAll(".ui-menu-item"):l,l.length||(m=String.fromCharCode(e.keyCode),p=RegExp("^"+f(m),"i"),l=this.activeMenu.children(".ui-menu-item").filter(function(){return p.test(d(this).children("a").text())})),
l.length?(this.focus(e,l),1<l.length?(this.previousFilter=m,this.filterTimer=this._delay(function(){delete this.previousFilter},1E3)):delete this.previousFilter):delete this.previousFilter}q&&e.preventDefault()},_activate:function(d){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(d):this.select(d))},refresh:function(){var e,f=this.options.icons.submenu;e=this.element.find(this.options.menus);e.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,
"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=d(this),h=e.prev("a"),n=d("<span>").addClass("ui-menu-icon ui-icon "+f).data("ui-menu-submenu-carat",!0);h.attr("aria-haspopup","true").prepend(n);e.attr("aria-labelledby",h.attr("id"))});e=e.add(this.element);e.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()});e.children(":not(.ui-menu-item)").each(function(){var e=
d(this);/[^\-\u2014\u2013\s]/.test(e.text())||e.addClass("ui-widget-content ui-menu-divider")});e.children(".ui-state-disabled").attr("aria-disabled","true");this.active&&!d.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(d,e){var f;this.blur(d,d&&"focus"===d.type);this._scrollIntoView(e);this.active=e.first();f=this.active.children("a").addClass("ui-state-focus");this.options.role&&this.element.attr("aria-activedescendant",
f.attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");d&&"keydown"===d.type?this._close():this.timer=this._delay(function(){this._close()},this.delay);f=e.children(".ui-menu");f.length&&/^mouse/.test(d.type)&&this._startOpening(f);this.activeMenu=e.parent();this._trigger("focus",d,{item:e})},_scrollIntoView:function(e){var f,l,m,n,p,q;this._hasScroll()&&(f=parseFloat(d.css(this.activeMenu[0],"borderTopWidth"))||0,l=parseFloat(d.css(this.activeMenu[0],
"paddingTop"))||0,m=e.offset().top-this.activeMenu.offset().top-f-l,n=this.activeMenu.scrollTop(),p=this.activeMenu.height(),q=e.height(),0>m?this.activeMenu.scrollTop(n+m):m+q>p&&this.activeMenu.scrollTop(n+m-p+q))},blur:function(d,e){e||clearTimeout(this.timer);this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",d,{item:this.active}))},_startOpening:function(d){clearTimeout(this.timer);"true"===d.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close();
this._open(d)},this.delay))},_open:function(e){var f=d.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true");e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(f)},collapseAll:function(e,f){clearTimeout(this.timer);this.timer=this._delay(function(){var l=f?this.element:d(e&&e.target).closest(this.element.find(".ui-menu"));l.length||(l=this.element);this._close(l);this.blur(e);
this.activeMenu=l},this.delay)},_close:function(d){d||(d=this.active?this.active.parent():this.element);d.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(d){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(d,e))},expand:function(d){var e=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();
e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(d,e)}))},next:function(d){this._move("next","first",d)},previous:function(d){this._move("prev","last",d)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(d,e,f){var m;this.active&&("first"===d||"last"===d?m=this.active["first"===d?"prevAll":"nextAll"](".ui-menu-item").eq(-1):m=this.active[d+
"All"](".ui-menu-item").eq(0));if(!m||!m.length||!this.active)m=this.activeMenu.children(".ui-menu-item")[e]();this.focus(f,m)},nextPage:function(e){var f,l,m;this.active?this.isLastItem()||(this._hasScroll()?(l=this.active.offset().top,m=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return f=d(this),0>f.offset().top-l-m}),this.focus(e,f)):this.focus(e,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())):this.next(e)},previousPage:function(e){var f,
l,m;this.active?this.isFirstItem()||(this._hasScroll()?(l=this.active.offset().top,m=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return f=d(this),0<f.offset().top-l+m}),this.focus(e,f)):this.focus(e,this.activeMenu.children(".ui-menu-item").first())):this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||d(e.target).closest(".ui-menu-item");var f={item:this.active};this.active.has(".ui-menu").length||
this.collapseAll(e,!0);this._trigger("select",e,f)}})})(jQuery);
(function(d,f){d.widget("ui.progressbar",{version:"1.9.2",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=d("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");
this.valueDiv.remove()},value:function(d){return d===f?this._value():(this._setOption("value",d),this)},_setOption:function(d,f){"value"===d&&(this.options.value=f,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete"));this._super(d,f)},_value:function(){var d=this.options.value;return"number"!=typeof d&&(d=0),Math.min(this.options.max,Math.max(this.min,d))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var d=this.value(),f=this._percentage();
this.oldValue!==d&&(this.oldValue=d,this._trigger("change"));this.valueDiv.toggle(d>this.min).toggleClass("ui-corner-right",d===this.options.max).width(f.toFixed(0)+"%");this.element.attr("aria-valuenow",d)}})})(jQuery);
(function(d,f){d.widget("ui.slider",d.ui.mouse,{version:"1.9.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var e,f,k=this.options,l=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),m=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+
" ui-widget ui-widget-content ui-corner-all"+(k.disabled?" ui-slider-disabled ui-disabled":""));this.range=d([]);k.range&&(!0===k.range&&(k.values||(k.values=[this._valueMin(),this._valueMin()]),k.values.length&&2!==k.values.length&&(k.values=[k.values[0],k.values[0]])),this.range=d("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===k.range||"max"===k.range?" ui-slider-range-"+k.range:"")));f=k.values&&k.values.length||1;for(e=l.length;e<f;e++)m.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=l.add(d(m.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(d){d.preventDefault()}).mouseenter(function(){k.disabled||d(this).addClass("ui-state-hover")}).mouseleave(function(){d(this).removeClass("ui-state-hover")}).focus(function(){k.disabled?d(this).blur():(d(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),d(this).addClass("ui-state-focus"))}).blur(function(){d(this).removeClass("ui-state-focus")});
this.handles.each(function(e){d(this).data("ui-slider-handle-index",e)});this._on(this.handles,{keydown:function(e){var f,h,k,l=d(e.target).data("ui-slider-handle-index");switch(e.keyCode){case d.ui.keyCode.HOME:case d.ui.keyCode.END:case d.ui.keyCode.PAGE_UP:case d.ui.keyCode.PAGE_DOWN:case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,d(e.target).addClass("ui-state-active"),f=this._start(e,l),!1===
f))return}f=this.options.step;this.options.values&&this.options.values.length?h=k=this.values(l):h=k=this.value();switch(e.keyCode){case d.ui.keyCode.HOME:k=this._valueMin();break;case d.ui.keyCode.END:k=this._valueMax();break;case d.ui.keyCode.PAGE_UP:k=this._trimAlignValue(h+(this._valueMax()-this._valueMin())/5);break;case d.ui.keyCode.PAGE_DOWN:k=this._trimAlignValue(h-(this._valueMax()-this._valueMin())/5);break;case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:if(h===this._valueMax())return;k=this._trimAlignValue(h+
f);break;case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:if(h===this._valueMin())return;k=this._trimAlignValue(h-f)}this._slide(e,l,k)},keyup:function(e){var f=d(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,f),this._change(e,f),d(e.target).removeClass("ui-state-active"))}});this._refreshValue();this._animateOff=!1},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all");
this._mouseDestroy()},_mouseCapture:function(e){var f,k,l,m,n,p,q,r,t=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),f={x:e.pageX,y:e.pageY},k=this._normValueFromMouse(f),l=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var f=Math.abs(k-t.values(e));l>f&&(l=f,m=d(this),n=e)}),!0===u.range&&this.values(1)===u.min&&(n+=1,m=d(this.handles[n])),p=this._start(e,n),
!1===p?!1:(this._mouseSliding=!0,this._handleIndex=n,m.addClass("ui-state-active").focus(),q=m.offset(),r=!d(e.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=r?{left:0,top:0}:{left:e.pageX-q.left-m.width()/2,top:e.pageY-q.top-m.height()/2-(parseInt(m.css("borderTopWidth"),10)||0)-(parseInt(m.css("borderBottomWidth"),10)||0)+(parseInt(m.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,n,k),this._animateOff=!0,!0))},_mouseStart:function(){return!0},
_mouseDrag:function(d){var f=this._normValueFromMouse({x:d.pageX,y:d.pageY});return this._slide(d,this._handleIndex,f),!1},_mouseStop:function(d){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(d,this._handleIndex),this._change(d,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(d){var f,
k,l,m,n;return"horizontal"===this.orientation?(f=this.elementSize.width,k=d.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(f=this.elementSize.height,k=d.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),l=k/f,1<l&&(l=1),0>l&&(l=0),"vertical"===this.orientation&&(l=1-l),m=this._valueMax()-this._valueMin(),n=this._valueMin()+l*m,this._trimAlignValue(n)},_start:function(d,f){var k={handle:this.handles[f],value:this.value()};return this.options.values&&this.options.values.length&&
(k.value=this.values(f),k.values=this.values()),this._trigger("start",d,k)},_slide:function(d,f,k){var l,m,n;this.options.values&&this.options.values.length?(l=this.values(f?0:1),2===this.options.values.length&&!0===this.options.range&&(0===f&&k>l||1===f&&k<l)&&(k=l),k!==this.values(f)&&(m=this.values(),m[f]=k,n=this._trigger("slide",d,{handle:this.handles[f],value:k,values:m}),this.values(f?0:1),!1!==n&&this.values(f,k,!0))):k!==this.value()&&(n=this._trigger("slide",d,{handle:this.handles[f],value:k}),
!1!==n&&this.value(k))},_stop:function(d,f){var k={handle:this.handles[f],value:this.value()};this.options.values&&this.options.values.length&&(k.value=this.values(f),k.values=this.values());this._trigger("stop",d,k)},_change:function(d,f){if(!this._keySliding&&!this._mouseSliding){var k={handle:this.handles[f],value:this.value()};this.options.values&&this.options.values.length&&(k.value=this.values(f),k.values=this.values());this._trigger("change",d,k)}},value:function(d){if(arguments.length)this.options.value=
this._trimAlignValue(d),this._refreshValue(),this._change(null,0);else return this._value()},values:function(e,f){var k,l,m;if(1<arguments.length)this.options.values[e]=this._trimAlignValue(f),this._refreshValue(),this._change(null,e);else{if(!arguments.length)return this._values();if(!d.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();k=this.options.values;l=arguments[0];for(m=0;m<k.length;m+=1)k[m]=this._trimAlignValue(l[m]),this._change(null,
m);this._refreshValue()}},_setOption:function(e,f){var k,l=0;d.isArray(this.options.values)&&(l=this.options.values.length);d.Widget.prototype._setOption.apply(this,arguments);switch(e){case "disabled":f?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(k=0;k<l;k+=1)this._change(null,k);this._animateOff=!1;break;case "min":case "max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var d=this.options.value;return d=this._trimAlignValue(d),d},_values:function(d){var f,k;if(arguments.length)return f=this.options.values[d],
f=this._trimAlignValue(f),f;f=this.options.values.slice();for(k=0;k<f.length;k+=1)f[k]=this._trimAlignValue(f[k]);return f},_trimAlignValue:function(d){if(d<=this._valueMin())return this._valueMin();if(d>=this._valueMax())return this._valueMax();var f=0<this.options.step?this.options.step:1,k=(d-this._valueMin())%f;d-=k;return 2*Math.abs(k)>=f&&(d+=0<k?f:-f),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var e,
f,k,l,m,n=this.options.range,p=this.options,q=this,r=this._animateOff?!1:p.animate,t={};this.options.values&&this.options.values.length?this.handles.each(function(k){f=100*((q.values(k)-q._valueMin())/(q._valueMax()-q._valueMin()));t["horizontal"===q.orientation?"left":"bottom"]=f+"%";d(this).stop(1,1)[r?"animate":"css"](t,p.animate);!0===q.options.range&&("horizontal"===q.orientation?(0===k&&q.range.stop(1,1)[r?"animate":"css"]({left:f+"%"},p.animate),1===k&&q.range[r?"animate":"css"]({width:f-e+
"%"},{queue:!1,duration:p.animate})):(0===k&&q.range.stop(1,1)[r?"animate":"css"]({bottom:f+"%"},p.animate),1===k&&q.range[r?"animate":"css"]({height:f-e+"%"},{queue:!1,duration:p.animate})));e=f}):(k=this.value(),l=this._valueMin(),m=this._valueMax(),f=m!==l?100*((k-l)/(m-l)):0,t["horizontal"===this.orientation?"left":"bottom"]=f+"%",this.handle.stop(1,1)[r?"animate":"css"](t,p.animate),"min"===n&&"horizontal"===this.orientation&&this.range.stop(1,1)[r?"animate":"css"]({width:f+"%"},p.animate),"max"===
n&&"horizontal"===this.orientation&&this.range[r?"animate":"css"]({width:100-f+"%"},{queue:!1,duration:p.animate}),"min"===n&&"vertical"===this.orientation&&this.range.stop(1,1)[r?"animate":"css"]({height:f+"%"},p.animate),"max"===n&&"vertical"===this.orientation&&this.range[r?"animate":"css"]({height:100-f+"%"},{queue:!1,duration:p.animate}))}})})(jQuery);
(function(d){function f(d){return function(){var f=this.element.val();d.apply(this,arguments);this._refresh();f!==this.element.val()&&this._trigger("change")}}d.widget("ui.spinner",{version:"1.9.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);
this._setOption("min",this.options.min);this._setOption("step",this.options.step);this._value(this.element.val(),!0);this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},f=this.element;return d.each(["min","max","step"],function(d,l){var m=f.attr(l);void 0!==m&&m.length&&(e[l]=m)}),e},_events:{keydown:function(d){this._start(d)&&this._keydown(d)&&d.preventDefault()},keyup:"_stop",
focus:function(){this.previous=this.element.val()},blur:function(d){this.cancelBlur?delete this.cancelBlur:(this._refresh(),this.previous!==this.element.val()&&this._trigger("change",d))},mousewheel:function(d,f){if(f){if(!this.spinning&&!this._start(d))return!1;this._spin((0<f?1:-1)*this.options.step,d);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(d)},100);d.preventDefault()}},"mousedown .ui-spinner-button":function(e){function f(){this.element[0]===
this.document[0].activeElement||(this.element.focus(),this.previous=k,this._delay(function(){this.previous=k}))}var k;k=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();e.preventDefault();f.call(this);this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur;f.call(this)});!1!==this._start(e)&&this._repeat(null,d(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){if(d(e.currentTarget).hasClass("ui-state-active")){if(!1===
this._start(e))return!1;this._repeat(null,d(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)}},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var d=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton");this.buttons=d.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");this.buttons.height()>Math.ceil(0.5*d.height())&&0<d.height()&&
d.height(d.height());this.options.disabled&&this.disable()},_keydown:function(e){var f=this.options,k=d.ui.keyCode;switch(e.keyCode){case k.UP:return this._repeat(null,1,e),!0;case k.DOWN:return this._repeat(null,-1,e),!0;case k.PAGE_UP:return this._repeat(null,f.page,e),!0;case k.PAGE_DOWN:return this._repeat(null,-f.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+
this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(d){return!this.spinning&&!1===this._trigger("start",d)?!1:(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(d,f,k){d=d||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,f,k)},d);this._spin(f*this.options.step,k)},_spin:function(d,f){var k=this.value()||0;this.counter||
(this.counter=1);k=this._adjustValue(k+d*this._increment(this.counter));if(!this.spinning||!1!==this._trigger("spin",f,{value:k}))this._value(k),this.counter++},_increment:function(e){var f=this.options.incremental;return f?d.isFunction(f)?f(e):Math.floor(e*e*e/5E4-e*e/500+17*e/200+1):1},_precision:function(){var d=this._precisionOf(this.options.step);return null!==this.options.min&&(d=Math.max(d,this._precisionOf(this.options.min))),d},_precisionOf:function(d){d=d.toString();var f=d.indexOf(".");
return-1===f?0:d.length-f-1},_adjustValue:function(d){var f,k,l=this.options;return f=null!==l.min?l.min:0,k=d-f,k=Math.round(k/l.step)*l.step,d=f+k,d=parseFloat(d.toFixed(this._precision())),null!==l.max&&d>l.max?l.max:null!==l.min&&d<l.min?l.min:d},_stop:function(d){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",d))},_setOption:function(d,f){if("culture"===d||"numberFormat"===d){var k=this._parse(this.element.val());
this.options[d]=f;this.element.val(this._format(k))}else("max"===d||"min"===d||"step"===d)&&"string"==typeof f&&(f=this._parse(f)),this._super(d,f),"disabled"===d&&(f?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:f(function(d){this._super(d);this._value(this.element.val())}),_parse:function(d){return"string"==typeof d&&""!==d&&(d=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(d,10,
this.options.culture):+d),""===d||isNaN(d)?null:d},_format:function(d){return""===d?"":window.Globalize&&this.options.numberFormat?Globalize.format(d,this.options.numberFormat,this.options.culture):d},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(d,f){var k;""!==d&&(k=this._parse(d),null!==k&&(f||(k=this._adjustValue(k)),d=this._format(k)));this.element.val(d);this._refresh()},
_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.uiSpinner.replaceWith(this.element)},stepUp:f(function(d){this._stepUp(d)}),_stepUp:function(d){this._spin((d||1)*this.options.step)},stepDown:f(function(d){this._stepDown(d)}),_stepDown:function(d){this._spin((d||1)*-this.options.step)},pageUp:f(function(d){this._stepUp((d||1)*this.options.page)}),
pageDown:f(function(d){this._stepDown((d||1)*this.options.page)}),value:function(d){if(!arguments.length)return this._parse(this.element.val());f(this._value).call(this,d)},widget:function(){return this.uiSpinner}})})(jQuery);
(function(d,f){function e(d){return 1<d.hash.length&&d.href.replace(k,"")===location.href.replace(k,"").replace(/\s/g,"%20")}var h=0,k=/#.*$/;d.widget("ui.tabs",{version:"1.9.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var e=this,f=this.options,h=f.active,k=location.hash.substring(1);this.running=!1;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",
f.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(e){d(this).is(".ui-state-disabled")&&e.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){d(this).closest("li").is(".ui-state-disabled")&&this.blur()});this._processTabs();if(null===h&&(k&&this.tabs.each(function(e,f){if(d(f).attr("aria-controls")===k)return h=e,!1}),null===h&&(h=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null===h||-1===h))h=this.tabs.length?0:!1;!1!==
h&&(h=this.tabs.index(this.tabs.eq(h)),-1===h&&(h=f.collapsible?!1:0));f.active=h;!f.collapsible&&!1===f.active&&this.anchors.length&&(f.active=0);d.isArray(f.disabled)&&(f.disabled=d.unique(f.disabled.concat(d.map(this.tabs.filter(".ui-state-disabled"),function(d){return e.tabs.index(d)}))).sort());!1!==this.options.active&&this.anchors.length?this.active=this._findActive(this.options.active):this.active=d();this._refresh();this.active.length&&this.load(f.active)},_getCreateEventData:function(){return{tab:this.active,
panel:this.active.length?this._getPanelForTab(this.active):d()}},_tabKeydown:function(e){var f=d(this.document[0].activeElement).closest("li"),h=this.tabs.index(f),k=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case d.ui.keyCode.RIGHT:case d.ui.keyCode.DOWN:h++;break;case d.ui.keyCode.UP:case d.ui.keyCode.LEFT:k=!1;h--;break;case d.ui.keyCode.END:h=this.anchors.length-1;break;case d.ui.keyCode.HOME:h=0;break;case d.ui.keyCode.SPACE:e.preventDefault();clearTimeout(this.activating);this._activate(h);
return;case d.ui.keyCode.ENTER:e.preventDefault();clearTimeout(this.activating);this._activate(h===this.options.active?!1:h);return;default:return}e.preventDefault();clearTimeout(this.activating);h=this._focusNextTab(h,k);e.ctrlKey||(f.attr("aria-selected","false"),this.tabs.eq(h).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",h)},this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===d.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},
_handlePageNav:function(e){if(e.altKey&&e.keyCode===d.ui.keyCode.PAGE_UP)return this._activate(this._focusNextTab(this.options.active-1,!1)),!0;if(e.altKey&&e.keyCode===d.ui.keyCode.PAGE_DOWN)return this._activate(this._focusNextTab(this.options.active+1,!0)),!0},_findNextTab:function(e,f){for(var h=this.tabs.length-1;-1!==d.inArray((e>h&&(e=0),0>e&&(e=h),e),this.options.disabled);)e=f?e+1:e-1;return e},_focusNextTab:function(d,e){return d=this._findNextTab(d,e),this.tabs.eq(d).focus(),d},_setOption:function(d,
e){"active"===d?this._activate(e):"disabled"===d?this._setupDisabled(e):(this._super(d,e),"collapsible"===d&&(this.element.toggleClass("ui-tabs-collapsible",e),!e&&!1===this.options.active&&this._activate(0)),"event"===d&&this._setupEvents(e),"heightStyle"===d&&this._setupHeightStyle(e))},_tabId:function(d){return d.attr("aria-controls")||"ui-tabs-"+ ++h},_sanitizeSelector:function(d){return d?d.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,f=this.tablist.children(":has(a[href])");
e.disabled=d.map(f.filter(".ui-state-disabled"),function(d){return f.index(d)});this._processTabs();!1===e.active||!this.anchors.length?(e.active=!1,this.active=d()):this.active.length&&!d.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=d()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active);this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);
this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"});this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var f=
this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist");this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return d("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=d();this.anchors.each(function(h,k){var p,q,r,t=d(k).uniqueId().attr("id"),u=d(k).closest("li"),
x=u.attr("aria-controls");e(k)?(p=k.hash,q=f.element.find(f._sanitizeSelector(p))):(r=f._tabId(u),p="#"+r,q=f.element.find(p),q.length||(q=f._createPanel(r),q.insertAfter(f.panels[h-1]||f.tablist)),q.attr("aria-live","polite"));q.length&&(f.panels=f.panels.add(q));x&&u.data("ui-tabs-aria-controls",x);u.attr({"aria-controls":p.substring(1),"aria-labelledby":t});q.attr("aria-labelledby",t)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},
_createPanel:function(e){return d("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){d.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var f=0,h;h=this.tabs[f];f++)!0===e||-1!==d.inArray(f,e)?d(h).addClass("ui-state-disabled").attr("aria-disabled","true"):d(h).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var f={click:function(d){d.preventDefault()}};
e&&d.each(e.split(" "),function(d,e){f[e]="_eventHandler"});this._off(this.anchors.add(this.tabs).add(this.panels));this._on(this.anchors,f);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(e){var f,h,k=this.element.parent();"fill"===e?(d.support.minHeight||(h=k.css("overflow"),k.css("overflow","hidden")),f=k.height(),this.element.siblings(":visible").each(function(){var e=
d(this),h=e.css("position");"absolute"===h||"fixed"===h||(f-=e.outerHeight(!0))}),h&&k.css("overflow",h),this.element.children().not(this.panels).each(function(){f-=d(this).outerHeight(!0)}),this.panels.each(function(){d(this).height(Math.max(0,f-d(this).innerHeight()+d(this).height()))}).css("overflow","auto")):"auto"===e&&(f=0,this.panels.each(function(){f=Math.max(f,d(this).height("").height())}).height(f))},_eventHandler:function(e){var f=this.options,h=this.active,k=d(e.currentTarget).closest("li"),
q=k[0]===h[0],r=q&&f.collapsible,t=r?d():this._getPanelForTab(k),u=h.length?this._getPanelForTab(h):d(),h={oldTab:h,oldPanel:u,newTab:r?d():k,newPanel:t};e.preventDefault();if(!k.hasClass("ui-state-disabled")&&!k.hasClass("ui-tabs-loading")&&!this.running&&!(q&&!f.collapsible||!1===this._trigger("beforeActivate",e,h)))f.active=r?!1:this.tabs.index(k),this.active=q?d():k,this.xhr&&this.xhr.abort(),!u.length&&!t.length&&d.error("jQuery UI Tabs: Mismatching fragment identifier."),t.length&&this.load(this.tabs.index(k),
e),this._toggle(e,h)},_toggle:function(e,f){function h(){q.running=!1;q._trigger("activate",e,f)}function k(){f.newTab.closest("li").addClass("ui-tabs-active ui-state-active");r.length&&q.options.show?q._show(r,q.options.show,h):(r.show(),h())}var q=this,r=f.newPanel,t=f.oldPanel;this.running=!0;t.length&&this.options.hide?this._hide(t,this.options.hide,function(){f.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");k()}):(f.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),
t.hide(),k());t.attr({"aria-expanded":"false","aria-hidden":"true"});f.oldTab.attr("aria-selected","false");r.length&&t.length?f.oldTab.attr("tabIndex",-1):r.length&&this.tabs.filter(function(){return 0===d(this).attr("tabIndex")}).attr("tabIndex",-1);r.attr({"aria-expanded":"true","aria-hidden":"false"});f.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(e){e=this._findActive(e);e[0]!==this.active[0]&&(e.length||(e=this.active),e=e.find(".ui-tabs-anchor")[0],this._eventHandler({target:e,
currentTarget:e,preventDefault:d.noop}))},_findActive:function(e){return!1===e?d():this.tabs.eq(e)},_getIndex:function(d){return"string"==typeof d&&(d=this.anchors.index(this.anchors.filter("[href$='"+d+"']"))),d},_destroy:function(){this.xhr&&this.xhr.abort();this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeData("href.tabs").removeData("load.tabs").removeUniqueId();
this.tabs.add(this.panels).each(function(){d.data(this,"ui-tabs-destroy")?d(this).remove():d(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")});this.tabs.each(function(){var e=d(this),f=e.data("ui-tabs-aria-controls");
f?e.attr("aria-controls",f):e.removeAttr("aria-controls")});this.panels.show();"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(e){var h=this.options.disabled;!1!==h&&(e===f?h=!1:(e=this._getIndex(e),d.isArray(h)?h=d.map(h,function(d){return d!==e?d:null}):h=d.map(this.tabs,function(d,f){return f!==e?f:null})),this._setupDisabled(h))},disable:function(e){var h=this.options.disabled;if(!0!==h){if(e===f)h=!0;else{e=this._getIndex(e);if(-1!==d.inArray(e,h))return;d.isArray(h)?
h=d.merge([e],h).sort():h=[e]}this._setupDisabled(h)}},load:function(f,h){f=this._getIndex(f);var k=this,p=this.tabs.eq(f),q=p.find(".ui-tabs-anchor"),r=this._getPanelForTab(p),t={tab:p,panel:r};e(q[0])||(this.xhr=d.ajax(this._ajaxSettings(q,h,t)))&&"canceled"!==this.xhr.statusText&&(p.addClass("ui-tabs-loading"),r.attr("aria-busy","true"),this.xhr.success(function(d){setTimeout(function(){r.html(d);k._trigger("load",h,t)},1)}).complete(function(d,e){setTimeout(function(){"abort"===e&&k.panels.stop(!1,
!0);p.removeClass("ui-tabs-loading");r.removeAttr("aria-busy");d===k.xhr&&delete k.xhr},1)}))},_ajaxSettings:function(e,f,h){var k=this;return{url:e.attr("href"),beforeSend:function(e,l){return k._trigger("beforeLoad",f,d.extend({jqXHR:e,ajaxSettings:l},h))}}},_getPanelForTab:function(e){e=d(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+e))}});!1!==d.uiBackCompat&&(d.ui.tabs.prototype._ui=function(d,e){return{tab:d,panel:e,index:this.anchors.index(d)}},d.widget("ui.tabs",
d.ui.tabs,{url:function(d,e){this.anchors.eq(d).attr("href",e)}}),d.widget("ui.tabs",d.ui.tabs,{options:{ajaxOptions:null,cache:!1},_create:function(){this._super();var e=this;this._on({tabsbeforeload:function(f,h){d.data(h.tab[0],"cache.tabs")?f.preventDefault():h.jqXHR.success(function(){e.options.cache&&d.data(h.tab[0],"cache.tabs",!0)})}})},_ajaxSettings:function(e,f,h){var k=this.options.ajaxOptions;return d.extend({},k,{error:function(d,e){try{k.error(d,e,h.tab.closest("li").index(),h.tab[0])}catch(f){}}},
this._superApply(arguments))},_setOption:function(d,e){"cache"===d&&!1===e&&this.anchors.removeData("cache.tabs");this._super(d,e)},_destroy:function(){this.anchors.removeData("cache.tabs");this._super()},url:function(d){this.anchors.eq(d).removeData("cache.tabs");this._superApply(arguments)}}),d.widget("ui.tabs",d.ui.tabs,{abort:function(){this.xhr&&this.xhr.abort()}}),d.widget("ui.tabs",d.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super();this._on({tabsbeforeload:function(d,
e){if(d.target===this.element[0]&&this.options.spinner){var f=e.tab.find("span"),h=f.html();f.html(this.options.spinner);e.jqXHR.complete(function(){f.html(h)})}}})}}),d.widget("ui.tabs",d.ui.tabs,{options:{enable:null,disable:null},enable:function(e){var f=this.options,h;if(e&&!0===f.disabled||d.isArray(f.disabled)&&-1!==d.inArray(e,f.disabled))h=!0;this._superApply(arguments);h&&this._trigger("enable",null,this._ui(this.anchors[e],this.panels[e]))},disable:function(e){var f=this.options,h;if(e&&
!1===f.disabled||d.isArray(f.disabled)&&-1===d.inArray(e,f.disabled))h=!0;this._superApply(arguments);h&&this._trigger("disable",null,this._ui(this.anchors[e],this.panels[e]))}}),d.widget("ui.tabs",d.ui.tabs,{options:{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},add:function(e,h,k){k===f&&(k=this.anchors.length);var p,q,r=this.options;h=d(r.tabTemplate.replace(/#\{href\}/g,e).replace(/#\{label\}/g,h));e=e.indexOf("#")?this._tabId(h):e.replace("#","");return h.addClass("ui-state-default ui-corner-top").data("ui-tabs-destroy",
!0),h.attr("aria-controls",e),p=k>=this.tabs.length,q=this.element.find("#"+e),q.length||(q=this._createPanel(e),p?0<k?q.insertAfter(this.panels.eq(-1)):q.appendTo(this.element):q.insertBefore(this.panels[k])),q.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide(),p?h.appendTo(this.tablist):h.insertBefore(this.tabs[k]),r.disabled=d.map(r.disabled,function(d){return d>=k?++d:d}),this.refresh(),1===this.tabs.length&&!1===r.active&&this.option("active",0),this._trigger("add",null,this._ui(this.anchors[k],
this.panels[k])),this},remove:function(e){e=this._getIndex(e);var f=this.options,h=this.tabs.eq(e).remove(),k=this._getPanelForTab(h).remove();return h.hasClass("ui-tabs-active")&&2<this.anchors.length&&this._activate(e+(e+1<this.anchors.length?1:-1)),f.disabled=d.map(d.grep(f.disabled,function(d){return d!==e}),function(d){return d>=e?--d:d}),this.refresh(),this._trigger("remove",null,this._ui(h.find("a")[0],k[0])),this}}),d.widget("ui.tabs",d.ui.tabs,{length:function(){return this.anchors.length}}),
d.widget("ui.tabs",d.ui.tabs,{options:{idPrefix:"ui-tabs-"},_tabId:function(e){e=e.is("li")?e.find("a[href]"):e;return e=e[0],d(e).closest("li").attr("aria-controls")||e.title&&e.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF\-]/g,"")||this.options.idPrefix+ ++h}}),d.widget("ui.tabs",d.ui.tabs,{options:{panelTemplate:"<div></div>"},_createPanel:function(e){return d(this.options.panelTemplate).attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)}}),
d.widget("ui.tabs",d.ui.tabs,{_create:function(){var d=this.options;null===d.active&&d.selected!==f&&(d.active=-1===d.selected?!1:d.selected);this._super();d.selected=d.active;!1===d.selected&&(d.selected=-1)},_setOption:function(d,e){if("selected"!==d)return this._super(d,e);var f=this.options;this._super("active",-1===e?!1:e);f.selected=f.active;!1===f.selected&&(f.selected=-1)},_eventHandler:function(){this._superApply(arguments);this.options.selected=this.options.active;!1===this.options.selected&&
(this.options.selected=-1)}}),d.widget("ui.tabs",d.ui.tabs,{options:{show:null,select:null},_create:function(){this._super();!1!==this.options.active&&this._trigger("show",null,this._ui(this.active.find(".ui-tabs-anchor")[0],this._getPanelForTab(this.active)[0]))},_trigger:function(d,e,f){var h,k,r=this._superApply(arguments);return r?("beforeActivate"===d?(h=f.newTab.length?f.newTab:f.oldTab,k=f.newPanel.length?f.newPanel:f.oldPanel,r=this._super("select",e,{tab:h.find(".ui-tabs-anchor")[0],panel:k[0],
index:h.closest("li").index()})):"activate"===d&&f.newTab.length&&(r=this._super("show",e,{tab:f.newTab.find(".ui-tabs-anchor")[0],panel:f.newPanel[0],index:f.newTab.closest("li").index()})),r):!1}}),d.widget("ui.tabs",d.ui.tabs,{select:function(d){d=this._getIndex(d);if(-1===d){if(!this.options.collapsible||-1===this.options.selected)return;d=this.options.selected}this.anchors.eq(d).trigger(this.options.event+this.eventNamespace)}}),function(){var e=0;d.widget("ui.tabs",d.ui.tabs,{options:{cookie:null},
_create:function(){var d=this.options,e;null==d.active&&d.cookie&&(e=parseInt(this._cookie(),10),-1===e&&(e=!1),d.active=e);this._super()},_cookie:function(f){var h=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++e)];return arguments.length&&(h.push(!1===f?-1:f),h.push(this.options.cookie)),d.cookie.apply(null,h)},_refresh:function(){this._super();this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_eventHandler:function(){this._superApply(arguments);this.options.cookie&&
this._cookie(this.options.active,this.options.cookie)},_destroy:function(){this._super();this.options.cookie&&this._cookie(null,this.options.cookie)}})}(),d.widget("ui.tabs",d.ui.tabs,{_trigger:function(e,f,h){h=d.extend({},h);return"load"===e&&(h.panel=h.panel[0],h.tab=h.tab.find(".ui-tabs-anchor")[0]),this._super(e,f,h)}}),d.widget("ui.tabs",d.ui.tabs,{options:{fx:null},_getFx:function(){var e,f,h=this.options.fx;return h&&(d.isArray(h)?(e=h[0],f=h[1]):e=f=h),h?{show:f,hide:e}:null},_toggle:function(d,
e){function f(){k.running=!1;k._trigger("activate",d,e)}function h(){e.newTab.closest("li").addClass("ui-tabs-active ui-state-active");r.length&&u.show?r.animate(u.show,u.show.duration,function(){f()}):(r.show(),f())}var k=this,r=e.newPanel,t=e.oldPanel,u=this._getFx();if(!u)return this._super(d,e);k.running=!0;t.length&&u.hide?t.animate(u.hide,u.hide.duration,function(){e.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");h()}):(e.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),
t.hide(),h())}}))})(jQuery);
(function(d){function f(e,f){var h=(e.attr("aria-describedby")||"").split(/\s+/);h.push(f);e.data("ui-tooltip-id",f).attr("aria-describedby",d.trim(h.join(" ")))}function e(e){var f=e.data("ui-tooltip-id"),h=(e.attr("aria-describedby")||"").split(/\s+/),f=d.inArray(f,h);-1!==f&&h.splice(f,1);e.removeData("ui-tooltip-id");(h=d.trim(h.join(" ")))?e.attr("aria-describedby",h):e.removeAttr("aria-describedby")}var h=0;d.widget("ui.tooltip",{version:"1.9.2",options:{content:function(){return d(this).attr("title")},hide:!0,
items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};this.options.disabled&&this._disable()},_setOption:function(e,f){var h=this;"disabled"===e?(this[f?"_disable":"_enable"](),this.options[e]=f):(this._super(e,f),"content"===e&&d.each(this.tooltips,function(d,e){h._updateContent(e)}))},_disable:function(){var e=
this;d.each(this.tooltips,function(f,h){var n=d.Event("blur");n.target=n.currentTarget=h[0];e.close(n,!0)});this.element.find(this.options.items).andSelf().each(function(){var e=d(this);e.is("[title]")&&e.data("ui-tooltip-title",e.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var e=d(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var f=this,h=d(e?e.target:this.element).closest(this.options.items);
h.length&&!h.data("ui-tooltip-id")&&(h.attr("title")&&h.data("ui-tooltip-title",h.attr("title")),h.data("ui-tooltip-open",!0),e&&"mouseover"===e.type&&h.parents().each(function(){var e=d(this),h;e.data("ui-tooltip-open")&&(h=d.Event("blur"),h.target=h.currentTarget=this,f.close(h,!0));e.attr("title")&&(e.uniqueId(),f.parents[this.id]={element:this,title:e.attr("title")},e.attr("title",""))}),this._updateContent(h,e))},_updateContent:function(d,e){var f;f=this.options.content;var h=this,p=e?e.type:
null;if("string"==typeof f)return this._open(e,d,f);(f=f.call(d[0],function(f){d.data("ui-tooltip-open")&&h._delay(function(){e&&(e.type=p);this._open(e,d,f)})}))&&this._open(e,d,f)},_open:function(e,h,m){function n(d){r.of=d;p.is(":hidden")||p.position(r)}var p,q,r=d.extend({},this.options.position);if(m)if(p=this._find(h),p.length)p.find(".ui-tooltip-content").html(m);else{h.is("[title]")&&(e&&"mouseover"===e.type?h.attr("title",""):h.removeAttr("title"));p=this._tooltip(h);f(h,p.attr("id"));p.find(".ui-tooltip-content").html(m);
this.options.track&&e&&/^mouse/.test(e.type)?(this._on(this.document,{mousemove:n}),n(e)):p.position(d.extend({of:h},this.options.position));p.hide();this._show(p,this.options.show);this.options.show&&this.options.show.delay&&(q=setInterval(function(){p.is(":visible")&&(n(r.of),clearInterval(q))},d.fx.interval));this._trigger("open",e,{tooltip:p});m={keyup:function(e){e.keyCode===d.ui.keyCode.ESCAPE&&(e=d.Event(e),e.currentTarget=h[0],this.close(e,!0))},remove:function(){this._removeTooltip(p)}};
if(!e||"mouseover"===e.type)m.mouseleave="close";if(!e||"focusin"===e.type)m.focusout="close";this._on(!0,h,m)}},close:function(f){var h=this,m=d(f?f.currentTarget:this.element),n=this._find(m);this.closing||(m.data("ui-tooltip-title")&&m.attr("title",m.data("ui-tooltip-title")),e(m),n.stop(!0),this._hide(n,this.options.hide,function(){h._removeTooltip(d(this))}),m.removeData("ui-tooltip-open"),this._off(m,"mouseleave focusout keyup"),m[0]!==this.element[0]&&this._off(m,"remove"),this._off(this.document,
"mousemove"),f&&"mouseleave"===f.type&&d.each(this.parents,function(e,f){d(f.element).attr("title",f.title);delete h.parents[e]}),this.closing=!0,this._trigger("close",f,{tooltip:n}),this.closing=!1)},_tooltip:function(e){var f="ui-tooltip-"+h++,m=d("<div>").attr({id:f,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return d("<div>").addClass("ui-tooltip-content").appendTo(m),m.appendTo(this.document[0].body),d.fn.bgiframe&&m.bgiframe(),
this.tooltips[f]=e,m},_find:function(e){return(e=e.data("ui-tooltip-id"))?d("#"+e):d()},_removeTooltip:function(d){d.remove();delete this.tooltips[d.attr("id")]},_destroy:function(){var e=this;d.each(this.tooltips,function(f,h){var n=d.Event("blur");n.target=n.currentTarget=h[0];e.close(n,!0);d("#"+f).remove();h.data("ui-tooltip-title")&&(h.attr("title",h.data("ui-tooltip-title")),h.removeData("ui-tooltip-title"))})}})})(jQuery);
jQuery.effects||function(d,f){var e=!1!==d.uiBackCompat;d.effects={effect:{}};(function(e,f){function l(d,e,f){var h=u[e.type]||{};return null==d?f||!e.def?null:e.def:(d=h.floor?~~d:parseFloat(d),isNaN(d)?e.def:h.mod?(d+h.mod)%h.mod:0>d?0:h.max<d?h.max:d)}function m(d){var f=r(),k=f._rgba=[];return d=d.toLowerCase(),y(q,function(e,h){var l,m=h.re.exec(d),m=m&&h.parse(m),n=h.space||"rgba";if(m)return l=f[n](m),f[t[n].cache]=l[t[n].cache],k=f._rgba=l._rgba,!1}),k.length?("0,0,0,0"===k.join()&&e.extend(k,
z.transparent),f):z[d]}function n(d,e,f){return f=(f+1)%1,1>6*f?d+6*(e-d)*f:1>2*f?e:2>3*f?d+6*(e-d)*(2/3-f):d}var p=/^([\-+])=\s*(\d+\.?\d*)/,q=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(d){return[d[1],d[2],d[3],d[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(d){return[2.55*d[1],2.55*d[2],2.55*d[3],d[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,
parse:function(d){return[parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(d){return[parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(d){return[d[1],d[2]/100,d[3]/100,d[4]]}}],r=e.Color=function(d,f,k,l){return new e.Color.fn.parse(d,f,k,l)},t={rgba:{props:{red:{idx:0,type:"byte"},
green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},x=r.support={},v=e("<p>")[0],z,y=e.each;v.style.cssText="background-color:rgba(1,1,1,.5)";x.rgba=-1<v.style.backgroundColor.indexOf("rgba");y(t,function(d,e){e.cache="_"+d;e.props.alpha={idx:3,type:"percent",def:1}});r.fn=e.extend(r.prototype,{parse:function(n,p,q,
u){if(n===f)return this._rgba=[null,null,null,null],this;if(n.jquery||n.nodeType)n=e(n).css(p),p=f;var v=this,x=e.type(n),E=this._rgba=[];p!==f&&(n=[n,p,q,u],x="array");if("string"===x)return this.parse(m(n)||z._default);if("array"===x)return y(t.rgba.props,function(d,e){E[e.idx]=l(n[e.idx],e)}),this;if("object"===x)return n instanceof r?y(t,function(d,e){n[e.cache]&&(v[e.cache]=n[e.cache].slice())}):y(t,function(e,f){var h=f.cache;y(f.props,function(d,e){if(!v[h]&&f.to){if("alpha"===d||null==n[d])return;
v[h]=f.to(v._rgba)}v[h][e.idx]=l(n[d],e,!0)});v[h]&&0>d.inArray(null,v[h].slice(0,3))&&(v[h][3]=1,f.from&&(v._rgba=f.from(v[h])))}),this},is:function(d){var e=r(d),f=!0,h=this;return y(t,function(d,k){var l,m=e[k.cache];return m&&(l=h[k.cache]||k.to&&k.to(h._rgba)||[],y(k.props,function(d,e){if(null!=m[e.idx])return f=m[e.idx]===l[e.idx],f})),f}),f},_space:function(){var d=[],e=this;return y(t,function(f,h){e[h.cache]&&d.push(f)}),d.pop()},transition:function(d,e){var f=r(d),h=f._space(),k=t[h],m=
0===this.alpha()?r("transparent"):this,n=m[k.cache]||k.to(m._rgba),p=n.slice();return f=f[k.cache],y(k.props,function(d,h){var k=h.idx,m=n[k],q=f[k],r=u[h.type]||{};null!==q&&(null===m?p[k]=q:(r.mod&&(q-m>r.mod/2?m+=r.mod:m-q>r.mod/2&&(m-=r.mod)),p[k]=l((q-m)*e+m,h)))}),this[h](p)},blend:function(d){if(1===this._rgba[3])return this;var f=this._rgba.slice(),k=f.pop(),l=r(d)._rgba;return r(e.map(f,function(d,e){return(1-k)*l[e]+k*d}))},toRgbaString:function(){var d="rgba(",f=e.map(this._rgba,function(d,
e){return null==d?2<e?1:0:d});return 1===f[3]&&(f.pop(),d="rgb("),d+f.join()+")"},toHslaString:function(){var d="hsla(",f=e.map(this.hsla(),function(d,e){return null==d&&(d=2<e?1:0),e&&3>e&&(d=Math.round(100*d)+"%"),d});return 1===f[3]&&(f.pop(),d="hsl("),d+f.join()+")"},toHexString:function(d){var f=this._rgba.slice(),k=f.pop();return d&&f.push(~~(255*k)),"#"+e.map(f,function(d){return d=(d||0).toString(16),1===d.length?"0"+d:d}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":
this.toRgbaString()}});r.fn.parse.prototype=r.fn;t.hsla.to=function(d){if(null==d[0]||null==d[1]||null==d[2])return[null,null,null,d[3]];var e=d[0]/255,f=d[1]/255,h=d[2]/255;d=d[3];var k=Math.max(e,f,h),l=Math.min(e,f,h),m=k-l,n=k+l,p=0.5*n,q,r;return l===k?q=0:e===k?q=60*(f-h)/m+360:f===k?q=60*(h-e)/m+120:q=60*(e-f)/m+240,0===p||1===p?r=p:0.5>=p?r=m/n:r=m/(2-n),[Math.round(q)%360,r,p,null==d?1:d]};t.hsla.from=function(d){if(null==d[0]||null==d[1]||null==d[2])return[null,null,null,d[3]];var e=d[0]/
360,f=d[1],h=d[2];d=d[3];f=0.5>=h?h*(1+f):h+f-h*f;h=2*h-f;return[Math.round(255*n(h,f,e+1/3)),Math.round(255*n(h,f,e)),Math.round(255*n(h,f,e-1/3)),d]};y(t,function(d,m){var n=m.props,q=m.cache,u=m.to,t=m.from;r.fn[d]=function(d){u&&!this[q]&&(this[q]=u(this._rgba));if(d===f)return this[q].slice();var m,p=e.type(d),v="array"===p||"object"===p?d:arguments,x=this[q].slice();return y(n,function(d,e){var f=v["object"===p?d:e.idx];null==f&&(f=x[e.idx]);x[e.idx]=l(f,e)}),t?(m=r(t(x)),m[q]=x,m):r(x)};y(n,
function(f,k){r.fn[f]||(r.fn[f]=function(l){var m=e.type(l),n="alpha"===f?this._hsla?"hsla":"rgba":d,q=this[n](),r=q[k.idx],u;return"undefined"===m?r:("function"===m&&(l=l.call(this,r),m=e.type(l)),null==l&&k.empty?this:("string"===m&&(u=p.exec(l),u&&(l=r+parseFloat(u[2])*("+"===u[1]?1:-1))),q[k.idx]=l,this[n](q)))})})});y("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),function(d,
f){e.cssHooks[f]={set:function(d,k){var l,n="";if("string"!==e.type(k)||(l=m(k))){k=r(l||k);if(!x.rgba&&1!==k._rgba[3]){for(l="backgroundColor"===f?d.parentNode:d;(""===n||"transparent"===n)&&l&&l.style;)try{n=e.css(l,"backgroundColor"),l=l.parentNode}catch(p){}k=k.blend(n&&"transparent"!==n?n:"_default")}k=k.toRgbaString()}try{d.style[f]=k}catch(q){}}};e.fx.step[f]=function(d){d.colorInit||(d.start=r(d.elem,f),d.end=r(d.end),d.colorInit=!0);e.cssHooks[f].set(d.elem,d.start.transition(d.end,d.pos))}});
e.cssHooks.borderColor={expand:function(d){var e={};return y(["Top","Right","Bottom","Left"],function(f,h){e["border"+h+"Color"]=d}),e}};z=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);(function(){function e(){var f=this.ownerDocument.defaultView?
this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,h={},k,l;if(f&&f.length&&f[0]&&f[f[0]])for(l=f.length;l--;)k=f[l],"string"==typeof f[k]&&(h[d.camelCase(k)]=f[k]);else for(k in f)"string"==typeof f[k]&&(h[k]=f[k]);return h}var k=["add","remove","toggle"],l={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};d.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,f){d.fx.step[f]=
function(d){if("none"!==d.end&&!d.setAttr||1===d.pos&&!d.setAttr)jQuery.style(d.elem,f,d.end),d.setAttr=!0}});d.effects.animateClass=function(f,n,p,q){var r=d.speed(n,p,q);return this.queue(function(){var n=d(this),p=n.attr("class")||"",q,v=r.children?n.find("*").andSelf():n,v=v.map(function(){return{el:d(this),start:e.call(this)}});q=function(){d.each(k,function(d,e){f[e]&&n[e+"Class"](f[e])})};q();v=v.map(function(){this.end=e.call(this.el[0]);var f=this.start,k=this.end,m={},n,p;for(n in k)p=k[n],
f[n]!==p&&!l[n]&&(d.fx.step[n]||!isNaN(parseFloat(p)))&&(m[n]=p);return this.diff=m,this});n.attr("class",p);v=v.map(function(){var e=this,f=d.Deferred(),h=jQuery.extend({},r,{queue:!1,complete:function(){f.resolve(e)}});return this.el.animate(this.diff,h),f.promise()});d.when.apply(d,v.get()).done(function(){q();d.each(arguments,function(){var e=this.el;d.each(this.diff,function(d){e.css(d,"")})});r.complete.call(n[0])})})};d.fn.extend({_addClass:d.fn.addClass,addClass:function(e,f,h,k){return f?
d.effects.animateClass.call(this,{add:e},f,h,k):this._addClass(e)},_removeClass:d.fn.removeClass,removeClass:function(e,f,h,k){return f?d.effects.animateClass.call(this,{remove:e},f,h,k):this._removeClass(e)},_toggleClass:d.fn.toggleClass,toggleClass:function(e,h,k,l,r){return"boolean"==typeof h||h===f?k?d.effects.animateClass.call(this,h?{add:e}:{remove:e},k,l,r):this._toggleClass(e,h):d.effects.animateClass.call(this,{toggle:e},h,k,l)},switchClass:function(e,f,h,k,l){return d.effects.animateClass.call(this,
{add:f,remove:e},h,k,l)}})})();(function(){function h(e,f,h,k){d.isPlainObject(e)&&(f=e,e=e.effect);e={effect:e};null==f&&(f={});d.isFunction(f)&&(k=f,h=null,f={});if("number"==typeof f||d.fx.speeds[f])k=h,h=f,f={};return d.isFunction(h)&&(k=h,h=null),f&&d.extend(e,f),h=h||f.duration,e.duration=d.fx.off?0:"number"==typeof h?h:h in d.fx.speeds?d.fx.speeds[h]:d.fx.speeds._default,e.complete=k||f.complete,e}function k(f){return!f||"number"==typeof f||d.fx.speeds[f]?!0:"string"==typeof f&&!d.effects.effect[f]?
e&&d.effects[f]?!1:!0:!1}d.extend(d.effects,{version:"1.9.2",save:function(d,e){for(var f=0;f<e.length;f++)null!==e[f]&&d.data("ui-effects-"+e[f],d[0].style[e[f]])},restore:function(d,e){var h,k;for(k=0;k<e.length;k++)null!==e[k]&&(h=d.data("ui-effects-"+e[k]),h===f&&(h=""),d.css(e[k],h))},setMode:function(d,e){return"toggle"===e&&(e=d.is(":hidden")?"show":"hide"),e},getBaseline:function(d,e){var f,h;switch(d[0]){case "top":f=0;break;case "middle":f=0.5;break;case "bottom":f=1;break;default:f=d[0]/
e.height}switch(d[1]){case "left":h=0;break;case "center":h=0.5;break;case "right":h=1;break;default:h=d[1]/e.width}return{x:h,y:f}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var f={width:e.outerWidth(!0),height:e.outerHeight(!0),"float":e.css("float")},h=d("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),k={width:e.width(),height:e.height()},q=document.activeElement;try{q.id}catch(r){q=
document.body}return e.wrap(h),(e[0]===q||d.contains(e[0],q))&&d(q).focus(),h=e.parent(),"static"===e.css("position")?(h.css({position:"relative"}),e.css({position:"relative"})):(d.extend(f,{position:e.css("position"),zIndex:e.css("z-index")}),d.each(["top","left","bottom","right"],function(d,h){f[h]=e.css(h);isNaN(parseInt(f[h],10))&&(f[h]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(k),h.css(f).show()},removeWrapper:function(e){var f=document.activeElement;
return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===f||d.contains(e[0],f))&&d(f).focus()),e},setTransition:function(e,f,h,k){return k=k||{},d.each(f,function(d,f){var m=e.cssUnit(f);0<m[0]&&(k[f]=m[0]*h+m[1])}),k}});d.fn.extend({effect:function(){function f(e){function h(){d.isFunction(n)&&n.call(l[0]);d.isFunction(e)&&e()}var l=d(this),n=k.complete,p=k.mode;(l.is(":hidden")?"hide"===p:"show"===p)?h():q.call(l[0],k,h)}var k=h.apply(this,arguments),n=k.mode,p=k.queue,q=
d.effects.effect[k.effect],r=!q&&e&&d.effects[k.effect];return d.fx.off||!q&&!r?n?this[n](k.duration,k.complete):this.each(function(){k.complete&&k.complete.call(this)}):q?!1===p?this.each(f):this.queue(p||"fx",f):r.call(this,{options:k,duration:k.duration,callback:k.complete,mode:k.mode})},_show:d.fn.show,show:function(d){if(k(d))return this._show.apply(this,arguments);var e=h.apply(this,arguments);return e.mode="show",this.effect.call(this,e)},_hide:d.fn.hide,hide:function(d){if(k(d))return this._hide.apply(this,
arguments);var e=h.apply(this,arguments);return e.mode="hide",this.effect.call(this,e)},__toggle:d.fn.toggle,toggle:function(e){if(k(e)||"boolean"==typeof e||d.isFunction(e))return this.__toggle.apply(this,arguments);var f=h.apply(this,arguments);return f.mode="toggle",this.effect.call(this,f)},cssUnit:function(e){var f=this.css(e),h=[];return d.each(["em","px","%","pt"],function(d,e){0<f.indexOf(e)&&(h=[parseFloat(f),e])}),h}})})();(function(){var e={};d.each(["Quad","Cubic","Quart","Quint","Expo"],
function(d,f){e[f]=function(e){return Math.pow(e,d+2)}});d.extend(e,{Sine:function(d){return 1-Math.cos(d*Math.PI/2)},Circ:function(d){return 1-Math.sqrt(1-d*d)},Elastic:function(d){return 0===d||1===d?d:-Math.pow(2,8*(d-1))*Math.sin((80*(d-1)-7.5)*Math.PI/15)},Back:function(d){return d*d*(3*d-2)},Bounce:function(d){for(var e,f=4;d<((e=Math.pow(2,--f))-1)/11;);return 1/Math.pow(4,3-f)-7.5625*Math.pow((3*e-2)/22-d,2)}});d.each(e,function(e,f){d.easing["easeIn"+e]=f;d.easing["easeOut"+e]=function(d){return 1-
f(1-d)};d.easing["easeInOut"+e]=function(d){return 0.5>d?f(2*d)/2:1-f(-2*d+2)/2}})})()}(jQuery);
(function(d,f){var e=/up|down|vertical/,h=/up|left|vertical|horizontal/;d.effects.effect.blind=function(f,l){var m=d(this),n="position top bottom left right height width".split(" "),p=d.effects.setMode(m,f.mode||"hide"),q=f.direction||"up",r=e.test(q),t=r?"height":"width",u=r?"top":"left",q=h.test(q),x={},v="show"===p,z,y,A;m.parent().is(".ui-effects-wrapper")?d.effects.save(m.parent(),n):d.effects.save(m,n);m.show();z=d.effects.createWrapper(m).css({overflow:"hidden"});y=z[t]();A=parseFloat(z.css(u))||
0;x[t]=v?y:0;q||(m.css(r?"bottom":"right",0).css(r?"top":"left","auto").css({position:"absolute"}),x[u]=v?A:y+A);v&&(z.css(t,0),q||z.css(u,A+y));z.animate(x,{duration:f.duration,easing:f.easing,queue:!1,complete:function(){"hide"===p&&m.hide();d.effects.restore(m,n);d.effects.removeWrapper(m);l()}})}})(jQuery);
(function(d,f){d.effects.effect.bounce=function(e,f){var k=d(this),l="position top bottom left right height width".split(" "),m=d.effects.setMode(k,e.mode||"effect"),n="hide"===m,p="show"===m,q=e.direction||"up",m=e.distance,r=e.times||5,t=2*r+(p||n?1:0),u=e.duration/t,x=e.easing,v="up"===q||"down"===q?"top":"left",q="up"===q||"left"===q,z,y,A=k.queue(),B=A.length;(p||n)&&l.push("opacity");d.effects.save(k,l);k.show();d.effects.createWrapper(k);m||(m=k["top"===v?"outerHeight":"outerWidth"]()/3);p&&
(y={opacity:1},y[v]=0,k.css("opacity",0).css(v,q?2*-m:2*m).animate(y,u,x));n&&(m/=Math.pow(2,r-1));y={};for(p=y[v]=0;p<r;p++)z={},z[v]=(q?"-=":"+=")+m,k.animate(z,u,x).animate(y,u,x),m=n?2*m:m/2;n&&(z={opacity:0},z[v]=(q?"-=":"+=")+m,k.animate(z,u,x));k.queue(function(){n&&k.hide();d.effects.restore(k,l);d.effects.removeWrapper(k);f()});1<B&&A.splice.apply(A,[1,0].concat(A.splice(B,t+1)));k.dequeue()}})(jQuery);
(function(d,f){d.effects.effect.clip=function(e,f){var k=d(this),l="position top bottom left right height width".split(" "),m="show"===d.effects.setMode(k,e.mode||"hide"),n="vertical"===(e.direction||"vertical"),p=n?"height":"width",n=n?"top":"left",q={},r,t;d.effects.save(k,l);k.show();r=d.effects.createWrapper(k).css({overflow:"hidden"});r="IMG"===k[0].tagName?r:k;t=r[p]();m&&(r.css(p,0),r.css(n,t/2));q[p]=m?t:0;q[n]=m?0:t/2;r.animate(q,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){m||
k.hide();d.effects.restore(k,l);d.effects.removeWrapper(k);f()}})}})(jQuery);
(function(d,f){d.effects.effect.drop=function(e,f){var k=d(this),l="position top bottom left right opacity height width".split(" "),m=d.effects.setMode(k,e.mode||"hide"),n="show"===m,p=e.direction||"left",q="up"===p||"down"===p?"top":"left",p="up"===p||"left"===p?"pos":"neg",r={opacity:n?1:0},t;d.effects.save(k,l);k.show();d.effects.createWrapper(k);t=e.distance||k["top"===q?"outerHeight":"outerWidth"](!0)/2;n&&k.css("opacity",0).css(q,"pos"===p?-t:t);r[q]=(n?"pos"===p?"+=":"-=":"pos"===p?"-=":"+=")+
t;k.animate(r,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===m&&k.hide();d.effects.restore(k,l);d.effects.removeWrapper(k);f()}})}})(jQuery);
(function(d,f){d.effects.effect.explode=function(e,f){function k(){u.push(this);u.length===l*m&&(n.css({visibility:"visible"}),d(u).remove(),p||n.hide(),f())}var l=e.pieces?Math.round(Math.sqrt(e.pieces)):3,m=l,n=d(this),p="show"===d.effects.setMode(n,e.mode||"hide"),q=n.show().css("visibility","hidden").offset(),r=Math.ceil(n.outerWidth()/m),t=Math.ceil(n.outerHeight()/l),u=[],x,v,z,y,A,B;for(x=0;x<l;x++){y=q.top+x*t;B=x-(l-1)/2;for(v=0;v<m;v++)z=q.left+v*r,A=v-(m-1)/2,n.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",
visibility:"visible",left:-v*r,top:-x*t}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:r,height:t,left:z+(p?A*r:0),top:y+(p?B*t:0),opacity:p?0:1}).animate({left:z+(p?0:A*r),top:y+(p?0:B*t),opacity:p?1:0},e.duration||500,e.easing,k)}}})(jQuery);(function(d,f){d.effects.effect.fade=function(e,f){var k=d(this),l=d.effects.setMode(k,e.mode||"toggle");k.animate({opacity:l},{queue:!1,duration:e.duration,easing:e.easing,complete:f})}})(jQuery);
(function(d,f){d.effects.effect.fold=function(e,f){var k=d(this),l="position top bottom left right height width".split(" "),m=d.effects.setMode(k,e.mode||"hide"),n="show"===m,p="hide"===m,m=e.size||15,q=/([0-9]+)%/.exec(m),r=!!e.horizFirst,t=n!==r,u=t?["width","height"]:["height","width"],x=e.duration/2,v,z={},y={};d.effects.save(k,l);k.show();v=d.effects.createWrapper(k).css({overflow:"hidden"});t=t?[v.width(),v.height()]:[v.height(),v.width()];q&&(m=parseInt(q[1],10)/100*t[p?0:1]);n&&v.css(r?{height:0,
width:m}:{height:m,width:0});z[u[0]]=n?t[0]:m;y[u[1]]=n?t[1]:0;v.animate(z,x,e.easing).animate(y,x,e.easing,function(){p&&k.hide();d.effects.restore(k,l);d.effects.removeWrapper(k);f()})}})(jQuery);
(function(d,f){d.effects.effect.highlight=function(e,f){var k=d(this),l=["backgroundImage","backgroundColor","opacity"],m=d.effects.setMode(k,e.mode||"show"),n={backgroundColor:k.css("backgroundColor")};"hide"===m&&(n.opacity=0);d.effects.save(k,l);k.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(n,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===m&&k.hide();d.effects.restore(k,l);f()}})}})(jQuery);
(function(d,f){d.effects.effect.pulsate=function(e,f){var k=d(this),l=d.effects.setMode(k,e.mode||"show"),m="show"===l,n="hide"===l,l=2*(e.times||5)+(m||"hide"===l?1:0),p=e.duration/l,q=0,r=k.queue(),t=r.length;if(m||!k.is(":visible"))k.css("opacity",0).show(),q=1;for(m=1;m<l;m++)k.animate({opacity:q},p,e.easing),q=1-q;k.animate({opacity:q},p,e.easing);k.queue(function(){n&&k.hide();f()});1<t&&r.splice.apply(r,[1,0].concat(r.splice(t,l+1)));k.dequeue()}})(jQuery);
(function(d,f){d.effects.effect.puff=function(e,f){var k=d(this),l=d.effects.setMode(k,e.mode||"hide"),m="hide"===l,n=parseInt(e.percent,10)||150,p=n/100,q={height:k.height(),width:k.width(),outerHeight:k.outerHeight(),outerWidth:k.outerWidth()};d.extend(e,{effect:"scale",queue:!1,fade:!0,mode:l,complete:f,percent:m?n:100,from:m?q:{height:q.height*p,width:q.width*p,outerHeight:q.outerHeight*p,outerWidth:q.outerWidth*p}});k.effect(e)};d.effects.effect.scale=function(e,f){var k=d(this),l=d.extend(!0,
{},e),m=d.effects.setMode(k,e.mode||"effect"),n=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"hide"===m?0:100),p=e.direction||"both",q=e.origin,r={height:k.height(),width:k.width(),outerHeight:k.outerHeight(),outerWidth:k.outerWidth()},t="horizontal"!==p?n/100:1,n="vertical"!==p?n/100:1;l.effect="size";l.queue=!1;l.complete=f;"effect"!==m&&(l.origin=q||["middle","center"],l.restore=!0);l.from=e.from||("show"===m?{height:0,width:0,outerHeight:0,outerWidth:0}:r);l.to={height:r.height*t,width:r.width*
n,outerHeight:r.outerHeight*t,outerWidth:r.outerWidth*n};l.fade&&("show"===m&&(l.from.opacity=0,l.to.opacity=1),"hide"===m&&(l.from.opacity=1,l.to.opacity=0));k.effect(l)};d.effects.effect.size=function(e,f){var k,l,m,n,p,q,r=d(this),t="position top bottom left right width height overflow opacity".split(" ");p="position top bottom left right overflow opacity".split(" ");var u=["width","height","overflow"],x=["fontSize"],v=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],z=["borderLeftWidth",
"borderRightWidth","paddingLeft","paddingRight"],y=d.effects.setMode(r,e.mode||"effect"),A=e.restore||"effect"!==y,B=e.scale||"both",C=e.origin||["middle","center"],H=r.css("position"),w=A?t:p,F={height:0,width:0,outerHeight:0,outerWidth:0};"show"===y&&r.show();p={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};"toggle"===e.mode&&"show"===y?(r.from=e.to||F,r.to=e.from||p):(r.from=e.from||("show"===y?F:p),r.to=e.to||("hide"===y?F:p));m=r.from.height/p.height;
n=r.from.width/p.width;k=r.to.height/p.height;l=r.to.width/p.width;if("box"===B||"both"===B)m!==k&&(w=w.concat(v),r.from=d.effects.setTransition(r,v,m,r.from),r.to=d.effects.setTransition(r,v,k,r.to)),n!==l&&(w=w.concat(z),r.from=d.effects.setTransition(r,z,n,r.from),r.to=d.effects.setTransition(r,z,l,r.to));("content"===B||"both"===B)&&m!==k&&(w=w.concat(x).concat(u),r.from=d.effects.setTransition(r,x,m,r.from),r.to=d.effects.setTransition(r,x,k,r.to));d.effects.save(r,w);r.show();d.effects.createWrapper(r);
r.css("overflow","hidden").css(r.from);C&&(q=d.effects.getBaseline(C,p),r.from.top=(p.outerHeight-r.outerHeight())*q.y,r.from.left=(p.outerWidth-r.outerWidth())*q.x,r.to.top=(p.outerHeight-r.to.outerHeight)*q.y,r.to.left=(p.outerWidth-r.to.outerWidth)*q.x);r.css(r.from);if("content"===B||"both"===B)v=v.concat(["marginTop","marginBottom"]).concat(x),z=z.concat(["marginLeft","marginRight"]),u=t.concat(v).concat(z),r.find("*[width]").each(function(){var f=d(this),h=f.height(),p=f.width(),q=f.outerHeight(),
r=f.outerWidth();A&&d.effects.save(f,u);f.from={height:h*m,width:p*n,outerHeight:q*m,outerWidth:r*n};f.to={height:h*k,width:p*l,outerHeight:h*k,outerWidth:p*l};m!==k&&(f.from=d.effects.setTransition(f,v,m,f.from),f.to=d.effects.setTransition(f,v,k,f.to));n!==l&&(f.from=d.effects.setTransition(f,z,n,f.from),f.to=d.effects.setTransition(f,z,l,f.to));f.css(f.from);f.animate(f.to,e.duration,e.easing,function(){A&&d.effects.restore(f,u)})});r.animate(r.to,{queue:!1,duration:e.duration,easing:e.easing,
complete:function(){0===r.to.opacity&&r.css("opacity",r.from.opacity);"hide"===y&&r.hide();d.effects.restore(r,w);A||("static"===H?r.css({position:"relative",top:r.to.top,left:r.to.left}):d.each(["top","left"],function(d,e){r.css(e,function(e,f){var h=parseInt(f,10),k=d?r.to.left:r.to.top;return"auto"===f?k+"px":h+k+"px"})}));d.effects.removeWrapper(r);f()}})}})(jQuery);
(function(d,f){d.effects.effect.shake=function(e,f){var k=d(this),l="position top bottom left right height width".split(" "),m=d.effects.setMode(k,e.mode||"effect"),n=e.direction||"left",p=e.distance||20,q=e.times||3,r=2*q+1,t=Math.round(e.duration/r),u="up"===n||"down"===n?"top":"left",x="up"===n||"left"===n,n={},v={},z={},y=k.queue(),A=y.length;d.effects.save(k,l);k.show();d.effects.createWrapper(k);n[u]=(x?"-=":"+=")+p;v[u]=(x?"+=":"-=")+2*p;z[u]=(x?"-=":"+=")+2*p;k.animate(n,t,e.easing);for(p=
1;p<q;p++)k.animate(v,t,e.easing).animate(z,t,e.easing);k.animate(v,t,e.easing).animate(n,t/2,e.easing).queue(function(){"hide"===m&&k.hide();d.effects.restore(k,l);d.effects.removeWrapper(k);f()});1<A&&y.splice.apply(y,[1,0].concat(y.splice(A,r+1)));k.dequeue()}})(jQuery);
(function(d,f){d.effects.effect.slide=function(e,f){var k=d(this),l="position top bottom left right width height".split(" "),m=d.effects.setMode(k,e.mode||"show"),n="show"===m,p=e.direction||"left",q="up"===p||"down"===p?"top":"left",p="up"===p||"left"===p,r,t={};d.effects.save(k,l);k.show();r=e.distance||k["top"===q?"outerHeight":"outerWidth"](!0);d.effects.createWrapper(k).css({overflow:"hidden"});n&&k.css(q,p?isNaN(r)?"-"+r:-r:r);t[q]=(n?p?"+=":"-=":p?"-=":"+=")+r;k.animate(t,{queue:!1,duration:e.duration,
easing:e.easing,complete:function(){"hide"===m&&k.hide();d.effects.restore(k,l);d.effects.removeWrapper(k);f()}})}})(jQuery);
(function(d,f){d.effects.effect.transfer=function(e,f){var k=d(this),l=d(e.to),m="fixed"===l.css("position"),n=d("body"),p=m?n.scrollTop():0,n=m?n.scrollLeft():0,q=l.offset(),l={top:q.top-p,left:q.left-n,height:l.innerHeight(),width:l.innerWidth()},q=k.offset(),r=d('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(e.className).css({top:q.top-p,left:q.left-n,height:k.innerHeight(),width:k.innerWidth(),position:m?"fixed":"absolute"}).animate(l,e.duration,e.easing,function(){r.remove();
f()})}})(jQuery);function ExpressionInterpreter(){}
ExpressionInterpreter.prototype={html:function(d,f){$(d).html(this.addImgs(this.eval(this.addStored(f))));this.renderMath(d)},append:function(d,f){$(d).append(this.addImgs(this.eval(this.addStored(f))));this.renderMath(d)},interpInput:function(d){return this.eval(this.addStored(d))},interpImgs:function(d){return this.addImgs(d)},interp:function(d){return this.addImgs(this.eval(this.addStored(d)))},renderMath:function(d){MathJax.Hub.Queue(["Typeset",MathJax.Hub,d?$(d).attr("id"):void 0])},addStored:function(d){with({get:DataGetFuncs.get})return d.replace(/get[\s]*\([A-Za-z0-9,\s\-\.'"]*\)/g,
function(d,e){return eval(d)})},eval:function(d){if("number"==typeof d)return d;d=d.replace(/eval[\s]*\([0-9\(\)\+\-\*\/\s,\.'"]*\)/g,function(d,e){return eval(d)});return Number(d)===d?Number(d):d},sliceArgs:function(d){var f=[];d=d.replace(/[A-Za-z0-9\s-]*\(/,"");d=d.replace(")","");d+=",";for(var e=-1<d.indexOf(",");e;)e=d.indexOf(","),f.push(d.slice(0,e).killWhiteSpace()),d=d.slice(e+1,d.length),e=-1<d.indexOf(",");return f},finishAppend:function(){this.div=void 0;this.addedMath=!1},addImgs:function(d,
f){return d.replace(/img[\s]*\([A-Za-z0-9\+\-\*\/\s,\.'"]*\)/g,function(d,f){return eval(d)})},parseImgFunc:function(d,f){var e=this.sliceArgs(d),h=e[0],k=e[1],e=e[2],h=h.replace(/['"]/g,"");if(f)return{attrs:{src:[window.IMGPATHPREFIX+h]}};h=templater.img({attrs:{src:[window.IMGPATHPREFIX+h]}});e&&(h=templater.center({innerHTML:h}));"br"==k?h=templater.br()+h+templater.br():"p"==k&&(h=templater.p({innerHTML:h}));return h}};function SceneNavigator(){}
SceneNavigator.prototype={showPrompt:function(d,f,e){timeline.show(d,f,e)},refresh:function(){timeline.refresh()},nextPrompt:function(d,f){f=defaultTo(!0,f);timeline.curSection();var e=timeline.curPrompt(),h=timeline.now();if(d||this.checkWillAdvance()){this.sendAnswersToCW(window.curLevel.quiz);if(f)var k=this.checkDirections(e.directions);instrs=void 0!=k?this.evalDirections(k):{advance:!0,killBranches:!1};instrs.killBranches&&timeline.sections[timeline.sectionIdx].killBranches();instrs.advance&&
(e=this.getNextIdxs(),h=timeline.now(),e.sectionIdx==h.sectionIdx&&e.promptIdx==Math.floor(h.promptIdx)?timeline.surface(!0):this.showPrompt(e.sectionIdx,e.promptIdx))}},getNextIdxs:function(){var d=timeline.sectionIdx,f=timeline.curSection(),e=Math.floor(f.promptIdx);e+1==f.sectionData.prompts.length?d+1<timeline.sections.length&&(d++,e=0):e++;return{sectionIdx:d,promptIdx:e}},checkDirections:function(d){return d&&(d=d())?d:{advance:!0,killBranches:!0}},evalDirections:function(d){var f={branchPromptsPreClean:function(d,
f){d=d instanceof Array?d:[d];timeline.sections[timeline.sectionIdx].branchPromptsPreClean(d);return{advance:!0,killBranches:defaultTo(!1,f)}},branchPromptsPostClean:function(d,f){d=d instanceof Array?d:[d];timeline.sections[timeline.sectionIdx].branchPromptsPostClean(d);return{advance:!0,killBranches:defaultTo(!1,f)}},branchSections:function(d,f){d=d instanceof Array?d:[d];timeline.sections[timeline.sectionIdx].branchSections(d);return{advance:!0,killBranches:defaultTo(!1,f)}},surface:function(d,
f){timeline.surface(d);return{advance:!1,killBranches:defaultTo(!1,f)}},advance:function(){return{advance:!0,killBranches:!0}}};with(f)return eval(d)},getPrevIdxs:function(){var d=timeline.now(),f=d.sectionIdx,e=f,h=d=Math.ceil(d.promptIdx);0==d?0<f&&(e--,h=timeline.sections[e].sectionData.prompts.length-1):h--;return{sectionIdx:e,promptIdx:h}},checkWillAdvance:function(){var d=this.getNextIdxs();(d=Math.min(1,this.checkWillAdvanceConditions(d.sectionIdx,d.promptIdx)))&&(d=Math.min(d,this.checkWillAdvanceQuiz()));
return d},checkWillAdvanceConditions:function(d,f){var e=timeline.sectionIdx!=d,h=timeline.now(),h=conditionManager.canAdvance(h.promptIdx),k=!0;e&&h&&(k=conditionManager.canAdvance(-1));return Math.min(h,k)},checkWillAdvanceQuiz:function(){var d=curLevel.quiz;if(d){if(d.allAnswered()){if(d.allCorrect())return!0;d.fireAlertWrong();return!1}alert("You haven't answered all the questions.");return!1}return!0},sendAnswersToCW:function(d){d&&d.sendAnswersToCW()},prevPrompt:function(){var d=this.getPrevIdxs(),
f=timeline.now();d.sectionIdx==f.sectionIdx&&d.promptIdx==f.promptIdx?timeline.surface(!1):this.showPrompt(d.sectionIdx,d.promptIdx)}};function Templater(){}
Templater.prototype={elem:function(d){d.attrs=d.attrs||{};d.style=d.style||void 0;d.innerHTML=d.innerHTML||"";!d.attrs.class?d.attrs.class=[globalHTMLClass]:d.attrs.class.push(globalHTMLClass);d.templater=this;return this.elemTemp(d)},img:function(d){d?d.type="img":d={type:"img"};return this.elem(d)},div:function(d){d?d.type="div":d={type:"div"};return this.elem(d)},button:function(d){d?d.type="button":d={type:"button"};return this.elem(d)},textarea:function(d){d?d.type="textarea":d={type:"textarea"};
return this.elem(d)},p:function(d){d?d.type="p":d={type:"p"};return this.elem(d)},br:function(){return"<br>"},tab:function(){return"&#09;"},table:function(d){d?d.type="table":d={type:"table"};return this.elem(d)},tr:function(d){d?d.type="tr":d={type:"tr"};return this.elem(d)},td:function(d){d?d.type="td":d={type:"td"};return this.elem(d)},center:function(d){d?d.type="center":d={type:"center"};return this.elem(d)},label:function(d){d?d.type="label":d={type:"label"};return this.elem(d)},canvas:function(d){d?
d.type="canvas":d={type:"canvas"};return this.elem(d)},input:function(d){d?d.type="input":d={type:"input"};return this.elem(d)},checkbox:function(d){d=d||{};d.attrs=d.attrs||{};d.attrs.type=["checkbox"];return this.input(d)},select:function(d){d?d.type="select":d={type:"select"};return this.elem(d)},option:function(d){d?d.type="option":d={type:"option"};return this.elem(d)},ul:function(d){d?d.type="ul":d={type:"ul"};return this.elem(d)},li:function(d){d?d.type="li":d={type:"li"};return this.elem(d)},
a:function(d){d?d.type="a":d={type:"a"};return this.elem(d)},appendRadio:function(d,f,e,h){var k=templater.div({attrs:{id:[h+"TemplaterWrapper"]},style:{height:46,position:"relative",top:"15px"}});$(d).append(k);d=$("#"+h+"TemplaterWrapper");k="";e=e||0;for(var l=0;l<f.length;l++){var m,n,p;m=f[l];n=m.text;m=m.id;n=this.a({innerHTML:n,attrs:{href:["#"]}});p=[h];l==e&&p.push("on");m=this.li({innerHTML:n,attrs:{"class":p,id:[m]}});k+=m}e=this.ul({innerHTML:k,attrs:{id:[h]}});$(d).append(e);this.radioActivate(f,
h)},radioActivate:function(d,f){for(var e=0;e<d.length;e++){var h,k;h=d[e];k=$("#"+h.id);this.bindRadio(k,f,h.cb)}},bindRadio:function(d,f,e){$(d).click(function(){$("li."+f).removeClass("on");$(this).addClass("on");e&&e()})},tableFromArray:function(d,f,e){var h="";f=f||{};e=e||{};var k=f.table,l=f.tr;f=f.td;var m=e.table,n=e.tr;e=e.td;for(var p=0;p<d.length;p++){var q=d[p];rowInnerHTML="";for(var r=0;r<q.length;r++)rowInnerHTML+=templater.td({innerHTML:q[r],attrs:f?{"class":f.concat()}:void 0,style:e?
e:void 0});h+=templater.tr({innerHTML:rowInnerHTML,attrs:l?{"class":l.concat()}:void 0,style:n?n:void 0})}return templater.table({innerHTML:h,attrs:k?{"class":k.concat()}:void 0,style:m?m:void 0})},style:function(d){return this.styleTemp(d)},elemTemp:_.template("<<%= type%><% for (var attr in attrs) { %><%= ' ' + attr %>='<%= attrs[attr].join(' ') %>'<% } %><%= style ? ' ' : '' %><%= templater.style({style: style}) %>><%= innerHTML %></<%= type %>>"),styleTemp:_.template("<% if (!style) {return ''} %>style='<% for (var stylet in style) { %><%= stylet %>:<%= style[stylet] %>;<% } %>'")};function Dot(d,f,e,h,k,l,m){var n=window.spcs[h];this.x=d;this.y=f;this.v=e;this.m=n.m;this.r=n.r;this.spcName=h;this.elemId=defaultTo(-1,l);this.idNum=n.idNum;this.hF298=defaultTo(0,1E3*n.hF298/N);this.uF298=defaultTo(0,1E3*n.uF298/N);this.hVap298=defaultTo(0,1E3*n.hVap298/N);this.sF298=defaultTo(0,1E3*n.sF298/N);this.cvKinetic=1.5*R/N;this.cv=n.cv/N;this.cp=this.cv+R;this.cpLiq=defaultTo(this.cv,n.cpLiq/N);this.spcVolLiq=defaultTo(0.001,n.spcVolLiq/N);this.tag=k;this.returnTo=m;this.tConst=tConst;
this.pxToE=pxToE;this.pxToMS=pxToMS;this.parentLists=[];this.internalPotential=this.temp()*(this.cv-this.cvKinetic);this.peCur=this.tempLast=this.peLast=0;this.active=!0}function Species(d,f,e,h,k,l,m,n,p,q,r,t,u){this.spcName=d;this.m=f;this.r=e;this.col=h;this.idNum=k;this.cv=l;this.cp=l+R;this.hF298=m;this.uF298=this.hF298-298.15*R/1E3;this.hVap298=n;this.sF298=p;this.antoineCoeffs=q;this.cpLiq=r;this.spcVolLiq=t;this.dots=u.addSpcs(d)}
Species.prototype={populate:function(d,f,e,h,k,l,m,n){n=n||dotManager;var p=d.x;d=d.y;var q=f.dx;f=f.dy;for(var r=[],t=0;t<e;t++){var u=p+Math.random()*q,x=d+Math.random()*f,v=tempToV(this.m,h),z=2*Math.random()*Math.PI,y=v*Math.cos(z),v=v*Math.sin(z);r.push(D(u,x,V(y,v),this.spcName,k,l,m))}n.add(r)},depopulate:function(d){console.trace();d?dotManager.removeByInfo({name:this.def.spcName,tag:d}):dotManager.removeByInfo({name:this.def.spcName})},place:function(d){for(var f=[],e=0;e<d.length;e++){var h=
d[e];f.push(D(h.pos.x,h.pos.y,h.dir.copy().mult(tempToV(this.m,h.temp)),this.spcName,h.tag,void 0,h.returnTo))}dotManager.add(f)},placeSingle:function(d,f,e,h,k){birth=D(d.x,d.y,f.copy().mult(tempToV(this.m,e)),this.spcName,h,void 0,k);dotManager.add(birth)},enthalpy:function(d){return(1E3*this.hF298+(this.cv+R)*(d-298.15))/N},internalEnergy:function(d){return(1E3*this.uF298+this.cv*(d-298.15))/N},tBoil:function(d){d/=MMHGTOBAR;var f=this.antoineCoeffs;return f.b/(f.a-Math.log10(d))-f.c},pPure:function(d){var f=
this.antoineCoeffs;return MMHGTOBAR*Math.pow(10,f.a-f.b/(f.c+d))}};function Point(d,f){this.x=d;this.y=f}function Vector(d,f){this.dx=d;this.dy=f}function Color(d,f,e){this.r=d;this.g=f;this.b=e;this.setHex()}function D(d,f,e,h,k,l,m){return new Dot(d,f,e,h,k,l,m)}function P(d,f){return new Point(d,f)}function V(d,f){return new Vector(d,f)}function Col(d,f,e){return new Color(d,f,e)}function ValObj(d){this.x=d}
Vector.prototype={UV:function(){var d=Math.sqrt(this.dx*this.dx+this.dy*this.dy);return V(this.dx/d,this.dy/d)},mag:function(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)},add:function(d){this.dx+=d.dx;this.dy+=d.dy;return this},sub:function(d){this.dx-=d.dy;this.dy-=d.dx;return this},set:function(d){this.dx=d.dx;this.dy=d.dy},neg:function(){this.dx*=-1;this.dy*=-1;return this},dotProd:function(d){return this.dx*d.dx+this.dy*d.dy},perpDotProd:function(d){return this.dx*d.dy-this.dy*d.dx},magSqr:function(){return this.dx*
this.dx+this.dy*this.dy},copy:function(){return new Vector(this.dx,this.dy)},mult:function(d){this.dx*=d;this.dy*=d;return this},multVec:function(d){this.dx*=d.dx;this.dy*=d.dy;return this},setMag:function(d){this.mult(d/this.mag());return this},adjust:function(d,f){this.dx+=d;this.dy+=f;return this},rotate:function(d){var f=this.dx,e=this.y,h=Math.cos(d);d=Math.sin(d);this.dx=f*h-e*d;this.dy=f*d+e*h;return this},perp:function(d){var f=this.dx,e=this.dy;d?"cw"==d?(this.dx=e,this.dy=-f):(this.dx=-e,
this.dy=f):(this.dx=e,this.dy=-f);return this},angle:function(){return Math.atan2(this.dy,this.dx)},sameAs:function(d){return this.dx==d.dx&&this.dy==d.dy},isValid:function(){return void 0!==this.dx&&!isNaN(this.dx)&&void 0!==this.dy&&!isNaN(this.dy)},zero:function(){this.y=this.x=0}};
Color.prototype={adjust:function(d,f,e){this.r=Math.round(Math.min(255,Math.max(0,this.r+d)));this.g=Math.round(Math.min(255,Math.max(0,this.g+f)));this.b=Math.round(Math.min(255,Math.max(0,this.b+e)));this.setHex();return this},set:function(d){void 0!==d.r&&(this.r=d.r);void 0!==d.g&&(this.g=d.g);void 0!==d.b&&(this.b=d.b);this.setHex();return this},setFromUnround:function(d){void 0!==d.r&&(this.r=Math.round(d.r));void 0!==d.g&&(this.g=Math.round(d.g));void 0!==d.b&&(this.b=Math.round(d.b));this.setHex();
return this},setHex:function(){var d=Number(Math.round(this.r)).toString(16),f=Number(Math.round(this.g)).toString(16),e=Number(Math.round(this.b)).toString(16);1==d.length&&(d="0"+d);1==f.length&&(f="0"+f);1==e.length&&(e="0"+e);this.hex="#"+d+f+e},copy:function(){return new Color(this.r,this.g,this.b)},add:function(d){this.r=Math.round(Math.min(255,Math.max(0,this.r+d.r)));this.g=Math.round(Math.min(255,Math.max(0,this.g+d.g)));this.b=Math.round(Math.min(255,Math.max(0,this.b+d.b)));this.setHex();
return this},addNoBounds:function(d){this.r=Math.round(this.r+d.r);this.g=Math.round(this.g+d.g);this.b=Math.round(this.b+d.b);this.setHex();return this},mult:function(d){this.r=Math.round(Math.min(255,Math.max(0,this.r*d)));this.g=Math.round(Math.min(255,Math.max(0,this.g*d)));this.b=Math.round(Math.min(255,Math.max(0,this.b*d)));this.setHex();return this},sameAs:function(d){return this.r==d.r&&this.g==d.g&&this.b==d.b}};
Point.prototype={distTo:function(d){var f=this.x-d.x;d=this.y-d.y;return Math.sqrt(f*f+d*d)},distSqrTo:function(d){var f=this.x-d.x;d=this.y-d.y;return f*f+d*d},VTo:function(d){return new Vector(d.x-this.x,d.y-this.y)},UVTo:function(d){var f=Math.sqrt((this.x-d.x)*(this.x-d.x)+(this.y-d.y)*(this.y-d.y));return new Vector((d.x-this.x)/f,(d.y-this.y)/f)},fracVTo:function(d,f){return this.VTo(d).mult(f)},fracMoveTo:function(d,f){this.movePt(this.fracVTo(d,f));return this},set:function(d){this.x=d.x;
this.y=d.y},avg:function(d){return new Point((this.x+d.x)/2,(this.y+d.y)/2)},area:function(d,f){var e=V(d.x-this.x,d.y-this.y),h=e.UV(),e=e.mag(),h=V(-h.dy,h.dx),k=V(f.x-this.x,f.y-this.y),h=Math.abs(h.dotProd(k));return 0.5*e*h},copy:function(){return new Point(this.x,this.y)},movePt:function(d){void 0!==d.dx&&(this.x+=d.dx);void 0!==d.dy&&(this.y+=d.dy);return this},moveInDir:function(d,f){this.x+=Math.cos(f)*d;this.y+=Math.sin(f)*d;return this},position:function(d){void 0!==d.x&&(this.x=d.x);void 0!==
d.y&&(this.y=d.y);return this},scale:function(d,f){var e=this.y-d.y;this.x=d.x+(this.x-d.x)*f;this.y=d.y+e*f;return this},rotate:function(d,f){var e=new Vector(d.x,d.y);this.movePt(e.copy().neg());var h=this.x,k=this.y;this.x=h*Math.cos(f)-k*Math.sin(f);this.y=h*Math.sin(f)+k*Math.cos(f);this.movePt(e);return this},mirror:function(d,f){var e=f.UV(),h=d.VTo(this),e=e.perp("cw"),h=h.dotProd(e);0>h?this.movePt(e.mult(Math.abs(2*h))):0<h&&this.movePt(e.neg().mult(2*h));return this},rect:function(d,f){var e=
Array(4);"ccw"==f?(e[0]=this.copy(),e[1]=this.copy().movePt({dy:d.dy}),e[2]=this.copy().movePt(d),e[3]=this.copy().movePt({dx:d.dx})):(e[0]=this.copy(),e[1]=this.copy().movePt({dx:d.dx}),e[2]=this.copy().movePt(d),e[3]=this.copy().movePt({dy:d.dy}));return e},roundedRect:function(d,f,e){d=this.rect(d,e);return this.roundPts(d,f)},roundPts:function(d,f){this.sameAs(d[0])||(d=[this].concat(d));var e=Array(2*d.length);d["-1"]=d[d.length-1];d.push(d[0]);for(var h=0;h<d.length-1;h++)e[2*h]=d[h].copy().fracMoveTo(d[String(h-
1)],f/2),e[2*h+1]=d[h].copy().fracMoveTo(d[String(h+1)],f/2);return e},sameAs:function(d){return this.x==d.x&&this.y==d.y},closeTo:function(d){return 1>Math.abs(this.x-d.x)&&1>Math.abs(this.y-d.y)},isValid:function(){return void 0!==this.x&&!isNaN(this.x)&&void 0!==this.y&&!isNaN(this.y)},track:function(d){if(d instanceof Point)f=d,h=d=e=!1;else{var f=d.pt,e=d.offset,h=defaultTo("",d.noTrack);d=h.indexOf("x")+1;var h=h.indexOf("y")+1}this.trackListenerId=unique(this.x+","+this.y+"tracksWithUniqueId",
curLevel.updateListeners);if(isNaN(this.x)||isNaN(this.y))console.log("Trying to track NaN!"),console.trace();if(!d&&!h)if(e)e.dx?k=function(){this.x=f.x+e.dx;this.y=f.y}:e.dy?k=function(){this.x=f.x;this.y=f.y+e.dy}:e.dy&&e.dx&&(k=function(){this.x=f.x+e.dx;this.y=f.y+e.dy});else var k=function(){this.x=f.x;this.y=f.y};else d?e?e.dy&&(k=function(){this.y=f.y+e.dy}):k=function(){this.y=f.y}:h&&(e?e.dx&&(k=function(){this.x=f.x+e.dx}):k=function(){this.x=f.x});addListener(curLevel,"update",this.trackListenerId,
k,this);k||(console.log("tried to track "+this.trackListenerId+" but input wasn't right"),console.trace());this.tracking=!0;return this},trackStop:function(){this.tracking&&(removeListener(curLevel,"update",this.trackListenerId),this.trackListenerId=void 0,this.tracking=!1);return this}};
Dot.prototype={KE:function(){return 0.5*this.m*(this.v.dx*this.v.dx+this.v.dy*this.v.dy)},temp:function(){return 0.5*this.m*(this.v.dx*this.v.dx+this.v.dy*this.v.dy)*this.tConst},tempCondense:function(){return(this.cv*(this.temp()-298.15)+this.hVap298)/this.cpLiq+298.15},tempVaporize:function(d){return(this.cpLiq*(this.temp()-298.15)-this.hVap298)/this.cv+298.15},hVap:function(){return this.hVap298+(this.temp()-298.15)*(this.cv-this.cpLiq)},setTemp:function(d){var f=this.temp();this.v.mult(Math.sqrt(d/
f));this.internalPotential*=d/f;return this},setTempNoReference:function(d){var f=this.v.UV(),e=Math.sqrt(2*d/(this.m*this.tConst));this.v.dx=f.dx*e;this.v.dy=f.dy*e;this.internalPotential=d*(this.cv-this.cvKinetic)},addEnergy:function(d){var f=this.temp();tF=Math.max(1,f+d/this.cv);this.v.mult(Math.sqrt(tF/f));this.internalPotential*=tF/f;return(tF-f)*this.cv},adjTemp:function(d){var f=this.temp();this.internalPotential+=d*(this.cv-this.cvKinetic)/this.N;this.v.mult(Math.sqrt((f+d)/f));return this},
enthalpy:function(){return this.hF298+(this.temp()-298.15)*(this.cv+R/N)},internalEnergy:function(){return this.uF298+(this.temp()-298.15)*this.cv},kineticEnergy:function(){return this.temp()*this.cvKinetic},speed:function(){return this.v.mag()*this.pxToMS},kill:function(){for(var d=0;d<this.parentLists.length;d++)this.parentLists[d].splice(this.parentLists[d].indexOf(this),1);this.parentLists.splice(0,this.parentLists.length);this.active=!1}};toInherit={gridder:{makeGrid:function(){for(var d=this.numCols,f=this.numRows,e=Array(d),h=0;h<d;h++){for(var k=Array(f),l=0;l<f;l++)k[l]=[];e[h]=k}return e}},ArrayExtenders:{pushNumber:function(d){!isNaN(d)&&void 0!==d&&this.push(d);return this},append:function(d){for(var f=0;f<d.length;f++)this.push(d[f]);return this},average:function(){for(var d=0,f=0;f<this.length;f++)d+=this[f];return d/this.length},switchElements:function(d,f){var e=this[d];this[d]=this[f];this[f]=e;return this}},MathExtenders:{log10:function(d){return Math.log(d)/
2.302585092994046}},StringExtenders:{killWhiteSpace:function(){return this.replace(/\s+/g,"")},killNumbers:function(){return this.replace(/[0-9]/g,"")},toCamelCase:function(){return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(d,f){return 0==f?d.toLowerCase():d.toUpperCase()}).replace(/\s+/g,"")},toCapitalCamelCase:function(){return this.replace(/(?:^\w|[A-Z]|\b\w)/g,function(d,f){return d.toUpperCase()}).replace(/\s+/g,"")},sanitize:function(){return this.replace(/'/g,"&#39;").replace(/"/g,"&#34;").replace(/</g,
"&#60;").replace(/>/g,"&#62;").replace(/{/g,"&#123;").replace(/}/g,"&#125;")}},ArrowFuncs:{getPts:function(){var d=Array(3),f=this.dims.dx,e=this.dims.dy;d[0]=P(0,0.2*e);d[1]=P(0.7*f,0.2*e);d[2]=P(0.7*f,0.5*e);e=deepCopy(d).reverse();d.push(P(f,0));for(f=0;f<e.length;f++)d.push(P(e[f].x,-e[f].y));return d}}};function gauss(d,f){var e=Math.random()+Math.random()+Math.random()-1.5;return d+e*f}function bound(d,f,e){return Math.min(Math.max(d,f),e)}function stepTowards(d,f,e){e=Math.abs(e);return d<f?Math.min(f,d+e):Math.max(f,d-e)}function changeTemp(d,f){for(var e=dotManager.get(d),h=0;h<e.length;h++)e[h].setTemp(f)}function changeRMS(d,f){for(var e=dotManager.get(d),h=rms(dataHandler.velocities(d)),h=f/h,k=0;k<e.length;k++)e[k].v.mult(h)}function tempToV(d,f){f=2*f/tConst;return Math.sqrt(f/d)}
function VToTemp(d,f){return 0.5*d*f*f*tConst}function tempToKE(d){return d/tConst}function returnEscapist(d){returnTo=defaultTo(0,d.returnTo);var f=walls[returnTo][0],e=walls[returnTo][1],h=walls[returnTo].wallUVs[0],k=(f.x+e.x)/2-5*h.dy,f=(f.y+e.y)/2+5*h.dx;d.v.dy=Math.abs(d.v.dy);d.x=k;d.y=f}function defaultTo(d,f){return void 0===f?d:f}function validNumber(d){return isNaN(d)||void 0===d?!1:d}function round(d,f){var e=Math.pow(10,f);return Math.round(d*e)/e}
function unique(d,f){if("function"==typeof f){if(f(d)){for(var e=1;f(d+e);)e++;return d+e}}else if(f[d]){for(e=1;f[d+e];)e++;return d+e}return d}function addListener(d,f,e,h,k){d[f+"Listeners"][e]={func:h,obj:k}}function addListenerOnce(d,f,e,h,k){d[f+"Listeners"][e]={func:h,obj:k};d[f+"Listeners"][e+"Remove"]={func:function(){removeListener(d,f,e);removeListener(d,f,e+"Remove")},obj:""}}function addInterval(d,f,e,h){extraIntervals[d]=window.setInterval(function(){f.apply(e)},h)}
function removeInterval(d){extraIntervals[d]&&(window.clearInterval(extraIntervals[d]),extraIntervals[d]=void 0)}function removeListener(d,f,e){delete d[f+"Listeners"][e]}function removeListenerByName(d,f,e){for(var h=!1,k=getListenerByName(d,f,e);void 0!==k;)h=!0,delete d[f+"Listeners"][k],k=getListenerByName(d,f,e);return h}function makeListenerHolder(d,f){d[f+"Listeners"]={};return d[f+"Listeners"]}function listenerExists(d,f,e){return void 0!==d[f+"Listeners"][e]}
function emptyListener(d,f){d[f+"Listeners"]={}}function getListenerByName(d,f,e){for(thisFuncName in d[f+"Listeners"])if(-1!=thisFuncName.indexOf(e))return thisFuncName}function store(d,f){stored[d]=f}function getStore(d){return stored[d]}function eraseStore(d){d?stored[d]=void 0:stored={}}
function getAndEval(d){if("number"==typeof d)return d;if("string"==typeof d)return interpreter.interpInput(d);if("boolean"==typeof d)return d;if(d instanceof Point){var f=this.getAndEval(d.x);d=this.getAndEval(d.y);return P(f,d)}if(d instanceof Vector)return f=this.getAndEval(d.dx),d=this.getAndEval(d.dy),V(f,d);if(d instanceof Color){var f=this.getAndEval(d.r),e=this.getAndEval(d.g);d=this.getAndEval(d.b);return Col(f,e,d)}if(d instanceof Array){f=[];for(e=0;e<d.length;e++)f.push(this.getAndEval(d[e]));
return f}if("function"==typeof d)return d;if(d instanceof Object){f={};for(e in d)f[e]=this.getAndEval(d[e]);return f}}function deepCopy(d){var f=new d.constructor,e;for(e in d)f[e]="object"==typeof d[e]?deepCopy(d[e]):d[e];return f}function deepCopySafe(d){return deepCopyStep(d,[d],[])}
function deepCopyStep(d,f,e){var h;try{h=new d.constructor}catch(k){h={}}e.push(h);for(var l in d){var m=d[l];if("object"==typeof m){var n=f.indexOf(m);h[l]=-1==n?deepCopyStep(m,f.concat([m]),e.concat()):e[n]}else h[l]=m}return h}function recordData(d,f,e,h,k){k=defaultTo("record",k);store("record"+d,k);addListener(curLevel,k,d,function(){f.push(e.apply(h))},h)}function recordDataStop(d){var f=getStore("record"+d);removeListener(curLevel,f,d)}
function grabAttrs(d,f){var e={},h;for(h in d){e[h]={};for(var k=0;k<f.length;k++)e[h][f[k]]=d[h][f[k]]}return e}function execListeners(d){for(var f in d){var e=d[f];e.func.apply(e.obj)}}
function makeSlider(d,f,e,h,k,l,m,n){var p="";k=""+templater.center({innerHTML:k});p+=templater.div({attrs:{id:[h+"parent"]},style:{padding:"5px"},innerHTML:templater.div({attrs:{id:[h]}})});d.append(k);f.append(p);p=$(e+"parent");e=$(e);(!p.length||!e.length)&&p;addJQueryElems($(e),"slider");e.slider("option",l);for(l=0;l<m.length;l++){var q=m[l],p=q.eventType;k=q.obj;q=q.func;void 0===k?sliderBind(e,p,q,""):sliderBind(e,p,q,k)}if(n)div[n]();sliderList.push(h);return[d,f]}
function sliderBind(d,f,e,h){d.bind(f,function(d,f){e.apply(h,[d,f])});return d}function addJQueryElems(d,f){d=d instanceof Array?d:[d];for(var e=0;e<d.length;e++){var h=d[e];$(h)[f]();recursiveAddClass(h,globalHTMLClass)}}function recursiveAddClass(d,f){$(d).addClass(f);for(var e=$(d).children(),h=0;h<e.length;h++){var k=$(e[h]);recursiveAddClass(k,f)}}function stringTogetherGET(d){var f=[],e;for(e in d)f.push(e+"="+d[e]);return f.join("&")}
function hideSliders(){for(;0<sliderList.length;idIdx++)$("#"+sliderList[0]).hide()}function S(d,f,e){sceneNavigator.showPrompt(d,f,e)}function alertValid(d){void 0!==d&&""!=d&&alert(d)}function fillEmptyGraphDivs(){for(var d=0;d<graphHolderDivs.length;d++)fillEmptyGraphDiv($("#"+graphHolderDivs[d]))}function fillEmptyGraphDiv(d){"empty"==$(d).attr("filledWith")&&new GraphBlank(d)}function rotatePts(d,f,e){for(var h=0;h<d.length;h++)d[h].rotate(f,e)}
function mirrorPts(d,f,e){for(var h=0;h<d.length;h++)d[h].mirror(f,e);return d}function angleToUV(d){return V(Math.cos(d),Math.sin(d))}function UVToAngle(d){return Math.atan2(d.dy,d.dx)}function getSign(d){return 0>d?-1:1}function fracDiff(d,f){return Math.abs(d-f)/Math.min(Math.abs(d),Math.abs(f))}function getLen(d){for(var f=0,e=0;e<d.length-1;e++)f+=d[e].distTo(d[e+1]);return f}function exprHasReturn(d){return/(\(|\:|\?|\s)return/.test(" "+d)}
function byAttr(d,f,e){if(d instanceof Array)for(var h=0;h<d.length;h++){if(d[h][e]==f)return d[h]}else for(h in d)if(d[h][e]==f)return d[h]}function inRect(d,f,e){e=mouseOffset(e);return e.x>=d.x&&e.x<=d.x+f.dx&&e.y>=d.y&&e.y<=d.y+f.dy}function ptInRect(d,f,e){return e.x>=d.x&&e.x<=d.x+f.dx&&e.y>=d.y&&e.y<=d.y+f.dy}function extend(d,f){return function(){return f(d())}}function getNth(d,f){var e=0,h;for(h in d)if(e++==f)return d[h]}function countAttrs(d){var f=0,e;for(e in d)f++;return f}
function objectsEqual(d,f){return Math.min(objectsEqualInDirection(d,f),objectsEqualInDirection(f,d))}function objectsEqualInDirection(d,f){for(var e in d)if(f&&f.hasOwnProperty(e))if("object"==typeof d[e]){if(!objectsEqual(d[e],f[e]))return!1}else{if(d[e]!=f[e])return!1}else return!1;return!0}function rms(d){for(var f=0,e=0;e<d.length;e++)f+=d[e]*d[e];f/=d.length;return Math.sqrt(f)}globalMousePos=P(0,0);
function mouseOffset(d){d=$(d).offset();return P(globalMousePos.x-d.left,globalMousePos.y-d.top)}function mouseOffsetDiv(d){d=$("#"+d).offset();return P(globalMousePos.x-d.left,globalMousePos.y-d.top)}$(document).mousemove(function(d){globalMousePos.x=d.pageX;globalMousePos.y=d.pageY;for(var f in curLevel.mousemoveListeners)d=curLevel.mousemoveListeners[f],d.func.apply(d.obj)});$(document).mousedown(function(d){for(var f in curLevel.mousedownListeners)d=curLevel.mousedownListeners[f],d.func.apply(d.obj)});
$(document).mouseup(function(d){for(var f in curLevel.mouseupListeners)d=curLevel.mouseupListeners[f],d.func.apply(d.obj)});function DrawingTools(){}
DrawingTools.prototype={clear:function(d){var f=myCanvas.width,e=myCanvas.height;c.clearRect(0,0,f,e);c.fillStyle=d.hex;c.fillRect(0,0,f,e)},dots:function(){for(var d in spcs){var f=spcs[d].dots;c.fillStyle=spcs[d].col.hex;if(f[0])var e=f[0].r;for(var h=0;h<f.length;h++)c.beginPath(),c.arc(f[h].x,f[h].y,e,0,2*Math.PI,!0),c.closePath(),c.fill()}},dotsAsst:function(d){for(var f=0;f<d.length;f++)c.fillStyle=spcs[d[f].spcName].col.hex,c.beginPath(),c.arc(d[f].x,d[f].y,d[f].r,0,2*Math.PI,!0),c.closePath(),
c.fill()},walls:function(d,f){for(var e=0;e<d.length;e++){var h=d[e];if(h.show){c.beginPath();c.strokeStyle=h.col.hex;c.moveTo(h[0].x,h[0].y);for(var k=1;k<h.length-1;k++)c.lineTo(h[k].x,h[k].y);c.closePath();c.stroke()}}},circle:function(d,f,e,h,k){k.beginPath();k.arc(d.x,d.y,f,0,2*Math.PI,!0);k.closePath();h?(k.fillStyle=e.hex,k.fill()):(k.strokeStyle=e.hex,k.stroke())},fillPts:function(d,f,e){e.fillStyle=f.hex;e.beginPath();e.moveTo(d[0].x,d[0].y);for(f=1;f<d.length;f++)e.lineTo(d[f].x,d[f].y);
e.closePath();e.fill()},fillPtsAlpha:function(d,f,e,h){var k=h.globalAlpha;h.globalAlpha=e;draw.fillPts(d,f,h);h.globalAlpha=k},fillPtsStroke:function(d,f,e,h){h.fillStyle=f.hex;h.strokeStyle=e.hex;h.beginPath();h.moveTo(d[0].x,d[0].y);for(f=1;f<d.length;f++)h.lineTo(d[f].x,d[f].y);h.closePath();h.stroke();h.fill()},roundedRect:function(d,f,e,h,k){var l=d.x;d=d.y;var m=f.dx;f=f.dy;k.fillStyle=h.hex;k.beginPath();k.moveTo(l+e,d);this.curvedLine(P(l+m-e,d),P(l+m,d),P(l+m,d+e),k);this.curvedLine(P(l+
m,d+f-e),P(l+m,d+f),P(l+m-e,d+f),k);this.curvedLine(P(l+e,d+f),P(l,d+f),P(l,d+f-e),k);this.curvedLine(P(l,d+e),P(l,d),P(l+e,d),k);k.closePath();k.fill()},fillRect:function(d,f,e,h){h.fillStyle=e.hex;h.fillRect(d.x,d.y,f.dx,f.dy)},fillStrokeRect:function(d,f,e,h,k){k.strokeStyle=h.hex;k.fillStyle=e.hex;k.fillRect(d.x,d.y,f.dx,f.dy);k.strokeRect(d.x,d.y,f.dx,f.dy)},strokeRect:function(d,f,e,h){h.strokeStyle=e.hex;h.strokeRect(d.x,d.y,f.dx,f.dy)},line:function(d,f,e,h){h.strokeStyle=e.hex;h.beginPath();
h.moveTo(d.x,d.y);h.lineTo(f.x,f.y);h.closePath();h.stroke()},curvedLine:function(d,f,e,h){h.lineTo(d.x,d.y);h.quadraticCurveTo(f.x,f.y,e.x,e.y)},path:function(d,f,e){e.strokeStyle=f.hex;e.beginPath();e.moveTo(d[0].x,d[0].y);for(f=1;f<d.length;f++)e.lineTo(d[f].x,d[f].y);e.stroke()},text:function(d,f,e,h,k,l,m){m.save();m.translate(f.x,f.y);m.rotate(l);m.fillStyle=h.hex;m.font=e;m.textAlign=k;f=parseFloat(e);e=0;for(h=d.indexOf("\n");-1!=h;)k=d.slice(0,h),m.fillText(k,0,e),e+=f+2,d=d.slice(h+1,d.length),
h=d.indexOf("\n");m.fillText(d,0,e);m.restore()}};function DotManager(){this.lists={ALLDOTS:[]};this.spcLists={};this.count=0}
DotManager.prototype={add:function(d){d instanceof Array?this.count+=d.length:this.count++;this.execAllCombos(this.addFunc,d)},remove:function(d){if(d instanceof Array){this.count-=d.length;for(var f=0;f<d.length;f++)d[f].kill()}else this.count--,d.kill()},removeByAttr:function(d,f){for(var e=this.lists.ALLDOTS,h=e.length-1;0<=h;h--)e[h][d]==f&&e[h].kill()},changeDotSpc:function(d,f){d instanceof Array||(d=[d]);for(var e=spcs[f],h=0;h<d.length;h++){var k=d[h],l=(k.hF298-1E3*e.hF298/N+k.cv*(k.temp()-
298.15))/(e.cv/N)+298.15;if(0<l){for(var m=0;m<k.parentLists.length;m++)k.parentLists[m].splice(k.parentLists[m].indexOf(k),1);k.parentLists=[];k.m=e.m;k.r=e.r;k.col=e.col;k.spcName=e.spcName;k.hF298=1E3*e.hF298/N;k.hVap298=1E3*e.hVap298/N;k.idNum=e.idNum;k.cvKinetic=1.5*R/N;k.cv=e.cv/N;k.cp=k.cv+R;k.cpLiq=e.cpLiq/N;k.spcVolLiq=e.spcVolLiq/N;k.setTempNoReference(l);l=this.getRelevantLists(k);for(m=0;m<l.length;m++)k.parentLists.push(l[m]),l[m].push(k)}}},changeDotWall:function(d,f){var e,h;d instanceof
Array||(d=[d]);for(var k=0;k<d.length;k++){var l=d[k];l.tag=f;l.returnTo=f;e=0;for(h=l.parentLists.length;e<h;e++)l.parentLists[e].splice(l.parentLists[e].indexOf(l),1);l.parentLists=[];var m=this.getRelevantLists(l);e=0;for(h=m.length;e<h;e++)l.parentLists.push(m[e]),m[e].push(l)}},addSpcs:function(d){this.lists[d]||(this.lists[d]=[],this.spcLists[d]=this.lists[d]);return this.lists[d]},removeByInfo:function(d){d.spcName&&d.tag?this.execAllCombos(this.removeByNameAndTagFunc,d):d.spcName?this.execAllCombos(this.removeByNameFunc,
d):d.tag?this.execAllCombos(this.removeByTagFunc,d):(console.log("No useful info given to removeByInfo func in DotManager"),console.trace())},getWithLog:function(d){var f=this.get(d);if(f)return f;console.log("Bad species data");console.log(d)},get:function(d){return this.createIfNotExists(d)},clearAll:function(){for(var d in this.lists)this.lists[d].splice(0,this.lists[d].length)},createIfNotExists:function(d){if(d){if(d.spcName&&d.tag)return this.getByNameAndTag(d);if(d.spcName)return this.getByName(d.spcName);
if(d.tag)return this.getByTag(d.tag)}else return this.lists.ALLDOTS},addFunc:function(d,f){d.push(f);f.parentLists.push(d)},removeFunc:function(d,f){var e=d.indexOf(f);-1<e?(d.splice(e,1),f.parentLists.splice(f.parentLists.indexOf(d),1)):(console.log("Tried to remove dot from global list of spcName "+f.spcName+" and tag "+f.tag+". Dot not present."),console.trace())},removeByNameAndTagFunc:function(d,f){for(var e=d.length-1;-1<e;e--)d[e].spcName==f.spcName&&d[e].tag==f.tag&&d[e].kill()},removeByNameFunc:function(d,
f){for(var e=d.length-1;-1<e;e--)d[e].spcName==f.spcName&&(d.splice(e,1),d[e].kill())},removeByNameAndTagFunc:function(d,f){for(var e=d.length-1;-1<e;e--)d[e].tag==f.tag&&(d.splice(e,1),d[e].kill())},execAllCombos:function(d,f){if(f instanceof Array&&f.length)var e=f,h={spcName:e[0].spcName,tag:e[0].tag};else h=f;h=this.getRelevantLists(h);if(e)for(var k=0;k<e.length;k++)this.execFuncOnLists(d,h,e[k]);else f instanceof Dot&&this.execFuncOnLists(d,h,f)},execFuncOnLists:function(d,f,e){e.active=!0;
for(var h=0;h<f.length;h++)d(f[h],e)},getRelevantLists:function(d){var f=[];f.push(this.lists.ALLDOTS);d.spcName&&d.tag&&f.push(this.getByNameAndTag(d));d.spcName&&f.push(this.getByName(d.spcName));d.tag&&f.push(this.getByTag(d.tag));return f},getByNameAndTag:function(d){if(this.lists[d.spcName+"-"+d.tag])return this.lists[d.spcName+"-"+d.tag];if(spcs[d.spcName])return this.lists[d.spcName+"-"+d.tag]=[],this.lists[d.spcName+"-"+d.tag];console.log("Tried to get bad spcName "+spcName);console.trace()},
getByName:function(d){if(this.lists[d])return this.lists[d];if(spcs[d])return this.lists[d]=[],this.lists[d];console.log("Tried to get bad spcName "+d);console.trace()},getByTag:function(d){this.lists[d]||(this.lists[d]=[]);return this.lists[d]}};AuxFunctions={getDims:function(){var d=$("#main").height(),d=d-$("#auxSpacer").height();return V(400,d/2)},pickParentDiv:function(d,f){if(void 0===f){for(var e=0;e<auxHolderDivs.length;e++){var h=$("#"+auxHolderDivs[e]),k=$(h).attr("filledWith");if(""==k)return $(h).attr("filledWith",d),h}console.log("Aux divs are all full!");console.trace()}else{h=$("#"+auxHolderDivs[f]);if(!h.length)return console.log("Bad div idx "+f+".  Defaulting to next empty slot"),this.pickParentDiv(d);k=$(h).attr("filledWith");
if(""==k||void 0==k)return $(h).attr("filledWith",d),h;console.log("Trying to add "+d+" in "+f+" but "+f+" is already filled with "+k+".");console.log("Defaulting to next empty slot");return this.pickParentDiv(d)}},parentDivEmpty:function(){var d=this.parentDiv.attr("filledWith");return void 0==d||""==d},cleanUpParent:function(){$(this.parentDiv).removeAttr("style");$(this.parentDiv).html("");$(this.parentDiv).attr("filledWith","")}};function PhaseEquilGenerator(){this.oneComp=new PhaseEquilGenerator.OneComp;this.twoComp=new PhaseEquilGenerator.TwoComp}PhaseEquilGenerator.TwoComp=function(){};
PhaseEquilGenerator.TwoComp.prototype={constP:function(d,f,e,h,k){var l=d.tBoil(h),m=f.tBoil(h),n=l<m?d:f;d=l>m?d:f;e=this.makeConstPEquil(h,n,d,l<m?l:m,l>m?l:m,e[n.spcName],e[d.spcName],k);return new PhaseEquilGenerator.TwoComp.EquilData(e,n.spcName,d.spcName,h)},makeConstPEquil:function(d,f,e,h,k,l,m,n){for(var p=[],q=1/(n-1),r=0,t=0;r<n;r++){var u=this.solveTAtStep(h+(k-h)*t,d,t,f,e,h,k,l,m);if(!1!==u){var x=this.solvePTotal(u,t,f,e,l,m),v=this.pSpc(f,u,l,1-t);p.push(new PhaseEquilGenerator.TwoComp.EquilPt(1-
t,t,v/x,1-v/x,u,d))}t+=q}return p},solveTAtStep:function(d,f,e,h,k,l,m,n,p){for(var q=this.solvePTotal(d,e,h,k,n,p),r=0;0.01<fracDiff(q,f);){r++;var t=this.getDPDT(d,e,h,k,l,m,n,p);d+=(f-q)/t;q=this.solvePTotal(d,e,h,k,n,p);if(40==r)return!1}return d},getDPDT:function(d,f,e,h,k,l,m,n){k=0.995*d;d*=1.005;l=this.solvePTotal(k,f,e,h,m,n);return(this.solvePTotal(d,f,e,h,m,n)-l)/(d-k)},solvePTotal:function(d,f,e,h,k,l){e=this.pSpc(e,d,k,1-f);d=this.pSpc(h,d,l,f);return e+d},pSpc:function(d,f,e,h){return d.pPure(f)*
e(h,f)*h}};PhaseEquilGenerator.TwoComp.EquilPt=function(d,f,e,h,k,l){this.xLight=d;this.xHeavy=f;this.yLight=e;this.yHeavy=h;this.temp=k;this.pressure=l};PhaseEquilGenerator.TwoComp.EquilData=function(d,f,e,h){this.data=d;this.keyLight=f;this.keyHeavy=e;this.pressure=h};PhaseEquilGenerator.OneComp=function(){};
PhaseEquilGenerator.OneComp.prototype={equilData:function(d,f,e,h,k){k=window.spcs[d];d=this.genLiqGasData(k,f,e);e=this.genSolidLiqEqData(k,f,e);f=this.genSolidGasEqData(k,h,f);return[d,e,f]},genLiqGasData:function(d,f,e){for(var h=[],k=f;k<=e;k+=(e-f)/20){var l=d.pPure(k);h.push(new PhaseEquilGenerator.OneComp.EquilPt(d.spcName,k,l))}return h},genSolidLiqEqData:function(d,f,e){var h=d.pPure(f);e=d.pPure(e);h=new PhaseEquilGenerator.OneComp.EquilPt(d.spcName,f,h);d=new PhaseEquilGenerator.OneComp.EquilPt(d.spcName,
f,e);return[h,d]},genSolidGasEqData:function(d,f,e){for(var h=[],k=d.pPure(e),l=0.5*d.pPure(f),m=Math.log(k/l)/(e-f),n=l/Math.exp(m*f),p=0;20>p;p++){var q=f+p/19*(e-f),r=n*Math.exp(q*m),r=l+(r-l)*Math.log((Math.E-1)*(r-l)/(k-l)+1);h.push(new PhaseEquilGenerator.OneComp.EquilPt(d.spcName,q,r))}return h}};PhaseEquilGenerator.OneComp.EquilPt=function(d,f,e){this.spcName=d;this.temp=f;this.pressure=e};GraphBase={setStds:function(){window.storedGraphs[this.handle]=this;window.curLevel.graphs[this.handle]=this;this.hashMarkLen=10;this.checkMarkOversize=3;this.bgCol=curLevel.bgCol;this.gridCol=Col(72,72,72);this.toggleCol=Col(255,255,255);this.data={};this.legend={};this.markers={};this.textCol=Col(255,255,255);this.flashMult=1.5;this.flashRate=0.1;this.graphBoundCol=Col(255,255,255);this.integralCol=Col(150,150,150);this.integralAlpha=0.5;this.ptStroke=Col(0,0,0);this.rectSideLen=8;this.characLen=
Math.sqrt(Math.pow(this.rectSideLen,2)/2);this.buttonId=this.handle+"Reset";this.graphId=this.handle+"Graph";this.parentDiv=this.pickParentDiv("graph");this.parentDivId=$(this.parentDiv).attr("id");this.makeReset=defaultTo(!0,this.makeReset);var d=this.makeCanvas(this.dims,this.parentDiv,this.handle+"Graph",this.makeReset,this.handle+"Button");this.graphDisplayHTMLElement=d.HTMLElem;this.graphDisplay=d.canvas;this.layers=new GraphBase.Layers;this.wrapperId;this.initDrawLayers();this.hasData=!1},makeDataFunc:function(d){with(DataGetFuncs)return exprHasReturn(d)?
eval("(function(){"+d+"})"):eval("(function(){return "+d+"})")},initDrawLayers:function(){addListener(curLevel,"update","drawLayers"+this.handle,this.drawLayers,this)},setNumGridLinesAndSpacing:function(d){var f,e,h;d=d?d:{};d.x?(f=d.x,e=this.getGridSpacing(f,this.graphRangeFrac.x,this.dims.dx)):(e=40,f=Math.ceil(this.dims.dx*Math.abs(this.graphRangeFrac.x.max-this.graphRangeFrac.x.min)/e));d.y?(d=d.y,h=this.getGridSpacing(d,this.graphRangeFrac.y,this.dims.dy)):(h=40,d=Math.ceil(this.dims.dy*Math.abs(this.graphRangeFrac.y.max-
this.graphRangeFrac.y.min)/h));this.numGridLines=P(f,d);this.gridSpacing=P(e,h)},makeCanvas:function(d,f,e,h,k){var l=this;f.html("");d=templater.canvas({attrs:{id:[e],"class":["noSelect"],width:[d.dx],height:[d.dy]}});h&&(d+=templater.button({attrs:{id:[k]},style:{position:"absolute",right:".5em",bottom:".5em"},innerHTML:templater.img({attrs:{src:[window.IMGPATHPREFIX+"img/refresh.gif"]}})}));d=$(d);$(f).append(d);h&&(addJQueryElems($("#"+k),"button"),$("#"+k).click(function(){l.reset()}));f=document.getElementById(e);
e=f.getContext("2d");return{HTMLElem:f,canvas:e}},restoreHTML:function(){this.parentDivEmpty()||(this.parentDiv=this.pickParentDiv("graph"),this.parentDivId=$(this.parentDiv).attr("id"));var d=this.makeCanvas(this.dims,this.parentDiv,this.handle+"Graph",this.makeReset,this.handle+"Button");this.graphDisplayHTMLElement=d.HTMLElem;this.graphDisplay=d.canvas;this.layers.setDrawCanvas(this.graphDisplay);if(this.legend)for(var f in this.legend)this.legend[f].setCanvas(this.graphDisplay),this.legend[f].toggleActivate()},
clearHTML:function(){this.cleanUpParent()},remove:function(){this.disable();removeListener(curLevel,"update","drawLayers"+this.handle);removeListenerByName(curLevel,"update","flashAdvance"+this.handle);this.layers.removeAll();this.cleanUpParent();return this},enable:function(d){for(var f in this.data)this.data[f].recordStart();this.active=!0;if(d){for(f in this.data)this.data[f].addVal();this.addLast()}return this},disable:function(){for(var d in this.data)this.data[d].recordStop();this.active=!1;
return this},integrate:function(d){this.data[d].integralPts=this.getIntegralPts(d);this.drawIntegral(d);return this},getIntegralPts:function(d){var f=this.data[d].src.x,e=this.data[d].src.y;d=Array(f.length);for(var h=0;h<f.length;h++)d[h]=this.valToCoord(P(f[h],e[h]));f=this.yStart*this.dims.dy;e=d[0].x;d.push(P(d[d.length-1].x,f));d.push(P(e,f));return d},setData:function(d,f){var e=this.data[d];e?e.setData(f):console.log("Bad set handle "+d)},drawAllBG:function(){this.drawBGRect();this.drawGrid();
this.drawBounds();this.legend&&this.drawLegend();this.drawLabels()},drawBGRect:function(){draw.roundedRect(P(0,0),V(this.dims.dx,this.dims.dy),20,this.bgCol,this.graphDisplay)},drawGrid:function(){for(var d=this.axisRange.x.min/10,f=0;f<this.numGridLines.x;f++){var d=this.logScale.x?10*d:this.axisRange.x.min+this.stepSize.x*f,e=this.valToCoord(P(d,1)),h=e.x,k=this.graphRangeFrac.y.max*this.dims.dy,e=P(h,this.graphRangeFrac.y.min*this.dims.dy+this.hashMarkLen),h=P(h,k);draw.line(e,h,this.gridCol,this.graphDisplay)}d=
this.axisRange.y.min/10;for(f=0;f<this.numGridLines.y;f++)d=this.logScale.y?10*d:this.axisRange.y.min+this.stepSize.y*f,e=this.valToCoord(P(1,d)),h=e.y,k=this.graphRangeFrac.x.min*this.dims.dx,e=P(this.graphRangeFrac.x.max*this.dims.dx-this.hashMarkLen,h),h=P(k,h),draw.line(e,h,this.gridCol,this.graphDisplay)},drawBounds:function(){var d=P(this.graphRangeFrac.x.min*this.dims.dx,this.graphRangeFrac.y.max*this.dims.dy),f=V(this.dims.dx*(this.graphRangeFrac.x.max-this.graphRangeFrac.x.min),this.dims.dy*
(this.graphRangeFrac.y.min-this.graphRangeFrac.y.max));draw.strokeRect(d,f,this.graphBoundCol,this.graphDisplay)},drawLabels:function(){var d=P(this.dims.dx*(this.graphRangeFrac.x.min+this.graphRangeFrac.x.max)/2,Math.min(this.dims.dy*this.graphRangeFrac.y.min+50,this.dims.dy-20)),f=P(Math.max(this.dims.dx*this.graphRangeFrac.x.min-50,20),this.dims.dy*(this.graphRangeFrac.y.min+this.graphRangeFrac.y.max)/2);d.y+=this.labelFontSize/2;f.y+=this.labelFontSize/2;draw.text(this.xLabel,d,this.labelFont,
this.textCol,"center",0,this.graphDisplay);draw.text(this.yLabel,f,this.labelFont,this.textCol,"center",-Math.PI/2,this.graphDisplay)},drawLegend:function(){for(var d in this.legend)this.legend[d].draw()},drawMarkers:function(){for(var d in this.markers)this.markers[d].draw()},clearData:function(d,f){var e=this.data[d];e&&e.clearData();f&&this.drawAllData()},enqueueData:function(d,f){var e=this.data[d];e&&e.enqueueData(f)},updateRange:function(){var d=this.valRange.copy(),f;for(f in this.data)this.data[f].updateRange(this.valRange);
this.setAxisBounds(d)},flushQueues:function(d,f){f=defaultTo(!1,f);d=defaultTo(!0,d);var e=this.valRange.copy(),h;for(h in this.data){var k=this.data[h];k.visible&&k.updateRange(this.valRange)}k=this.axisRange.copy();this.setAxisBounds(e);if(!this.rangeIsSame(k.x,this.axisRange.x)||!this.rangeIsSame(k.y,this.axisRange.y))f=!0;f?this.drawAllData():this.drawPts();d&&this.flashInit();for(h in this.data)this.data[h].flushQueue();this.drawLayers()},drawLayers:function(d){if((turn%2||d)&&this.hasData&&
this.layers.count){this.drawAllData();for(d=0;d<this.layers.layers.length;d++)for(var f=this.layers.layers[d],e=0;e<f.length;e++)f[e].draw()}},flashInit:function(){for(var d in this.data)this.data[d].flashInit()},rangeIsSame:function(d,f){return!(d.max!=f.max||d.min!=f.min)},getGridSpacing:function(d,f,e){f=e*Math.abs(f.max-f.min);return(f-20)/(d-1)},setAxisBounds:function(d){this.setAxisBoundsX(d);this.setAxisBoundsY(d)},setAxisBoundsX:function(d){var f=this.axisInit,e=this.valRange;!(f.x.min<e.x.min&&
f.x.max>e.x.max)&&!this.axesFixed.x?d?this.rangeIsSame(d.x,this.valRange.x)||this.getXBounds():this.getXBounds():this.setAxisToInit("x")},setAxisBoundsY:function(d){var f=this.axisInit,e=this.valRange;!(f.y.min<e.y.min&&f.y.max>e.y.max)&&!this.axesFixed.y?d?this.rangeIsSame(d.y,this.valRange.y)||this.getYBounds():this.getYBounds():this.setAxisToInit("y")},setAxisToInit:function(d){var f=this.axisRange[d],e=this.axisInit[d],h=this.numGridLines[d];f.min=e.min;f.max=e.max;this.stepSize[d]=(f.max-f.min)/
(h-1)},getXBounds:function(){var d=this.valRange.x.max-this.valRange.x.min,f=void 0,e=void 0;0!=d?this.logScale.x?(e=this.numGridLines.x-1,f=Math.pow(10,Math.floor(Math.log(this.valRange.x.min)/Math.LN10)),e=f*Math.pow(10,e),d=1):(f=d/(this.numGridLines.x-2),e=Math.pow(10,Math.floor(Math.log10(f))),d=Math.ceil(f/e)*e,f=Math.floor(this.valRange.x.min/d)*d,e=f+(this.numGridLines.x-1)*d):(d=0.2,f=Math.floor(this.valRange.x.min),e=f+d*this.numGridLines.x);if(f<this.axisRange.x.min||e>this.axisRange.x.max)this.axisRange.x.min=
f,this.axisRange.x.max=e,this.stepSize.x=d},getYBounds:function(){var d=Math.abs(this.valRange.y.max-this.valRange.y.min),f=void 0,e=void 0;0!=d?this.logScale.y?(e=this.numGridLines.y-1,f=Math.pow(10,Math.floor(Math.log(this.valRange.y.min)/Math.LN10)),e=f*Math.pow(10,e),d=1):(f=d/(this.numGridLines.y-2),e=Math.pow(10,Math.floor(Math.log10(f))),d=Math.ceil(f/e)*e,f=Math.floor(this.valRange.y.min/d)*d,e=f+(this.numGridLines.y-1)*d):(f=Math.floor(this.valRange.y.min),d=0.2,e=f+d*this.numGridLines.y);
if(f<this.axisRange.y.min||e>this.axisRange.y.max)this.axisRange.y.min=f,this.axisRange.y.max=e,this.stepSize.y=d},drawAxisVals:function(){if(0<this.stepSize.x&&0<this.stepSize.y){for(var d=0;d<this.numGridLines.x;d++){var f=this.graphRangeFrac.x.min*this.dims.dx+this.gridSpacing.x*d,e=this.graphRangeFrac.y.min*this.dims.dy+this.hashMarkLen+10+this.axisValFontSize/2,h;h=this.logScale.x?this.numToAxisVal(this.axisRange.x.min*Math.pow(10,d)):this.numToAxisVal(this.axisRange.x.min+this.stepSize.x*d,
1);draw.text(h,P(f,e),this.axisValFont,this.textCol,"center",0,this.graphDisplay)}for(d=0;d<this.numGridLines.y;d++)e=this.graphRangeFrac.y.min*this.dims.dy-this.gridSpacing.y*d,f=this.graphRangeFrac.x.min*this.dims.dx-this.hashMarkLen-10,h=this.logScale.y?this.numToAxisVal(this.axisRange.y.min*Math.pow(10,d)):this.numToAxisVal(this.axisRange.y.min+this.stepSize.y*d,1),draw.text(h,P(f,e),this.axisValFont,this.textCol,"center",-Math.PI/2,this.graphDisplay)}},makeLegendEntry:function(d,f,e,h){var k=
this.dims.dx-this.legendWidth+5,l=30,m;for(m in this.legend)l+=35;d=new GraphBase.LegendEntry(this,d,f,k,l,this.legendFontSize,this.dims,this.toggleCol,this.legendFont,this.textCol,h);d.toggleActivate();this.legend[e]=d;this.drawAllBG()},numToAxisVal:function(d){return(0.1>=Math.abs(d)||1E3<=Math.abs(d))&&0!=d?d.toExponential():d.toFixed(1)},getRange:function(d){var f=Number.MAX_VALUE,e=-Number.MAX_VALUE,h;for(h in this.data)for(var k=this.data[h].data[d],l=0;l<k.length;l++)var m=k[l],f=Math.min(f,
m),e=Math.max(e,m);return{min:f,max:e}},resetStd:function(){for(var d in this.data)this.data[d].reset();removeListener(curLevel,"update","flash"+this.name);this.drawAllBG();this.resetRanges();this.hasData=!1},resetRanges:function(){this.axisRange=new GraphBase.Range(Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE);this.valRange=new GraphBase.Range(Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE)},ptsExist:function(d){for(var f=0;f<d.length;f++){var e=d[f];
if(void 0===e.x||void 0===e.y||isNaN(e.x)||isNaN(e.y))return!1}return!0},valToCoord:function(d){var f;f=this.logScale.x?this.graphRangeFrac.x.min*this.dims.dx+this.gridSpacing.x*(this.numGridLines.x-1)*Math.log(d.x/this.axisRange.x.min)/Math.log(this.axisRange.x.max/this.axisRange.x.min):this.graphRangeFrac.x.min*this.dims.dx+this.gridSpacing.x*(this.numGridLines.x-1)*(d.x-this.axisRange.x.min)/(this.axisRange.x.max-this.axisRange.x.min);d=this.logScale.y?this.dims.dy-(1-this.graphRangeFrac.y.min)*
this.dims.dy-this.gridSpacing.y*Math.log(d.y/this.axisRange.y.min)/Math.LN10:this.dims.dy-(1-this.graphRangeFrac.y.min)*this.dims.dy-this.gridSpacing.y*(this.numGridLines.y-1)*(d.y-this.axisRange.y.min)/(this.axisRange.y.max-this.axisRange.y.min);return P(f,d)},dataScaling:function(){return V(this.gridSpacing.x/this.stepSize.x,this.gridSpacing.y/this.stepSize.y)},checkMark:function(d,f,e,h,k){var l=Col(0,0,0);d.x-=e;d.y-=e;f.dx+=2*e;f.dy+=2*e;return new CheckMark(d,f,h,l,k)},addMarker:function(d){d.handle?
(d.graphDisplay=this.graphDisplay,d.graph=this,d.layers=this.layers,this.markers[d.handle]=new GraphBase.Marker(d)):console.log("Tried to add a graph marker for "+this.handle+" with no handle.  Add a handle.")},LegendEntry:function(d,f,e,h,k,l,m,n,p,q,r){this.graph=d;this.set=f;this.pos=P(h,k);this.font=p;this.textCol=q;this.toggleCol=n;this.text=e;this.textPos=P(h+10,k+l/2);this.fontSize=l;this.boxPos=P(m.dx-18,k-5);this.boxDims=V(13,13);this.mouseListenerName="toggle"+this.graph.handle.toCapitalCamelCase()+
this.set.handle.toCapitalCamelCase();this.drawMarker=r;this.checkMark=d.checkMark(this.boxPos.copy(),this.boxDims.copy(),d.checkMarkOversize,d.toggleCol,d.graphDisplay)}};
GraphBase.LegendEntry.prototype={draw:function(){this.drawToggle();this.drawText();this.drawMarker(this.pos)},drawToggle:function(){draw.fillStrokeRect(this.boxPos,this.boxDims,this.graph.gridCol,this.toggleCol,this.graph.graphDisplay);this.set.visible&&this.checkMark.draw()},drawText:function(){draw.text(this.text,this.textPos,this.font,this.textCol,"left",0,this.graph.graphDisplay)},toggle:function(){ptInRect(this.boxPos,this.boxDims,mouseOffsetDiv(this.graph.parentDivId))&&(this.set.visible=this.set.visible?
!1:!0,this.graph.drawAllBG(),this.graph.drawAllData())},toggleActivate:function(){addListener(curLevel,"mouseup",this.mouseListenerName,this.toggle,this)},toggleDeactivate:function(){removeListener(curLevel,"mouseup",this.mouseListenerName)},setCanvas:function(d){this.checkMark.setCanvas(d)}};GraphBase.Range=function(d,f,e,h){this.x={min:d,max:f};this.y={min:e,max:h}};GraphBase.Range.prototype={copy:function(){return new GraphBase.Range(this.x.min,this.x.max,this.y.min,this.y.max)}};
GraphBase.Marker=function(d){this.handle=d.handle;this.dataX="function"==typeof d.x?d.x:this.wrapInDataGet(d.x);this.dataY="function"==typeof d.y?d.y:this.wrapInDataGet(d.y);this.graph=d.graph;this.graphDisplay=d.graphDisplay;validNumber(this.dataX())&&validNumber(this.dataY())?this.coordLast=this.graph.valToCoord(P(this.dataX(),this.dataY())):this.coordLast=void 0;this.markerType=d.markerType;this.col=d.col;this.visible=!0;this.layers=d.layers;this.dataValid=!0;if(this.drawFuncs[this.markerType])this.drawCB=
this.drawFuncs[this.markerType];else{console.log("Bad marker type "+this.markerType+".  Choices include ");for(var f in this.drawFuncs)console.log(f)}this.characLen=15;this.imgCharacLen=this.characLen+2;this.layers.addItem("marker",this);var e=this;d.label&&(this.legendEntry=this.addLegendEntry(d.label,function(d){e.drawCB(d)}))};
GraphBase.Marker.prototype={wrapInDataGet:function(d){with(DataGetFuncs)d=exprHasReturn(d)?eval("(function(){"+d+"})"):eval("(function(){return "+d+"})");return d},setDataValid:function(){try{this.dataValid=!1!==validNumber(this.dataX())&&!1!==validNumber(this.dataY())?!0:!1}catch(d){this.dataValid=!1}},setDrawCanvas:function(d){this.graphDisplay=d},addLegendEntry:function(d,f){this.graph.makeLegendEntry(this,d,this.handle,f)},draw:function(){this.visible&&(this.dataValid&&(this.coordLast=this.graph.valToCoord(P(this.dataX(),
this.dataY()))),this.drawCB(this.coordLast))},drawFuncs:{bullseye:function(d){var f=this.characLen;window.draw.circle(d,0.15*f,this.col,!0,this.graphDisplay);window.draw.line(d.copy().movePt(V(-f/2,0)),d.copy().movePt(V(f/2,0)),this.col,this.graphDisplay);window.draw.line(d.copy().movePt(V(0,-f/2)),d.copy().movePt(V(0,f/2)),this.col,this.graphDisplay);window.draw.circle(d,0.3*f,this.col,!1,this.graphDisplay)}},remove:function(){this.layers.removeItem("marker",this)}};
GraphBase.Layers=function(){this.layers=[];this.handleIdxPairs={};this.count=0};
GraphBase.Layers.prototype={addLayer:function(d){this.layers.push([]);this.handleIdxPairs[d]=this.layers.length-1},setDrawCanvas:function(d){for(var f=0;f<this.layers.length;f++)for(var e=this.layers[f],h=0;h<e.length;h++)e[h].setDrawCanvas(d)},removeLayer:function(d){var f=this.handleIdxPairs[d];for(d in this.handleIdxPairs)this.handleIdxPairs[d]>f&&this.handleIdxPairs[d]--;this.count-=this.layers[f].length;this.layers.splice(f,1);delete this.handleIdxPairs[d]},addItem:function(d,f){this.layers[this.handleIdxPairs[d]].push(f);
this.count++},removeItem:function(d,f){var e=this.layers[this.handleIdxPairs[d]].indexOf(f);this.layers[this.handleIdxPairs[d]].splice(e,1);this.count--},removeAll:function(){for(var d=0;d<this.layers.length;d++)for(var f=this.layers[d],e=0;e<f.length;e++)f[e].remove()}};function GraphPhaseTwoComp(d){this.spcAName=d.spcAName;this.spcBName=d.spcBName;this.spcA=spcs[this.spcAName];this.spcB=spcs[this.spcBName];this.wallGas=d.wallGas;this.liquid=d.liquid;this.primaryKeyType=/light/i.test(d.primaryKey)?"Light":"Heavy";this.handle=d.handle;this.actCoeffFuncs=d.actCoeffFuncs;this.pressure=d.pressure||1;d.axesFixed={x:!0};d.numGridLines={x:6};this.keyNamePairs=this.getKeyNamePairs(this.spcA,this.spcB,this.pressure);(!this.spcA||!this.spcB)&&console.log("Bad species data for phase diagram "+
this.spcAName+" "+this.spcBName);d.yLabel="Temp";d.xLabel="frac "+this.keyNamePairs[this.primaryKeyType].toCapitalCamelCase();d.makeReset=!1;this.graph=new GraphScatter(d);this.equilData;this.updateEquilData(this.pressure);this.equilDataHandle=this.handle+"PhaseData";this.graph.addSet({handle:this.equilDataHandle,label:"Phase\nData",pointCol:Col(255,255,255),flashCol:Col(0,0,0),trace:!0,recording:!1,showPts:!1});this.recordFracData(this.wallGas,this.keyNamePairs[this.primaryKeyType]);this.recordFracData(this.liquid.wallLiq,
this.keyNamePairs[this.primaryKeyType]);var f=this.liquid;this.liqTempFunc=function(){return f.temp};this.gasTempFunc=this.makeTempFunc(this.wallGas);this.yFuncKillLow=this.makeFracFunc(this.wallGas,this.keyNamePairs[this.primaryKeyType],!0);this.yFunc=this.makeFracFunc(this.wallGas,this.keyNamePairs[this.primaryKeyType]);this.xFuncKillLow=this.makeFracFunc(this.liquid.wallLiq,this.keyNamePairs[this.primaryKeyType],!0);this.xFunc=this.makeFracFunc(this.liquid.wallLiq,this.keyNamePairs[this.primaryKeyType]);
this.updateGraph();this.active=!1;defaultTo(!0,d.makeLiquidMarker)&&this.makeLiquidMarker();defaultTo(!0,d.makeSystemMarker)&&this.makeSystemMarker();defaultTo(!0,d.makeGasMarker)&&this.makeGasMarker();this.graph.hasData=!0}
GraphPhaseTwoComp.prototype={recordFracData:function(d,f){d.recordFrac({spcName:f,tag:d.handle})},setDataValid:function(){this.graph.setDataValid()},makeLiquidMarker:function(){this.graph.addMarker({handle:"liquid",col:Col(200,0,0),markerType:"bullseye",x:this.xFuncKillLow,y:this.liqTempFunc,label:"Liquid"})},makeSystemMarker:function(){var d=this,f=d.liquid,e=f.wallGas,h=f.wallGas.dotManager,k=f.wallLiq.dotManager;this.graph.addMarker({handle:"system",col:Col(200,200,0),markerType:"bullseye",x:function(){return(d.xFunc()*
k.count+d.yFunc()*h.count)/(h.count+k.count)},y:function(){var h=e.getCv();return(h*d.gasTempFunc()+f.Cp*d.liqTempFunc())/(h+f.Cp)},label:"System"})},makeGasMarker:function(){this.graph.addMarker({handle:"gas",col:Col(0,200,0),markerType:"bullseye",x:this.yFuncKillLow,y:this.gasTempFunc,label:"Gas"})},makeTempFunc:function(d){var f=d.getDataSrc("temp");return function(){for(var d=0,h=Math.max(0,f.length-30);h<f.length;h++)d+=f[h];return d/Math.min(Math.max(1,f.length),30)}},makeFracFunc:function(d,
f,e){var h=d.getDataSrc("frac",{spcName:f,tag:d.handle}),k=d.dotManager;return e?function(){if(50<k.count){for(var d=0,e=Math.max(0,h.length-30);e<h.length;e++)d+=h[e];return d/Math.min(Math.max(1,h.length),30)}return-1E5}:function(){for(var d=0,e=Math.max(0,h.length-30);e<h.length;e++)d+=h[e];return d/Math.min(Math.max(1,h.length),30)}},clearHTML:function(){this.graph.clearHTML()},restoreHTML:function(){this.graph.restoreHTML()},drawAllData:function(){this.graph.drawAllData()},disable:function(){this.graph.disable()},
save:function(){},addLast:function(){this.graph.addLast()},remove:function(){this.graph.remove()},setPressure:function(d){var f=this.updateEquilData(d);this.updateGraph();this.pressure=d;return f},getKeyNamePairs:function(d,f,e){return d.tBoil(e)<f.tBoil(e)?{Light:d.spcName,Heavy:f.spcName}:{Light:f.spcName,Heavy:d.spcName}},updateEquilData:function(d){d=phaseEquilGenerator.twoComp.constP(this.spcA,this.spcB,this.actCoeffFuncs,d,20);for(var f=[],e=[],h=0;h<d.data.length;h++){var k=d.data[h],l=k.temp,
m=k["y"+this.primaryKeyType];f.push(P(k["x"+this.primaryKeyType],l));e.push(P(m,l))}this.equilData=f.concat(e.reverse());return d},updateGraph:function(){this.graph.clearData(this.equilDataHandle,!1);this.graph.enqueueData(this.equilDataHandle,this.equilData);this.graph.updateRange();this.graph.drawAllData()}};function GraphPhaseOneComp(d){this.spcName=d.spcName;this.spc=spcs[this.spcName];this.wallGas=d.wallGas;this.liquid=d.liquid;this.handle=d.handle;this.pressure=d.pressure||1;d.axesFixed={x:!1,y:!1};d.numGridLines={x:6};d.xLabel="Temperature";d.yLabel="Pressure "+this.spcName;d.makeReset=!1;this.equilDataSets=void 0;this.triplePointTemp=d.triplePointTemp;this.criticalPointTemp=d.criticalPointTemp;this.updateEquilData();var f=this.getYMin(this.equilDataSets),e=this.getYMax(this.equilDataSets),e=this.getOrderOfMagRange(f,
e);d.numGridLines=defaultTo({},d.numGridLines);d.numGridLines.y=e+1;d.axisInit.y={min:Math.pow(10,Math.floor(Math.log(f)/Math.LN10)),step:1};d.logScale={y:!0};this.graph=new GraphScatter(d);this.equilDataHandles=this.makeEqDataHandles(this.equilDataSets,this.handle);this.addEqDataSets(this.graph,this.equilDataSets,this.equilDataHandles);this.tempFunc=this.makeTempFunc(this.wallGas,this.liquid);this.pressureFunc=this.makePressureFunc(this.wallGas,this.spcName);this.updateGraph();this.active=!1;defaultTo(!0,
d.makeSystemMarker)&&this.makeMarker();this.graph.hasData=!0}
GraphPhaseOneComp.prototype={addEqDataSets:function(d,f,e){for(d=0;d<f.length;d++)this.graph.addSet({handle:this.equilDataHandles[d],label:"Phase\nData",pointCol:Col(255,255,255),flashCol:Col(0,0,0),trace:!0,recording:!1,showPts:!1})},makeMarker:function(){this.graph.addMarker({handle:"system",col:Col(200,0,0),markerType:"bullseye",x:this.tempFunc,y:this.pressureFunc,label:"System"})},updateEquilData:function(){this.equilDataSets=phaseEquilGenerator.oneComp.equilData(this.spcName,this.triplePointTemp,
this.criticalPointTemp,this.triplePointTemp-25,!1)},getYMin:function(d){for(var f=Number.MAX_VALUE,e=0;e<d.length;e++)for(var h=d[e],k=0;k<h.length;k++)f=Math.min(h[k].pressure,f);return f},getYMax:function(d){for(var f=Number.MIN_VALUE,e=0;e<d.length;e++)for(var h=d[e],k=0;k<h.length;k++)f=Math.max(h[k].pressure,f);return f},getOrderOfMagRange:function(d,f){return Math.ceil(Math.log(f)/Math.LN10)-Math.floor(Math.log(d)/Math.LN10)},makePressureFunc:function(d,f){var e=d.recordFrac({spcName:f,tag:d.handle}).src(),
h=d.getDataSrc("pExt",void 0,!0),k=!1!==h?h:d.getDataSrc("pInt",void 0,!0);return function(){for(var d=0,f=Math.max(0,k.length-30);f<k.length;f++)d+=k[f];return d/Math.min(k.length,30)*e[e.length-1]}},makeTempFunc:function(d,f){var e=d.getDataSrc("temp");return function(){var h=f.Cp,k=d.getCv();return(e[e.length-1]*k+f.temp*h)/(k+h)}},updateGraph:function(){for(var d=0;d<this.equilDataSets.length;d++)this.graph.clearData(this.equilDataHandles[d],!1),this.graph.enqueueData(this.equilDataHandles[d],
this.equilDataToPoints(this.equilDataSets[d]));this.graph.updateRange();this.graph.drawAllData()},setPressure:function(){},makeEqDataHandles:function(d,f){for(var e=[],h=0;h<d.length;h++)e.push(f+"PhaseDataSet"+h);return e},equilDataToPoints:function(d){for(var f=[],e=0;e<d.length;e++)f.push(P(d[e].temp,d[e].pressure));return f}};function GraphScatter(d){this.active=!0;this.handle=d.handle;this.dims=this.getDims();this.xLabel=d.xLabel;this.yLabel=d.yLabel;var f=d.axesInit||d.axisInit;this.labelFontSize=15;this.legendFontSize=12;this.axisValFontSize=11;this.labelFont=this.labelFontSize+"pt calibri";this.legendFont=this.legendFontSize+"pt calibri";this.axisValFont=this.axisValFontSize+"pt calibri";this.borderSpacing=70;this.logScale=d.logScale?{x:defaultTo(!1,d.logScale.x),y:defaultTo(!1,d.logScale.y)}:{x:!1,y:!1};this.legendWidth=
80;d.axesFixed=d.axesFixed||{};this.axesFixed={x:defaultTo(!1,d.axesFixed.x),y:defaultTo(!1,d.axesFixed.y)};this.graphRangeFrac=new GraphBase.Range(this.borderSpacing/this.dims.dx,(this.dims.dx-(this.legendWidth+8))/this.dims.dx,1-this.borderSpacing/this.dims.dy,0.05);this.makeReset=d.makeReset;this.setNumGridLinesAndSpacing(d.numGridLines);this.axisInit=this.setAxesInit(f,this.numGridLines);this.resetRanges();this.stepSize=new GraphScatter.Coord(0,0);this.setStds();this.layers.addLayer("flasher");
this.layers.addLayer("marker");this.drawAllBG()}
_.extend(GraphScatter.prototype,AuxFunctions,GraphBase,{setAxesInit:function(d,f){var e,h,k,l;this.logScale.x?(l=f.x-1,Math.pow(10,Math.floor(Math.log(d.x.min)/Math.LN10)),Math.pow(10,l)):(e=d.x.min,h=e+d.x.step*(f.x-1));this.logScale.y?(l=f.y-1,k=Math.pow(10,Math.floor(Math.log(d.y.min)/Math.LN10)),l=k*Math.pow(10,l)):(k=d.y.min,l=k+d.y.step*(f.y-1));return new GraphBase.Range(e,h,k,l)},addSet:function(d){if(!this.data[d.handle]){var f=this,e=new GraphScatter.Set(this,d.handle,d.label,d.data,d.pointCol,
d.flashCol,d.fillInPts,d.fillInPtsMin,d.trace,d.recording,d.showPts),h=d.pointCol.copy();this.data[d.handle]=e;var k;k=d.trace&&defaultTo(!0,d.showPts)?function(d){draw.line(d.copy().movePt(V(-9,0)),d.copy().movePt(V(9,0)),h,f.graphDisplay);f.drawPtStd(d,h)}:d.trace?function(d){draw.line(d.copy().movePt(V(-9,0)),d.copy().movePt(V(9,0)),h,f.graphDisplay)}:function(d){f.drawPtStd(d,h)};this.makeLegendEntry(e,e.label,d.handle,k);this.drawAllBG()}},setDataValid:function(){for(var d in this.data)this.data[d].setDataValid();
for(var f in this.markers)this.markers[f].setDataValid()},drawAllData:function(){this.drawAllBG();this.drawAxisVals();this.drawPts(!1)},drawPts:function(d){for(var f in this.data)this.data[f].drawPts(!1!==d)},addLast:function(){for(var d in this.data){var f=this.data[d];f.recording&&f.dataValid&&(f.trimNewData(),f.enqueuePts())}this.flushQueues(!0,!1);this.hasData=!0},getAxisBounds:function(){this.getXBounds();this.getYBounds()},graphPt:function(d,f,e){d=this.valToCoord(P(d,f));this.drawPtStd(d,e)},
drawPtStd:function(d,f){this.drawPt(d,f,this.characLen)},drawPt:function(d,f,e,h){h=h||this.graphDisplay;var k=d.x,l=d.y;d=P(k-e,l);var m=P(k,l-e),n=P(k+e,l);e=P(k,l+e);draw.fillPtsStroke([d,m,n,e],f,this.ptStroke,h)},reset:function(){this.resetStd()}});
GraphScatter.Set=function(d,f,e,h,k,l,m,n,p,q,r){this.graph=d;this.handle=f;this.label=e;this.data=new GraphScatter.Data;this.showPts=defaultTo(!0,r);this.graphedPts=[];this.graphedPtIdxs=[];h=h||{};this.dataFuncs=new GraphScatter.DataFuncs(d,h.x,h.y);this.pointCol=k;this.flashCol=l;this.fillInPts=defaultTo(!0,m);this.fillInPtsMin=defaultTo(5,n);this.trace=defaultTo(!1,p);this.visible=!0;this.recordListenerName=this.graph.handle+this.handle.toCapitalCamelCase()+"Record";this.traceLastIdxs=new GraphScatter.Coord(0,
0);this.flashers=[];this.queuePts=[];this.queueIdxs=[];this.recording=defaultTo(!0,q);this.dataValid=!0;this.recording&&this.recordStart()};
GraphScatter.Set.prototype={reset:function(){this.graphedPts.splice(0,this.graphedPts.length);this.graphedPtIdxs.splice(0,this.graphedPtIdxs.length);this.flashers.splice(0,this.flashers.length);this.queueIdxs.splice(0,this.queueIdxs.length);this.queuePts.splice(0,this.queuePts.length)},setDataValid:function(){try{var d=this.dataFuncs.x(),f=this.dataFuncs.y();this.dataValid=!1!==validNumber(d)&&!1!==validNumber(f)?!0:!1}catch(e){this.dataValid=!1}},addVal:function(){this.data.x.push(this.dataFuncs.x());
this.data.y.push(this.dataFuncs.y())},clearData:function(){this.queuePts.splice(0,this.queuePts.length);this.queueIdxs.splice(0,this.queueIdxs.length);this.data.clear()},enqueueData:function(d){var f=this.data.x.length;this.queuePts=this.queuePts.concat(d);this.addData(d);for(d=f;d<this.data.x.length;d++)this.queueIdxs.push(P(d,d))},addData:function(d){this.data.addData(d)},recordStart:function(){addListener(curLevel,"update",this.recordListenerName,function(){this.dataValid&&this.addVal()},this)},
recordStop:function(){removeListener(curLevel,"update",this.recordListenerName)},trimNewData:function(){if(this.graphedPtIdxs.length){var d=this.data.x,f=this.data.y,e=this.graphedPtIdxs[this.graphedPtIdxs.length-1].x,h=this.graphedPtIdxs[this.graphedPtIdxs.length-1].y,k=d.length-e;if(k!=f.length-h)return!1;e=this.findRuns(d,f,h,e,k);for(h=e.length-1;0<=h;h--)this.trimRun(d,f,e[h])}},findRuns:function(d,f,e,h,k){for(var l=function(d,e,f){this.xStartIdx=d;this.yStartIdx=e;this.length=f},m=[],n=[],
p=void 0,q=e,r=h,t=0;t<k-1;t++){var u=P(d[e+t],f[h+t]);if(1>=n.length)n.push(u),2==n.length&&(p=n[0].VTo(n[1]).UV());else{var x=n[n.length-1].VTo(u).UV();0.99<Math.abs(x.dotProd(p))?n.push(u):(3<=n.length&&m.push(new l(q,r,e+t-q,h+t-r)),n=[u],q=e+t,r=h+t)}}3<=n.length&&m.push(new l(q,r,e+t-q,h+t-r));return m},trimRun:function(d,f,e){for(var h=P(d[e.xStartIdx],f[e.yStartIdx]),k=P(d[e.xStartIdx+e.length-1],f[e.yStartIdx+e.length-1]),l=h,m=k,n=l.VTo(m),p=m.VTo(l),q=!0,r=1;r<e.length-1;r++){var t=P(d[e.xStartIdx+
r],f[e.yStartIdx+r]);if(q&&(0>h.VTo(t).dotProd(n)||0>k.VTo(t).dotProd(p)))q=!1;0>n.dotProd(l.VTo(t))?(l=t,n=l.VTo(m)):0>p.dotProd(m.VTo(t))&&(m=t,p=m.VTo(l))}p=[h.x];n=[h.y];l!=h&&(p.push(l.x),n.push(l.y));m!=k&&(p.push(m.x),n.push(m.y));p.push(k.x);n.push(k.y);h=[e.xStartIdx,e.length].concat(p);e=[e.yStartIdx,e.length].concat(n);Array.prototype.splice.apply(d,h);Array.prototype.splice.apply(f,e)},enqueuePts:function(){var d=this.data.pt(),f=[],e=[];if(d.isValid()){var h=new GraphScatter.Coord(this.data.x.length-
1,this.data.y.length-1);if(this.fillInPts&&this.data.x.length&&this.data.y.length&&this.graphedPtIdxs.length)var k=this.graphedPtIdxs[this.graphedPtIdxs.length-1],l=this.data.pt(k.x,k.y),k=this.fillInPtsFunc(d,h,l,k,this.data),f=f.concat(k.newPts),e=e.concat(k.dataIdxs);f.push(d);e.push(h)}this.queuePts=this.queuePts.concat(f);this.queueIdxs=this.queueIdxs.concat(e)},fillInPtsFunc:function(d,f,e,h,k){var l=f.x-h.x;if(l!=f.y-h.y)return{newPts:[],dataIdxs:[]};d=this.graph.valToCoord(d);var m=this.graph.valToCoord(e);
f=this.graph.dataScaling();for(var m=d.VTo(m).UV().perp(),n=l-1;0<n;n--){var l=h.x+n,p=h.y+n,q=d.VTo(this.graph.valToCoord(P(k.x[l],k.y[p]))),q=Math.abs(q.dotProd(m));if(q>this.fillInPtsMin){n=P(k.x[l],k.y[p]);f=this.getEdgePt({x:l,y:p},h,m,n,q,d,k,f);if(!f)break;d=f.dataIdx;f=f.pt;e=this.fillInPtsFunc(f,d,e,h,k);return{newPts:[f].concat(e.newPts),dataIdxs:[d].concat(e.dataIdxs)}}}return{newPts:[],dataIdxs:[]}},getEdgePt:function(d,f,e,h,k,l,m,n){for(d=d.x-f.x-1;0<d;d--){n=f.x+d;var p=f.y+d,q=l.VTo(this.graph.valToCoord(P(m.x[n],
m.y[p]))),q=Math.abs(q.dotProd(e));if(q<k)return{pt:h,dataIdx:{x:n+1,y:p+1}};h=P(m.x[n],m.y[p]);k=q}},updateRange:function(d){this.trace?this.updateRangeFromData(d):this.updateRangeFromPts(d)},updateRangeFromData:function(d){for(var f=this.queueIdxs[0]?this.queueIdxs[0].x:0;f<this.data.x.length;f++){var e=this.data.x[f],h=this.data.y[f];d.x.max=Math.max(d.x.max,e);d.x.min=Math.min(d.x.min,e);d.y.max=Math.max(d.y.max,h);d.y.min=Math.min(d.y.min,h)}},updateRangeFromPts:function(d){for(var f=0;f<this.queuePts.length;f++){var e=
this.queuePts[f].x,h=this.queuePts[f].y;d.x.max=Math.max(d.x.max,e);d.x.min=Math.min(d.x.min,e);d.y.max=Math.max(d.y.max,h);d.y.min=Math.min(d.y.min,h)}},drawPts:function(d){if(this.visible&&(this.showPts||this.trace)&&(this.queuePts.length||this.graphedPts.length)){var f,e=[];d?(f=this.queuePts,e=this.queueIdxs):(f=this.graphedPts.concat(this.queuePts),e=this.graphedPtIdxs.concat(this.queueIdxs));this.trace&&(d?this.graphedPtIdxs.length&&e.length&&this.drawTrace(this.graphedPtIdxs[this.graphedPtIdxs.length-
1].x,e[e.length-1].x,this.graphedPtIdxs[this.graphedPtIdxs.length-1].y,e[e.length-1].y):this.drawTrace(e[0].x,e[e.length-1].x,e[0].y,e[e.length-1].y));if(this.showPts)for(d=0;d<f.length;d++)this.graph.graphPt(f[d].x,f[d].y,this.pointCol)}},flashInit:function(){if(this.visible&&this.showPts)for(var d=0;d<this.queuePts.length;d++){var f=this.queuePts[d],e=this.pointCol,h=this.flashCol,k=h.copy();new GraphScatter.Flasher(f,e,h,k,this.graph.characLen*this.graph.flashMult,2*this.graph.characLen*this.graph.flashMult,
this.graph.characLen,this.graph.flashMult,this.graph.flashRate,this.graph.graphDisplay,this.graph.layers,this.graph)}},flushQueue:function(){this.graphedPts=this.graphedPts.concat(this.queuePts);this.graphedPtIdxs=this.graphedPtIdxs.concat(this.queueIdxs);this.queuePts.splice(0,this.queuePts.length);this.queueIdxs.splice(0,this.queueIdxs.length)},drawTrace:function(d,f,e,h){if(f-d==h-e&&void 0!==d&&void 0!==e){f-=d;h=[this.graph.valToCoord(P(this.data.x[d],this.data.y[e]))];for(var k=1;k<f+1;k++){var l=
this.graph.valToCoord(P(this.data.x[d+k],this.data.y[e+k]));l.closeTo(h[h.length-1])||h.push(l)}draw.path(h,this.pointCol,this.graph.graphDisplay)}else console.log("Data count mismatch for tracing"),console.trace()}};GraphScatter.DataFuncs=function(d,f,e){this.x=d.makeDataFunc(f);this.y=d.makeDataFunc(e)};GraphScatter.Data=function(){this.x=[];this.y=[]};
GraphScatter.Data.prototype={pt:function(d){return void 0===d?P(this.x[this.x.length-1],this.y[this.y.length-1]):P(this.x[d],this.y[d])},addData:function(d){for(var f=0;f<d.length;f++)this.x.push(d[f].x),this.y.push(d[f].y)},toPts:function(){for(var d=[],f=0;f<this.x.length;f++)d.push(this.x[f],this.y[f]);return d},clear:function(){this.x.splice(0,this.x.length);this.y.splice(0,this.y.length)}};GraphScatter.Coord=function(d,f){this.x=d;this.y=f};
GraphScatter.Coord.prototype={copy:function(){return new GraphScatter.prototype.Coord(this.x,this.y)}};
GraphScatter.Flasher=function(d,f,e,h,k,l,m,n,p,q,r,t){this.pt=d;this.pointCol=f;this.flashCol=e;this.curCol=h;this.curCharacLen=k;this.imgCharacLen=l;this.finalCharacLen=m;this.flashMult=n;this.flashRate=p;this.graphDisplay=q;this.layers=r;this.graph=t;this.coordLast=this.graph.valToCoord(this.pt);this.advanceListenerHandle=this.addAdvanceListener();this.lifetime=1/this.flashRate;this.age=0;r.addItem("flasher",this)};
GraphScatter.Flasher.prototype={addAdvanceListener:function(){var d="flashAdvance"+this.graph.handle+this.pt.x+this.pt.y;addListener(curLevel,"update",d,function(){this.advance()},this);return d},setDrawCanvas:function(d){this.graphDisplay=d},draw:function(){this.coordLast=this.graph.valToCoord(this.pt);this.graph.drawPt(this.coordLast,this.curCol,this.curCharacLen,this.graphDisplay)},remove:function(){this.layers.removeItem("flasher",this);removeListener(curLevel,"update",this.advanceListenerHandle)},
advance:function(){this.curCharacLen=stepTowards(this.curCharacLen,this.finalCharacLen,-this.finalCharacLen*this.flashMult*this.flashRate);var d=this.curCol,f=Col(0,0,0);f.r=this.colStep("r");f.g=this.colStep("g");f.b=this.colStep("b");d.set(f);this.age>this.lifetime+1&&this.remove();this.age++},colStep:function(d){var f=this.pointCol[d];return stepTowards(this.curCol[d],f,(f-this.flashCol[d])*this.graph.flashRate)}};function GraphHist(d){this.active=!0;this.handle=d.handle;this.dims=this.getDims();this.xLabel=d.xLabel;this.yLabel=d.yLabel;this.labelFontSize=15;this.axisValFontSize=11;var f=d.axesInit;this.labelFont=this.labelFontSize+"pt calibri";this.axisValFont=this.axisValFontSize+"pt calibri";this.borderSpacing=70;this.graphRangeFrac=new GraphBase.Range(this.borderSpacing/this.dims.dx,0.95,1-this.borderSpacing/this.dims.dy,0.05);this.logScale=d.logScale?{x:defaultTo(!1,d.logScale.x),y:defaultTo(!1,d.logScale.y)}:
{x:!1,y:!1};this.numBins=18;this.axesFixed={x:defaultTo(!1,d.axesFixed.x),y:defaultTo(!1,d.axesFixed.y)};this.setNumGridLinesAndSpacing(d.numGridLines);this.axisInit=new GraphBase.Range(f.x.min,f.x.min+f.x.step*(this.numGridLines.x-1),f.y.min,f.y.min+f.y.step*(this.numGridLines.y-1));this.resetRanges();this.stepSize={x:0,y:0};Col(255,100,0);this.setStds();this.drawAllBG()}
_.extend(GraphHist.prototype,AuxFunctions,GraphBase,{addSet:function(d){this.data[d.handle]||(d=new GraphHist.Set(this,d.handle,d.data,d.barCol),this.data[d.handle]=d,this.drawAllBG())},drawAllData:function(){this.drawAllBG();this.bins&&(this.drawAxisVals(),this.graphBins())},addLast:function(){var d="",f;for(f in this.data)d=f;d=this.data[d];d.addVal();this.makeBins(d);this.hasData=!0},plotData:function(d){var f="",e;for(e in this.data)f=e;this.data[f].data.x=d;this.makeBins(this.data[f])},makeBins:function(d){this.valRange.x=
this.getRange("x");this.setAxisBoundsX();this.bins=this.makeBinBlanks(d.data.x);this.populateBins(d.data.x);this.setYAxis();this.drawAllData()},makeBinBlanks:function(d){d=[];this.binWidth=round((this.valRange.x.max-this.valRange.x.min)/(this.numBins-1),1);for(var f=0;f<this.numBins;f++)d.push(0);return d},populateBins:function(d){for(var f=0;f<d.length;f++)this.bins[Math.floor((d[f]-this.valRange.x.min)/this.binWidth)]++},setYAxis:function(){for(var d=0,f=0;f<this.bins.length;f++)d=Math.max(this.bins[f],
d);this.valRange.y.min=0;this.valRange.y.max=d;this.setAxisBoundsY()},graphBins:function(){var d,f;for(f in this.data)d=f;d=this.data[d].barCol;for(f=0;f<this.bins.length;f++){var e=this.binWidth*(f+1),h=this.valToCoord(P(this.binWidth*f,this.bins[f])),e=this.valToCoord(P(e,0)),e=h.VTo(e);draw.fillStrokeRect(h,e,d,this.bgCol,this.graphDisplay)}},clear:function(){this.clearStd()}});
GraphHist.Set=function(d,f,e,h){this.graph=d;this.handle=f||"onlyData";this.data=new GraphHist.Data;this.dataFunc=new GraphHist.DataFunc(d,e);this.dataValid=!0;this.barCol=h;this.visible=!0};GraphHist.Set.prototype={addVal:function(){this.data.x=this.dataFunc.x()},recordStop:function(){},setDataValid:function(){try{this.dataValid=!1!==validNumber(this.dataFunc.x())?!0:!1}catch(d){}}};GraphHist.Data=function(){this.x=[]};GraphHist.DataFunc=function(d,f){this.x=d.makeDataFunc(f)};function GraphBlank(d){this.dims=this.getGraphDims();this.borderSpacing=70;this.xStart=this.borderSpacing/this.dims.dx;this.yStart=1-this.borderSpacing/this.dims.dy;this.legendWidth=80;this.xEnd=(this.dims.dx-(this.legendWidth+8))/this.dims.dx;this.yEnd=0.05;this.gridSpacing=40;this.setNumGridLines();this.setStds();this.handle="blank"+Math.round(1E5*Math.random());this.parentDiv=d;this.makeCanvasNoReset(this.dims,d);this.parentDiv.attr("filledWith","blank");this.drawBGBlank()}
_.extend(GraphBlank.prototype,GraphBase,{drawBGBlank:function(){this.graph.save();this.drawBGRect();this.graph.globalAlpha=0.2;this.drawGrid();this.drawBounds();this.graph.restore()}});function DataDisplayer(){this.entries={}}
DataDisplayer.prototype={setReadouts:function(d){this.readouts=d},addEntry:function(d){var f=d.label||"",e=defaultTo(1,d.decPlaces),h=d.handle,k=d.expr||"",l=d.units||"",m=this.readouts[d.readout];m||console.log("Bad readout name "+d.readout);d="display"+f+this.entries.length;var n=m.addEntry(f+h),h=new this.Entry(h,f,e,k,l,d,this,n);this.entries[h.handle]=h;with(DataGetFuncs){var p;p=exprHasReturn(k)?eval("(function(){"+k+"})"):eval("(function(){return "+k+"})");addListener(curLevel,"update",d,function(){var d=
f,h;h=p();h=isNaN(h)||void 0===h?"":h.toFixed(e);d=d+(h+" ")+l;n.setText(d)})}return h},removeEntry:function(d){this.entries[d]&&this.entries[d].remove()},Entry:function(d,f,e,h,k,l,m,n){this.handle=d;this.label=f;this.decPlaces=e;this.expr=h;this.units=k;this.listenerStr=l;this.dataDisplayer=m;this.readoutEntry=n;this.removed=!1}};
DataDisplayer.prototype.Entry.prototype={remove:function(){this.removed||(delete this.dataDisplayer.entries[this.handle],this.readoutEntry.remove(),removeListener(curLevel,"update",this.listenerStr),this.removed=!0)}};DataGetFuncs={tempSmooth:function(d){d=walls[d].getDataSrc("temp");for(var f=Math.min(15,d.length),e=d.length-f,h=0,k=0;k<f;k++)h+=d[e+k];return h/f},collisions:function(){for(var d=collide.hitsPerTurn,f=Math.min(15,d.length),e=d.length-f,h=0,k=0;k<f;k++)h+=d[e+k];return 1E3*h/f/updateInterval},temp:function(d){d=walls[d].getDataSrc("temp");return d[d.length-1]},pInt:function(d){d=walls[d].getDataSrc("pInt");return d[d.length-1]},pExt:function(d){d=walls[d].getDataSrc("pExt");return d[d.length-1]},
vol:function(d){d=walls[d].getDataSrc("vol");return d[d.length-1]},q:function(d){d=walls[d].getDataSrc("q");return d[d.length-1]},mass:function(d){d=walls[d].getDataSrc("mass");return d[d.length-1]},moles:function(d,f){var e=walls[d].getDataSrc("moles",f);return e[e.length-1]},frac:function(d,f){var e=walls[d].getDataSrc("frac",f);return e[e.length-1]},time:function(d){d=walls[d].getDataSrc("time");return d[d.length-1]},work:function(d){d=walls[d].getDataSrc("work");return d[d.length-1]},enthalpy:function(d){d=
walls[d].getDataSrc("enthalpy");return d[d.length-1]},internalEnergy:function(d){d=walls[d].getDataSrc("internalEnergy");return d[d.length-1]},vDist:function(d,f){var e=walls[d].getDataSrc("vDist",f);return e[e.length-1]},get:function(d,f,e,h,k){d=getStore(d);var l,m="int"==f||"float"==f;d&&(l="int"==f?Math.round(parseFloat(d)):"float"==f?parseFloat(d):"string"==f?d.sanitize():Number(d)==d?Number(d):d,m&&(k=void 0===k||isNaN(k)?l:k,h=void 0===h||isNaN(h)?l:h,l=bound(l,h,k)));if(void 0===l||m&&isNaN(l))l=
e;return l},img:function(d,f,e,h){if(h)return{attrs:{src:[window.IMGPATHPREFIX+d]}};d=templater.img({attrs:{src:[window.IMGPATHPREFIX+d]}});e&&(d=templater.center({innerHTML:d}));"br"==f?d=templater.br()+d+templater.br():"p"==f&&(d=templater.p({innerHTML:d}));return d}};window.BCollide=1.5;
function Experiment(){this.mutables={eAF:new Experiment.Mutable("LevelData.mainSequence[0].sceneData.rxns[0].activeE"),eAR:new Experiment.Mutable("LevelData.mainSequence[0].sceneData.rxns[1].activeE"),hFA:new Experiment.Mutable("LevelData.spcDefs[0].hF298"),hFB:new Experiment.Mutable("LevelData.spcDefs[1].hF298"),hFC:new Experiment.Mutable("LevelData.spcDefs[2].hF298"),hFD:new Experiment.Mutable("LevelData.spcDefs[3].hF298"),tempDots1:new Experiment.Mutable("LevelData.mainSequence[0].sceneData.dots[0].temp"),tempDots2:new Experiment.Mutable("LevelData.mainSequence[0].sceneData.dots[1].temp"),
tempWalls:new Experiment.Mutable("LevelData.mainSequence[0].sceneData.walls[0].temp"),BCollide:new Experiment.Mutable("window.BCollide")};this.data={nA:new Experiment.Data('walls[0].getDataSrc("frac", {spcName: "a", tag: "wally"})'),nB:new Experiment.Data('walls[0].getDataSrc("frac", {spcName: "b", tag: "wally"})'),nC:new Experiment.Data('walls[0].getDataSrc("frac", {spcName: "c", tag: "wally"})'),nD:new Experiment.Data('walls[0].getDataSrc("frac", {spcName: "d", tag: "wally"})'),temp:new Experiment.Data('walls[0].getDataSrc("temp")')};
this.dataToEval={fracProdsExp:new Experiment.Data("nC + nD"),eqConstExp:new Experiment.Data("nC * nD / (nB * nA)")};this.dimensions=[new Experiment.Dimension([{paths:["tempDots1","tempDots2","tempWalls"],testVals:"[298.15, 398.15 ... 900]"}]),new Experiment.Dimension([{paths:["hFC","hFD"],testVals:"[-20, -18 ... -16]"},{paths:["eAR"],testVals:"[24, 20... 16]"}])];this.appendEqData=!0;this.numReps=4;this.runTime=40;this.draw=!1;this.runNum=0;this.totalRuns=this.getTotalRuns();console.log("Running "+
this.totalRuns+" tests at "+this.runTime+" seconds each.");console.log("Total run time: "+this.totalRuns*this.runTime+" seconds");this.resultsSets=[];this.repIdx=0;this.dimValIdxs=this.makeDimValIdxs(this.dimensions);this.finished=!1;this.measureNext()}
Experiment.prototype={measureNext:function(){var d=this;this.finished?(console.log("Done!  Ready to print"),curLevel.pause()):(this.setVals(this.mutables,this.dimensions,this.dimValIdxs),sceneNavigator.refresh(),this.draw||(curLevel.drawRun=function(){}),setTimeout(function(){d.tryNextMeasurement()},1E3*this.runTime))},print:function(d){d||(d=Experiment.Dimension.prototype.extendSet("[0 ... "+(this.dimensions.length-1)+"]"));d=this.sortResults(this.resultsSets,d);var f;f='<table border="1" cellpadding="3">'+
this.makeHeaderRow();for(var e=0;e<d.length;e++)f+=d[e].asTableRow(this.appendEqData,!0);f+="</table>";$("body").append("<br>");$("body").append(f)},sortResults:function(d,f){if(!f.length)return d;for(var e=f[0],h=this.sortSetsByDimIdx(d.concat(),e),e=this.pluckGroups(h,e),k=h=0;k<e.length;k++){var l=[h,e[k].length].concat(this.sortResults(e[k],f.slice(1,f.length-1)));Array.prototype.splice.apply(d,l);h+=e[k].length}return d},pluckGroups:function(d,f){for(var e=[],h=-1,k=0;k<d.length;k++)d[k].dimValIdxs[f]!=
h&&(e.push([]),h=d[k].dimValIdxs[f]),e[e.length-1].push(d[k]);return e},sortSetsByDimIdx:function(d,f){for(var e=0;e<d.length;e++)for(var h=0;h<d.length-1;h++){var k=d[h],l=d[h+1];l.dimValIdxs[f]<k.dimValIdxs[f]&&(d[h]=l,d[h+1]=k)}return d},tryNextMeasurement:function(){this.recordPt(this.data,this.mutables,this.dimValIdxs);this.finished=this.tick();this.measureNext()},tick:function(){this.runNum++;console.log(Math.round(100*this.runNum/this.totalRuns)+" %");var d=this.dimensions,f=this.dimValIdxs;
this.repIdx++;return this.repIdx==this.numReps?(this.repIdx=0,this.nextDimVal(d,f)):!1},nextDimVal:function(d,f){for(var e=d.length-1;0<=e;e--)if(f[e]++,f[e]==d[e].numPts)f[e]=0;else return!1;return!0},makeDimValIdxs:function(d){for(var f=[],e=0;e<d.length;e++)f.push(0);return f},makeHeaderRow:function(){var d="<tr>",f;for(f in this.mutables)d+="<td>"+f+"</td>";for(f in this.data)d+="<td>"+f+"</td>";for(f in this.dataToEval)d+="<td>"+f+"</td>";this.appendEqData&&(d+="<td>eq const</td><td>mole frac prods</td>");
return d+="</tr>"},getTotalRuns:function(){for(var d=1,f=0;f<this.dimensions.length;f++)d*=this.dimensions[f].numPts;return d*this.numReps},recordPt:function(d,f,e){this.resultsSets.length?this.resultsSets[this.resultsSets.length-1].isAtIdxs(e)||this.resultsSets.push(new Experiment.ResultsSet(e)):this.resultsSets.push(new Experiment.ResultsSet(e));this.resultsSets[this.resultsSets.length-1].addResults(new Experiment.Results(d,f,this.dataToEval))},setVals:function(d,f,e){for(var h=0;h<f.length;h++)for(var k=
f[h],l=e[h],m=0;m<k.paths.length;m++)for(var n=k.testVals[m][l],p=k.paths[m],q=0;q<p.length;q++)eval(d[p[q]].path+" = "+n)}};Experiment.ResultsSet=function(d){this.dimValIdxs=d.concat();this.results=[]};
Experiment.ResultsSet.prototype={addResults:function(d){this.results.push(d)},isAtIdxs:function(d){for(var f=0;f<d.length;f++)if(d[f]!=this.dimValIdxs[f])return!1;return!0},asTableRow:function(d,f){var e="";f&&(e+="<tr><td></td></tr>");for(var h=0;h<this.results.length;h++)e+=this.results[h].asTableRow(d);return e}};Experiment.Dimension=function(d){this.paths=_.pluck(d,"paths");d=_.pluck(d,"testVals");this.testVals=this.extendSets(d,this.paths);this.numPts=this.testVals[0].length};
Experiment.Dimension.prototype={extendSets:function(d,f){for(var e=[],h=0;h<d.length;h++)d[h]instanceof Array?e.push(d[h]):e.push(this.extendSet(d[h]));this.checkValLens(e,f);return e},extendSet:function(d){-1==d.indexOf("...")&&console.log("Unrecognized set "+d);d=d.replace("..."," ... ");var f=this.cleanSigVals(d.match(/[\-0-9\.]+/g)),e;d=f[0];3==f.length?(e=f[1]-f[0],f=f[2]):(f=f[1],e=f>d?1:-1);return this.setFromSigVals(d,e,f)},checkValLens:function(d,f){for(var e=d[0].length,h=d[0].length,k=
0;k<d.length;k++)e=Math.min(d[k].length,e),h=Math.max(d[k].length,h);e!=h&&(console.log("Dimension with paths "),console.log(f),console.log("has mismatched values sets: max length is "+h+" and min length is "+e),console.log("THIS EXPERIMENT WILL NOT WORK"))},cleanSigVals:function(d){for(var f=[],e=0;e<d.length;e++){var h=/[\.]+/.exec(d[e]);h&&h[0]!=d[e]?f.push(Number(d[e])):h||f.push(Number(d[e]))}return f},setFromSigVals:function(d,f,e){var h=[];if(d<e)for(;d<=e;d+=f)h.push(d);else for(;d>=e;d+=
f)h.push(d);return h}};Experiment.Results=function(d,f,e){this.data={};this.spcDefs=deepCopy(LevelData.spcDefs);var h=walls[0].getDataSrc("temp");this.finalTemp=this.avgLast(h,300);this.setPts=this.recordMutables(f);for(var k in d)this.data[k]=d[k].avg(200);this.evaledData=this.evalData(e,this.data)};
Experiment.Results.prototype={log:function(){console.log("\nSet point");console.log(this.objToStr(this.setPts));console.log("Produced data");console.log(this.objToStr(this.data)+"\n")},recordMutables:function(d){var f={},e;for(e in d)f[e]=eval(d[e].path);return f},evalData:function(d,f){var e={};with(f)for(var h in d)e[h]=eval(d[h].path);return e},asTableRow:function(d){var f="<tr>",e;for(e in this.setPts)f+="<td>"+this.setPts[e]+"</td>";for(e in this.data)f+="<td>"+this.data[e]+"</td>";for(e in this.evaledData)f+=
"<td>"+this.evaledData[e]+"</td>";d&&(f+=this.makeEqData(this.spcDefs));return f+"</tr>"},makeEqData:function(d){var f=this.finalTemp,e=1E3*d[3].hF298+d[3].cv*(f-298.15)+(1E3*d[2].hF298+d[2].cv*(f-298.15))-(1E3*d[1].hF298+d[1].cv*(f-298.15)+(1E3*d[0].hF298+d[0].cv*(f-298.15)));d=Math.exp(-(1E3*(d[2].hF298+d[3].hF298-(d[1].hF298+d[0].hF298)))/(298.15*R))*Math.exp(-(e/R)*(1/f-1/298.15));for(var h,f=0;1>=f&&!(h=Newton(d+" - (x*x)/((1-x)*(1-x))",{x:f},"x"),0<=h&&1>=h);f+=0.1);return"<td>"+d+"</td><td>"+
h+"</td>"},objToStr:function(d){var f="",e;for(e in d)f+=e+": "+d[e]+", ";return f},avgLast:function(d,f){for(var e=0,h=Math.max(0,d.length-f);h<d.length;h++)e+=d[h];return e/Math.min(f,d.length)}};Experiment.Mutable=function(d){this.path=d};Experiment.Mutable.prototype={get:function(){return eval(this.path)},set:function(d){eval(this.path+" = "+d)}};Experiment.Data=function(d){this.path=d};
Experiment.Data.prototype={all:function(){return eval(this.path)},last:function(){var d=eval(this.path);return d[d.length-1]},avg:function(d){for(var f=eval(this.path),e=0,h=Math.max(0,f.length-d);h<f.length;h++)e+=f[h];return e/d}};
function Newton(d,f,e){for(var h=function(f){f=deepCopy(f);with(f){f[e]+=1E-7;var h=eval(d);f[e]-=2E-7;f=eval(d);return(h-f)/2E-7}},k=function(e){with(e)return eval(d)},l=k(f),m=0;1E-7<Math.abs(l);){var n=h(f);f[e]-=l/n;l=k(f);m++;if(1E3<m)return f[e]+" EQ DID NOT CONVERGE"}return f[e]};ReactionHandler={addReaction:function(d){d.parent=this;d=new ReactionHandler.Reaction(d);this.initRxn(d);return d},rxnIsEnabled:function(d){return this.getRxn(this.activeRxns,d)?!0:!1},disableRxn:function(d){this.removeRxn(d)},enableRxn:function(d){if(d=this.getRxn(this.pausedRxns,d))this.pausedRxns.splice(this.pausedRxns.indexOf(d),1),this.initRxn(d)},removeRxn:function(d){for(var f in this.rxns){for(var e=this.rxns[f],h=!1,k=e.length-1;0<=k;k--)e[k].handle==d&&(e.splice(k,1),h=!0);h&&(0==e.length?
this.setHandlerByIdStr(f,{func:this.impactStd,obj:this}):1==e.length&&(e=e[0],this.initPair(e,!0)))}if(e=this.getRxn(this.activeRxns,d))this.activeRxns.splice(this.activeRxns.indexOf(e),1),this.pausedRxns.push(e)},getRxn:function(d,f){for(var e=0;e<d.length;e++)if(f==d[e].handle)return d[e]},initRxn:function(d){this.initPair(d);this.activeRxns.push(d)},removeAllReactions:function(){this.setDefaultHandler({func:this.impactStd,obj:this})},getIdStr:function(d,f){return d.idNum<f.idNum?d.idNum+"-"+f.idNum:
f.idNum+"-"+d.idNum},initPair:function(d){var f=this.getIdStr(d.rctADef,d.rctBDef);this.rxns[f]?this.rxns[f].push(d):this.rxns[f]=[d];1<this.rxns[f].length?this.setHandler(d.rctA,d.rctB,{func:this.rctHandlerMultPairs(f),obj:this}):this.setHandler(d.rctA,d.rctB,{func:this.rctHandlerSinglePair(f),obj:this})},countProds:function(d){var f=0,e;for(e in d)f+=d[e];return f},hitE:function(d,f,e,h){return 0.5*(Math.abs(e)*e*d.m*d.cvKinetic+Math.abs(h)*h*f.m*f.cvKinetic)*this.tConst},probFunc:function(d,f,
e){return d>1.5*f?1/(1+Math.exp(-e/R)):0},rctHandlerSinglePair:function(d){var f=this.rxns[d][0],e=f.activeE,h=f.prods;return function(d,l,m,n,p){var q=this.hitE(d,l,n,-p);return Math.random()<this.probFunc(q,e,f.sRxn298)?!this.react(d,l,h)?this.impactStd(d,l,m,n,p):!1:this.impactStd(d,l,m,n,p)}},rctHandlerMultPairs:function(d){var f=this.rxns[d];return function(d,h,k,l,m){for(var n=this.hitE(d,h,l,-m),p=[],q=0,r=0;r<f.length;r++)p[r]=this.probFunc(n,f[r].activeE,rxn.sF298),q+=p[r];r=this.pickRxnIdx(p,
1<q?1/q:1);return!1===r?this.impactStd(d,h,k,l,m):this.react(d,h,f[r].prods)?!1:this.impactStd(d,h,k,l,m)}},pickRxnIdx:function(d,f){for(var e=Math.random(),h=0,k=0;k<d.length;k++)if(h+=d[k]*f,h>e)return k;return!1},react:function(d,f,e){for(var h=d.internalEnergy()+f.internalEnergy(),k=0,l=0,m=0.5*(d.x+f.x),n=0.5*(d.y+f.y),p=[],q=0;q<e.length;q++){for(var r=e[q].name,t=e[q],u=[],k=k+this.spcs[r].uF298*t.count,l=l+this.spcs[r].cv*t.count,x=0;x<t.count;x++){var v=2*Math.random()*Math.PI,v=V(Math.sin(v),
Math.cos(v));u.push(D(m+3*v.dx,n+3*v.dy,v,r,d.tag,d.elemId,d.returnTo))}p.push(u)}k*=1E3/N;l/=N;e=(h-k)/l+298.15;if(0<e){this.dotManager.remove([d,f]);for(d=0;d<p.length;d++){u=p[d];this.dotManager.add(u);for(f=0;f<u.length;f++)u[f].setTemp(e)}return!0}return!1},Reaction:function(d){this.attrs=d;this.handle=d.handle;this.parent=d.parent;this.rctA=d.rctA||d.rctB;this.rctB=d.rctA&&d.rctB?d.rctB:void 0;this.rctADef=this.parent.spcs[this.rctA];this.rctBDef=this.parent.spcs[this.rctB];this.activeE=1E3*
d.activeE/N;if(this.rctA&&!this.rctADef)return console.log("reactant a "+this.rctA+" doesn't exist");if(this.rctB&&!this.rctBDef)return console.log("reactant b "+this.rctB+" doesn't exist");this.prods=this.reformatProds(d.prods);this.prodCount=this.countProds(this.prods);this.sRxn298=this.calcSRxn([new ReactionHandler.ReactionComponent(this.rctA,1),new ReactionHandler.ReactionComponent(this.rctB,1)],this.prods,this.parent.spcs)}};
ReactionHandler.Reaction.prototype={copy:function(){return new this.parent.Reaction(this.attrs)},doubleProds:function(){for(var d=0;d<this.prods.length;d++)this.prods[d].count*=2;this.prodCount*=2;return this},calcSRxn:function(d,f,e){for(var h=0,k=0;k<f.length;k++)h+=e[f[k].name].sF298;for(k=0;k<d.length;k++)h-=e[d[k].name].sF298;return h},increaseProd:function(d,f){for(var e=!1,h=0;h<this.prods.length;h++){var k=this.prods[h];if(k.name==d){k.count+=f;e=!0;break}}e||this.prods.push(new ReactionHandler.ReactionComponent(d,
f));this.prodCount+=f;return this},reformatProds:function(d){var f=[],e;for(e in d)f.push(new ReactionHandler.ReactionComponent(e,d[e]));return f},countProds:function(d){for(var f=0,e=0;e<d.length;e++)f+=d[e].count;return f},remove:function(){this.parent.removeRxn(this.handle)}};ReactionHandler.ReactionComponent=function(d,f){this.name=d;this.count=f};function CollideHandler(d){this.tConst=tConst;this.rxns={};this.dotManager=d;this.activeRxns=[];this.pausedRxns=[];this.numHits=0;this.hitsPerTurn=[];this.checkStore=this.check;this.breakUpStore=this.breakUp;this.recordingHits=!1;this.recordCleanUpListenerName="recordCollideHits"}
_.extend(CollideHandler.prototype,ReactionHandler,toInherit.gridder,{setSpcs:function(d){this.spcs=d;this.setDefaultHandler({func:this.impactStd,obj:this},this.spcs);this.setup(this.spcs)},setDefaultHandler:function(d,f){for(var e=countAttrs(f),h=0;h<e;h++)for(var k=h;k<e;k++)this[h+"-"+k]=d,this.rxns[h+"-"+k]=[]},setHandler:function(d,f,e){var h=this.getIdStr(this.spcs[d],this.spcs[f]);this.isIdStr(h)?this[h]=e:console.log("bad spc names "+d+" "+f)},setHandlerByIdStr:function(d,f){this.isIdStr(d)?
this[d]=f:console.log("bad id string "+d)},isIdStr:function(d){return/^[0-9]+\-[0-9]+$/.test(d)},recordCollisions:function(){this.check=this.checkRecord;this.breakUp=this.breakUpRecord;this.recordingCollisions=!0;addListener(curLevel,"sectionCleanUp",this.recordCleanUpListenerName,this.recordCollisionsStop,this)},recordCollisionsStop:function(){this.check=this.checkStore;this.breakUp=this.breakUpStore;this.recordingCollisions=!1;removeListener(curLevel,"sectionCleanUp",this.recordCleanUpListenerName)},
check:function(){for(var d=this.gridSize,f=this.xSpan,e=this.ySpan,h=this.grid=this.makeGrid(),k=dotManager.lists.ALLDOTS,l=k.length-1;-1<l;l--){var m=k[l],n=Math.floor(m.x/d),p=Math.floor(m.y/d),q=!0,r=Math.max(n-1,0),t=Math.min(n+1,f)+1;a:for(;r<t;r++)for(var u=Math.max(p-1,0),x=Math.min(p+1,e)+1;u<x;u++)for(var v=h[r][u].length-1;0<=v;v--){var z=h[r][u][v],y=m.x-z.x,A=m.y-z.y;if(y*y+A*A<=(m.r+z.r)*(m.r+z.r)&&(y=this[Math.min(m.idNum,z.idNum)+"-"+Math.max(m.idNum,z.idNum)],A=V(z.x-m.x,z.y-m.y).UV(),
!1===y.func.apply(y.obj,[m,z,A,m.v.dotProd(A),z.v.dotProd(A)]))){q=!1;h[r][u].splice(v,1);break a}}0<=n&&0<=p&&n<this.numCols&&p<this.numRows?q&&h[n][p].push(m):(returnEscapist(m),console.log("ball out of bounds"))}},checkRecord:function(){var d=this.gridSize,f=this.xSpan,e=this.ySpan,h=this.grid=this.makeGrid();this.hitsPerTurn.push(this.numHits);this.numHits=0;for(var k=dotManager.lists.ALLDOTS,l=k.length-1;-1<l;l--){var m=k[l],n=Math.floor(m.x/d),p=Math.floor(m.y/d),q=!0,r=Math.max(n-1,0),t=Math.min(n+
1,f)+1;a:for(;r<t;r++)for(var u=Math.max(p-1,0),x=Math.min(p+1,e)+1;u<x;u++)for(var v=h[r][u].length-1;-1<v;v--){var z=h[r][u][v],y=m.x-z.x,A=m.y-z.y;if(y*y+A*A<=(m.r+z.r)*(m.r+z.r)&&(y=this[Math.min(m.idNum,z.idNum)+"-"+Math.max(m.idNum,z.idNum)],A=V(z.x-m.x,z.y-m.y).UV(),!1===y.func.apply(y.obj,[m,z,A,m.v.dotProd(A),z.v.dotProd(A)]))){q=!1;h[r][u].splice(v,1);break a}}0<=n&&0<=p&&n<this.numCols&&p<this.numRows?q&&h[n][p].push(m):(returnEscapist(m),console.log("ball out of bounds"))}},impactStd:function(d,
f,e,h,k){var l=(h*(d.m-f.m)+2*f.m*k)/(d.m+f.m),m=(k*(f.m-d.m)+2*d.m*h)/(d.m+f.m),n=d.temp(),p=f.temp();d.v.dx+=e.dx*(l-h);d.v.dy+=e.dy*(l-h);f.v.dx+=e.dx*(m-k);f.v.dy+=e.dy*(m-k);h=d.temp();k=f.temp();l=n+(h-n)*d.cvKinetic/d.cv;m=p+(k-p)*f.cvKinetic/f.cv;d.v.mult(Math.sqrt(l/h));d.internalPotential*=l/n;f.v.mult(Math.sqrt(m/k));f.internalPotential*=m/p;this.breakUp(d,f,e);return!0},breakUp:function(d,f,e){var h=d.r+f.r,k=f.x-e.dx*h,l=f.y-e.dy*h;f.x=d.x+e.dx*h;f.y=d.y+e.dy*h;d.x=k;d.y=l},breakUpRecord:function(d,
f,e){this.numHits++;var h=d.r+f.r,k=f.x-e.dx*h,l=f.y-e.dy*h;f.x=d.x+e.dx*h;f.y=d.y+e.dy*h;d.x=k;d.y=l},setup:function(d){this.gridSize=Math.max(5,2*this.getMaxR(d));this.numCols=Math.ceil(myCanvas.width/this.gridSize+1);this.numRows=Math.ceil(myCanvas.height/this.gridSize+1);this.xSpan=Math.floor(myCanvas.width/this.gridSize);this.ySpan=Math.floor(myCanvas.height/this.gridSize)},getMaxR:function(d){var f=0,e;for(e in d)f=Math.max(f,d[e].r);return f}});function DotMigrator(){this.numCols=this.numRows=40}
DotMigrator.prototype={migrateDots:function(d,f,e){this.width=$("#myCanvas").width();this.height=$("#myCanvas").height();this.colWidth=this.width/(this.numCols-1);this.rowHeight=this.height/(this.numRows-1);this.offset=0.12345;f=window.walls.getWallsByHandles(f);e=window.walls.getWallsByHandles(e);var h=this.makeWallGrid(this.numRows,this.numCols),k=this.makeWallGrid(this.numRows,this.numCols);this.mapWallsOnToGrid(f,h);this.mapWallsOnToGrid(e,k);k=this.expandGrid(k);h=this.contractGrid(h);this.subtractGrid(h,
k);this.placeDots(d,h,this.gridToPtList(h,this.colWidth,this.rowHeight,this.offset))},placeDots:function(d,f,e){for(var h=0;h<d.length;h++)if(!f[Math.floor((d[h].y-this.offset)/this.rowHeight)][Math.floor((d[h].x-this.offset)/this.colWidth)]){var k=e[Math.floor(Math.random()*e.length)].copy();d[h].x=k.x+Math.random()*this.colWidth;d[h].y=k.y+Math.random()*this.rowHeight}},gridToPtList:function(d,f,e,h){for(var k=[],l=0;l<d.length;l++)for(var m=0,n=d[0].length;m<n;m++)d[l][m]&&k.push(P(h+m*f,h+l*e));
return k},mapWallsOnToGrid:function(d,f){for(var e=0;e<d.length;e++)this.mapWallOnToGrid(d[e],f)},subtractGrid:function(d,f){for(var e=0;e<d.length;e++)for(var h=0;h<d[0].length;h++)d[e][h]=Math.min(d[e][h],!f[e][h])},mapWallOnToGrid:function(d,f){for(var e,h,k=0;k<f.length;k++){var l=this.offset+this.rowHeight*(k+0.5),m=[];e=0;for(h=d.length-1;e<d.length;e++)(d[e].y<l&&d[h].y>=l||d[h].y<l&&d[e].y>=l)&&m.push(d[e].x+(l-d[e].y)/(d[h].y-d[e].y)*(d[h].x-d[e].x)),h=e;for(e=0;e<m.length-1;)m[e]>m[e+1]?
(h=m[e],m[e]=m[e+1],m[e+1]=h,e&&e--):e++;for(e=0;e<m.length;e+=2)for(h=m[e];h<m[e+1];h+=5)xGridIdx=Math.floor((h-this.offset)/this.colWidth),f[k][xGridIdx]=!0}},expandGrid:function(d){for(var f=this.makeWallGrid(d.length,d[0].length),e=0;e<d.length;e++)for(var h=0;h<d[0].length;h++)if(d[e][h]||d[e][h+1]||d[e-1]&&d[e-1][h]||d[e+1]&&d[e+1][h])f[e][h]=!0;return f},contractGrid:function(d){for(var f=this.makeWallGrid(d.length,d[0].length),e=0;e<d.length;e++)for(var h=0;h<d[0].length;h++)if(d[e][h]&&d[e][h+
1]&&(d[e-1]?d[e-1][h]:1)&&(d[e+1]?d[e+1][h]:1))f[e][h]=!0;return f},makeWallGrid:function(d,f){for(var e=Array(f),h=0;h<f;h++){for(var k=Array(d),l=0;l<d;l++)k[l]=!1;e[h]=k}return e}};function Attractor(){this.eDebt=0;this.k1=0.5;this.k2=0.07}
_.extend(Attractor.prototype,toInherit.gridder,{setup:function(){this.gridSize=30;this.numCols=Math.ceil(myCanvas.width/this.gridSize+1);this.numRows=Math.ceil(myCanvas.height/this.gridSize+1);this.xSpan=Math.floor(myCanvas.width/this.gridSize);this.ySpan=Math.floor(myCanvas.height/this.gridSize);this.dotManager=dotManager;return this},attract:function(){for(var d=this.makeGrid(),f=this.gridSize,e=this.xSpan,h=this.ySpan,k=dotMagnager.lists.ALLDOTS,l=0;l<k.length;l++){var m=k[l];if(0<m.attractStr){m.tempLast=
m.temp();for(var n=Math.floor(m.x/f),p=Math.floor(m.y/f),q=Math.max(n-1,0);q<=Math.min(n+1,e);q++)for(var r=Math.max(p-1,0);r<=Math.min(p+1,h);r++)for(var t=d[q][r].length-1;-1<t;t-=1){var u=d[q][r][t],x=m.x-u.x,v=m.y-u.y,z=Math.sqrt(x*x+v*v),y=V(x,v);y.dx/=z;y.dy/=z;var z=Math.max(0,z-m.r-u.r)*pxToE,x=m.attractStrs[u.idNum],v=(m.attractRad+u.attractRad)/2,A=v*v*v*v*v,B=(0.97*v+z)*(0.97*v+z)*(0.97*v+z)*(0.97*v+z)*(0.97*v+z),C=-x*(5*A/(B*(0.97*v+z))-8*A*v*v*v/(B*(0.97*v+z)*(0.97*v+z)*(0.97*v+z)*(0.97*
v+z))),H=y.copy().mult(C/m.m),y=y.mult(-C/u.m);m.v.add(H);u.v.add(y);z=-x*(A*v*v*v/(B*(0.97*v+z)*(0.97*v+z)*(0.97*v+z))-A/B);m.peCur+=z;u.peCur+=z}d[n][p].push(m)}}this.adjustE()},adjustE:function(){for(var d=dotManager.lists.ALLDOTS,f=0;f<d.length;f++){var e=d[f];if(0<e.attractStr){var h=e.tempLast+e.peCur-e.peLast;0>h&&(this.eDebt+=10-h,h=10);e.setTemp(h);e.peLast=e.peCur;e.peCur=0}}0<this.eDebt&&this.exactDebt()},exactDebt:function(){for(var d=0.3*dataHandler.avgTemp(),f=dotManager.lists.ALLDOTS,
e=0;e<f.length;e++){var h=f[e],k=h.temp();if(k>d){var l=Math.min(Math.min(k-d,5),this.eDebt);this.eDebt-=l;h.setTemp(k-l);if(0>=this.eDebt)break}}},zeroAllEnergies:function(){for(var d=dotManager.lists.ALLDOTS,f=0;f<d.length;f++)d[f].peLast=0,d[f].keLast=0,d[f].tempLast=0},assignELastAll:function(){for(var d=this.makeGrid(),f=this.gridSize,e=this.xSpan,h=this.ySpan,k=dotManager.lists.ALLDOTS,l=0;l<k.length;l++){var m=k[l];if(0<m.attrStr){m.tempLast=m.temp();for(var n=Math.floor(m.x/f),p=Math.floor(m.y/
f),q=Math.max(n-1,0);q<=Math.min(n+1,e);q++)for(var r=Math.max(p-1,0);r<=Math.min(p+1,h);r++)for(var t=d[q][r].length-1;-1<t;t-=1){var u=d[q][r][t],x=pxToE*V(m.x-u.x,m.y-u.y).mag(),x=Math.max(0,x-m.r-u.r)*pxToE,v=(m.attractRad+u.attractRad)/2,z=v*v*v*v*v,y=(0.97*v+x)*(0.97*v+x)*(0.97*v+x)*(0.97*v+x)*(0.97*v+x),x=-m.attractStrs[u.idNum]*(z*v*v*v/(y*(0.97*v+x)*(0.97*v+x)*(0.97*v+x))-z/y);m.peLast+=x;u.peLast+=x}d[n][p].push(m)}}}});function DataHandler(){this.tConst=tConst}
DataHandler.prototype={temp:function(d){return this.KEAvg(d)*this.tConst},tempFunc:function(d){var f=this;return function(){return f.KEAvg(d)*f.tConst}},countFunc:function(d){var f=this;return function(){return f.count(d)}},count:function(d){return dotManager.get(d).length},RMS:function(d){var f=0;d=dotManager.get(d);for(var e=0;e<d.length;e++)f+=d[e].v.magSqr();return pxToMS*Math.sqrt(f/d.length)},velocities:function(d){d=dotManager.get(d);for(var f=Array(d.length),e=0;e<d.length;e++)f[e]=d[e].v.mag();
return f},velocityAvg:function(d){vList=this.velocities(d);for(var f=d=0;f<vList.length;f++)d+=vList[f];return d/vList.length},KEAvg:function(d){var f=0;d=dotManager.get(d);for(var e=0;e<d.length;e++)f+=d[e].KE();return f/d.length},volume:function(d){return void 0===d?walls.totalVolume():walls.wallVolume(d)},volumeFunc:function(d){var f=this;return function(){return f.volume(d)}}};function WallHandler(d){var f=d?Array(d.pts.length):[];_.extend(f,WallMethods.main,WallMethods.collideMethods);f.defaultCol=Col(255,255,255);d&&(f.assemble(d),d.handles.length!=d.pts.length&&console.log("NAME YOUR WALLS"),d.handlers&&f.doInitHandlers(d.handlers));f.setup();return f}
WallMethods={main:{assemble:function(d){this.removed=!1;var f=d.pts,e=d.handles;this.numWalls=f.length;this.qArrowFill=Col(200,0,0);this.qArrowFillFinal=Col(100,0,0);this.qArrowStroke=Col(255,255,255);var h=defaultTo([],d.bounds),k=defaultTo([],d.vols),l=defaultTo([],d.shows),m=defaultTo([],d.records);d=defaultTo([],d.temps);for(var n=0;n<f.length;n++)this.setWallVals(n,f[n],e[n],h[n],k[n],l[n],m[n],d[n])},setDefaultReadout:function(d){this.defaultReadout=d;return this},unsetDefaultReadout:function(){this.defaultReadout=
void 0;return this},setup:function(){this.gridDim=20;this.xSpan=Math.floor(myCanvas.width/this.gridDim);this.ySpan=Math.floor(myCanvas.height/this.gridDim);this.numCols=Math.ceil(myCanvas.width/this.gridDim);this.numRows=Math.ceil(myCanvas.height/this.gridDim);for(var d=0;d<this.length;d++)this.setupWall(d)},setAllHandler:function(d){for(var f=0;f<this.length;f++)this.setWallHandler(f,d)},pareData:function(){for(var d=0;d<this.length;d++)this[d].pareData()},setWallHandler:function(d,f){var e=this.idxByInfo(d);
/isothermal/i.test(f)&&this[e].isothermalInit();for(var h=0;h<this[e].length;h++)"string"==typeof f?this[e].handlers[h]={obj:this,func:this[f]}:"object"==typeof f&&(this[e].handlers[h]=f)},setSubWallHandler:function(d,f,e){d=this.idxByInfo(d);"string"==typeof e?(this[d][f].isothermal=/isothermal/i.test(e),this[d].handlers[f]={obj:this,func:this[e]}):"object"==typeof e&&(this[d].handlers[f]=e)},getSubWallHandler:function(d,f){return this[this.idxByInfo(d)+"-"+f]},setupWall:function(d){this[d].wallUVs=
this.getWallUV(d);this[d].wallPerpUVs=this.getPerpUVs(d);this[d].wallGrids=this.scatterPts(d)},scatterPts:function(d){var f=this.makeBlankGrid(),e=this[d];e.scatter=Array(e.length-1);var h=e.wallUVs,k=this.gridDim;for(d=0;d<e.scatter.length;d++)for(var l=h[d],m=e[d].distTo(e[d+1]),m=Math.ceil(m/k),n=e[d],p=0;p<m;p++){var q=Math.floor((n.x+l.dx*k*p)/k),r=Math.floor((n.y+l.dy*k*p)/k);(-1!=q||-1!=r)&&f[q][r].push(d)}return f},makeBlankGrid:function(){for(var d=Array(this.numCols+1),f=0;f<this.numCols+
1;f++){for(var e=Array(this.numRows+1),h=0;h<this.numRows+1;h++)e[h]=[];d[f]=e}return d},setWallVals:function(d,f,e,h,k,l,m,n,p,q,r,t){h={min:P(0,h&&h.yMin?h.yMin:30),max:P(0,h&&h.yMax?h.yMax:435)};this[d]=f;_.extend(this[d],WallMethods.wall,WallMethods.wallDataHandler);this[d].handle=e;this[d].hitMode="Std";this[d].vs=this.makeWallVs(f);this[d].bounds=h;this[d].dotManager=q||dotManager;k&&this[d].setVol(k);this[d].col=defaultTo(this.defaultCol,p);this[d].show=defaultTo(!0,l);!1!==r&&this.closeWall(this[d]);
this[d].ptsInit=this.copyWallPts(this[d]);this[d].g=g;this[d].pConst=pConst;this[d].liquids={};this[d].data={};this[d].q=0;this[d].hitThreshold=-15;this[d].handlers=[];this[d].pIntLen=35;this[d].surfAreaAdj={};this[d].eToAdd=0;this[d].isLiquid=!1;this[d].isothermal=!1;this[d].removed=!1;this[d].tSet=n;this[d].massChunks={};this[d].forceInternal=0;this[d].pLastRecord=turn;this[d].isothermalRate=defaultTo(1,t);this[d].boundMaxHandlers=[];this[d].boundMinHandlers=[];this[d].mass=0;this[d].Cp=this[d].setupCp();
this[d].parent=this;makeListenerHolder(this[d],"cleanUp");this[e]=this[d];(m=defaultTo(!0,m))&&this[d].recordDefaults()},addWall:function(d){this.numWalls++;var f=this.length;this.setWallVals(f,d.pts,d.handle,d.bounds,d.vol,d.show,d.record,d.temp,d.col,d.dotManager,d.close,d.isothermalRate);this.setupWall(f);this.setWallHandler(f,d.handler);d.border&&this[f].addBorder(d.border);d.hitMode&&this[f].setHitMode(d.hitMode);return this[f]},makeWallVs:function(d){for(var f=[],e=0;e<d.length;e++)f.push(V(0,
0));f.push(f[0]);return f},setPtsInit:function(){for(var d=0;d<this.length;d++)this[d].ptsInit=this.copyWallPts(this[d])},copyWallPts:function(d){for(var f=d.length,e=Array(f),h=0;h<f;h++)e[h]=d[h].copy();return e},idxByHandle:function(d){for(var f=0;f<this.length;f++)if(d==this[f].handle)return f;console.log("Failed to get wall idx by handle\nHandle:"+d)},idxByInfo:function(d){return parseFloat(d)!=d?this.idxByHandle(d):d},remove:function(){for(var d=this.length-1;0<=d;d-=1)this.removeWall(d);this.removed=
!0;emptyListener(curLevel,"wallMove")},removeWall:function(d){this[d]&&(this.numWalls-=1,this[d].recordAllStop(),this[d].cleanUp(),this[d].removeBorder(),this[d].removed=!0,d=this.idxByInfo(d),this[this[d].handle]=void 0,this.splice(d,1),this.removeHandlers(d))},removeHandlers:function(d){for(var f in this)-1!=f.indexOf(d+"-")&&(this[f]=void 0)},closeWall:function(d){d.push(P(d[0].x,d[0].y))},getPerpUVs:function(d){d=this[d].wallUVs;for(var f=Array(d.length),e=0;e<d.length;e++){var h=d[e];f[e]=V(-h.dy,
h.dx)}return f},getWallUV:function(d){for(var f=this[d].length-1,e=Array(f),h=0;h<f;h++){var k=this[d][h],l=this[d][h+1];e[h]=V(l.x-k.x,l.y-k.y).UV()}return e},check:function(){for(var d=this.gridDim,f=this.xSpan,e=this.ySpan,h=dotManager.lists.ALLDOTS,k=0;k<h.length;k++){var l=h[k],m=[],n=[],p=Math.floor(l.x/d),q=Math.floor(l.y/d),r=Math.max(p-1,0),p=Math.min(p+1,f)+1;a:for(;r<p;r++)for(var t=Math.max(q-1,0),u=Math.min(q+1,e)+1;t<u;t++)for(var x=0;x<this.length;x++)for(var v=this[x].wallGrids[r][t],
z=0;z<v.length;z++){var y=v[z];if(!1===this.haveChecked(x,y,m,n)){if(!0===this[x].checkWallHit(l,y))break a;m.push(x);n.push(y)}}}},haveChecked:function(d,f,e,h){for(var k=0;k<e.length;k++)if(e[k]==d&&h[k]==f)return!0;return!1},getWallsByHandles:function(d){for(var f=[],e=0;e<d.length;e++)f.push(this[d[e]]),f[f.length-1]||console.log("Bad wall handle "+d[e]);return f},wallVolume:function(d){return this.area(this[d].slice(0,this[d].length-1))*vConst},area:function(d){var f=0,e=this.isConvex(d),h=e.multiplier;
if(e.isConvex)return this.areaConvex(d);d=this.splitConcave(d,h);f+=this.area(d[0]);return f+=this.area(d[1])},isConvex:function(d){for(var f=this.getMult(d),e=1;e<d.length-1;e++){var h=this.abcs(d,e),h=this.angleBetweenPts(h.a,h.b,h.c,f);if(h>Math.PI)return{isConvex:!1,multiplier:f}}this.angleBetweenPts(d[d.length-2],d[d.length-1],d[0],f);h=this.angleBetweenPts(d[d.length-1],d[0],d[1],f);return h>Math.PI?{isConvex:!1,multiplier:f}:{isConvex:!0,multiplier:f}},getMult:function(d){var f=Math.PI*(d.length-
2),e=this.getAreaUVs(d),h=this.getIntAngles(d,e,1);d=this.getIntAngles(d,e,-1);if(round(h,2)==round(f,2))return 1;if(round(d,2)==round(f,2))return-1},getAreaUVs:function(d){for(var f=Array(d.length),e=0;e<d.length-1;e++){var h=d[e],k=d[e+1];f[e]=h.VTo(k).UV()}h=d[d.length-1];k=d[0];f[f.length]=h.VTo(k).UV();return f},getIntAngles:function(d,f,e){f=0;for(var h=1;h<d.length-1;h++)f+=this.angleBetweenPts(d[h-1],d[h],d[h+1],e);f+=this.angleBetweenPts(d[d.length-2],d[d.length-1],d[0],e);return f+=this.angleBetweenPts(d[d.length-
1],d[0],d[1],e)},splitConcave:function(d,f){for(var e=Array(d.length+2),h=0;h<d.length;h++)e[h]=d[h];e[e.length-2]=d[0];e[e.length-1]=d[1];for(h=1;h<e.length-1;h++){var k=this.abcs(e,h);if(this.angleBetweenPts(k.a,k.b,k.c,f)>Math.PI)return h==d.length&&(h=0),this.splitAt(e.slice(0,e.length-2),h,f)}},splitAt:function(d,f,e){d=d.slice(f,d.length).concat(d.slice(0,f));e=d[0];for(f=2;f<d.length-1;f++)if(!this.crossesWall(e,d[f],d))return e=d.slice(0,f+1),d=d.slice(0,1).concat(d.slice(f,d.length)),[e,
d]},abcs:function(d,f){return{a:d[f-1],b:d[f],c:d[f+1]}},crossesWall:function(d,f,e){d.VTo(f);for(var h=1;h<e.length;h++){var k,l;h==e.length-1?(k=e[h],l=e[0]):(k=e[h],l=e[h+1]);if(this.linesCross(d,f,k,l))return!0}return!1},linesCross:function(d,f,e,h){var k=d.VTo(f),l=e.VTo(h),m=k.mag(),n=l.mag(),k=k.UV(),p=l.UV(),l=this.getDist(d,f,e,h,k,p,"p1");d=this.getDist(d,f,e,h,k.neg(),p.neg(),"p2");l.dx=round(l.dx,5);l.dy=round(l.dy,5);d.dx=round(d.dx,5);d.dy=round(d.dy,5);m=round(m,5);n=round(n,5);return!(l.dx>=
m||l.dy>=n||d.dx>=m||d.dy>=n)},getDist:function(d,f,e,h,k,l,m){"p1"==m?(a=d,b=e):(a=f,b=h);if(0==k.dx&&0==l.dx)return new Vector(Infinity,Infinity);if(0==k.dx)return d=a.x-b.x,d=Math.abs(d/l.dx),k=b.copy().movePt(l.copy().mult(d)),new Vector(a.distTo(k),b.distTo(k));if(0==l.dx)return d=b.x-a.x,d=Math.abs(d/k.dx),k=a.copy().movePt(k.copy().mult(d)),new Vector(a.distTo(k),b.distTo(k));if(0==k.dy&&0==l.dy)return new Vector(Infinity,Infinity);if(0==k.dy)return d=a.y-b.y,d=Math.abs(d/l.dy),k=b.copy().movePt(l.copy().mult(d)),
new Vector(a.distTo(k),b.distTo(k));if(0==l.dy)return d=b.y-a.y,d=Math.abs(d/k.dy),k=a.copy().movePt(k.copy().mult(d)),new Vector(a.distTo(k),b.distTo(k));d=l.dx*k.dy/k.dx-l.dy;if(0==d)return new Vector(Infinity,Infinity);d=(b.y-a.y-k.dy*b.x/k.dx+a.x*k.dy/k.dx)/d;return new Vector((b.x+l.dx*d-a.x)/k.dx,d)},angleBetweenPts:function(d,f,e,h){var k=d.VTo(f).UV();d=k.copy().neg();f=f.VTo(e).UV();h=k.copy().add(f).perp(1==h?"cw":"ccw");d=Math.atan2(d.dy,d.dx);f=Math.atan2(f.dy,f.dx);h=Math.atan2(h.dy,
h.dx);return this.distBetweenAngles(d,h)+this.distBetweenAngles(h,f)},distBetweenAngles:function(d,f){0>d&&(d+=2*Math.PI);0>f&&(f+=2*Math.PI);var e=Math.max(d,f)-Math.min(d,f);return e>Math.PI?2*Math.PI-e:e},areaConvex:function(d){for(var f=0,e=d[0],h=2;h<d.length;h++)f+=e.area(d[h-1],d[h]);return f}}};WallMethods.DataObj=function(){this.srcVal=[];this.idVal;this.typeVal;this.idArgsVal;this.wallHandleVal;this.recordingVal=!1;this.recordStopVal=void 0;this.readoutVal};
WallMethods.DataObj.prototype={id:function(d){d&&(this.idVal=d);return this.idVal},type:function(d){d&&(this.typeVal=d);return this.typeVal},idArgs:function(d){d&&(this.idArgsVal=d);return this.idArgsVal},argsMatch:function(d){return objectsEqual(this.idArgsVal,d)},readout:function(d){d&&(this.readoutVal=d);return this.readoutVal},wallHandle:function(d){d&&(this.wallHandleVal=d);return this.wallHandleVal},src:function(d){d&&(this.srcVal=d);return this.srcVal},recording:function(d){void 0!==d&&(this.recordingVal=
d);return this.recordingVal},recordStop:function(d){d?this.recordStopVal=d:this.recordStopVal&&this.recordingVal&&this.recordStopVal()}};WallMethods.wall={reset:function(){for(var d=this.ptsInit,f=0;f<d.length;f++)this[f].x=d[f].x,this[f].y=d[f].y;for(d=this.forceInternal=0;d<this.vs.length;d++)this.vs[d].zero();this.parent.setupWall(this.parent.indexOf(this))},setVol:function(d){d=this.volToY(d);this[0].position({y:d});this[1].position({y:d})},volToY:function(d){var f=this[2].distTo(this[3]);return this[2].y-d/(vConst*f)},checkWallHit:function(d,f){var e=this.wallUVs[f],h=this.wallPerpUVs[f],k=V(d.x+d.v.dx-h.dx*d.r-this[f].x,d.y+
d.v.dy-h.dy*d.r-this[f].y),k=h.dotProd(k),l=-h.dotProd(d.v);return 0>k&&k>this.hitThreshold&&this.isBetween(d,f,e)?(this["didHit"+this.hitMode](d,f,e,l,h),!0):!1},didHitStd:function(d,f,e,h,k){var l=this.handlers[f];l.func.apply(l.obj,[d,this,f,e,h,k])},isBetween:function(d,f,e){var h=d.v.dotProd(e),k=h*e.dx,l=h*e.dy,h=P(this[f].x+k,this[f].y+l),k=P(this[f+1].x+k,this[f+1].y+l);f=V(-e.dx,-e.dy);h=V(d.x-h.x,d.y-h.y);d=V(d.x-k.x,d.y-k.y);return 0<=h.dotProd(e)&&0<=d.dotProd(f)},didHitArrowDV:function(d,
f,e,h,k){var l=d.v.copy(),m=this.handlers[f];m.func.apply(m.obj,[d,this,f,e,h,k]);f=P(d.x,d.y);e=d.v.copy();d=-k.dotProd(d.v);this.drawArrowV(f,l,e,h,d)},didHitArrowSpd:function(d,f,e,h,k){var l=d.v.copy(),m=this.handlers[f];m.func.apply(m.obj,[d,this,f,e,h,k]);f=P(d.x,d.y);e=d.v.copy();d=-k.dotProd(d.v);this.drawArrowSpd(f,l,e,h,d)},didHitGravity:function(d,f,e,h,k){var l=this.handlers[f];if(0!=e.dx)var m=d.y,n=d.v.dy;l.func.apply(l.obj,[d,this,f,e,h,k]);0!=e.dx&&(f=d.v.dy*d.v.dy+2*gInternal*(d.y-
m),0<=f?d.v.dy=0<d.v.dy?Math.sqrt(f):-Math.sqrt(f):(d.v.dy=-1E-7,d.y=(d.v.dy*d.v.dy-n*n)/(2*gInternal)+m))},drawArrowV:function(d,f,e,h,k){var l=Array(3);l[0]=d.copy().movePt(f.copy().mult(10).neg());l[1]=d.copy();l[2]=d.copy().movePt(e.copy().mult(10));f="drawArrow"+round(d.x,0)+round(d.y,0);new ArrowLine(f,l,Col(255,0,0),50,c);d=d.copy().movePt(e.mult(15));h=(Math.abs(h)+Math.abs(k))*pxToMS;animText.newAnim({pos:d},{pos:d.copy().movePt({dy:-20}),col:curLevel.bgCol},{text:"deltaV = "+round(h,1)+
"m/s",time:3E3})},drawArrowSpd:function(d,f,e,h,k){h=Array(3);h[0]=d.copy().movePt(f.copy().mult(10).neg());h[1]=d.copy();h[2]=d.copy().movePt(e.copy().mult(10));f="drawArrow"+round(d.x,0)+round(d.y,0);new ArrowLine(f,h,Col(255,0,0),50,c);d=d.copy().movePt(e.mult(15));e=0.1*e.mag()*pxToMS;animText.newAnim({pos:d},{pos:d.copy().movePt({dy:-20}),col:curLevel.bgCol},{text:"Speed = "+round(e,1)+"m/s",time:3E3})},changeSetPt:function(d,f,e){if(-1!=f.indexOf("isothermal"))var h="cVIsothermal";else-1!=f.indexOf("adiabatic")&&
(h="cVAdiabatic");removeListener(curLevel,"wallMove","cV"+this.handle);f=d-this[0].y;0!=f&&(f=getSign(f),this.vs[0].dy=e*f,this.vs[1].dy=e*f,this.parent.setSubWallHandler(this.handle,0,h),addListener(curLevel,"wallMove","cV"+this.handle,function(){var e=this[0].y,f=stepTowards(e,d,this.vs[0].dy);this[0].y=f;this[1].y=f;this[this.length-1].y=f;this.parent.setupWall(this.handle);round(e,2)==round(d,2)&&(removeListener(curLevel,"wallMove","cV"+this.handle),this.parent.setSubWallHandler(this.handle,0,
"staticAdiabatic"),this.vs[0].dy=0,this.vs[1].dy=0)},this))},releaseWithBounds:function(d,f,e,h){this.moveStop();removeListener(curLevel,"wallMove","releaseWithBounds"+this.handle);removeListener(curLevel,"wallMove","cP"+this.handle);this.parent.setSubWallHandler(this.handle,0,e);d=defaultTo(0,d);f=defaultTo(Number.MAX_VALUE,f);var k=g,l=this.bounds;addListener(curLevel,"wallMove","releaseWithBounds"+this.handle,function(){var e=this[0].y,n=e+this.vs[0].dy+0.5*k;n<d||n>f?(this.moveStop(),this.parent.setSubWallHandler(this.handle,
0,"staticAdiabatic"),n<d?(h(d),e=d):(h(f),e=f)):n>l.max.y||n<l.min.y?e=this.hitBounds(e,k,l.min.y,l.max.y):(e=n,this.vs[0].dy+=k,this.vs[1].dy+=k);this[0].y=e;this[1].y=e;this[this.length-1].y=e;this.parent.setupWall(this.handle)},this)},moveInit:function(){var d=g,f=this.bounds;addListener(curLevel,"wallMove","cP"+this.handle,function(){var e=this[0].y,h,k=e+this.vs[0].dy+0.5*d;if(k>f.max.y){for(var l=!0,m=0;m<this.boundMaxHandlers.length;m++)this.boundMaxHandlers[m].replacesStd?(h=this.boundMaxHandlers[m].func.apply(this.boundMaxHandlers[m].obj,
[this,k,f.max.y]),l=!1):this.boundMaxHandlers[m].func.apply(this.boundMaxHandlers[m].obj,[this,k,f.max.y]);l&&(h=this.hitBounds(e,d,f.min.y,f.max.y))}else if(k<f.min.y){l=!0;for(m=0;m<this.boundMinHandlers.length;m++)this.boundMinHandlers[m].replacesStd?(h=this.boundMinHandlers[m].func.apply(this.boundMinHandlers[m].obj,[this,k,f.min.y]),l=!1):this.boundMinHandlers[m].func.apply(this.boundMinHandlers[m].obj,[this,k,f.min.y]);l&&(h=this.hitBounds(e,d,f.min.y,f.max.y))}else h=k,this.vs[0].dy+=d,this.vs[1].dy+=
d;this[0].y=h;this[1].y=h;this[this.length-1].y=h;this.parent.setupWall(this.handle)},this)},addBoundHandler:function(d,f){var e=this["bound"+d.toCapitalCamelCase()+"Handlers"];e?e.push(f):console.log("Bad wall bound handler type "+d)},removeBoundHandler:function(d,f){var e=this["bound"+d.toCapitalCamelCase()+"Handlers"];if(e){var h=e.indexOf(f);0<=h&&e.splice(h,1)}else console.log("Bad wall bound handler type "+d)},moveStop:function(){this.vs[0].dy=0;this.vs[1].dy=0;removeListener(curLevel,"wallMove",
"cP"+this.handle);removeListener(curLevel,"wallMove","releaseWithBounds"+this.handle)},hitBounds:function(d,f,e,h){var k=1,l=this.vs[0].dy,m=Math.max(e,Math.min(h,d+l*k+0.5*f*k*k));d=l*l+2*f*(m-d);if(m==h)var n=(-l+Math.sqrt(d))/f;else m==e&&(n=(-l-Math.sqrt(d))/f);this.vs[0].dy+=f*n;this.vs[1].dy+=f*n;this.vs[0].dy*=-1;this.vs[1].dy*=-1;k-=n;l=this.vs[0].dy;-2*l<k*f&&0>l&&(e=Math.abs(2*l/f),k-=Math.floor(k/e)*e);this.vs[0].dy+=f*k;this.vs[1].dy+=f*k;return m+l*k+0.5*f*k*k},setHitMode:function(d){/^[sS]td$/.test(d)||
/^[aA]rrowDV$/.test(d)||/^[aA]rrowSpd$/.test(d)||/^[gG]ravity$$/.test(d)?this.hitMode=d.toCapitalCamelCase():console.log("bad hitMode "+d)},setDefaultReadout:function(d){this.defaultReadout=d;return this},unsetDefaultReadout:function(){this.defaultReadout=void 0;return this},setTemp:function(d){this.tSet=d},getCv:function(){var d=0,f;for(f in window.spcs)var e=dotManager.get({tag:this.handle,spcName:f}),d=d+(e?e.length:0)*spcs[f].cv/N;return d},isothermalInit:function(d){if(d)if("number"==typeof d)this.tSet=
d;else if(/current/i.test(d)){var f=this.getDataSrc("temp");f.length&&(this.tSet=f[f.length-1])}this.eToAdd=0;dotManager.get({tag:this.handle});f=this.data.temp.src();this.isothermal||(addListener(curLevel,"data","recordEnergyForIsothermal"+this.handle,function(){var d;d=this.tSet-(f[f.length-1]||this.tSet);this.eToAdd=this.getCv()*d;for(var h in this.liquids){var k=this.liquids[h],l="setT"+k.handle;removeListener(curLevel,"update",l);var m=this.tSet;d=m-k.temp;if(1<Math.abs(d)){var n=d/15;addListener(curLevel,
"update",l,function(){var d=stepTowards(k.temp,m,n);this.q+=(d-k.temp)*k.Cp*JtoKJ;k.temp=d;d==m&&removeListener(curLevel,"update",l)},this)}}},this),this.recordQ());for(d=0;d<this.length;d++)this[d].isothermal=!0;this.isothermal=!0},isothermalStop:function(){this.isothermal=!1;removeListener(curLevel,"data","recordEnergyForIsothermal"+this.handle)},surfArea:function(){var d=0;for(ptIdx=0;ptIdx<this.length-1;ptIdx++)d+=this[ptIdx].distTo(this[ptIdx+1]);return d},updateMass:function(){var d=0,f;for(f in this.massChunks)d+=
this.massChunks[f];this.mass=d},setMass:function(d,f){this.massChunks[d]=f;this.updateMass();return this},unsetMass:function(d){if(d)delete this.massChunks[d];else for(d in this.massChunks)delete this.massChunk[d];this.updateMass();return this},addLiquid:function(d){this.liquids[d.handle]=d},removeLiquid:function(d){"string"==typeof d&&(d=this.liquids[d]);d&&d.handle&&delete this.liquids[d.handle]},setBounds:function(d,f){var e=this.bounds;f&&(f instanceof Point?e.max=f:e.max.y=f);d&&(d instanceof
Point?e.min=d:e.min.y=d)},addBorder:function(d){d.wall=this;this.border=new WallMethods.Border(d)},removeBorder:function(){this.border&&this.border.remove()},addPts:function(d,f){for(var e=[],h=this.parent.idxByInfo(this.handle),k=d;k<this.length;k++)e.push(this.parent.getSubWallHandler(h,d));this.concat();h=[];for(k=0;k<f.length;k++)h.push(V(0,0));h=[d,0].concat(h);k=[d,0].concat(f);Array.prototype.splice.apply(this,k);Array.prototype.splice.apply(this.vs,h);for(h=d+f.length;h<this.length;h++)this.parent.setSubWallHandler(this.handle,
h,e[h-f.length-d]);e=e[0]||this.parent[id+"-"+(d-1)];for(h=d;h<d+f.length;h++)this.parent.setSubWallHandler(this.handle,h,e);this.parent.setupWall(this.handle);this.border&&!this.border.removed&&this.border.update()},removePts:function(d,f){for(var e=[],h=this.parent.idxByInfo(this.handle),k=d+f;k<this.length;k++)e.push(this.parent.getSubWallHandler(h,k));this.splice(d,f);this.vs.splice(splice,f);for(k=d;k<this.length;k++)this.parent.setSubWallHandler(h,k,e[k-d]);this.parent.setupWall(this.handle);
this.border&&!this.border.removed&&this.border.update()},getPt:function(d){return this[d]},getUV:function(d){return this.wallUVs[d]},getPerpUV:function(d){return this.wallPerpUVs[d]},populateArrows:function(d){var f=this.parent.qArrowFill,e=this.parent.qArrowFillFinal,h=this.parent.qArrowStroke,k=getSign(d),l={"-1":"cw",1:"ccw"}[k];this.turnLastArrow=this.data.q.src().length-1;d=V(110*Math.abs(d),170*Math.abs(d));var m=d.copy();m.dx*=1.4;m.dy*=0.85;var n={"-1":0,1:-m.dx-30};if(7<d.dx||7<d.dy)for(var p=
0;p<this.length-1;p++)if(this[p].isothermal)for(var q=this[p].distTo(this[p+1]),r=Math.round(q/150),t=q/=r+1,u=0;u<r;u++){var x=this[p].copy().movePt(this.wallUVs[p].copy().mult(t)).movePt(this.wallPerpUVs[p].copy().mult(n[k]));new ArrowFly({pos:x,dist:30,UV:this.wallUVs[p].copy().perp(l),fill:f,fillFinal:e,stroke:h,dims:d,dimsFinal:m,lifespan:3500});t+=q}},cleanUp:function(){var d=this.cleanUpListeners,f;for(f in d){var e=d[f];e.func.apply(e.obj)}}};
WallMethods.BoundHandler=function(d,f,e){this.func=d;this.obj=f;this.replacesStd=e};WallMethods.wallDataHandler={setupCp:function(){for(var d=this.handle,f=[],e=[],h=0;h<LevelData.spcDefs.length;h++){var k=dotManager.get({tag:d,spcName:LevelData.spcDefs[h].spcName});k&&(f.push(k),e.push(LevelData.spcDefs[h].cv/N))}return function(){for(var d=0,h=0;h<f.length;h++)d+=f[h].length*e[h];return d}},pExt:function(){return this.pConst*this.mass*this.g/(this[1].x-this[0].x)},pInt:function(){var d=this.surfArea(),f;for(f in this.surfAreaAdj)d+=this.surfAreaAdj[f].val;d=this.pConst*this.forceInternal/
((turn-this.pLastRecord)*d);this.forceInternal=0;this.pLastRecord=turn;this.pIntList[this.pIntIdx]=d;this.pIntIdx++;this.pIntIdx==this.pIntLen&&(this.pIntIdx=0);return this.pIntList.average()},addSurfAreaAdjust:function(d){this.surfAreaAdj[d]={val:0};return this.surfAreaAdj[d]},removeSurfAreaAdjust:function(d){delete this.surfAreaAdj[d]},getDataObj:function(d,f,e){if(this.data[d])if(this.data[d]instanceof Array)for(e=0;e<this.data[d].length;e++){if(this.data[d][e].argsMatch(f))return this.data[d][e]}else return this.data[d];
else!0!==e&&(console.log('Tried to get bad data type "'+d+'" with args'),console.log(f));return!1},getDataSrc:function(d,f,e){if(this.data[d])if(this.data[d]instanceof Array)for(e=0;e<this.data[d].length;e++){if(this.data[d][e].argsMatch(f))return this.data[d][e].srcVal}else return this.data[d].srcVal;else e||(console.log('Tried to get bad data type "'+d+'" with args'),console.log(f));return!1},removeDataObj:function(d,f){if(this.data[d])if(this.data[d]instanceof Array){for(var e=0;e<this.data[d].length;e++)if(this.data[d][e].argsMatch(f))return this.data[d].splice(e,
1);console.log("Couldn't find data "+d+" with args "+f)}else return delete this.data[d]},pareData:function(){for(var d in this.data){var f=this.data[d];if(f instanceof Array)for(var e=0;e<f.length;e++)600<f[e].srcVal.length&&f[e].srcVal.splice(0,f[e].srcVal.length-300);else 600<f.srcVal.length&&f.srcVal.splice(0,f.srcVal.length-300)}},createSingleValDataObj:function(d,f,e){var h=new WallMethods.DataObj;e?this.data[d]?this.data[d].push(h):this.data[d]=[h]:this.data[d]=h;this.setupStdDataObj(h,d);h.recordStop(function(){});
h.srcVal=[f()];return h},recordDefaults:function(){this.recordTime();this.recordTemp();this.recordPInt();this.recordVol()},recordTime:function(){this.data.time=new WallMethods.DataObj;var d=this.data.time;this.setupStdDataObj(d,"time");var f=Date.now();recordData(d.id()+d.wallHandle(),d.src(),function(){return(Date.now()-f)/1E3},this,"update")},recordTemp:function(d){var f=this.data.temp;if(!f||!f.recording()){this.data.temp=new WallMethods.DataObj;f=this.data.temp;this.setupStdDataObj(f,"temp");
var e=this.dotManager.getWithLog({tag:this.handle});d||(d=function(){for(var d=0,f=0;f<e.length;f++)d+=e[f].KE();return e.length?tConst*d/e.length:0});recordData(f.id()+f.wallHandle(),f.src(),d,this,"update")}return this},recordRMS:function(){},getRMSMass:function(d){if(d)for(var f in spcs)for(var e=spcs[f].dots,h=0;h<e.length;h++)if(d){if(e[h].tag==d)return e[h].m}else return e[h].m},recordPInt:function(){var d=this.data.pInt;if(!d||!d.recording())this.data.pInt=new WallMethods.DataObj,d=this.data.pInt,
this.setupStdDataObj(d,"pInt"),this.pIntList=[],this.pIntIdx=0,recordData(d.id()+d.wallHandle(),d.src(),this.pInt,this,"update");return d},recordPExt:function(){var d=this.data.pExt;if(!d||!d.recording())this.data.pExt=new WallMethods.DataObj,d=this.data.pExt,this.setupStdDataObj(d,"pExt"),recordData(d.id()+d.wallHandle(),d.src(),this.pExt,this,"update");return d},recordVol:function(){var d=this.data.vol;if(!d||!d.recording())this.data.vol=new WallMethods.DataObj,d=this.data.vol,this.setupStdDataObj(d,
"vol"),recordData(d.id()+d.wallHandle(),d.src(),function(){return this.parent.wallVolume(this.handle)},this,"update");return d},recordWork:function(){var d=this.data.work;if(!d||!d.recording()){this.data.work=new WallMethods.DataObj;d=this.data.work;this.setupStdDataObj(d,"work");this.work=0;var f=LtoM3,e=PUNITTOPA,h=JtoKJ,k=this,l=this.getDataObj("vol").src();recordData(d.id()+d.wallHandle(),d.src(),function(){var d=l.length,d=f*(l[d-1]-l[d-2]);if(isNaN(d))return k.work=0;var n=k.pExt()*e;k.work-=
h*n*d;return k.work},this,"update")}return d},recordMass:function(){var d=this.data.mass;if(!d||!d.recording())this.data.mass=new WallMethods.DataObj,d=this.data.mass,this.setupStdDataObj(d,"mass"),recordData(d.id()+d.wallHandle(),d.src(),function(){return this.mass},this,"update");return d},recordQ:function(){var d=this.data.q;if(!d||!d.recording())this.data.q=new WallMethods.DataObj,d=this.data.q,this.setupStdDataObj(d,"q"),recordData(d.id()+d.wallHandle(),d.src(),function(){return this.q},this,
"update");return d},recordEnthalpy:function(){return this.recordEnergy("enthalpy","cp","hF298")},recordInternalEnergy:function(){return this.recordEnergy("internalEnergy","cv","uF298")},recordEnergy:function(d,f,e){var h=[],k=[],l=[],m=[],n=[],p=this.data[d];if(!p||!p.recording()){this.data[d]=new WallMethods.DataObj;p=this.data[d];this.setupStdDataObj(p,d);var q=this.getDataSrc("temp");if(this.isLiquid){for(d=0;d<LevelData.spcDefs.length;d++)if(void 0!==LevelData.spcDefs[d][e]&&void 0!==LevelData.spcDefs[d].cpLiq){var r=
this.dotManager.get({tag:this.handle,spcName:LevelData.spcDefs[d].spcName});n.push(r);k.push(1E3*LevelData.spcDefs[d][e]/N);l.push(1E3*LevelData.spcDefs[d].hVap298/N);m.push(LevelData.spcDefs[d].cpLiq/N)}f=function(){for(var d=0,e=0,f=q[q.length-1]-298.15,h=0;h<n.length;h++)d+=n[h].length*(k[h]+m[h]*f-l[h]),e+=n[h].length;return d*N/e}}else{for(d=0;d<LevelData.spcDefs.length;d++)r=this.dotManager.get({tag:this.handle,spcName:LevelData.spcDefs[d].spcName}),n.push(r),k.push(1E3*LevelData.spcDefs[d][e]/
N),h.push(LevelData.spcDefs[d][f]/N);f=function(){for(var d=0,e=0,f=q[q.length-1]-298.15,l=0;l<n.length;l++)d+=n[l].length*(k[l]+h[l]*f),e+=n[l].length;return d*N/e}}recordData(p.id()+p.wallHandle(),p.src(),f,this,"update")}return p},recordVDist:function(d){var f=this.dotManager.createIfNotExists(d);this.data.vDist||(this.data.vDist=[]);if(!this.getDataObj("vDist",d)){this.data.vDist.push(new WallMethods.DataObj);var e=this.data.vDist[this.data.vDist.length-1];this.setupInfoDataObj(e,"vDist",d);recordData(e.id()+
e.wallHandle(),e.src(),function(){for(var d=[],e=0;e<f.length;e++)d.push(f[e].speed());return d},this,"update")}},recordMoles:function(d){var f,e=this.dotManager.createIfNotExists(d);this.data.moles||(this.data.moles=[]);this.getDataObj("moles",d)?f=this.getDataObj("moles",d):(this.data.moles.push(new WallMethods.DataObj),f=this.data.moles[this.data.moles.length-1],this.setupInfoDataObj(f,"moles",d),recordData(f.id()+f.wallHandle(),f.src(),function(){return e.length/N},this,"update"));return f},recordFrac:function(d){var f,
e=this.dotManager.createIfNotExists(d),h=this.dotManager.createIfNotExists(d.tag?{tag:d.tag}:void 0);this.data.frac||(this.data.frac=[]);this.getDataObj("frac",d)?f=this.getDataObj("frac",d):(this.data.frac.push(new WallMethods.DataObj),f=this.data.frac[this.data.frac.length-1],this.setupInfoDataObj(f,"frac",d),recordData(f.id()+f.wallHandle(),f.src(),function(){return e.length/(h.length||1)},this,"update"));return f},setupStdDataObj:function(d,f){d.recording(!0);d.recordStop(this.recordStop);d.id(f);
d.type(f);d.wallHandle(this.handle)},setupInfoDataObj:function(d,f,e){d.recording(!0);d.recordStop(this.recordStopDestroy);d.id(f+(e.spcName||"").toCapitalCamelCase()+(e.tag||"").toCapitalCamelCase());d.wallHandle(this.handle);d.type(f);d.idArgs(e)},recordStopDestroy:function(){this.recording(!1);walls[this.wallHandle()].removeDataObj(this.type(),this.idArgs());recordDataStop(this.id()+this.wallHandle())},recordStop:function(){this.recording(!1);recordDataStop(this.id()+this.wallHandle())},recordAllStop:function(){for(var d in this.data){var f=
this.data[d];if(f instanceof Array)for(var e=0;e<f.length;e++)f[e].recordStop();else f.recordStop()}return this},resetWork:function(){this.work=0;return this},resetQ:function(){this.q=0;return this},displayQArrowsRate:function(d){d=d.threshold;if(this.data.q.recording()&&(!this.data.qArrowsRate||!this.data.qArrowsRate.recording())&&(!this.data.qArrowsAmmt||!this.data.qArrowsAmmt.recording())){this.data.qArrowsRate=new WallMethods.DataObj;var f=this.data.qArrowsRate;f.displaying(!0);f.wallHandle(this.handle);
f.id("qArrowsRate");this.turnLastArrow=Math.max(0,this.data.q.length-1);this.qArrowThreshold=defaultTo(d,0.3);var e="checkForDisplayArrows"+f.wallHandle(),h=this;qSrc=this.data.q.src();addListener(curLevel,"update",e,function(){h.checkDisplayArrows(qSrc)},this);this.turnLastArrow=turn;addListener(this,"cleanUp","qArrowsRate",function(){removeListener(curLevel,"update",e);removeListenerByName(curLevel,"update","ArrowFly")})}else console.log("Tried to display q arrowsRate for wall "+this.handle+" while not recording or already displaying.  Will not display."),
console.trace()},makeDataList:function(){var d=[];d.displaying=!1;d.recording=!1;return d},resetQ:function(){this.q=0;this.displayingQArrowsAmmt&&(this.displayQArrowsAmmtStop(),this.displayQArrowsAmmt(this.qArrowAmmtMax))},resetWork:function(){this.work=0},checkDisplayArrows:function(d){d=d[d.length-1]-d[this.turnLastArrow];Math.abs(d)>this.qArrowThreshold&&(this.populateArrows(d),this.turnLastArrow=turn)}};WallMethods.collideMethods={cPAdiabaticDamped:function(d,f,e,h,k,l){h=d.temp();l=0.5*d.m*(d.v.dx*d.v.dx+d.v.dy*d.v.dy);d.v.copy();var m=d.v.dy,n=f.vs[e].dy,p=d.m,q=f.mass,r=Math.abs(n);if(1<r){e=m*m;var t=n*n,r=0.0017*r*r*r-0.0281*r*r+0.205*r+0.8466,u=r*r,x=p*(1+p/(u*q)),v=-2*p*(m*p/q+n)/u;e=(-v+Math.sqrt(v*v-4*x*((p*(p*e/q+2*n*m)+q*t)/u-p*e-q*t)))/(2*x);d.y+=d.r;f.vs[0].dy=(p*m+q*n-p*e)/(q*r);f.vs[1].dy=f.vs[0].dy}else t=f[e],e=(m*(p-q)+2*q*n)/(d.m+q),f.vs[0].dy=(n*(q-p)+2*p*m)/(q+p),f.vs[1].dy=
f.vs[0].dy,d.y=t.y+d.r;m=0.5*d.m*(d.v.dx*d.v.dx+e*e);l=Math.sqrt((l+2*(m-l)/3)/m);e*=l;d.v.dx*=l;d.setTemp(h+(0.5*tConst*d.m*(d.v.dx*d.v.dx+e*e)-h)*d.cvKinetic/d.cv);0>d.v.dy*e&&(d.v.dy*=-1);f.forceInternal+=d.m*(Math.abs(k)+Math.abs(d.v.dy))},cPAdiabatic:function(d,f,e,h,k,l){f=d.temp();d.v.copy();h=d.v.dy;l=wall.vs[e].dy;var m=d.m,n=wall.mass,p=wall[e];e=(h*(m-n)+2*n*l)/(d.m+n);wall.vs[0].dy=(l*(n-m)+2*m*h)/(n+m);wall.vs[1].dy=wall.vs[0].dy;d.y=p.y+d.r;h=Math.sqrt((KEO+2*(KEF-KEO)/3)/KEF);e*=h;
d.v.dx*=h;d.setTemp(f+(0.5*tConst*d.m*(d.v.dx*d.v.dx+e*e)-f)*d.cvKinetic/d.cv);0>d.v.dy*e&&(d.v.dy*=-1);wall.forceInternal+=d.m*(Math.abs(k)+Math.abs(d.v.dy))},staticAdiabatic:function(d,f,e,h,k,l){this.reflect(d,h,k);f.forceInternal+=2*d.m*Math.abs(k)},cVIsothermal:function(d,f,e,h,k,l){if(f.eToAdd){l=getSign(f.eToAdd);e=d.temp();l*=Math.min(Math.abs(f.eToAdd),20*d.cv*f.isothermalRate);0>l&&e<=20*f.isothermalRate&&(l=-Math.max(0,e-1)*d.cv);f.eToAdd-=l;var m=e+l/d.cv,n=Math.sqrt(m/e),p=k*n;this.reflect(d,
h,k);d.v.dx*=n;d.v.dy*=n;d.internalPotential*=m/e;f.forceInternal+=d.m*(Math.abs(k)+Math.abs(p));f.q+=l*JtoKJ}else f.forceInternal+=2*d.m*Math.abs(k),this.reflect(d,h,k)},cVAdiabatic:function(d,f,e,h,k,l){d.v.dy=-d.v.dy+2*f.vs[e].dy},reflect:function(d,f,e){d.v.dx-=2*f.dy*e;d.v.dy+=2*f.dx*e;d.x-=f.dy;d.y+=f.dx},outlet:function(d){dotManager.remove(d)}};WallMethods.Border=function(d){this.wall=d.wall;this.type=d.type;this.yMin=void 0!==d.yMin?d.yMin:this.wall[0].y;this.col=d.col||this.wall.col.copy().adjust(-100,-100,-100);this.thick=d.thickness||5;this.update=this.pickGenerator(this.type);this.update();this.removed=!1};
WallMethods.Border.prototype={remove:function(){this.removed=!0;removeListener(curLevel,"update",this.listenerName)},pickGenerator:function(d){if("open"==d)return this.genOpen();if("wrap"==d)return this.genWrap()},genOpen:function(){return this.genBorder(this.thick,this.col,1,"end",!0)},genWrap:function(){return this.genBorder(this.thick,this.col,0,"end",!1)},genBorder:function(d,f,e,h,k){var l=this,m=c;this.listenerName="drawBorder"+this.wall.handle.toCapitalCamelCase();return function(){l.remove();
var n=l.genSegs(e,h,d,k);addListener(curLevel,"update",l.listenerName,function(){for(var d=0;d<n.length;d++)draw.fillPts(n[d],f,m)});l.removed=!1}},genSegs:function(d,f,e,h){var k=[];f="end"==f?this.wall.length-1:f;for(var l=d;l<f;l++){var m=this.wall.wallPerpUVs[l].copy().neg(),n=this.wall[l].copy(),p=this.wall[l+1].copy(),q=l+1==f?0:l+1,r;r=this.getExtendV(m,this.wall[l-1]?l-1:this.wall.length-2,d-1,e,h);m=this.getExtendV(m,q,0,e,h);m=p.copy().movePt(m);r=n.copy().movePt(r);"open"==this.type&&(l==
d?(n.y=this.yMin,r.y=this.yMin):l==f-1&&(p.y=this.yMin,m.y=this.yMin));k.push([n,p,m,r])}return k},getExtendV:function(d,f,e,h,k){var l=this.wall.wallPerpUVs[f].copy().neg();f=k&&f==e?d.copy():l.add(d).UV();d=d.dotProd(f);return f.mult(h/d)}};function ButtonManager(d){this.wrapperDivId=d;this.groups=[]}
ButtonManager.prototype={addGroup:function(d,f,e,h,k){var l=$("#"+this.wrapperDivId),m="group"+d,n=m+"Wrapper",p=m+"Padder",q=templater.div({attrs:{id:[m],"class":["buttonGroup"]}}),q=f+templater.br()+q,n=templater.div({attrs:{id:[n],handle:[d],"class":["buttonManagerElem","displayText","buttonGroupWrapper"]},innerHTML:q}),p=templater.div({attrs:{id:[p],handle:[d],"class":["buttonManagerElem","buttonGroupPadder"]},innerHTML:n});l.append(p);this.groups.push(new ButtonManager.Group(l,m,d,f,e,h,k))},
removeGroup:function(d){var f=this.getGroup(d);f?(d=this.groups.indexOf(f),f=this.getGroupDiv(f),this.groups.splice(d,1),f.remove()):console.log("Bad group handle "+d)},removeButton:function(d,f){var e=this.getGroup(d);e?e.removeButton(f):console.log("Bad group handle "+d)},getGroupDiv:function(d){for(var f=$("#"+this.wrapperDivId).children(),e=0;e<f.length;e++)if($(f[e]).attr("handle")==d.handle)return $(f[e])},arrangeGroupWrappers:function(){var d=this.arrangeObjs(this.groups);this.arrangeHTML($("#"+
this.wrapperDivId),d)},arrangeAllGroups:function(){for(var d=0;d<this.groups.length;d++)this.arrangeGroup(this.groups[d].handle)},arrangeGroup:function(d){var f=this.getGroup(d);f?(d=this.arrangeObjs(f.buttons),this.arrangeHTML($("#"+f.groupId),d)):console.log("Bad group name "+d)},setButtonWidth:function(){for(var d=$("button.buttonManagerElem"),f=100,e=0;e<d.length;e++)var h=d[e],f=Math.max(f,$(h).outerWidth());for(e=0;e<d.length;e++)h=d[e],$(h).css("width",f)},arrangeHTML:function(d,f){for(var e=
d.children(),h=!1,k=0;k<e.length;k++){var l=e[k],m=f[k],l=$(l).attr("handle");if(h=Math.max(h,l!=m.handle))break}if(h){h={};for(k=0;k<e.length;k++)l=e[k],h[$(l).attr("handle")]=$(l).clone(!0);d.html("");for(e=0;e<f.length;e++)d.append(h[f[e].handle])}},addButton:function(d,f,e,h,k,l){var m=this.getGroup(d);m?m.addButton(f,e,h,k,l):console.log("Bad group handle "+d)},getGroup:function(d){for(var f=0;f<this.groups.length;f++)if(this.groups[f].handle==d)return this.groups[f]},arrangeObjs:function(d){var f=
[];d=this.sortObjs(d.concat());var e=this.slicePrefs(d);d=this.sliceNoPrefs(d);for(var h=0;h<e.length;h++){var k=e[h].prefIdx;f[k]?f.push(e[h]):f[k]=e[h]}for(h=e=0;e<d.length;)void 0==f[h]&&(f[h]=d[e],e++),h++;for(h=f.length-1;0<=h;h--)void 0==f[h]&&f.splice(h,1);return f},sortObjs:function(d){for(var f=0;f<d.length;f++)for(var e=0;e<d.length-1;e++)if(d[e].prefIdx>d[e+1].prefIdx||void 0==d[e].prefIdx){var h=d[e];d[e]=d[e+1];d[e+1]=h}return d},slicePrefs:function(d){for(var f=0;f<d.length;f++)if(void 0==
d[f].prefIdx)return d.slice(0,f);return d.slice(0,d.length)},sliceNoPrefs:function(d){for(var f=0;f<d.length;f++)if(void 0==d[f].prefIdx)return d.slice(f,d.length);return[]}};ButtonManager.Group=function(d,f,e,h,k,l,m){this.mgrDiv=d;this.groupId=f;this.handle=e;this.label=h;this.prefIdx=k;this.buttons=[];this.isRadio=l;this.isToggle=m&&!l};
ButtonManager.Group.prototype={addButton:function(d,f,e,h,k,l){var m=d+"Button",n=d+"Wrapper";this.buttons.push(new ButtonManager.Button(d,m,n,f,e,h,l));f=templater.button({innerHTML:f,attrs:{id:[m],"class":["buttonManagerElem","buttonManagerButton"],handle:[d]}});d=templater.div({innerHTML:f,attrs:{id:[n],"class":["buttonManagerElem","buttonWrapper"],handle:[d]}});$("#"+this.groupId).append(d);m=$("button#"+m);addJQueryElems(m,"button");d=this.buttons[this.buttons.length-1];n=d.click;f=d.mousedown;
e=d.mouseup;this.isRadio?n=this.wrapInRadio(d,n):this.isToggle&&(n=this.wrapInToggle(d,n));k&&n&&n();k&&this.isRadio?this.pushRadio(d):k&&this.isToggle&&this.toggleButton(d);n&&$(m).click(n);f&&$(m).mousedown(f);e&&$(m).mouseup(e)},removeButton:function(d){d=this.getButton(d);this.getButtonDiv(d).remove();this.buttons.splice(this.buttons.indexOf(d),1)},wrapInRadio:function(d,f){var e=f,h=this;return function(){h.pushRadio(d);e()}},wrapInToggle:function(d,f){var e=f,h=this;return function(){h.toggleButton(d);
e()}},pushRadio:function(d){for(var f=0;f<this.buttons.length;f++)$("#"+this.buttons[f].buttonId).removeClass("ui-button-as-radio-selected");$("#"+d.buttonId).addClass("ui-button-as-radio-selected")},toggleButton:function(d){d=$("#"+d.buttonId);d.hasClass("ui-button-as-radio-selected")?d.removeClass("ui-button-as-radio-selected"):d.addClass("ui-button-as-radio-selected")},getButton:function(d){for(var f=0;f<this.buttons.length;f++)if(this.buttons[f].handle==d)return this.buttons[f];console.log("Bad button handle "+
d)},getButtonDiv:function(d){for(var f=$("#"+this.groupId).children(),e=0;e<f.length;e++)if($(f[e]).attr("handle")==d.handle)return $(f[e])}};ButtonManager.Button=function(d,f,e,h,k,l,m){this.handle=d;this.buttonId=f;this.wrapperId=e;this.label=h;this.click;this.mousedown;this.mouseup;k.mousedown||k.mouseup?(k.mousedown&&(this.mousedown=this.wrapExprs(k.mousedown)),k.mouseup&&(this.mouseup=this.wrapExprs(k.mouseup))):this.click=this.wrapExprs(k);this.prefIdx=l};
ButtonManager.Button.prototype={wrapExprs:function(d){if("function"==typeof d)return d;d=d instanceof Array?d.join(";")+";":d+";";with(DataGetFuncs)d=eval("(function() {"+d+"})");return d}};function QuizRenderer(){this.hoverCol=Col(0,81,117);this.selectedCol=Col(40,121,147)}
QuizRenderer.prototype={render:function(d,f){var e=new QuizRenderer.Quiz(d);if(this.checkQuizTyping(e)){var h=templater.div({attrs:{id:["quizWrapper"]}}),k=templater.div({attrs:{id:["quizContent"],"class":["niceFont","whiteFont"]}}),l=templater.div({attrs:{id:["quizFooter"]}});$(f).append(h);h=$("#quizWrapper");$(h).append(k);$(h).append(l);k=$("#quizContent");l=$("#quizFooter");for(h=0;h<e.questions.length;h++)this.renderQuestion(e.questions[h],k);d[0]&&"setVals"==d[0].type?this.appendButtons(l,
function(){sceneNavigator.prevPrompt()},function(){sceneNavigator.refresh()},"Back","Set values"):this.appendButtons(l,function(){sceneNavigator.prevPrompt()},function(){sceneNavigator.nextPrompt()},"Back","Submit");return e}},checkQuizTyping:function(d){d=d.questions;for(var f=!1,e=!1,h=0;h<d.length;h++)"setVals"==d.type?f=!0:e=!0;return f&&e?(console.log("Bad quiz typing.  Can't mix setVals with others"),!1):!0},renderQuestion:function(d,f){"multChoice"==d.type?this.renderMultChoice(d,f):"text"==
d.type?this.renderTextBox(d,f,3,50):"textSmall"==d.type?this.renderTextBox(d,f,1,10):"setVals"==d.type&&this.renderTextBox(d,f,1,10)},renderMultChoice:function(d,f){for(var e=d.options,h=void 0===d.questionText?"":interpreter.interp(d.questionText)+templater.br(),h=h+"<div style = 'padding-top:4px;'>",k=0;k<e.length;k++)var l=e[k],h=h+templater.div({attrs:{id:[d.storeAs+String(k)],"class":["multChoiceBlock"]},innerHTML:l.text});f.append(h+"</div>");for(k=0;k<e.length;k++)l=e[k],l.div=$("#"+d.storeAs+
String(k));this.bindMultChoiceQuestion(d)},bindMultChoiceQuestion:function(d){var f=this,e=d.options,h=function(h){var k=e[h];d.answered=!0;if(!k.selected){for(var n=0;n<e.length;n++)e[n]!=k&&(e[n].div.css("background-color","transparent"),e[n].selected=!1);k.selected=!0;store(d.storeAs,h);d.hasCorrectAnswer()?d.correct=k.correct?!0:!1:d.correct=!0;$(k.div).css("background-color",f.selectedCol.hex)}};void 0!==getStore(d.storeAs)&&h(getStore(d.storeAs));for(var k=0;k<d.options.length;k++)this.bindMultChoiceOption(d,
h,d.options,d.options[k])},bindMultChoiceOption:function(d,f,e,h){var k=this;h.div.click(function(){f(e.indexOf(h))});h.div.hover(function(){h.selected||$(this).css("background-color",k.hoverCol.hex)},function(){h.selected||$(this).css("background-color","transparent")})},renderTextBox:function(d,f,e,h){var k=d.storeAs,l=defaultTo("Type your answer here.",d.boxText);textareaHTML=templater.textarea({attrs:{id:[k],rows:[e],cols:[h],placeholder:[l]}});e=(void 0===d.questionText?"":interpreter.interp(d.questionText)+
templater.br())+templater.table({attrs:{"class":["niceFont","whiteFont"]},innerHTML:templater.tr({innerHTML:templater.td({innerHTML:d.label})+templater.td({innerHTML:"&#32;&#32;"})+templater.td({innerHTML:textareaHTML})+templater.td({innerHTML:d.units||""})})});f.append(e);d.div=$("#"+k);var m=function(e){e=void 0!==e?e:d.div.val();""!=e&&(store(d.storeAs,e),d.answered=!0,d.hasCorrectAnswer()?0.05>fracDiff(parseFloat(d.answer),parseFloat(val))?d.correct=!0:d.correct=!1:d.correct=!0)};getStore(d.storeAs)&&
(m(getStore(d.storeAs)),d.div.html(getStore(d.storeAs)));d.div.change(function(){m()})},appendButtons:function(d,f,e,h,k){h=templater.button({attrs:{id:["quizButtonLeft"]},innerHTML:h})+templater.button({attrs:{id:["quizButtonRight"]},innerHTML:k});h=templater.div({attrs:{id:["quizSubmitWrapper"]},style:{"float":"right"},innerHTML:h});$(d).append(h);$("#quizButtonLeft").click(f);$("#quizButtonRight").click(e);addJQueryElems($("#quizButtonLeft"),"button");addJQueryElems($("#quizButtonRight"),"button");
$(d).css("min-height",$("#quizButtonLeft").height()+5+"px")}};QuizRenderer.Quiz=function(d){this.questions=[];for(var f=0;f<d.length;f++)this.questions.push(new QuizRenderer.Question(d[f]))};
QuizRenderer.Quiz.prototype={allAnswered:function(){for(var d=0;d<this.questions.length;d++)if(!this.questions[d].answered)return!1;return!0},allCorrect:function(){for(var d=0;d<this.questions.length;d++)if(!this.questions[d].correct)return!1;return!0},fireAlertWrong:function(){for(var d=0;d<this.questions.length;d++){var f=this.questions[d];if(f.hasCorrectAnswer()&&!f.correct)if("multChoice"==f.type)for(var e=0;e<f.options.length;e++){if(f.options[e].selected&&f.options[e].message){alert(f.options[e].message);
return}}else if(f.message){alert(f.message);break}}},sendAnswersToCW:function(){for(var d=0;d<this.questions.length;d++)this.questions[d].sendAnswerToCW()}};
QuizRenderer.Question=function(d){this.type=d.type;this.label=this.getQuestionLabel(d.label,this.CWQuestionId);this.boxText=defaultTo(d.text,d.boxText);this.CWQuestionId=d.CWQuestionId;this.questionText=this.getQuestionText(d.questionText||d.preText,this.CWQuestionId);this.units=d.units;this.message=d.message;this.storeAs=d.storeAs;this.options=this.makeOptions(d.options);this.answered=!1;this.answer=d.answer;this.correct=!1;this.div=void 0};
QuizRenderer.Question.prototype={makeOptions:function(d){if(d){for(var f=[],e=0;e<d.length;e++)f.push(new QuizRenderer.MultChoiceOption(d[e],this.CWQuestionId));return f}},getQuestionText:function(d,f){if(void 0===f)return d;var e=new XMLHttpRequest;if(/^(http|https)/.test(document.URL)){var h=window.stringTogetherGET({"goto":"simulation",command:"get_question_text",question_id:f});e.open("GET","CW.php?"+h);e.send(null)}return e.responseText?atob(e.responseText):d},getQuestionLabel:function(d,f){if(void 0===
f)return d;var e=new XMLHttpRequest;if(/^(http|https)/.test(document.URL)){var h=window.stringTogetherGET({"goto":"simulation",command:"get_question_label",question_id:f});e.open("GET","CW.php?"+h);e.send(null)}return requiest.responseText?atob(e.responseText):defaultText},hasCorrectAnswer:function(){if(("text"==this.type||"textSmall"==this.type||"setVals"==this.type)&&void 0!==this.answer)return!0;if("multChoice"==this.type)for(var d=0;d<this.options.length;d++)if(this.options[d].correct)return!0;
return!1},sendAnswerToCW:function(){var d=new XMLHttpRequest,f;if("text"==this.type||"textSmall"==this.type||"setVals"==this.type)f=getStore(this.storeAs),f=btoa(f),/^(http|https)/.test(document.URL)&&(f=window.stringTogetherGET({"goto":"simulation",command:"send_answer",question_id:this.CWQuestionId,answer_text_64:f}),d.open("GET","CW.php?"+f),d.send(null));else if("multChoice"==this.type)for(var e=0;e<this.options.length;e++)this.options[e].selected&&(void 0!==this.options[e].CWAnswerId&&/^(http|https)/.test(document.URL))&&
(f=window.stringTogetherGET({"goto":"simulation",command:"send_answer",question_id:this.CWQuestionId,answer_id:this.options[e].CWanswerId}),d.open("GET","CW.php?"+f),d.send(null))}};QuizRenderer.MultChoiceOption=function(d,f){this.CWAnswerId=d.CWAnswerId;this.correct=d.correct||!1;this.text=this.getAnswerText(d.text,f,this.CWAnswerId);this.selected=!1;this.message=d.message;this.div=void 0};
QuizRenderer.MultChoiceOption.prototype={getAnswerText:function(d,f,e){if(void 0===f||void 0===e)return d;var h=new XMLHttpRequest;f=window.stringTogetherGET({"goto":"simulation",command:"get_answer_text",question_id:f,answer_id:e});/^(http|https)/.test(document.URL)&&(h.open("GET","CW.php?"+f),h.send(null));return h.responseText?atob(h.responseText):d}};function SliderManager(d){this.containerId=d;this.sliderGroupWrapper=this.appendSliderGroupWrapper(this.containerId)}
SliderManager.prototype={addSlider:function(d,f,e,h,k){k=void 0===k?this.getMaxIdx(this.sliderGroupWrapper)+1:k;k=this.insertSliderWrapper(this.containerId,this.sliderGroupWrapper,k,f);var l=this.insertSliderPadding(k);f="sliderInnerContainer"+this.containerId+"Handle"+f;var m="#"+this.containerId+" #"+f;makeSlider(l,l,m,f,d,e,h);this.setWidths();return new SliderManager.Slider(this,k,$(m))},setWidths:function(){var d=this.sliderGroupWrapper.children();if(d.length){this.sliderGroupWrapper.css("width",
150*d.length/(1+1.5*d.length)+"%");for(var f=100/d.length,e=0;e<d.length;e++)$(d[e]).css("width",f+"%")}},insertSliderWrapper:function(d,f,e,h){for(var k="sliderIdx"+e+"Handle"+h,l=f.children(),m=-1,n=0;n<l.length;n++){var p=$(l[n]).attr("sliderIdx");if(void 0!==p&&e<=p){m=n;break}}e=templater.div({attrs:{id:[k],handle:[h],sliderIdx:[e],"class":["sliderWrapper"]}});-1==m?f.append(e):$(l[n]).before(e);return $("#"+d+" #"+k)},insertSliderPadding:function(d){var f=d.attr("id")+"Padding",e=templater.div({attrs:{id:[f],
"class":["sliderPadding"]}});d.append(e);return $("#"+d.attr("id")+" #"+f)},getMaxIdx:function(d){d=d.children();for(var f=-1,e=0;e<d.length;e++){var h=$(d[e]).attr("sliderIdx");void 0!==h&&!isNaN(h)&&(f=Math.max(h,f))}return f},appendSliderGroupWrapper:function(d){$("#"+d).append(templater.div({attrs:{id:["sliderWrapper"],"class":["sliderGroupWrapper"]}}));return $("#"+d+" #sliderWrapper")}};
SliderManager.Slider=function(d,f,e){this.manager=d;this.wrapper=f;this.slider=e;this.selector=e.selector;this.removed=!1};SliderManager.Slider.prototype={remove:function(){this.removed||(this.wrapper.remove(),this.manager.setWidths(),this.removed=!0)}};function ActivationEnergySpcChanger(d){this.collideHandler=d;this.pairs={};this.active=!1;this.standardBreakUp=this.collideHandler.breakUp;this.breakUpFunc=this.makeBreakUpFunc()}
ActivationEnergySpcChanger.prototype={addPair:function(d){var f=d.spcNameLow,e=d.spcNameHigh;this.pairs[f]||this.pairs[e]?console.log("Trying to add another energy threshold to either "+f+" or "+e):(this.pairs[d.spcNameLow]=d,this.pairs[d.spcNameHigh]=d,this.active||this.addActiveEBreakUp())},removePair:function(d){delete this.pairs[d.spcNameLow];delete this.pairs[d.spcNameHigh];countAttrs(this.pairs)||(this.active=!1,this.restoreBreakUp())},addActiveEBreakUp:function(){this.collideHandler.breakUp=
this.breakUpFunc},restoreBreakUp:function(){this.collideHandler.breakUp=this.standardBreakUp},makeBreakUpFunc:function(){var d=this;return function(f,e,h){var k,l=d.pairs[f.spcName],m=d.pairs[e.spcName];l&&(k=f.kineticEnergy(),l.activationEnergy>=k&&f.spcName==l.spcNameHigh?dotManager.changeDotSpc([f],l.spcNameLow):l.activationEnergy<k&&f.spcName==l.spcNameLow&&dotManager.changeDotSpc([f],l.spcNameHigh));m&&(k=e.kineticEnergy(),m.activationEnergy>=k&&e.spcName==m.spcNameHigh?dotManager.changeDotSpc([e],
m.spcNameLow):m.activationEnergy<k&&e.spcName==m.spcNameLow&&dotManager.changeDotSpc([e],m.spcNameHigh));d.standardBreakUp(f,e,h)}}};function ConditionManager(){this.conditionSets={}}
ConditionManager.prototype={add:function(d){var f=this.timeStrToStamp(d.requiredFor);this.conditionSets[f]||(this.conditionSets[f]=[]);var f=this.conditionSets[f],e=this.getIfExists(d,f);d=new ConditionManager.TriggerEntry(d);e&&(d.satisfied=e.satisfied,f.splice(f.indexOf(e,1)));f.push(d)},canAdvance:function(d){var f;"number"==typeof d?f=d:/prompt/i.test(d)?f=/[0-9]+/.exec(d):/section/i.test(d)&&(f=-1);return this.checkConditions(this.conditionSets[f]||[])},checkConditions:function(d,f){f=defaultTo(!0,
f);for(var e,h=-1,k=!0,l=0;l<d.length;l++){var m=d[l],n=m.trigger;m.satisfied||(m=!0,"conditions"==n.checkOn&&!n.conditionFunc()?m=!1:!n.isSatisfied()&&!n.conditionFunc()&&(m=!1),!m&&(n.priority>h&&n.message)&&(e=n.message,h=n.priority),m||(k=!1))}f&&e&&alert(e);k&&d.map(function(d){d.satisfied=!0;/conditions/i.test(d.checkOn)&&d.recordVals()});return k},stripForInheritance:function(){for(var d in this.conditionSets)for(var f=this.conditionSets[d],e=f.length-1;0<=e;e--)f[e].satisfied&&f.splice(e,
1);return this},getIfExists:function(d,f){for(var e=0;e<f.length;e++)if(d.handle==f[e].trigger.handle)return f[e]},timeStrToStamp:function(d){return/section/i.test(d)?-1:/prompt/i.test(d)?Number(/[0-9]+/.exec(d)):isNaN(Number(d))?timeline.nowTime().promptIdx:Number(d)}};ConditionManager.TriggerEntry=function(d){this.trigger=d;this.satisfied=!1};compressorFuncs={getBinPts:function(d,f,e,h){var k=[];h=defaultTo(5,h);k.push(P(d.x-f*e.dx/2,d.y-e.dy));k.push(P(d.x-e.dx/2,d.y));k.push(P(d.x+e.dx/2,d.y));k.push(P(d.x+f*e.dx/2,d.y-e.dy));k.push(P(d.x+f*e.dx/2+h,d.y-e.dy));k.push(P(d.x+e.dx/2+h,d.y+h));k.push(P(d.x-e.dx/2-h,d.y+h));k.push(P(d.x-f*e.dx/2-h,d.y-e.dy));k.push(P(d.x-f*e.dx/2,d.y-e.dy));return k}};
objectFuncs={setupStd:function(){this.enabled=!0;this.removed=!1;this.handle&&this.addToCurLevel();this.wrapRemove()},wrapRemove:function(){var d=this.remove;this.remove=function(){this.removed=!0;this.handle&&this.removeFromCurLevel();d.apply(this)}},addToCurLevel:function(){curLevel[curLevel.key(this.type,this.handle)]=this},removeFromCurLevel:function(){var d=curLevel.key(this.type,this.handle);delete curLevel[d]},pickSliderPos:function(){var d;this.wall?d=(this.wall[0].x+this.wall[1].x)/2:this.pos&&
this.dims?d=this.pos.x+this.dims.dx/2:this.pos&&(d=this.pos.x);if(d){var f=$("#main").width()/3;d=Math.floor(d/f);if(0==d)return"left";if(1!=d&&2==d)return"right"}return this.checkForMigrateCenter()},addSlider:function(d,f,e,h,k,l){if(!k||!l){h||(h=this.pickSliderPos());switch(h){case "left":k=$(".active #sliderHolderLeft");$(".active #sliderHolderSingle").hide();$(".active #sliderHolderDouble").show();break;case "center":k=$(".active #sliderHolderCenter");$(".active #sliderHolderSingle").show();
$(".active #sliderHolderDouble").hide();break;case "right":k=$(".active #sliderHolderRight"),$(".active #sliderHolderSingle").hide(),$(".active #sliderHolderDouble").show()}l=k}h=".active #slider"+this.handle.toCapitalCamelCase();k=makeSlider(l,k,h,d,f,e);this.sliderWrapperSelectors||(this.sliderWrapperSelectors=[]);this.sliderWrapperSelectors.push(".active #"+$(l).attr("id"));this.sliderWrapperSelectors.push(".active #"+$(k).attr("id"));return h},checkForMigrateCenter:function(){return""!=$("#sliderHolderCenter").html().killWhiteSpace()?
(this.migrateCenterSlider(),"right"):"center"},migrateCenterSlider:function(){var d=$("#sliderHolderCenter").html();$("#sliderHolderCenter").html("");$("#sliderHolderLeft").html(d)},removeSlider:function(){if(this.sliderWrapperSelectors)for(var d=0;d<this.sliderWrapperSelectors.length;d++)$(this.sliderWrapperSelectors[d]).html("")},hideSliderDivs:function(){$(".active #sliderHolderSingle").hide();$(".active #sliderHolderDouble").hide()},valToPercent:function(d){return 100*(d-this.min)/(this.max-this.min)},
percentToVal:function(d){return d*(this.max-this.min)/100+this.min},pressureToMass:function(d){return d*(this.wall[1].x-this.wall[0].x)/(pConst*g)},massToPressure:function(d){return d*pConst*g/(this.wall[1].x-this.wall[0].x)},toggle:function(){this.enabled?this.disable():this.enable()}};function ActivationEnergyPair(d){this.type="ThresholdEnergyPair";spcs[d.spcNameLow]&&spcs[d.spcNameHigh]?(this.spcNameLow=d.spcNameLow,this.spcNameHigh=d.spcNameHigh,this.spcDefLow=spcs[this.spcNameLow],this.spcDefHigh=spcs[this.spcNameHigh],this.activationEnergy=d.activationEnergy,this.addToChanger(),this.setupStd()):(console.log("One of the species names in threshold energy pair is bad"),console.log("The names are "+d.spcNameLow+" and "+d.spcNameHigh))}
_.extend(ActivationEnergyPair.prototype,objectFuncs,{addToChanger:function(){activationEnergySpcChanger.addPair(this)},remove:function(){activationEnergySpcChanger.removePair(this)}});function ArrowFly(d){this.type="ArrowFly";this.pos=d.pos.copy();if(d.posFinal)this.posFinal=d.posFinal,this.UV=this.pos.VTo(this.posFinal).UV(),this.dir=this.UV.angle(),this.dist=this.pos.distTo(this.posFinal);else if(d.V)this.posFinal=this.pos.copy().movePt(d.V),this.UV=d.V.UV(),this.dir=this.UV.angle();else if((d.dir||d.UV)&&d.dist)d.dir?(this.dir=d.dir,this.UV=angleToUV(d.dir)):(this.UV=d.UV,this.dir=this.UV.angle(),this.UV=d.UV),this.posFinal=this.pos.copy().movePt(this.UV.copy().mult(d.dist)),
this.dist=d.dist;this.drawCanvas=defaultTo(c,d.drawCanvas);this.dims=d.dims.copy();this.dimsFinal=defaultTo(this.dims,d.dimsFinal);this.fill=d.fill.copy();this.fillUnround={r:this.fill.r,g:this.fill.g,b:this.fill.b};this.fillFinal=defaultTo(this.fill,d.fillFinal);this.stroke=defaultTo(this.fill,d.stroke.copy());this.fade=defaultTo(!0,d.fade);this.fadeTurns=defaultTo(4,d.fadeTurns);this.strokeUnround={r:this.stroke.r,g:this.stroke.g,b:this.stroke.b};this.strokeFinal=defaultTo(this.fillFinal,d.strokeFinal);
this.alpha=defaultTo(1,d.alpha);this.alphaFinal=defaultTo(this.alpha,d.alphaFinal);this.age=0;this.lifespan=Math.round(d.lifespan/updateInterval);this.getSteps();this.pts=this.getPts();this.onFinish=d.onFinish;return this.init()}
_.extend(ArrowFly.prototype,objectFuncs,toInherit.ArrowFuncs,{getSteps:function(){var d=1/this.lifespan;this.posStep=this.pos.VTo(this.posFinal).mult(d);this.dimsStep=V(this.dimsFinal.dx-this.dims.dx,this.dimsFinal.dy-this.dims.dy).mult(d);this.fillStep={r:d*(this.fillFinal.r-this.fill.r),g:d*(this.fillFinal.g-this.fill.g),b:d*(this.fillFinal.b-this.fill.b)};this.strokeStep={r:d*(this.strokeFinal.r-this.stroke.r),g:d*(this.strokeFinal.g-this.stroke.g),b:d*(this.strokeFinal.b-this.stroke.b)};this.alphaStep=
(this.alphaFinal-this.alpha)*d},init:function(){this.updateListenerName=unique(this.type+defaultTo("",this.handle),curLevel.updateListeners);addListener(curLevel,"update",this.updateListenerName,this.run,this);this.setupStd();return this},run:function(){this.drawCanvas.save();this.drawCanvas.globalAlpha=this.alpha;this.drawCanvas.translate(this.pos.x,this.pos.y);this.drawCanvas.rotate(this.dir);draw.fillPtsStroke(this.pts,this.fill,this.stroke,this.drawCanvas);this.drawCanvas.restore();this.takeStep();
this.age++;this.age==this.lifespan&&(this.onFinish&&this.onFinish.func.apply(this.onFinish.obj),this.fade?(this.alphaStep=-this.alpha/this.fadeTurns,this.remove(),this.updateListenerName=unique(this.type+defaultTo("",this.handle)+"fade",curLevel.updateListeners),addListener(curLevel,"update",this.updateListenerName,this.runFade,this),this.addCleanUp()):this.remove())},runFade:function(){this.drawCanvas.save();this.drawCanvas.globalAlpha=this.alpha;this.drawCanvas.translate(this.pos.x,this.pos.y);
this.drawCanvas.rotate(this.dir);draw.fillPtsStroke(this.pts,this.fill,this.stroke,this.drawCanvas);this.drawCanvas.restore();this.takeStepFade();this.age++;this.age==this.lifespan+this.fadeTurns&&this.remove()},scale:function(){for(var d=(this.dims.dx+this.dimsStep.dx)/this.dims.dx,f=(this.dims.dy+this.dimsStep.dy)/this.dims.dy,e=0;e<this.pts.length;e++)this.pts[e].x*=d,this.pts[e].y*=f},takeStep:function(){this.pos.movePt(this.posStep);this.dims.add(this.dimsStep);this.scale();this.alpha+=this.alphaStep;
this.fillUnround.r+=this.fillStep.r;this.fillUnround.g+=this.fillStep.g;this.fillUnround.b+=this.fillStep.b;this.strokeUnround.r+=this.strokeStep.r;this.strokeUnround.g+=this.strokeStep.g;this.strokeUnround.b+=this.strokeStep.b;this.fill.setFromUnround(this.fillUnround);this.stroke.setFromUnround(this.strokeUnround)},takeStepFade:function(){this.pos.movePt(this.posStep);this.dims.add(this.dimsStep);this.scale();this.alpha+=this.alphaStep},remove:function(){removeListener(curLevel,"update",this.updateListenerName);
this.removeCleanUp()}});function ArrowLine(d,f,e,h,k){this.handle=d;this.pts={line:f,arrow:Array(3)};this.col=e;this.drawCanvas=defaultTo(c,k);d=this.pts.line[this.pts.line.length-1];e=d.VTo(this.pts.line[this.pts.line.length-2]).UV();f=e.copy().rotate(0.5);e=e.copy().rotate(-0.5);this.pts.arrow[0]=d.copy().movePt(f.mult(10));this.pts.arrow[1]=d;this.pts.arrow[2]=d.copy().movePt(e.mult(10));return this.show(h)}
ArrowLine.prototype={draw:function(){for(var d=this.pts.line,f=0;f<d.length-1;f++)draw.line(d[f],d[f+1],this.col,this.drawCanvas);d=this.pts.arrow;draw.line(d[0],d[1],this.col,this.drawCanvas);draw.line(d[1],d[2],this.col,this.drawCanvas)},show:function(d){addListener(curLevel,"update","drawArrow"+this.handle,this.makeDrawFunc(d),this);return this},makeDrawFunc:function(d){var f=0,e=this,h=function(){e.draw()};d&&(h=extend(h,function(){f++;f==d&&removeListener(curLevel,"update","drawArrow"+e.handle)}));
return h},hide:function(){removeListener(curLevel,"update","drawArrow"+this.handle)}};function ArrowStatic(d){this.type="ArrowStatic";this.pos=d.pos.copy();this.dims=d.dims.copy();this.handle=d.handle;this.pts=this.getPts();this.drawCanvas=defaultTo(c,d.drawCanvas);this.label=d.label?d.label:!1;d.angle?this.angle=d.angle:d.UV&&(this.angle=UVToAngle(d.UV));this.setTextOffset();this.fill=d.fill.copy();this.textCol=defaultTo(Col(255,255,255),d.textCol);this.stroke=defaultTo(d.stroke,Col(0,0,0));this.init()}
_.extend(ArrowStatic.prototype,objectFuncs,toInherit.ArrowFuncs,{init:function(){this.updateListenerName=unique(this.type+defaultTo("",this.handle),curLevel.updateListeners);this.label?addListener(curLevel,"update",this.updateListenerName,this.runLabel,this):addListener(curLevel,"update",this.updateListenerName,this.runNoLabel,this);this.setupStd()},runLabel:function(){this.drawCanvas.save();this.drawCanvas.translate(this.pos.x,this.pos.y);this.drawCanvas.rotate(this.angle);draw.fillPtsStroke(this.pts,
this.fill,this.stroke,this.drawCanvas);this.drawCanvas.translate(this.textOffset.dx,this.textOffset.dy);this.drawCanvas.rotate(-this.angle);draw.text(this.label,P(0,0),"13pt calibri",this.textCol,"center",0,this.drawCanvas);this.drawCanvas.restore()},runNoLabel:function(){this.drawCanvas.save();this.drawCanvas.translate(this.pos.x,this.pos.y);this.drawCanvas.rotate(this.angle);draw.fillPtsStroke(this.pts,this.fill,this.stroke,this.drawCanvas);this.drawCanvas.restore()},setTextOffset:function(){this.textOffset=
V(7+5*Math.sin(Math.abs(-this.angle)),5*Math.cos(this.angle))},getDims:function(){return this.dims},move:function(d){this.pos.movePt(d);return this},scale:function(d){this.dims.multVec(d);this.pts=this.getPts();return this},size:function(d){this.dims=d.copy();this.pts=this.getPts();return this},rotate:function(d){this.angle+=d;this.setTextOffset();return this},getAngle:function(){return this.angle},setFill:function(d){this.fill=d.copy()},setStroke:function(d){this.stroke=d.copy()},remove:function(){removeListener(curLevel,
"update",this.updateListenerName);this.removeCleanUp()}});function Cell(d){this.type="Cell";this.handle=d.handle;var f=d.pos;this.nodeMass=d.nodeMass||700;var e=d.rad;this.drawCanvas=d.drawCanvas||window.c;var h=f.copy().movePt(V(e,e)),k=Math.max(3,d.numCorners)||8;this.membraneColor=d.col;this.sideLenMin=15;this.energyTransferMax=0.5;this.guideNodes=this.makeGuideNodes(f,e,k,this.nodeMass);f=this.makeOuterWallPts(this.guideNodes,10);e=this.makeInnerWallPts(this.guideNodes,10);this.outerWall=walls.addWall({pts:f,handle:"cell"+this.handle.toCapitalCamelCase()+
"Outer",handler:"staticAdiabatic",show:!1,record:!1,col:Col(255,255,255)});this.innerWall=walls.addWall({pts:e,handle:"cell"+this.handle.toCapitalCamelCase()+"Inner",handler:"staticAdiabatic",show:!1,record:!0,col:Col(255,255,255)});this.innerWall.hitThreshold=-10;this.outerWall.hitThreshold=-10;this.parentWallMemberTag=d.parentWallHandle;this.cellMemberTag=this.innerWall.handle;f=d.innerChanceTransport||{};e=d.outerChanceTransport||{};this.fillInUnspecdSpcs(f);this.fillInUnspecdSpcs(e);this.assignWallHandlers(this.guideNodes,
this.innerWall,this.outerWall,this.parentWallMemberTag,this.cellMemberTag,this.energyTransferMax,f,e,10);this.wallUpdateListenerName=this.addWallUpdateListener(this.guideNodes,this.innerWall,this.outerWall,this.handle,10,this.sideLenMin,d.boundingCorner,d.boundingVector,this.wallColor);this.drawListenerName=this.addDrawListener(this.guideNodes,this.innerWall,this.outerWall,this.membraneColor,this.drawCanvas);this.dotId=timeline.takeNumber();this.addDots(h,this.innerWall,d.dots||{},d.temp,this.dotId,
this.cellMemberTag);this.energyBank=this.energyToTransfer=0;this.energyBankMax=20;this.calcHeatTransferListenerName="calcHeatTrans"+this.handle;this.setupCalcHeatTransfer(this.calcHeatTransferListenerName,this.innerWall,walls[d.parentWallHandle]);window.dotMigrator.migrateDots(window.dotManager.get({tag:this.parentWallMemberTag}),[this.parentWallMemberTag],[this.outerWall.handle]);this.setupStd()}
_.extend(Cell.prototype,objectFuncs,{makeGuideNodes:function(d,f,e,h){center=d.copy().movePt(V(f,f));d=[];for(var k=0,l=Math.PI*(e-2)/e,m=2*Math.PI/e,n=0;n<e;n++){var p=P(center.x+f*Math.cos(k),center.y+f*Math.sin(k));d.push(new Cell.GuideNode(p,h,l));k+=m}for(n=0;n<d.length;n++)d[n].prev=0==n?d[d.length-1]:d[n-1],d[n].next=n==d.length-1?d[0]:d[n+1];return d},fillInUnspecdSpcs:function(d){for(var f=0;f<LevelData.spcDefs.length;f++){var e=LevelData.spcDefs[f].spcName;void 0===d[e]&&(d[e]=0)}},makeOuterWallPts:function(d,
f){for(var e=[],h=0,k=d[0];h<d.length;){k.prev.outerWallIdx=h;var l=k.next.pos.VTo(k.pos).perp("ccw"),m=k.pos.VTo(k.prev.pos).perp("ccw"),l=k.pos.copy().movePt(l.add(m).UV().mult(f/2));e.push(l);h++;k=k.prev}return e},makeInnerWallPts:function(d,f){for(var e=[],h=0,k=d[0];h<d.length;){k.innerWallIdx=h;var l=k.prev.pos.VTo(k.pos).perp("ccw"),m=k.pos.VTo(k.next.pos).perp("ccw"),l=k.pos.copy().movePt(l.add(m).UV().mult(f/2));e.push(l);h++;k=k.next}return e},assignWallHandlers:function(d,f,e,h,k,l,m,
n,p){for(var q=0;q<d.length;q++)this.assignWallHandler(f,d[q].innerWallIdx,e,d[q].outerWallIdx,d[q],d[q].next,k,h,-1,l,m,p),this.assignWallHandler(e,d[q].outerWallIdx,f,d[q].innerWallIdx,d[q].next,d[q],h,k,1,l,n,p)},assignWallHandler:function(d,f,e,h,k,l,m,n,p,q,r,t){walls.setSubWallHandler(d.handle,f,{func:function(d,f,v,z,y,A){if(d.tag==m)if(Math.random()<r[d.spcName])this.transferDot(d,n,A,t);else{f=z.dx*(l.pos.x-k.pos.x)+z.dy*(l.pos.y-k.pos.y);var B=z.dx*(d.x-k.pos.x)+z.dy*(d.y-k.pos.y),C=-z.dx*
(d.x-l.pos.x)-z.dy*(d.y-l.pos.y);v=new Point(k.pos.x+0.5*z.dx*f,k.pos.y+0.5*z.dy*f);var B=B/f,H=C/f;vecNodeAPerp=A.copy().mult(k.v.dotProd(A));vecNodeBPerp=A.copy().mult(l.v.dotProd(A));k.v.dx-=vecNodeAPerp.dx;k.v.dy-=vecNodeAPerp.dy;l.v.dx-=vecNodeBPerp.dx;l.v.dy-=vecNodeBPerp.dy;var C=vecNodeAPerp.dx*A.dx+vecNodeAPerp.dy*A.dy,w=vecNodeBPerp.dx*A.dx+vecNodeBPerp.dy*A.dy,B=y+(1-B)*C+(1-H)*w;y=-0.5*(C+w);C+=y;w=k.m*v.distSqrTo(k.pos)+l.m*v.distSqrTo(l.pos);z=z.dx*(d.x-v.x)+z.dy*(d.y-v.y);v=-2*B/(1/
d.m+1/(k.m+l.m)+z*z/w);d.v.dx-=A.dx*v/d.m;d.v.dy-=A.dy*v/d.m;z=0.5*(C/(0.5*f)-z*v/w)*f;vWallTrans_F=y-v/(k.m+l.m);f=-(vWallTrans_F-z);z=-(vWallTrans_F+z);k.v.dx+=A.dx*f;k.v.dy+=A.dy*f;l.v.dx+=A.dx*z;l.v.dy+=A.dy*z;d.x+=A.dx;d.y+=A.dy;A=p*this.energyToTransfer;0<A?(A=Math.min(A,Math.min(this.energyBank,q)),d.addEnergy(A),this.energyBank-=A,this.energyToTransfer-=A*p):(A=Math.min(this.energyBank-A,Math.min(this.energyBankMax-this.energyBank,Math.min(q,Math.max(0,(d.temp()-10)*d.cv)))),d.addEnergy(-A),
this.energyBank+=A)}else d.tag==n&&(A=e.handlers[h],A.func.apply(A.obj,[d,e,h,e.wallUVs[h],-d.v.dotProd(e.wallPerpUVs[h]),e.wallPerpUVs[h]]))},obj:this})},transferDot:function(d,f,e,h){h=2*d.r+h;d.x-=h*e.dx;d.y-=h*e.dy;dotManager.changeDotWall(d,f)},addWallUpdateListener:function(d,f,e,h,k,l,m,n){var p=m.x,q=m.x+n.dx,r=m.y,t=m.y+n.dy;addListener(curLevel,"wallMove","moveCell"+this.handle.toCapitalCamelCase(),function(){for(var h=0;h<d.length;h++){d[h].pos.x+=d[h].v.dx;d[h].pos.y+=d[h].v.dy;d[h].v.dx*=
0.995;d[h].v.dy*=0.995;if(e[d[h].prev.outerWallIdx].x<p){d[h].pos.x+=2;d[h].v.dx=Math.abs(d[h].v.dx);for(var m=0;m<d.length;m++)d[m].v.dx+=0.5}else if(e[d[h].prev.outerWallIdx].x>q){d[h].pos.x-=2;d[h].v.dx=-Math.abs(d[h].v.dx);for(m=0;m<d.length;m++)d[m].v.dx-=0.5}if(e[d[h].prev.outerWallIdx].y<r){d[h].pos.y+=2;d[h].v.dy=Math.abs(d[h].v.dy);for(m=0;m<d.length;m++)d[m].v.dy+=0.5}else if(e[d[h].prev.outerWallIdx].y>t){d[h].pos.y-=2;d[h].v.dy=-Math.abs(d[h].v.dy);for(m=0;m<d.length;m++)d[m].v.dy-=0.5}}for(h=
0;h<d.length;h++){var m=d[h],n=m.prev.pos.UVTo(m.pos).perp("cw"),z=m.next.pos.UVTo(m.pos).perp("ccw"),n=n.add(z).UV();this.addAngleForce(m,m.prev,m.next,new Vector(-n.dx,-n.dy));this.addExpansionForce(m,m.next,l);e[m.outerWallIdx+1].x=m.pos.x+n.dx*k/2;e[m.outerWallIdx+1].y=m.pos.y+n.dy*k/2;f[m.innerWallIdx].x=m.pos.x-n.dx*k/2;f[m.innerWallIdx].y=m.pos.y-n.dy*k/2}e[0].x=e[e.length-1].x;e[0].y=e[e.length-1].y;f[f.length-1].x=f[0].x;f[f.length-1].y=f[0].y;window.walls.setupWall(walls.indexOf(f));window.walls.setupWall(walls.indexOf(e))},
this)},addAngleForce:function(d,f,e,h){f=this.angleBetweenPts(d.pos,f.pos,e.pos,h);d.v.dx-=3*h.dx*(f-d.nativeAngle);d.v.dy-=3*h.dy*(f-d.nativeAngle)},addExpansionForce:function(d,f,e){var h=d.pos.VTo(f.pos);h.magSqr()<e*e&&(e=h.UV(),f.v.dx+=0.2*e.dx,f.v.dy+=0.2*e.dy,d.v.dx-=0.2*e.dx,d.v.dy-=0.2*e.dy)},angleBetweenPts:function(d,f,e,h){h=Math.atan2(h.dy,h.dx);f=d.VTo(f);d=d.VTo(e);e=Math.atan2(f.dy,f.dx);d=Math.atan2(d.dy,d.dx);return this.distBetweenAngles(e,h)+this.distBetweenAngles(h,d)},distBetweenAngles:function(d,
f){0>d&&(d+=2*Math.PI);0>f&&(f+=2*Math.PI);var e=Math.max(d,f)-Math.min(d,f);return e>Math.PI?2*Math.PI-e:e},addDrawListener:function(d,f,e,h,k){addListener(curLevel,"update","drawCell"+this.handle,function(){for(var l=0;l<d.length;l++){var m=d[l];window.draw.fillPts([f[m.innerWallIdx],f[m.next.innerWallIdx],e[m.outerWallIdx],e[m.prev.outerWallIdx]],h,k)}},this)},setupCalcHeatTransfer:function(d,f,e){var h=f.getDataSrc("temp"),k=e.getDataSrc("temp");addListener(curLevel,"update",d,function(){var d=
f.Cp(),m=e.Cp();this.energyToTransfer=((d*h[h.length-1]+m*k[k.length-1])/(d+m)-k[k.length-1])*m},this)},addDots:function(d,f,e,h,k,l){for(var m in e){var n=window.spcs[m];n||console.log("Bad species name sent to cell: "+m);for(var p=e[m],q=Math.floor(e[m]/(2*(f.length-1))),r=0;r<f.length-1;r++){var t=f[r],u=f[r+1],x=d.VTo(t.avg(u)).UV();this.populateRightTriangle(d,t,t.avg(u),q,n,h,x,l,k,m);this.populateRightTriangle(d,u,t.avg(u),q,n,h,x,l,k,m);p-=2*q}this.populateRightTriangle(d,t,t.avg(u),p,n,h,
x,l,k,m)}},populateRightTriangle:function(d,f,e,h,k,l,m,n,p,q){k=m.copy().perp("cw");0>e.VTo(f).dotProd(k)&&(k=m.copy().perp("ccw"));var r=[];f=e.distTo(f);e=d.distTo(e);for(var t=0;t<h;t++){var u=Math.sqrt(Math.random())*e,x=Math.random()*f*u/e,v=d.x+m.dx*u+k.dx*x,u=d.y+m.dy*u+k.dy*x,x=V(Math.random()-0.5,Math.random()-0.5).UV();r.push(new Dot(v,u,x,q,n,p,n));r[r.length-1].setTemp(l)}window.dotManager.add(r)},remove:function(){}});
Cell.GuideNode=function(d,f,e){this.pos=d;this.prev=this.next=void 0;this.v=V(0,0);this.m=f;this.outerWallIdx=this.innerWallIdx=void 0;this.nativeAngle=e};Cell.GuideNode.prototype={};function CheckMark(d,f,e,h,k){var l=P(d.x,d.y+0.6*f.dy),m=P(d.x+0.4*f.dx,d.y+f.dy),n=P(d.x+f.dx,d.y);d=P(d.x+0.35*f.dx,d.y+0.75*f.dy);this.pts=[l,m,n,d];this.col=e;this.stroke=h;this.drawCanvas=k}CheckMark.prototype={draw:function(){draw.fillPtsStroke(this.pts,this.col,this.stroke,this.drawCanvas)},setCanvas:function(d){this.drawCanvas=d}};function Clamps(d){this.type="Clamps";this.handle=d.handle;this.draw=defaultTo(!1,d.draw);this.releaseWith=defaultTo("button",d.releaseWith);this.currentClamper=void 0;this.clamps=d.clamps;this.wall=walls[d.wallInfo];this.buttonId="clampRelease"+this.wall.handle;this.wallHandler=this.wall.parent.getSubWallHandler(this.wall.handle,0);this.init()}
_.extend(Clamps.prototype,objectFuncs,{init:function(){this.setupStd();this.wall.moveStop();this.assembleClamps();"button"==this.releaseWith?this.makeReleaseButton():this.setupClampClicking();this.draw&&this.drawClamps();this.freezeWall()},assembleClamps:function(){for(var d=0;d<this.clamps.length;d++){var f=this.clamps[d];f.vol&&(f.y=this.wall.volToY(f.vol),delete f.vol);f.clamping=!1}this.sortClamps();this.addInitClamp()},sortClamps:function(){for(var d=0;d<this.clamps.length;d++){for(var f=!1,
e=0;e<this.clamps.length-1;e++)this.clamps[e].y>this.clamps[e+1].y&&(this.clamps.switchElements(e,e+1),f=!0);if(!f)break}},addInitClamp:function(){for(var d=this.wall[0].y,f=0;f<this.clamps.length;f++)if(this.clamps[f].y>d){this.clamps.splice(f,0,{y:d,clamping:!0});this.currentClamper=this.clamps[f];break}},makeReleaseButton:function(){var d=this;addButton(this.buttonId,"Release");$("#"+this.buttonId).click(function(){d.release()})},removeReleaseButton:function(){removeButton(this.buttonId)},release:function(){var d=
void 0,f=void 0;this.currentClamper.clamping=!1;var e=this.clamps.indexOf(this.currentClamper),h=this.clamps[e+1],e=this.clamps[e-1];h&&(d=h.y);e&&(f=e.y);var k=this;this.wall.releaseWithBounds(f,d,this.wallHandler,function(d){k.activateClamp(d)})},activateClamp:function(d){var f=this.clamps.indexOf(this.currentClamper);this.currentClamper.clamping=!1;this.currentClamper=d<this.currentClamper.y?this.clamps[f-1]:this.clamps[f+1];this.currentClamper.clamping=!0;this.freezeWall()},freezeWall:function(){walls.setSubWallHandler(this.wall.handle,
0,"staticAdiabatic")},remove:function(){this.wall.removed||(this.wall.moveInit(),this.wall.parent.setSubWallHandler(walls.indexOf(this.wall),0,this.wallHandler));"button"==this.releaseWith&&this.removeReleaseButton()}});function CompArrow(d){this.type="CompArrow";var f=defaultTo(0,d.wallInfo),e=defaultTo(1.5,d.speed),h=defaultTo("adiabatic",d.compMode),k=defaultTo(!0,d.stops),l=defaultTo({y:{min:30,max:350}},d.bounds);this.wall=walls[f];var m={};m.outer=Col(44,118,172);m.onClick=Col(44,118,172);m.inner=curLevel.bgCol.copy();var n=V(25,15);d="volDragger"+defaultTo("",d.handle);var p=c,q=canvas,r={};k&&(this.stops=new Stops({stopPt:{height:l.y.max},wallInfo:f}));var t=this.wall;r.onDown=function(){};r.onMove=function(){t.changeSetPt(this.pos.y,
h,e)};r.onUp=function(){};this.dragArrowFunc=this.makeDragArrowFunc(this.wall,0,m,n,d,p,q,r,l);this.dragArrow=this.dragArrowFunc();this.setupStd();return this}
_.extend(CompArrow.prototype,objectFuncs,{remove:function(){this.dragArrow.remove();this.stop&&this.stops.remove()},makeDragArrowFunc:function(d,f,e,h,k,l,m,n,p){return function(){var q=d[1].copy();return(new DragArrow(q,f,e,h,k,l,m,n,p)).show()}},enable:function(){this.dragArrow.setPos(this.wall[1].copy());this.dragArrow.show();this.enabled=!0},disable:function(){this.dragArrow.hide();this.enabled=!1}});function DragArrow(d,f,e,h,k,l,m,n,p){this.type="DragArrow";this.pos=d;this.rotation=f;this.posInit=this.pos.copy();this.cols=e;this.dims=h;this.name=k;this.listeners=n;this.drawCanvas=l;this.canvasElement=m;this.bounds=p;this.bounds.x?(this.bounds.x.max||(this.bounds.x.max=m.width-h.dx),this.bounds.x.min||(this.bounds.x.min=0)):this.bounds.x={min:0,max:m.width-h.dx};this.bounds.y?(this.bounds.y.max||(this.bounds.y.max=m.height-h.dy),this.bounds.y.min||(this.bounds.y.min=0)):this.bounds.y={min:0,
max:m.height-h.dy};this.pts={};this.pts.outer=[];this.pts.inner=[];d=this.dims.dx;f=this.dims.dy;this.pts.outer.push(P(0,0));this.pts.outer.push(P(0.9*d,-f/2));this.pts.outer.push(P(d,0));this.pts.outer.push(P(0.9*d,f/2));this.pts.outer.push(P(0,0));this.makeDrawFunc();this.clickListeners=this.makeListenerFuncs();return this}
DragArrow.prototype={makeDrawFunc:function(){this.dirUV=V(Math.cos(this.rotation+Math.PI/2),Math.sin(this.rotation+Math.PI/2));this.draw=function(){};var d=this;this.draw=extend(this.draw,function(){d.drawCanvas.save();d.drawCanvas.translate(d.pos.x,d.pos.y);d.drawCanvas.rotate(d.rotation)});this.draw=this.cols.stroke?extend(this.draw,function(){draw.fillPtsStroke(d.pts.outer,d.cols.outer,d.cols.stroke,d.drawCanvas)}):extend(this.draw,function(){draw.fillPts(d.pts.outer,d.cols.outer,d.drawCanvas)});
if(this.cols.inner||this.cols.onClick){for(var f=0;f<this.pts.outer.length;f++){var e=this.pts.outer[f].copy().movePt({dx:-this.dims.dx/2}).scale(P(0,0),0.6).movePt({dx:this.dims.dx/2});this.pts.inner.push(e)}this.cols.curInner=this.cols.inner?this.cols.inner:this.cols.outer;this.draw=extend(this.draw,function(){draw.fillPts(d.pts.inner,d.cols.curInner,d.drawCanvas)})}this.draw=extend(this.draw,function(){d.drawCanvas.restore()})},makeListenerFuncs:function(){var d=this.listeners,f=this;f.amSelected=
new Boolean;if(d.onDown||d.onMove||d.onUp){var e=function(){};f.cols.onClick&&(e=extend(e,function(){f.cols.curInner=f.cols.onClick}));var e=extend(e,function(){d.onDown.apply(f)}),h=this.makeMoveListenerFunc(f),e=extend(e,h);d.onUp&&(h=this.makeUpListenerFunc(f),e=extend(e,h));return function(){f.amSelected=f.checkSelected();f.amSelected&&(f.posInit=f.pos.copy(),f.mouseInit=mouseOffset(f.canvasElement),e())}}},makeMoveListenerFunc:function(d){var f=d.listeners,e=function(){var e=mouseOffset(d.canvasElement),
f=V(e.x-d.mouseInit.x,e.y-d.mouseInit.y).dotProd(d.dirUV),e=d.posInit.x+f*Math.cos(d.rotation+Math.PI/2),f=d.posInit.y+f*Math.sin(d.rotation+Math.PI/2);d.pos.x=Math.max(d.bounds.x.min,Math.min(e,d.bounds.x.max));d.pos.y=Math.max(d.bounds.y.min,Math.min(f,d.bounds.y.max))};f.onMove&&(e=extend(e,function(){f.onMove.apply(d)}));var h=function(){addListener(curLevel,"mouseup","dragArrow"+d.name+"RemoveMove",function(){removeListener(curLevel,"mousemove","dragArrow"+d.name);removeListener(curLevel,"mouseup",
"dragArrow"+d.name+"RemoveMove")},"")};return function(){addListener(curLevel,"mousemove","dragArrow"+d.name,e,"");h()}},makeUpListenerFunc:function(d){var f=function(){addListener(curLevel,"mouseup","mouseup"+d.name,function(){d.listeners.onUp.apply(d)},"");addListener(curLevel,"mouseup","mouseup"+d.name+"remove",function(){removeListener(curLevel,"mouseup","mouseup"+d.name);removeListener(curLevel,"mouseup","mouseup"+d.name+"remove")},"")};if(d.cols.onClick)var e=function(){},e=d.cols.inner?extend(e,
function(){d.cols.curInner=d.cols.inner}):extend(e,function(){d.cols.curInner=d.cols.outer}),f=extend(f,function(){addListener(curLevel,"mouseup","revertCols"+d.name,function(){e();removeListener(curLevel,"mouseup","revertCols"+d.name)},"")});return f},setPos:function(d){"number"==typeof d.x&&(this.pos.x=d.x);"number"==typeof d.y&&(this.pos.y=d.y)},show:function(){addListener(curLevel,"mousedown","dragArrow"+this.name,this.clickListeners,"");addListener(curLevel,"update","drawDragArrow"+this.name,
this.draw,"");return this},hide:function(){removeListener(curLevel,"mousedown","dragArrow"+this.name);removeListener(curLevel,"update","drawDragArrow"+this.name);return this},reset:function(){this.pos=this.posInit.copy();removeListener(curLevel,"update","moveWall");return this},remove:function(){removeListener(curLevel,"mousedown","dragArrow"+this.name);removeListener(curLevel,"update","drawDragArrow"+this.name)},checkSelected:function(){var d=mouseOffset(this.canvasElement).rotate(this.pos,-this.rotation),
f=this.pos.copy().movePt({dy:-this.dims.dy/2});return ptInRect(f,this.dims,d)}};function DragWeights(d){this.type="DragWeights";this.handle=d.handle;this.tempWeightDefs=d.weightDefs;this.wallInfo=defaultTo(0,d.wallInfo);this.wall=walls[this.wallInfo];this.zeroY=defaultTo(this.wall[2].y,d.min);this.pistonPt=defaultTo(this.wall[0],d.pistonPt);this.pistonOffset=defaultTo(void 0,d.pistonOffset);this.wallHandler=defaultTo("cPAdiabaticDamped",d.compMode);this.binY=defaultTo(myCanvas.height-15,d.binY);this.blockCol=defaultTo(Col(224,165,75),d.blockCol);this.binCol=defaultTo(Col(150,
150,150),d.binCol);void 0!==d.pInit?this.massInit=this.pressureToMass(d.pInit):this.massInit=this.pressureToMass(1);this.binHeight=defaultTo(45,d.binHeight);this.weightDimRatio=defaultTo(0.5,d.weightDimRatio);this.moveSpeed=defaultTo(20,d.moveSpeed);this.weightScalar=defaultTo(70,d.weightScalar);this.displayText=defaultTo(!0,d.displayText);this.binSlant=1.3;this.storeBinWidth=110;this.storeBinSpacing=60;this.pistonBinWidth=150;this.pistonBinSpacing=15;this.blockSpacing=2;this.mass=this.massInit;this.massChunkName=
"dragWeights";this.weightsOnPiston=[];this.font="12pt Calibri";this.fontCol=Col(255,255,255);this.binThickness=5;this.trackingPts=[];this.wall.setMass(this.massChunkName,this.massInit);this.wall.recordPExt();this.wall.recordWork();this.wall.recordMass();this.setupStd();return this.init()}
_.extend(DragWeights.prototype,objectFuncs,compressorFuncs,{init:function(){this.weightGroups=this.makeWeights(this.tempWeightDefs);this.bins={};this.bins.store=this.makeStoreBins();this.bins.piston=this.makePistonBins();this.savedWallHandler=this.wall.handlers[0];walls.setSubWallHandler(this.wallInfo,0,this.wallHandler);this.displayText||(this.draw=this.drawNoText);addListener(curLevel,"update","drawDragWeights"+this.wallInfo,this.draw,this);this.enable();this.wall.moveInit();this.dropAllIntoBins("instant");
delete this.tempWeightDefs;return this},remove:function(){this.wall.moveStop();this.trackingPts.map(function(d){d.trackStop()});this.trackingPts.splice(0,this.trackingPts.length);walls.setSubWallHandler(walls.indexOf(this.wall),0,this.savedWallHandler);removeListener(curLevel,"update","drawDragWeights"+this.wallInfo);removeListener(curLevel,"mousedown","weights"+this.wallInfo)},getWeightDims:function(d){for(var f={},e=this.storeBinWidth-this.blockSpacing,h=0,k=0,l=0;l<d.length;l++){var m=d[l],n=Math.sqrt(m.mass*
this.weightScalar/this.weightDimRatio);Math.max(n,h)>h&&(k=m.mass,h=n);f[m.name]=V(n,n*this.weightDimRatio)}return h>e?(this.weightScalar=0.99*e*e*this.weightDimRatio/k,this.getWeightDims(d)):f},nameWeights:function(d){for(var f=0;f<d.length;f++)d[f].name="grp"+f},assignMasses:function(d){for(var f=0;f<d.length;f++)weightDef=d[f],weightDef.mass=this.pressureToMass(weightDef.pressure)},makeWeights:function(d){this.nameWeights(d);var f={};this.assignMasses(d);for(var e=this.getWeightDims(d),h=0,k=0;k<
d.length;k++){var l=d[k],m={};m.name=l.name;m.dims=e[m.name];m.pressure=l.pressure;m.mass=l.mass;m.weights=[];for(var n=0;n<l.count;n++){var p={};p.pos=P(300,500);p.name=l.name;p.status="";p.id=h;m.weights.push(p);h++}f[m.name]=m}return f},makeStoreBins:function(){var d=(this.wall[0].x+this.wall[1].x)/2,f={},e=this.getNumGroups(),d=d-this.storeBinWidth*(e-1)/2-this.storeBinSpacing*(e-1)/2,h;for(h in this.weightGroups)f[h]=this.makeStoreBin(d,this.weightGroups[h]),d+=this.storeBinWidth+this.storeBinSpacing;
return f},makeStoreBin:function(d,f){var e={};e.pts=this.getBinPts(P(d,this.binY),this.binSlant,V(this.storeBinWidth,this.binHeight),this.binThickness);e.x=d-this.storeBinWidth/2;e.y=this.binY;e.slots=this.getBinSlots(P(e.x,e.y),f);e.visible=!0;return e},makePistonBins:function(){var d=(this.wall[0].x+this.wall[1].x)/2,f={},e=this.getNumGroups(),d=d-this.pistonBinWidth*(e-1)/2-this.pistonBinSpacing*(e-1)/2,h;for(h in this.weightGroups)f[h]=this.makePistonBin(d,this.weightGroups[h]),d+=this.pistonBinWidth+
this.pistonBinSpacing;return f},makePistonBin:function(d,f){var e={};if(this.pistonOffset){var h=this.pistonOffset.dx;e.pos=P(d-this.pistonBinWidth/2,0).movePt({dx:h}).track({pt:this.pistonPt,noTrack:"x",offset:{dy:this.pistonOffset.dy}})}else e.pos=P(d-this.pistonBinWidth/2,0).track({pt:this.pistonPt,noTrack:"x"});this.trackingPts.push(e.pos);e.slots=this.getPistonBinSlots(e.pos,f);e.visible=!1;return e},getBinSlots:function(d,f){var e=f.weights.length,h=f.dims,k=Math.floor(this.storeBinWidth/(h.dx+
this.blockSpacing));d.x+=(this.storeBinWidth-k*(h.dx+this.blockSpacing))/2;for(var e=Math.ceil(e/k),l=[],m=d.y-this.blockSpacing-h.dy,n=0;n<e;n++){for(var p=[],q=d.x+this.blockSpacing,r=0;r<k;r++){var t=P(q,m),u=new Boolean,u=!1;p.push(this.newSlot(u,t,f.name,"store",n,r));q+=h.dx+this.blockSpacing}l.push(p);m-=h.dy+this.blockSpacing}return l},getPistonBinSlots:function(d,f){var e=f.weights.length,h=f.dims,k=Math.floor(this.pistonBinWidth/(h.dx+this.blockSpacing));startX=d.x+(this.pistonBinWidth-
k*(h.dx+this.blockSpacing))/2;for(var e=Math.ceil(e/k),l=[],m=this.blockSpacing,n=0;n<e;n++){for(var p=[],q=startX+this.blockSpacing,r=0;r<k;r++){var t=P(q,0).track({pt:d,offset:{dy:-(m+h.dy)},noTrack:"x"});this.trackingPts.push(t);var u=new Boolean,u=!1;p.push(this.newSlot(u,t,f.name,"piston",n,r));q+=h.dx+this.blockSpacing}l.push(p);m+=h.dy+this.blockSpacing}return l},newSlot:function(d,f,e,h,k,l){return{isFull:d,pos:f,name:e,type:h,row:k,col:l}},binIsFull:function(d,f){var e=this.bins[d][f].slots;
for(rowIdx=0;rowIdx<e.length;rowIdx++)for(var h=e[rowIdx],k=0;k<h.length;k++)if(!h[k].isFull)return!1;return!0},binIsEmpty:function(d,f){var e=this.bins[d][f].slots;for(rowIdx=0;rowIdx<e.length;rowIdx++)for(var h=e[rowIdx],k=0;k<h.length;k++)if(h[k].isFull)return!1;return!0},allEmpty:function(d){var f=new Boolean,f=!0,e;for(e in this.bins[d])f=Math.min(f,this.binIsEmpty(d,e));return f},weightCount:function(d,f){var e=this.bins[d][f].slots,h=0;for(rowIdx=0;rowIdx<e.length;rowIdx++)for(var k=e[rowIdx],
l=0;l<k.length;l++)h+=k[l].isFull;return h},getPistonMass:function(){var d=0,f;for(f in this.weightGroups)for(var e=this.weightGroups[f],h=e.weights,e=e.mass,k=0;k<h.length;k++)"piston"==h[k].status&&(d+=e);return d+this.massInit},dropAllIntoBins:function(d){for(var f in this.weightGroups)for(var e=this.weightGroups[f],h=0;h<e.weights.length;h++){var k=e.weights[h];"piston"==k.status?(k.status="inTransit",k.slot.isFull=!1,this.takeOffPiston(k),this.dropIntoBin(k,"store",d)):"store"!=k.status&&(k.status=
"inTransit",this.dropIntoBin(k,"store",d))}return this},dropAllOntoPiston:function(d){for(var f in this.weightGroups)for(var e=this.weightGroups[f],h=0;h<e.weights.length;h++){var k=e.weights[h];"store"==k.status?(k.status="inTransit",k.slot.isFull=!1,this.takeOffPiston(k),this.dropIntoBin(k,"piston",d)):"piston"!=k.status&&(k.status="inTransit",this.dropIntoBin(k,"piston",d))}return this},dropIntoBin:function(d,f,e){var h=this;d.status="inTransit";var k=this.getDropSlot(d.name,f),l=k.slot;l.isFull=
!0;d.slot=l;k=k.id;if("instant"==e)this.dropInstant(d,l);else{e=d.name+d.id+"endId"+this.wallInfo;var m="moveWeight"+e+f+k;removeListenerByName(curLevel,"update",e)&&(d.slot.isFull=!1,d.slot=void 0);addListener(curLevel,"update",m,function(){var e=l.pos,f=V(e.x-d.pos.x,e.y-d.pos.y).UV();!1!==validNumber(f.dx)&&!1!==validNumber(f.dy)&&(d.pos.x=stepTowards(d.pos.x,e.x,f.dx*this.moveSpeed),d.pos.y=stepTowards(d.pos.y,e.y,f.dy*this.moveSpeed));this.weightArrived(d,l)&&(removeListener(curLevel,"update",
m),h.placeWeight(d,l))},this)}},placeWeight:function(d,f){d.status=f.type;"piston"==d.status&&this.putOnPiston(d,f)},dropInstant:function(d,f){d.pos=f.pos.copy();this.placeWeight(d,f)},weightArrived:function(d,f){return d.pos.sameAs(f.pos)},getDropSlot:function(d,f){for(var e=this.bins[f][d],h=0;h<e.slots.length;h++)for(var k=e.slots[h],l=0;l<k.length;l++){var m=e.slots[h][l];if(!m.isFull)return{slot:m,id:String(h)+String(l)}}alert("BOX IS FULL!  WHY IS THIS HAPPENING?")},getNumGroups:function(){var d=
0;for(idx in this.weightGroups)d++;return d},draw:function(){this.drawWeights();this.drawBins();this.drawBinLabels()},drawNoText:function(){this.drawWeights();this.drawBins()},drawWeights:function(){var d=c,f;for(f in this.weightGroups)for(var e=this.weightGroups[f],h=e.weights,e=e.dims,k=0;k<h.length;k++)draw.fillRect(h[k].pos,e,this.blockCol,d)},drawBins:function(){var d=c,f;for(f in this.bins){var e=this.bins[f],h;for(h in e){var k=e[h];k.visible&&draw.fillPts(k.pts,this.binCol,d)}}},drawBinLabels:function(){for(var d in this.bins.store){var f=
this.bins.store[d];f.visible&&draw.text(this.weightGroups[d].pressure+" bar each",P(f.x+this.storeBinWidth/2,f.y-this.binHeight),this.font,this.fontCol,"center",0,c)}},putOnPiston:function(d,f){this.weightsOnPiston.push(d);d.pos.track({pt:f.pos,noTrack:"x"});this.trackingPts.push(d.pos);d.status="piston";this.mass=this.getPistonMass();this.wall.setMass(this.massChunkName,this.mass)},takeOffPiston:function(d){for(var f=0;f<this.weightsOnPiston.length;f++)d==this.weightsOnPiston[f]&&this.weightsOnPiston.splice([f],
1);d.pos.trackStop();this.trackingPts.splice(this.trackingPts.indexOf(d.pos),1);this.mass=this.getPistonMass();this.wall.setMass(this.massChunkName,this.mass)},mousedown:function(){var d=this.getClicked();d&&(this.pickup(d),"piston"==this.selected.cameFrom&&this.takeOffPiston(this.selected),addListener(curLevel,"mousemove","weights",this.mousemove,this),addListener(curLevel,"mouseup","weights",this.mouseup,this))},mousemove:function(){var d=mouseOffset(myCanvas),f=this.selected.origPos,e=f.weight,
f=f.mouse,h=e.y+(d.y-f.y);this.selected.pos.x=e.x+(d.x-f.x);this.selected.pos.y=h},mouseup:function(){removeListener(curLevel,"mousemove","weights");removeListener(curLevel,"mouseup","weights");var d=this.getDest();this.dropIntoBin(this.selected,d);delete this.origPos;this.selected=void 0},getDest:function(){var d=this.selected,f=this.weightGroups[d.name].dims.dy;return"piston"==d.cameFrom||d.pos.y+f>this.zeroY?"store":"piston"},pickup:function(d){d.cameFrom=d.status;d.status="holding";var f=mouseOffset(myCanvas);
void 0!==d.slot&&(d.slot.isFull=!1);"piston"==d.status&&this.takeOffPiston(d);delete d.slot;this.selected=d;this.selected.origPos={mouse:f.copy(),weight:d.pos.copy()}},getClicked:function(){for(var d in this.weightGroups){d=this.weightGroups[d];for(var f=0;f<d.weights.length;f++){var e=d.weights[f];if(inRect(e.pos,d.dims,myCanvas)&&("inTransit"==e.status||this.isOnTop(e)))return e}}return!1},mouseOnWeight:function(d,f){var e=mouseOffset(myCanvas);return e.x>=f.x&&e.x<=f.x+d.dx&&e.y<=f.y&&e.y>=f.y-
d.dy},isOnTop:function(d){var f=d.slot;d=this.bins[f.type][d.name];for(var e=f.col,f=f.row+1;f<d.slots.length;f++)if(!0==d.slots[f][e].isFull)return!1;return!0},mass:function(){return this.mass},disable:function(){removeListener(curLevel,"mousedown","weights"+this.wallInfo);this.enabled=!1},enable:function(){addListener(curLevel,"mousedown","weights"+this.wallInfo,this.mousedown,this);this.enabled=!0}});var flowFuncs={getPts:function(d,f,e,h,k){e=d.VTo(f).mag();var l=this.width/e;this.fracOffset=Math.max(Math.min(this.fracOffset,1-l/2),l/2);e=k+l;k=d.copy().fracMoveTo(f,k-l);d=d.copy().fracMoveTo(f,e);f=k.copy().movePt(h.copy().neg().mult(this.depth));h=d.copy().movePt(h.copy().neg().mult(this.depth));return[k,f,h,d]},addPts:function(){var d=Math.min(this.ptIdxs[0],this.ptIdxs[1]),f=Math.max(this.ptIdxs[0],this.ptIdxs[1]),e=this.wall.getPt(d).copy(),f=this.wall.getPt(f).copy();this.perp=this.wall.getPerpUV(d);
d=this.wall.getUV(d);this.pts=this.getPts(e,f,d,this.perp,this.fracOffset)},addArrows:function(d,f){var e=[],h=30<this.width?2:1,k=this.pts[1].copy();k.movePt(d.copy().neg().mult(this.arrowDims.dy/3));for(var l=this.pts[1].VTo(this.pts[2]),l=l.copy().UV().copy().mult(l.mag()/(h+1)),m=0;m<h;m++)k.movePt(l),e.push(new ArrowStatic({pos:k,dims:this.arrowDims,UV:d.copy(),fill:this.arrowFill,stroke:this.arrowStroke,cleanUpWith:this.cleanUpWith}));return e}};function Heater(d){this.type="Heater";this.dims=defaultTo(V(100,40),d.dims);this.sliderWrapper=d.sliderWrapper;this.sliderTitleWrapper=d.sliderTitleWrapper;this.wall=walls[d.wallInfo];this.pos=d.pos?d.pos:this.centerOnWall(d.wallInfo,this.dims);d.offset&&this.pos.movePt(d.offset);this.wall.recordQ();this.wall.hitThreshold=-30;this.makeSlider=defaultTo(!0,d.makeSlider);this.handle=d.handle;this.drawCanvas=defaultTo(c,d.drawCanvas);this.cornerRound=0.2;this.qRate=defaultTo(0,d.init);this.qRateMax=defaultTo(1,
d.max);this.qRateMin=-this.qRateMax;this.rot=defaultTo(0,d.rotation);this.tempMax=defaultTo(Number.MAX_VALUE,d.tempMax);this.tempMin=defaultTo(1,d.tempMin);this.center=this.pos.copy().movePt(this.dims.copy().mult(0.5));var f=defaultTo(Col(200,0,0),d.colMax),e=defaultTo(Col(0,0,200),d.colMin),h=defaultTo(Col(100,100,100),d.colDefault);this.draw=this.makeDrawFunc(e,h,f);this.wallPts=this.pos.roundedRect(this.dims,0.3,"ccw");this.addWallHump(this.wallPts);this.eAdded=0;d.liquidHandle&&this.setupLiquidHeat(d.liquidHandle);
this.wallHandleHeater="heater"+this.handle.toCapitalCamelCase();this.hit=this.wrapHit(this.wall.getDataSrc("temp"));this.setupStd();this.makeSlider&&(this.slider=sliderManager.addSlider("Heater",this.handle+"Slider",{value:50},[{eventType:"slide",obj:this,func:this.parseSlider},{eventType:"slidestop",obj:this,func:function(d,e){$(this.slider.slider).slider("option",{value:50});e.value=50;this.parseSlider(d,e)}}],d.sliderIdx));this.init(this.wallHandleHeater,this.wall.handle)}
_.extend(Heater.prototype,objectFuncs,{parseSlider:function(d,f){this.setQRate(f.value)},setQRate:function(d){this.qRate=0.02*(d-50)*this.qRateMax;this.liquid&&(50!=d?addListener(curLevel,"update","heatLiquid"+this.handle,this.heatLiq,this):removeListener(curLevel,"update","heatLiquid"+this.handle))},heatLiq:function(){this.liquid.addQ(0.15*this.qRate*updateInterval)},addWallHump:function(d){for(var f=[],e=0;e<d.length-1;e++)d[e].y==d[e+1].y&&f.push(e);d[d.length-1].y==d[0].y&&f.push(d.length-1);
for(var h=f[0],e=0;e<f.length;e++)h=d[f[e]].y<d[h].y?f[e]:h;d.splice(h+1,0,P(h==d.length-1?(d[h].x+d[0].x)/2:(d[h].x+d[h+1].x)/2,d[h].y-5))},disable:function(){var d=$(this.sliderSelector);d.length&&$(d).slider("disable");this.enabled=!1},enable:function(){var d=$(this.sliderSelector);d.length&&$(d).slider("enable");this.enabled=!0},makeDrawFunc:function(d,f,e){this.pts=this.getPts(this.pos,this.dims);rotatePts(this.pts,this.center,this.rot);var h=this.getColorSteps(d,f,e),k=this,l=this.pts;return function(){var d=
getSign(k.qRate),e=h[String(d)],d=d*k.qRate/k.qRateMax,e=f.copy().adjust(e[0]*d,e[1]*d,e[2]*d);draw.path(l,e,k.drawCanvas)}},centerOnWall:function(d,f){var e=walls[d];return P((e[3].x+e[2].x)/2-f.dx/2,e[2].y-30-f.dy)},getPts:function(d,f,e){e=[];d=d.copy().movePt({dy:f.dy/2});var h=f.dy/2+2.5,k=f.dy/2-2.5,l=Math.floor((f.dx-2*h)/(2*(h-k)));e.push(d.copy().movePt({dy:200}));e.push(d.copy());e=e.concat(this.halfElipse(d,h,f.dy/2,0,5));d.movePt({dx:2*h});for(var m=0;m<l;m++)e=e.concat(this.halfElipse(d,
k,f.dy/2,Math.PI,5)),d.movePt({dx:-2*k}),e=e.concat(this.halfElipse(d,h,f.dy/2,0,5)),d.movePt({dx:2*h});e.push(d.copy());e.push(d.copy().movePt({dy:200}));this.endX=e[e.length-1].x;this.dims=V(this.endX-this.pos.x,f.dy);this.center=this.pos.copy().movePt(this.dims.copy().mult(0.5));return e},halfElipse:function(d,f,e,h,k){k=defaultTo(5,k);for(var l=Array(k),m=Math.PI/k,n=d.x+f,p=Math.PI,q=0;q<k;q++){var r=n+f*Math.cos(p),t=d.y+e*Math.sin(p);l[q]=P(r,t);p+=m}rotatePts(l,d,h);return l},getColorSteps:function(d,
f,e){var h={};e=[e.r-f.r,e.g-f.g,e.b-f.b];h["-1"]=[d.r-f.r,d.g-f.g,d.b-f.b];h["1"]=e;return h},init:function(d,f){addListener(curLevel,"update","drawHeater"+this.handle,this.draw,"");this.setupWalls(d);this.eAdded=0;dotMigrator.migrateDots(dotManager.get({tag:f}),[f],[d])},setupWalls:function(d){walls.addWall({pts:this.wallPts,handler:{func:this.hit,obj:this},handle:d,record:!1,show:!1});walls[d].createSingleValDataObj("vol",function(){return walls.wallVolume(d)})},wrapHit:function(d){return function(f,
e,h,k,l,m){walls.reflect(f,k,l);f.temp();if(0<this.qRate&&d[d.length-1]<this.tempMax||0>this.qRate&&d[d.length-1]>this.tempMin)f=0.001*f.addEnergy(this.qRate),this.eAdded+=f,this.wall.q+=f}},setupLiquidHeat:function(d){var f=this;timeline.curSection().addCmmdPoint("now","setup",function(){var e=curLevel.selectObj("Liquid",d);e||console.log("Bad liquid handle for heater "+this.handle+".  Handle "+handle);e.heater=f;e.getWallLiq().recordQ();f.liquid=e},!0,!0)},removeLiquid:function(){this.liquid=void 0},
remove:function(){this.slider.remove();removeListener(curLevel,"update","drawHeater"+this.handle);window.walls&&!walls.removed&&walls.removeWall(this.wallHandleHeater)}});function Inlet(d){this.arrowDims=V(15,20);this.arrowFill=Col(200,0,0);this.arrowStroke=Col(100,100,100);this.type="Inlet";this.handle=d.handle;this.width=defaultTo(30,d.width);this.depth=defaultTo(20,d.depth);this.fracOpen=defaultTo(1,d.fracOpen);this.makePts=this.depth;this.wallInfo=d.wallInfo;this.wall=walls[this.wallInfo];this.ptIdxs=d.ptIdxs;this.fracOffset=defaultTo(0.5,d.fracOffset);this.flows=this.processFlows(d.flows);if(this.makeSlider=d.makeSlider)this.slider=sliderManager.addSlider("Flow rate",
this.handle+"Slider",{value:100*this.fracOpen},[{eventType:"slide",obj:this,func:this.parseSlider}],d.sliderIdx);this.setupStd();this.arrows=[];this.init()}
_.extend(Inlet.prototype,flowFuncs,objectFuncs,{init:function(){this.addPts();this.makePts&&this.wall.addPts(this.ptIdxs[1],this.pts);var d={pos:this.pts[1].copy(),vec:this.pts[1].VTo(this.pts[2]),dir:this.perp.copy()};this.arrows=this.addArrows(this.pts[1].VTo(this.pts[2]).UV().perp("ccw"));this.makeInlet(d,this.flows)},processFlows:function(d){for(var f=[],e=0;e<d.length;e++){var h=d[e];f.push({spc:spcs[h.spcName],temp:h.temp,nDotMax:h.nDotMax,returnTo:this.wallInfo,tag:h.tag});f[f.length-1].nDotMax*=
1E3/updateInterval}return f},parseSlider:function(d,f){this.fracOpen=f.value/100},makeInlet:function(d,f){for(var e=d.pos,h=d.vec,k=d.dir,l=Array(f.length),m=f.length,n=0;n<l.length;n++)l[n]=0;addListener(curLevel,"update",this.type+this.handle,function(){for(var d=0;d<m;d++){var n=f[d];l[d]+=this.fracOpen*n.nDotMax;var r=Math.floor(l[d]);if(r){for(var t=[],u=0;u<r;u++){var x=Math.random(),x=P(e.x+h.dx*x,e.y+h.dy*x);t.push({pos:x,dir:k,temp:n.temp,returnTo:n.returnTo,tag:n.tag})}n.spc.place(t);l[d]-=
r}}},this)},remove:function(){this.slider&&this.slider.remove();this.arrows.map(function(d){d.remove()});removeListener(curLevel,"update",this.type+this.handle)}});function Liquid(d){this.type="Liquid";this.wallInfo=d.wallInfo;this.wallGas=walls[this.wallInfo];this.wallPtIdxs=d.wallPts||[this.wallGas.length-2,this.wallGas.length-3];this.handle=d.handle;this.actCoeffType=d.actCoeffType||"ideal";this.actCoeffInfo=d.actCoeffInfo;var f=d.makePhaseDiagram;this.Cp=0;var e=d.tempInit;this.temp=e;var h=d.spcCounts;this.spcDefs=this.getSpcDefs(h);this.tempDisplay=this.temp;this.criticalPointTemp=d.criticalPointTemp;this.triplePointTemp=d.triplePointTemp;this.isTwoComp=
2==countAttrs(this.spcDefs);this.spcA=getNth(this.spcDefs,0);this.isTwoComp&&(this.spcB=getNth(this.spcDefs,1));this.drivingForce=this.makeDrivingForce(this.spcDefs);this.dotMgrLiq=this.makeDotManager(this.spcDefs);this.wallLiq=this.makeWallLiq(this.spcDefs,h,this.wallGas,this.wallPtIdxs,this.dotMgrLiq);this.wallLiq.isLiquid=!0;this.surfAreaObj=this.wallGas.addSurfAreaAdjust(this.handle);this.numAbs=deepCopy(this.drivingForce);this.numEjt=deepCopy(this.numAbs);this.makeDots(this.wallLiq,this.wallGas,
this.wallPtIdxs,h,e,this.dotMgrLiq)&&this.deleteCount(this.spcDefs);this.dataGas=this.initData(this.wallGas,this.spcDefs,["pInt","temp"]);this.setupGrabPExt(this.wallGas,this.dataGas);this.dataLiq=this.initData(this.wallLiq,this.spcDefs);this.recordTempLiq(this.wallLiq);this.drawList=this.makeDrawList(this.dotMgrLiq);this.actCoeffFuncs=this.makeActCoeffFuncs(this.actCoeffType,this.actCoeffInfo,this.spcDefs);this.chanceZeroDf=0.4;this.drivingForceSensitivity=10;this.updateListenerName=this.type+this.handle;
this.phasePressure=d.phasePressure||1;this.makePhaseDiagram=this.wrapMakePhaseDiagram(this,this.spcDefs,this.actCoeffFuncs,"liquid"+this.handle.toCapitalCamelCase(),d.primaryKey,d.makeGasMarker,d.makeSystemMarker,d.makeLiquidMarker,this.phasePressure);f&&(this.phaseDiagram=this.makePhaseDiagram());this.updateEquilData(this.phaseDiagram,[this.phasePressure]);this.setupUpdate(this.spcDefs,this.dataGas,this.dataLiq,this.actCoeffFuncs,this.drivingForce,this.updateListenerName,this.drawList,this.dotMgrLiq,
this.wallLiq,this.numAbs,this.drivingForceSensitivity,this.numEjt,this.wallGas,this.wallPtIdxs,this.surfAreaObj);this.wallGas.addLiquid(this);this.wallBound=this.addWallBound(this.wallGas);this.phaseChangeEnabled=!0;this.equilData;this.energyForDots=0;this.setupStd()}
_.extend(Liquid.prototype,objectFuncs,{getSpcDefs:function(d){var f={},e;for(e in d)f[e]=window.spcs[e];return f},setupGrabPExt:function(d,f){timeline.curSection().addCmmdPoint("now","setup",function(){var e=d.getDataSrc("pExt",void 0,!0);e&&(f.pExt=e)},!0,!0)},makeActCoeffFuncs:function(d,f,e){d=d||"ideal";if(/(twoSfxMrg|twosuffixmargoules)/i.test(d))return this.makeTwoSfxMrgFuncs(e,f.a);if(/van[\s]*laar/i.test(d))return this.makeVanLaar(e,f);if(/ideal/i.test(d)){d={};for(var h in e)d[h]=function(d,
e){return 1};return d}},makeTwoSfxMrgFuncs:function(d,f){var e={},h=R,k;for(k in d)e[k]=function(d,e){return Math.exp(f*(1-d)*(1-d)/(h*e))};return e},makeVanLaar:function(d,f){var e={},h;for(h in d){var k=f[h],l=this.getActCoeffOther(h,f);void 0===k&&console.log("Missing activity coefficient for "+h);e[h]=this.makeVanLaarFunc(k,l)}return e},makeVanLaarFunc:function(d,f){return function(e,h){return Math.exp(d*f*(1-e)/(d*e+f*(1-e))*f*(1-e)/(d*e+f*(1-e)))}},getActCoeffOther:function(d,f){for(var e in f)if(e!=
d)return f[e]},makeWallLiq:function(d,f,e,h,k,l){d=this.getLiqWallVol(d,f);e=this.getWallLiqPts(e,h,d);return window.walls.addWall({pts:e,handler:{func:this.hit,obj:this},handle:"liquid"+this.handle.toCapitalCamelCase(),record:!1,show:!0,dotManager:k,close:!1})},makeNumAbsorbed:function(d){var f={},e;for(e in d)f[e]=0;return f},togglePhaseChange:function(){this.phaseChangeEnabled?this.disablePhaseChange():this.enablePhaseChange()},enablePhaseChange:function(){window.walls.setWallHandler(this.wallLiq.handle,
{func:this.hit,obj:this});this.phaseChangeEnabled=!0},disablePhaseChange:function(){window.walls.setWallHandler(this.wallLiq.handle,{func:this.hitNoPhaseChange,obj:this});this.phaseChangeEnabled=!1},getLiqWallVol:function(d,f,e){var h=0;if(e)for(k in d)h+=d[k].spcVolLiq*e.get({spcName:k}).length/N;else for(var k in d)h+=d[k].spcVolLiq*f[k]/N;return h},getWallLiqPts:function(d,f,e){var h=d[f[0]];f=d[f[1]];d=h.x<f.x?h:f;h=d==h?f:h;e=this.getWallHeight(h.x-d.x,e);d=d.copy().movePt(V(0,-e));return[h.copy().movePt(V(0,
-e)),d]},getWallHeight:function(d,f){return f/(vConst*d)+2},makeDotManager:function(d){var f=new DotManager,e;for(e in d)f.addSpcs(e);return f},makeDots:function(d,f,e,h,k,l){var m=d[1].copy();f=P(Math.max(f[e[0]].x,f[e[1]].x),f[e[0]].y);f=m.VTo(f);for(var n in h)spcs[n].populate(m,f,h[n],k,d.handle,void 0,d.handle,l)},recordTempLiq:function(d){var f=this;d.recordTemp(function(){return f.tempDisplay})},initData:function(d,f,e){var h={};if(e)for(var k=0;k<e.length;k++){var l=e[k],m=d.getDataObj(l,
void 0,!0);m&&(h[l]=m.src())}for(var n in f)f={spcName:n,tag:d.handle},d.recordFrac(f),h[n]=d.getDataObj("frac",f).src();return h},makeDrivingForce:function(d){var f={},e;for(e in d)f[e]=0;return f},setupUpdate:function(d,f,e,h,k,l,m,n,p,q,r,t,u,x,v){this.calcCp=this.setupCalcCp(d,n);this.calcEquil=this.setupUpdateEquil(u,p,d,f,e,h,k,n);this.drawDots=this.setupDrawDots(m);this.moveDots=this.setupMoveDots(n,d,p,u,x);this.ejectDots=this.setupEjectDots(n,d,k,q,r,m,p,t);var z=this.setupSizeWall(p,u,d,
n,x,v),y=this.setupFixLiquidTemp(u,dotManager,f),A=this.calcCp,B=this.calcEquil,C=this.drawDots,H=this.moveDots,w=this.ejectDots;A();var F=0,E=this;addListener(curLevel,"update",l,function(){if(5==F){var d;E.isTwoComp?(E.checkUpdateEquilAndPhaseDiagram=E.setupCheckUpdateEquilPhaseDiagram(E.phaseDiagram,E.wallGas.getDataSrc("pExt"),E.wallGas.getDataSrc("pInt")),d=E.checkUpdateEquilAndPhaseDiagram):d=function(){};removeListener(curLevel,"update",l);addListener(curLevel,"update",l,function(){0<E.Cp&&
2.5>E.Cp&&y();E.tempDisplay=E.temp;A();B();C();H();E.phaseChangeEnabled&&w();z();d();E.addEnergyToDots(window.dotManager.lists.ALLDOTS,E.energyForDots)&&(E.energyForDots=0)})}E.tempDisplay=E.temp;A();B();C();H();z();F++})},setupFixLiquidTemp:function(d,f,e){var h=this;return function(){var d=h.tDew(h.spcA,h.spcB,e,h.equilData),f=e.temp[e.temp.length-1],m=getSign(f-d),d=d+m*Math.min(15,m*(f-d)),f=(d-h.temp)*h.Cp;h.temp=d;h.energyForDots-=f}},tDew:function(d,f,e,h){if(d&&f){d=h.data;e=e[h.keyLight][e[h.keyLight].length-
1];h=1;for(f=d.length;h<f;h++)if(d[h].yLight<=e){f=d[h-1].yLight;var k=d[h-1].temp;return k+(e-f)*(d[h].temp-k)/(d[h].yLight-f)}}else return d.tBoil(e.pExt?e.pExt[e.pExt.length-1]:e.pInt[e.pInt.length-1])},addEnergyToDots:function(d,f){if(d.length&&f){for(var e=Math.min(d.length,20),h=Math.max(0,Math.floor(Math.random()*d.length-e)),k=f/e,e=e+h;h<e;h++)d[h].addEnergy(k);return!0}return!1},setupCalcCp:function(d,f){var e=this,h={},k;for(k in d)h[k]=f.get({spcName:k});return function(){var f=0,k;for(k in d)f+=
d[k].cpLiq*h[k].length/N;e.Cp=f}},setupUpdateEquil:function(d,f,e,h,k,l,m,n){var p=this;return function(){var q=5>Math.abs(d[0].y-f[0].y);0==n.count?p.updateEquilAllVap(d,f,e,h,k,l,m,n):q?p.updateEquilWithPExt(d,f,e,h,k,l,m,n):p.updateEquilStd(d,f,e,h,k,l,m,n)}},updateEquilAllVap:function(d,f,e,h,k,l,m,n){d=this.tDew(this.spcA,this.spcB,h,this.equilData);h=h.temp[h.temp.length-1]>d?-10:0;for(var p in e)m[p]=h},updateEquilWithPExt:function(d,f,e,h,k,l,m,n){f=0;h={};for(var p in e){n=k[p][k[p].length-
1];var q=this.temp,r=l[p](n,q),t=e[p].antoineCoeffs;n*=this.getPPure(t.a,t.b,t.c,q)*r;f+=n;h[p]=n}d=d.pExt()-f;for(p in e)m[p]=d*h[p]/f},updateEquilStd:function(d,f,e,h,k,l,m,n){for(var p in e){d=h[p][h[p].length-1];f=k[p][k[p].length-1];n=this.temp;var q=l[p](f,n),r=e[p].antoineCoeffs;f*=this.getPPure(r.a,r.b,r.c,n)*q;m[p]=d*(h.pExt?h.pExt[h.pExt.length-1]:h.pInt[h.pInt.length-1])-f}},setupDrawDots:function(d){return function(){window.draw.dotsAsst(d)}},setupMoveDots:function(d,f,e,h,k){var l=this,
m=[],n;for(n in f)m.push(d.get({spcName:n}));return function(){for(var d,f,n,t,u=e[0].x,x=e[1].x,v=h[k[0]].y,z=e[0].y,y=0;y<m.length;y++){var A=m[y];if(f=A.length){t=A[0].m;d=15+Math.ceil(15*Math.random());for(var B=0;B<d;B++){n=0.5*tempToV(t,l.temp);var C=2*Math.PI*Math.random();n=V(Math.cos(C)*n,Math.sin(C)*n);for(C=B;C<f;C+=d)A[C].x=Math.max(x,Math.min(u,A[C].x+n.dx)),A[C].y=Math.max(z,Math.min(v,A[C].y+n.dy))}}}}},setupEjectDots:function(d,f,e,h,k,l,m,n){var p=this,q=this.wallGas,r={},t;for(t in f)r[t]=
d.get({spcName:t});return function(){for(var t in f){var x=e[t],v=h[t];h[t]=0;0<x?n[t]+=v/(x*k+1):0>x&&(n[t]+=1+Math.sqrt(v*(-x*k+1)),n[t]+=(m[0].x-m[1].x)*-x*k/2E3);n[t]=Math.min(n[t],r[t].length);if(x=Math.floor(n[t]))p.eject(d,window.dotManager,f,t,x,q,l,m),n[t]=0}}},setupSizeWall:function(d,f,e,h,k,l){var m=this;return function(){var n=m.getLiqWallVol(e,void 0,h),n=m.getWallHeight(Math.abs(f[k[0]].x-f[k[1]].x),n);d[0].y=f[k[0]].y-n;d[1].y=f[k[0]].y-n;d.parent.setupWall(d.parent.indexOf(d));l.val=
2*n+d[1].x-d[0].x}},setupCheckUpdateEquilPhaseDiagram:function(d,f,e){var h=f?f:e,k=0,l=this;return function(){h[h.length-1]!=l.equilData.pressure&&k++;15<k&&(l.updateEquilData(d,h),k=0)}},updateEquilData:function(d,f){d?this.equilData=d.setPressure(f[f.length-1]):this.isTwoComp&&(this.equilData=phaseEquilGenerator.constP(this.spcA,this.spcB,this.actCoeffFuncs,f[f.length-1],20))},eject:function(d,f,e,h,k,l,m,n){e=d.get({spcName:h});k=Math.min(e.length,k);k=e.slice(0,k);for(e=0;e<k.length;e++){h=k[e];
0==h.temp()&&(h.v.dy=-1);h.setTemp(this.temp);var p=h.hVap();h.v.dy=-Math.abs(h.v.dy);h.y=n[0].y-1;h.setWall(l.handle);m.splice(m.indexOf(h),1);d.remove(h);this.calcCp();this.temp-=p/this.Cp;0==this.Cp&&(this.temp=0,this.energyForDots-=p);0>this.temp&&(this.energyForDots-=this.Cp*(1-this.temp),this.temp=1)}f.add(k)},getPPure:function(d,f,e,h){return Math.pow(10,d-f/(h+e))*MMHGTOBAR},makeDrawList:function(d){for(var f=d.lists.ALLDOTS.concat(),e=[],h=0;h<d.lists.ALLDOTS.length;h++){var k=Math.floor(Math.random()*
f.length);e.push(f[k]);f.splice(k,1)}return e},hit:function(d,f,e,h,k,l,m){f=this.drivingForce;if(void 0!==f[d.spcName]&&(e=this.chanceZeroDf,e/=1-e,e/(e+Math.exp(-f[d.spcName]*this.drivingForceSensitivity))>Math.random()))return this.absorbDot(d,this.drawList,this.dotMgrLiq,this.wallLiq,this.spcDefs,this.dataGas.temp);this.dotMgrLiq.count?this.adjTemps(d,h,k,this.dataGas,this.dataLiq,this.temp,window.dotManager.spcLists,this.spcDefs):WallMethods.collideMethods.reflect(d,h,k)},hitNoPhaseChange:function(d,
f,e,h,k,l,m){this.adjTemps(d,h,k,this.dataGas,this.dataLiq,this.temp,window.dotManager.spcLists,this.spcDefs)},absorbDot:function(d,f,e,h,k,l){window.dotManager.remove(d);f.splice(Math.floor(Math.random()*f.length),0,d);d.setWall(h.handle);e.add(d);f=l[l.length-1];this.energyForDots+=(d.temp()-f)*d.cv;d.setTemp(f);f=this.Cp;this.calcCp();this.temp=(this.temp*f+d.tempCondense()*d.cpLiq)/this.Cp;this.numAbs[d.spcName]++;return!1},adjTemps:function(d,f,e,h,k,l,m,n){var p=h.temp[h.temp.length-1];h=d.temp();
k=d.cv;var q=0,r;for(r in n)q+=m[r].length*n[r].cv/N;m=getSign(l-p);l=Math.abs((l-(this.Cp*l+q*p)/(this.Cp+q))*this.Cp);l=Math.max(m*Math.min(l,100*k),(5-h)*k);k=h+l/k;m=1;0<this.temp-l/this.Cp&&(this.temp-=l/this.Cp,m=Math.sqrt(k/h),d.v.mult(m),d.internalPotential*=k/h);WallMethods.collideMethods.reflect(d,f,e*m)},getWallLiq:function(){return this.wallLiq},getWallGas:function(){return this.wallGas},addQ:function(d){var f=this.Cp;if(0!=f){var e=this.temp;d=Math.min(f*(3E3-e),Math.max((-e+10)*f,d));
this.temp+=d/f;this.wallLiq.q+=d}},wrapMakePhaseDiagram:function(d,f,e,h,k,l,m,n,p){var q=this,r=this.makePhaseDiagram;return function(){return r.apply(q,[d,f,e,h,k,l,m,n,p])}},makePhaseDiagram:function(d,f,e,h,k,l,m,n,p){var q,r,t;for(t in f)q?r=t:q=t;this.isTwoComp?(d={x:{min:0,step:0.2},y:{min:300,step:1}},e=new GraphPhaseTwoComp({spcAName:q,spcBName:r,axisInit:d,actCoeffFuncs:e,handle:h,primaryKey:k,liquid:this,wallGas:this.wallGas,makeGasMarker:l,makeSystemMarker:m,makeLiquidMarker:n,pressure:p})):
(d={x:{min:200,step:1}},e=new GraphPhaseOneComp({spcName:q,axisInit:d,handle:h,liquid:this,wallGas:this.wallGas,makeSystemMarker:m,logScale:{y:!0},criticalPointTemp:this.criticalPointTemp,triplePointTemp:this.triplePointTemp}));return e},addWallBound:function(d){d.setBounds(void 0,this.wallLiq[0]);var f=new WallMethods.BoundHandler(function(d,f,k){f=d.vs[0].dy;var l=d.mass;f=(0.5*l*f*f+l*window.g*(k-d[0].y))*window.tConst*window.KB;d.vs[0].dy=0;d.vs[1].dy=0;this.temp+=f/this.Cp;return k},this,!0);
d.addBoundHandler("max",f);return f},remove:function(){removeListener(curLevel,"update",this.updateListenerName);this.wallGas.removeLiquid(this);this.heater&&this.heater.removeLiquid();this.wallLiq.removed||walls.removeWall(this.wallLiq.handle);this.wallGas.removed||this.wallGas.removeSurfAreaAdjust(this.handle)}});function Outlet(d){this.arrowDims=V(15,20);this.arrowFill=Col(200,0,0);this.arrowStroke=Col(100,100,100);this.type="Outlet";this.handle=d.handle;this.width=defaultTo(30,d.height);this.depth=defaultTo(20,d.depth)||20;this.fracOpen=defaultTo(1,d.fracOpen);this.makePts=this.depth;this.wallInfo=d.wallInfo;this.wall=walls[this.wallInfo];this.ptIdxs=d.ptIdxs;this.fracOffset=defaultTo(0.5,d.fracOffset);this.arrows=[];this.init()}
_.extend(Outlet.prototype,flowFuncs,objectFuncs,{init:function(){this.addPts();this.makePts&&this.wall.addPts(this.ptIdxs[1],this.pts);var d=Math.min(this.ptIdxs[0],this.ptIdxs[1])+2;this.arrows=this.addArrows(this.pts[1].VTo(this.pts[2]).UV().perp("cw"));walls.setSubWallHandler(this.wallInfo,d,"outlet")},remove:function(){this.arrows.map(function(d){d.remove()})}});function ParticleEmitter(d){this.type="ParticleEmitter";this.pos=d.pos;this.handle=d.handle;this.dir=d.dir;this.parentList=d.parentList;this.width=d.width;this.col=d.col;this.dist=d.dist;this.onGenerate=d.onGenerate;this.onArrive=d.onArrive;this.onRemove=d.onRemove;this.rate=defaultTo(Math.round(0.1*this.width),d.rate);this.speed=defaultTo(5,d.speed);this.speedSpread=defaultTo(1,d.speedSpread);2*this.speedSpread>this.speed&&console.log("Uh-oh.  Making particle emitter with handle "+this.handle+" with speed spread such that particles will hit ~0 speed");
this.accel=defaultTo(0.5,d.accel);this.accelSpread=defaultTo(1,d.accelSpread);this.dirSpread=defaultTo(0,d.dirSpread);this.drawCanvas=defaultTo(c,d.drawCanvas);this.makeBounds();this.setupStd();this.particles=[];return this.init()}
_.extend(ParticleEmitter.prototype,objectFuncs,{init:function(){this.runListenerName=unique("particle"+this.handle,curLevel.updateListeners);addListener(curLevel,"update",this.runListenerName,this.run,this);return this},adjust:function(d){for(var f in d)this[f]=d[f];this.makeBounds()},makeBounds:function(){this.UV=angleToUV(this.dir);var d=this.pos.copy().movePt(this.UV.copy().rotate(-Math.PI/2).mult(this.width/2)),f=this.pos.copy().movePt(this.UV.copy().rotate(Math.PI/2).mult(this.width/2));this.prodPt=
d;this.prodV=d.VTo(f);this.finishPt=d.copy().movePt(this.UV.copy().mult(this.dist));this.finishV=this.finishPt.VTo(this.prodPt)},run:function(){this.generateNew();this.updateParticles();this.draw()},trickleOut:function(){this.updateParticles();this.draw();0==this.particles.length&&this.remove()},generateNew:function(){for(var d=Math.round(Math.random()*this.rate),f=0;f<d;f++)this.particles.push(this.newParticle()),this.onGenerate&&this.onGenerate.func.apply(this.onGenerate.obj)},newParticle:function(){var d=
this.prodPt.copy().movePt(this.prodV.copy().mult(Math.random())),f=Math.max(0.01,this.speed+this.speedSpread*(Math.random()-0.5)),e=Math.max(0,this.accel+this.accelSpread*(Math.random()-0.5)),h=angleToUV(this.dir+this.dirSpread*(Math.random()-0.5)),k=this.getlifespan(d,f,e,h);return{pos:d,V:h.copy().mult(f),accelV:h.copy().mult(e),age:0,lifespan:k}},getlifespan:function(d,f,e,h){d=h.dotProd(this.UV);e=0.5*e*d;f*=d;return(-f+Math.sqrt(f*f-4*e*-this.dist))/(2*e)},updateParticles:function(){for(var d=
this.particles.length-1;0<=d;d-=1){var f=this.particles[d];f.pos.movePt(f.V);f.V.add(f.accelV);f.age++;f.age>f.lifespan&&(this.particles.splice(d,1),this.onArrive&&this.onArrive.func.apply(this.onArrive.obj))}},draw:function(){this.drawCanvas.strokeStyle=this.col.hex;for(var d=0;d<this.particles.length;d++){var f=this.particles[d];c.beginPath();c.moveTo(f.pos.x,f.pos.y);c.lineTo(f.pos.x+2,f.pos.y+2);c.stroke()}},stopFlow:function(){removeListener(curLevel,"update",this.runListenerName);addListener(curLevel,
"update",this.runListenerName,this.trickleOut,this)},remove:function(){this.onRemove&&this.onRemove.func.apply(this.onRemove.obj);this.parentList&&this.parentList.splice(_.indexOf(this.parentList,this),1);removeListener(curLevel,"update",this.runListenerName);this.removed=!0}});function Piston(d){this.type="Piston";this.handle=d.handle;this.wallInfo=defaultTo(0,d.wallInfo);this.wall=walls[this.wallInfo];this.min=defaultTo(2,d.min);this.max=defaultTo(15,d.max);this.makeSlider=defaultTo(!1,d.makeSlider);this.drawCanvas=defaultTo(c,d.drawCanvas);this.slant=0.07;this.sliderWrapper=d.sliderWrapper;this.sliderTitleWrapper=d.sliderTitleWrapper;this.left=this.wall[0].x;this.width=this.wall[1].x-this.left;this.pistonPt=this.wall[0];var f=defaultTo(2,d.init);this.setPressure(f);this.height=
500;this.draw=this.makeDrawFunc(this.height,this.left,this.width);this.dataSlotFont="12pt Calibri";this.dataSlotFontCol=Col(255,255,255);this.pStep=0.05;var e=this.left+this.width*this.slant,h=this.left+this.width-this.width*this.slant,k=this.pistonBottom.pos.y-2+this.pistonPt.y,l=Col(255,255,255);this.readout=new Readout("pistonReadout"+this.handle.toCapitalCamelCase(),e,h,k,"12pt calibri",l,"center",curLevel);this.wall.moveInit();this.wall.recordPExt();this.wall.recordWork();this.savedWallHandler=
this.wall.handlers[0];this.wallHandler=defaultTo("cPAdiabaticDamped",d.compMode);walls.setSubWallHandler(this.wallInfo,0,this.wallHandler);this.makeSlider&&(this.slider=sliderManager.addSlider("Pressure",this.handle+"Slider",{value:this.pToPercent(f)},[{eventType:"slide",obj:this,func:this.parseSlider}],d.sliderIdx));this.setupStd();return this.show()}
_.extend(Piston.prototype,objectFuncs,compressorFuncs,{makeDrawFunc:function(d,f,e){var h=d-45;this.pistonTop=this.makeTop(f,e,30,h,d,35,10);this.pistonBottom=this.makePlateBottom(P(f,-d+h+35),V(e,10));var k=this;return function(){k.readout&&k.setReadoutY();k.drawCanvas.save();k.drawCanvas.translate(0,k.pistonPt.y);draw.fillPts(k.pistonTop.pts,k.pistonTop.col,k.drawCanvas);draw.fillRect(k.pistonBottom.pos,k.pistonBottom.dims,k.pistonBottom.col,k.drawCanvas);k.drawCanvas.restore()}},makeTop:function(d,
f,e,h,k,l,m){var n=this.slant,p=1-n,q=Array(14);k=P(d+f/2-e/2,-k);var r=Col(150,150,150);f=V(f,l);d=k.copy().movePt({dy:h}).position({x:d});q[0]=P(d.x,d.y+f.dy+1);q[1]=P(d.x+f.dx*n,d.y);q[2]=P(k.x-f.dx*n,d.y);q[3]=P(k.x,d.y-5*f.dy*n);q[4]=P(k.x,k.y);q[5]=P(k.x+e,k.y);q[6]=P(k.x+e,d.y-5*f.dy*n);q[7]=P(k.x+e+f.dx*n,d.y);q[8]=P(d.x+f.dx*p,d.y);q[9]=P(d.x+f.dx,d.y+f.dy+1);q[10]=P(d.x+f.dx-m,d.y+f.dy+1);q[11]=P(d.x+f.dx*p-m,d.y+m);q[12]=P(d.x+f.dx*n+m,d.y+m);q[13]=P(d.x+m,d.y+f.dy+1);r=Col(150,150,150);
return{pts:q,col:r}},makePlateBottom:function(d,f){var e=Col(100,100,100);f.adjust(0,1);return{pos:d,dims:f,col:e}},enable:function(){this.slider&&this.slider.slider("option","disabled",!1);this.setMass(this.massStore);delete this.massStore;this.enabled=!0},disable:function(){this.slider&&this.slider.slider("option","disabled",!0);this.massStore=this.mass;this.setMass(0);this.enabled=!1},show:function(){addListener(curLevel,"update","drawPiston"+this.handle,this.draw,"");this.readout.show();return this},
pToPercent:function(d){return 100*(d-this.min)/(this.max-this.min)},hide:function(){removeListener(curLevel,"update","drawPiston"+this.handle);this.readout.hide()},parseSlider:function(d,f){this.setPressure(this.percentToVal(f.value))},setPressure:function(d){this.setMass(this.pressureToMass(d))},setMass:function(d){this.mass=d;this.wall.setMass("piston"+this.handle,this.mass)},setReadoutY:function(){this.readout.position({y:this.pistonBottom.pos.y-2+this.pistonPt.y})},remove:function(){this.wall.moveStop();
this.wall.unsetMass("piston"+this.handle);walls.setSubWallHandler(walls.indexOf(this.wall),0,this.savedWallHandler);this.hide();this.slider&&this.slider.remove();removeListener(curLevel,"update","moveWalls")}});function QArrowsAmmt(d){this.type="QArrowsAmmt";this.wallHandle=d.wallInfo;this.wall=walls[this.wallHandle];this.handle=d.handle;var f=this.wall;f.recordQ();var e=3*(1/d.scale);this.qArrowAmmtMax=isNaN(e)?3:e;this.qArrowAmmtMax=defaultTo(3,3*(1/d.scale));addListener(f,"cleanUp","qArrowsAmmt",function(){for(var d=0;d<this.qArrowsAmmt.length;d++)this.qArrowsAmmt[d].remove();removeListener(curLevel,"update",this.listenerName)},this);this.init(this.wall,this.qArrowAmmtMax);this.setupStd()}
_.extend(QArrowsAmmt.prototype,objectFuncs,{init:function(d,f){Col(175,0,0);var e=V(30,10),h=d[3].copy().fracMoveTo(d[2],0.25),k=d[3].copy().fracMoveTo(d[2],0.75),l=k.VTo(h).perp("cw").UV();h.movePt(l.copy().mult(5));k.movePt(l.copy().mult(5));var h=new ArrowStatic({pos:h,dims:e,fill:Col(175,0,0),stroke:Col(0,0,0),label:"Q",UV:l}),e=new ArrowStatic({pos:k,dims:e,fill:Col(175,0,0),stroke:Col(0,0,0),label:"Q",UV:l}),m=f/65;this.qArrowsAmmt=[h,e];var n="out";qLast=d.q;this.setAmmtArrowDims(this.qArrowsAmmt,
15,80,70,90,d.q,f);0<=d.q&&(n="in",this.flipAmmtArrows(this.qArrowsAmmt));this.listenerName=this.handle+"updateQAmmtArrows";addListener(curLevel,"update",this.listenerName,function(){Math.abs(d.q-qLast)>m&&(dir=0>d.q?"out":"in",this.setAmmtArrowDims(this.qArrowsAmmt,15,80,70,90,d.q,f),n!=dir&&(this.flipAmmtArrows(this.qArrowsAmmt),n=dir),qLast=d.q)},this)},flipAmmtArrows:function(d){for(var f=0;f<d.length;f++){var e=d[f],h=angleToUV(e.getAngle()).mult(1);e.move(h.mult(e.getDims().dx));e.rotate(Math.PI)}},
setAmmtArrowDims:function(d,f,e,h,k,l,m){for(var n=0;n<d.length;n++){var p=d[n],q=p.getDims(),r=Math.abs(l)/m,t=f+(e-f)*r;p.size(V(t,h+(k-h)*r));0<l&&p.move(V(0,t-q.dx))}},remove:function(){removeListener(curLevel,"update",this.listenerName)}});function RMSChanger(d){this.type="RMSChanger";this.info=d.info;this.min=defaultTo(1,d.min);this.val=dataHandler.RMS(this.info);this.max=defaultTo(15,d.max);this.handle=d.handle;this.totalDots=dataHandler.count(this.info);this.sliderPos=d.sliderPos;this.setupStd();return this.init()}
_.extend(RMSChanger.prototype,objectFuncs,{init:function(){this.sliderId=this.addSlider(1<this.totalDots?"Molecules' RMS":"Molecule's RMS",{value:this.valToPercent(this.val)},[{eventType:"slide",obj:this,func:this.parseSlider}],this.sliderPos)},parseSlider:function(d,f){changeRMS(this.info,this.percentToVal(f.value))},remove:function(){this.removeSlider()}});function Sandbox(d){this.type="Sandbox";this.handle=d.handle;this.emitterNum=0;d=defaultTo({},d);this.bin={};this.sand={};this.drawCanvas=defaultTo(c,d.drawCanvas);this.wallInfo=defaultTo(0,d.wallInfo);this.wall=walls[this.wallInfo];this.mass=this.pressureToMass(defaultTo(2,d.init));this.massMin=this.pressureToMass(defaultTo(0.5,d.min));this.massMax=this.pressureToMass(defaultTo(15,d.max));this.particleMass=defaultTo(0.01,d.partMass);this.buttonAddId="sandAdd"+this.handle;this.buttonRemoveId="sandRemove"+
this.handle;this.makeButtons();this.massChunkName="sandMass"+defaultTo("",this.handle);this.wall.setMass(this.massChunkName,this.mass);this.wall.recordPExt();this.wall.recordWork();this.wallHandler=defaultTo("cPAdiabaticDamped",d.compMode);walls.setSubWallHandler(this.wallInfo,0,this.wallHandler);this.trackingPts=[];this.wallPt=this.wall[0];this.emitters=[];this.binX=(this.wall[1].x+this.wall[0].x)/2;this.spcVol=70;this.sand.col=defaultTo(Col(224,165,75),d.sandCol);this.sand.pts=this.getSandPts();
this.sand.pos=P(this.binX,this.wall[0].y).track({pt:this.wallPt,noTrack:"x"});this.trackingPts.push(this.sand.pos);this.pistonPt=this.wall[0].y;this.setupStd();return this.init()}
_.extend(Sandbox.prototype,compressorFuncs,objectFuncs,{init:function(){this.drawListenerName=unique("drawSand"+this.handle,curLevel.updateListeners);addListener(curLevel,"update",this.drawListenerName,this.draw,this);this.wall.moveInit();this.wall.recordMass();this.wall.recordPExt();return this},makeButtons:function(){var d=this,f=this.handle+"SandButtons";buttonManager.addGroup(f,"Sand controls");buttonManager.addButton(f,"add","Add mass",{mousedown:function(){d.buttonAddDown()}});buttonManager.addButton(f,
"remove","Remove mass",{mousedown:function(){d.buttonRemoveDown()}})},removeButtons:function(){$("#"+this.buttonAddId).remove();$("#"+this.buttonRemoveId).remove()},draw:function(){this.drawCanvas.save();this.drawCanvas.translate(this.sand.pos.x,this.sand.pos.y);var d=Math.sqrt(0.4*this.mass);this.drawCanvas.scale(d,d);draw.fillPts(this.sand.pts,this.sand.col,this.drawCanvas);this.width=d*(this.sand.pts[this.sand.pts.length-1].x-this.sand.pts[0].x);this.drawCanvas.restore()},getSandPts:function(){var d=
Array(4);d[0]=P(-10,0);d[1]=P(-7,-2);d[2]=P(-3,-6);d[3]=P(0,-7);ptsRight=deepCopy(d).splice(0,d.length-1).reverse();mirrorPts(ptsRight,P(0,0),V(0,-10));return d=d.concat(ptsRight)},buttonAddDown:function(){this.mass<this.massMax&&(this.boundUpper(),this.addMass(),addListener(curLevel,"mouseup","mouseUpSandbox",this.buttonAddUp,this))},buttonAddUp:function(){this.boundUpperStop();this.addMassStop();removeListener(curLevel,"mouseup","mouseUpSandbox")},buttonRemoveDown:function(){this.mass>this.massMin&&
(this.boundLower(),this.removeMass(),addListener(curLevel,"mouseup","mouseUpSandbox",this.buttonRemoveUp,this))},buttonRemoveUp:function(){this.boundLowerStop();this.removeMassStop();removeListener(curLevel,"mouseup","mouseUpSandbox")},boundUpper:function(){var d=this.handle+"BoundUpper";curLevel.updateListeners[d]||addListener(curLevel,"update",d,function(){this.mass>this.massMax&&(this.stopAllEmitters(),removeListener(curLevel,"update",d))},this)},boundLower:function(){var d=this.handle+"BoundLower";
curLevel.updateListeners[d]||addListener(curLevel,"update",d,function(){this.mass<this.massMin&&(this.stopAllEmitters(),removeListener(curLevel,"update",d))},this)},boundUpperStop:function(){removeListener(curLevel,"update",this.handle+"BoundUpper")},boundLowerStop:function(){removeListener(curLevel,"update",this.handle+"BoundLower")},stopAllEmitters:function(){for(var d=0;d<this.emitters.length;d++)this.emitters[d].stopFlow()},addMass:function(){this.emitters.push(this.makeAddEmitter())},addMassStop:function(){this.emitters[this.emitters.length-
1].stopFlow()},removeMass:function(){this.emitters.push(this.makeRemoveEmitter())},removeMassStop:function(){this.emitters[this.emitters.length-1].stopFlow()},makeAddEmitter:function(){var d=this.handle+this.emitterNum;this.emitterNum++;var f={func:this.onArriveAdd,obj:this},e=this.emitters.length,h=Math.PI/2,k=this.sand.col,l=this.wall[0].y,m=new ParticleEmitter({pos:P((this.wall[0].x+this.wall[1].x)/2,0),width:this.width,dist:l,dir:h,col:k,onRemove:n,parentList:this.emitters,onArrive:f,handle:d});
m.adding=!0;moveListenerName=unique("adjustEmitter"+e,curLevel.updateListeners);addListener(curLevel,"update",moveListenerName,function(){m.adjust({dist:this.wallPt.y,width:this.width})},this);var n={func:function(){removeListener(curLevel,"update",moveListenerName)},obj:this};return m},makeRemoveEmitter:function(){var d=this.handle+this.emitterNum;this.emitterNum++;var f={func:this.onGenerateRemove,obj:this},e=this.emitters.length,h=-Math.PI/2,k=this.sand.col,l=(this.wall[0].x+this.wall[1].x)/2,
m=this.wall[0].y,n=new ParticleEmitter({pos:P(l,0),width:this.width,dist:m,dir:h,col:k,onRemove:q,parentList:this.emitters,onGenerate:f,handle:d});n.removing=!0;moveListenerName=unique("adjustEmitter"+e,curLevel.updateListeners);var p=this.wall[0];addListener(curLevel,"update",moveListenerName,function(){n.adjust({pos:P(l,p.y),dist:p.y,width:this.width})},this);var q={func:function(){removeListener(curLevel,"update",moveListenerName)},obj:this};return n},onGenerateRemove:function(){this.mass-=this.particleMass;
this.wall.setMass(this.massChunkName,this.mass)},onArriveAdd:function(){this.mass+=this.particleMass;this.wall.setMass(this.massChunkName,this.mass)},remove:function(){for(var d=0;d<this.emitters.length;d++)this.emitters[d].remove();this.emitters=[];this.trackingPts.map(function(d){d.trackStop()});this.trackingPts.splice(0,this.trackingPts.length);this.removeButtons();removeListener(curLevel,"update",this.drawListenerName);removeListener(curLevel,"data",this.cleanUpEmittersListenerName);this.wall.moveStop()}});function Stops(d){this.type="Stops";this.handle=d.handle;this.stopWidth=20;this.stopHeight=5;this.boundToSet=void 0;var f=d.stopPt;this.wallInfo=defaultTo(0,d.wallInfo);this.pts=this.wall=walls[this.wallInfo];if(f.vol){var e=this.pts[0].distTo(this.pts[1]);this.height=this.pts[2].y-f.vol/(vConst*e)}else f.y&&(this.height=f.height);if(this.willDraw=defaultTo(!0,d.draw))this.draw=this.makeDrawFunc(this.height);this.setupStd();return this.init()}
_.extend(Stops.prototype,objectFuncs,{makeDrawFunc:function(d){var f=this.pts[3].copy().position({y:d}),e=this.pts[2].copy().position({y:d}).movePt({dx:-this.stopWidth}),h=V(this.stopWidth,this.stopHeight),k=borderCol;return function(){draw.fillRect(f,h,k,c);draw.fillRect(e,h,k,c)}},init:function(){this.boundToSet=this.height>this.wall[0].y?"max":"min";this.yBoundSave=this.wall.bounds[this.boundToSet];"max"==this.boundToSet?walls[this.wallInfo].setBounds(void 0,this.height):"min"==this.boundToSet&&
walls[this.wallInfo].setBounds(this.height,void 0);this.willDraw&&addListener(curLevel,"update","drawStops"+this.wallInfo,this.draw,"");return this},remove:function(){window.walls&&!walls.removed&&("max"==this.boundToSet?walls[this.wallInfo].setBounds(void 0,this.yBoundSave):"min"==this.boundToSet&&walls[this.wallInfo].setBounds(this.yBoundSave,void 0));this.willDraw&&removeListener(curLevel,"update","drawStops"+this.wallInfo);return this}});function TempChanger(d){this.type="tempChanger";this.info=d.info;this.min=defaultTo(100,d.min);this.val=dataHandler.temp(this.info);this.max=defaultTo(1500,d.max);this.sliderPos=d.sliderPos;this.handle=d.handle;this.totalDots=dataHandler.count(this.info);this.setupStd();return this.init()}
_.extend(TempChanger.prototype,objectFuncs,{init:function(){this.sliderId=this.addSlider(1<this.totalDots?"System temperature":"Molecule's kinetic energy",{value:this.valToPercent(this.val)},[{eventType:"slide",obj:this,func:this.parseSlider}],this.sliderPos)},parseSlider:function(d,f){changeTemp(this.info,this.percentToVal(f.value))},remove:function(){this.removeSlider()}});function Tracer(d){this.handle=d.handle;this.type="Tracer";this.info=d.info;this.col=defaultTo(Col(175,175,175),d.col);this.lifespan=Math.round(1E3/updateInterval*defaultTo(5,d.lifespan));this.listenerHandle=this.type+this.handle+"Draw";this.listenerHandleSearch=this.type+this.handle+"Search";this.setupStd();this.drawCanvas=c;this.drawingTools=draw;this.init()}
_.extend(Tracer.prototype,objectFuncs,{init:function(){this.dot=this.getDot();this.pts=[];this.dot?(removeListener(curLevel,"update",this.listenerHandleSearch),addListener(curLevel,"update",this.listenerHandle,this.draw,this)):addListener(curLevel,"update",this.listenerHandleSearch,this.init,this)},getDot:function(){var d=dotManager.get(this.info);if(0<d.length)return this.info.idx&&this.info.idx<d.length?d[this.info.idx]:d[Math.floor(Math.random()*d.length)]},draw:function(){this.dot.active?(this.pts.push(P(this.dot.x,
this.dot.y)),this.pts.length>this.lifespan&&this.pts.splice(0,1),this.drawingTools.path(this.pts,this.col,this.drawCanvas)):this.init()},remove:function(){removeListener(curLevel,"update",this.listenerHandleSearch);removeListener(curLevel,"update",this.listenerHandle)}});function Trigger(d){this.type="Trigger";this.handle=d.handle;this.conditionFunc=this.wrapExpr(d.expr);this.checkOn=d.checkOn;this.requiredFor=!1===d.requiredFor?void 0:d.requiredFor||"now";this.message=d.message;this.priority=defaultTo(0,d.priorityUnsatisfied||d.priority);this.satisfyStore=defaultTo(void 0,d.satisfyStore);this.satisfyCmmds=defaultTo(void 0,d.satisfyCmmds);this.amSatisfied=!1;this.setupStd();this.init()}
_.extend(Trigger.prototype,objectFuncs,{init:function(){"conditions"==this.checkOn?this.initCheckOnConditions():this.initCheckOnInterval()},wrapExpr:function(d){with(DataGetFuncs)d=eval("(function() {return "+d+"})");return d},initCheckOnConditions:function(){this.requiredFor&&conditionManager.add(this)},initCheckOnInterval:function(){addListener(curLevel,"update",this.handle,function(){if(this.conditionFunc()){this.amSatisfied=!0;this.recordVals();if(this.satisfyCmmds)for(var d=0;d<this.satisfyCmmds.length;d++)eval(this.satisfyCmmds[d]);
removeListener(curLevel,"update",this.handle)}},this);this.requiredFor&&conditionManager.add(this)},recordVals:function(){with(DataGetFuncs)if(this.satisfyStore)for(var d=0;d<this.satisfyStore.length;d++){var f=this.satisfyStore[d],e=f.storeAs,f=eval(f.expr);store(e,f)}},isSatisfied:function(){return this.amSatisfied},remove:function(){removeListener(curLevel,"update",this.handle)}});function AuxImage(d){this.type="AuxImage";this.handle=d.handle;this.imgFunc=d.imgFunc;this.slotNum=d.slotNum;this.dims=this.getDims();this.bgCol=curLevel.bgCol;this.makeDiv(this.slotNum);this.addImage(this.imgFunc);curLevel.auxs[this.handle]=this;this.setupStd()}
_.extend(AuxImage.prototype,AuxFunctions,objectFuncs,{makeDiv:function(d){this.parentDiv=this.pickParentDiv("picture",d);this.parentDiv.html("");$(this.parentDiv).css({width:this.dims.dx,height:this.dims.dy,"background-color":this.bgCol.hex,"border-radius":20,padding:0})},addImage:function(d){var f=this;d=interpreter.parseImgFunc(d,!0);d.attrs||(d.attrs={});d.attrs.id=[this.type+this.handle];$(this.parentDiv).append(templater.img(d));var e=$("#"+d.attrs.id[0]);$(e).load(function(){var d=V(f.parentDiv.width(),
f.parentDiv.height()),k=V(e.width(),e.height()),l=Math.min(k.dx,d.dx)/k.dx,m=Math.min(k.dy,d.dy)/k.dy,l=Math.min(l,m),k=k.copy().mult(l),d=P(d.dx/2-k.dx/2,d.dy/2-k.dy/2);$(e).css({position:"absolute",left:d.x,top:d.y,width:k.dx,height:k.dy})})},clearHTML:function(){this.cleanUpParent()},restoreHTML:function(){$(this.parentDiv).css({width:this.dims.dx,height:this.dims.dy,"background-color":this.bgCol.hex,"border-radius":20,padding:0});this.addImage(this.imgFunc)},remove:function(){this.cleanUpParent();
delete curLevel.auxs[this.handle]}});function AnimText(d){this.drawCanvas=d}
AnimText.prototype={newAnim:function(d,f,e){var h=unique("animText",curLevel.updateListeners),k=e.text,l=new Boolean,m=new Boolean,n=new Boolean,p=new Boolean,l=void 0!==f.pos,m=void 0!==f.col,n=void 0!==f.rotation,p=void 0!==f.size,q;q=Col(255,255,255);var r=defaultTo("calibri",e.font),t=defaultTo("center",e.align);e=defaultTo(300,e.time);var u,x,v,z;d.size=defaultTo(13,d.size);d.rot=defaultTo(0,d.rot);d.col=defaultTo(q,d.col);u=d.size;x=d.rot;v=d.col;z=d.pos.copy();var y=Math.floor(e/updateInterval),
A=function(){},B=function(){},C=function(){},H=function(){},w,F,E,Y,G,Q;l&&(l=V(f.pos.x-d.pos.x,f.pos.y-d.pos.y),w=l.UV().mult(l.mag()/y),A=function(){z.x+=w.dx;z.y+=w.dy});m&&(F=Math.ceil((f.col.r-d.col.r)/y),E=Math.ceil((f.col.g-d.col.g)/y),Y=Math.ceil((f.col.b-d.col.b)/y),B=function(){v.adjust(F,E,Y)});n&&(m=f.rotation-d.rotation,G=m<=Math.PI?m/y:-m/y,C=function(){x+=G});p&&(Q=(f.size-d.size)/y,H=function(){u+=Q});var aa=0,da=this.drawCanvas;addListener(curLevel,"update",h,function(){draw.text(k,
z,Math.floor(u)+"pt "+r,v,t,x,da);A();B();C();H();aa==y&&removeListener(curLevel,"update",h);aa++},"")}};function Readout(d,f,e,h,k,l,m,n){this.handle=d;this.align=defaultTo("left",m);this.drawCanvas=c;this.font=defaultTo("13pt calibri",k);this.fontCol=defaultTo(Col(255,255,255),l);this.leftBound=f;this.width=e-f;this.y=h;this.entries=[];n.readouts[d]=this}
Readout.prototype={draw:function(){this.drawCanvas.save();this.drawCanvas.translate(this.leftBound,this.y);for(var d=0;d<this.entries.length;d++){var f=this.entries[d];window.draw.text(f.text,f.pos,this.font,this.fontCol,this.align,0,this.drawCanvas)}this.drawCanvas.restore()},update:function(d,f){var e=byAttr(this.entries,d,"name");e.val=round(f,e.decPlaces)},addEntry:function(d,f){var e=new this.Entry(d,"",this);f?this.entries.splice(f,0,e):this.entries.push(e);this.positionEntries();this.hide().show();
return e},removeEntry:function(d){for(var f=0;f<this.entries.length;f++)if(this.entries[f].handle==d)return this.entries.splice(f,1),this.positionEntries(),this;console.log("Tried to remove entry that does not exist: "+d)},entryExists:function(d){for(var f=0;f<this.entries.length;f++)if(this.entries[f].name==d)return!0;return!1},removeAllEntries:function(){this.entries=[]},positionEntries:function(){var d=this.entries.length,f;f=1<d?Math.floor(this.width/(d-1)):this.width;if("center"==this.align){f=
this.width/(d+1);for(var e=0;e<d;e++){var h=this.entries[e],k=f*(e+1),l=0;h.pos=P(k,l)}}else if("left"==this.align)for(e=0;e<d;e++)h=this.entries[e],k=f*e,l=0,h.pos=P(k,l)},getNumEntries:function(){var d=0,f;for(f in this.entries)d++;return d},reset:function(d){var f=byName(this.entries,d);this.tickReadout(f.curVal,f.setPt,d)},resetAll:function(){for(var d=0;d<this.entries.length;d++){var f=this.entries[d];this.hardUpdate(f.initVal,f.name)}},position:function(d){void 0!==d.x&&(this.leftBound=d.x);
void 0!==d.y&&(this.y=d.y)},show:function(){curLevel.readouts[this.handle]=this;addListener(curLevel,"update","drawReadout"+this.handle,this.draw,this);return this},hide:function(){delete curLevel.readouts[this.handle];removeListener(curLevel,"update","drawReadout"+this.handle);return this},Entry:function(d,f,e){this.handle=d;this.text=f;this.pos=void 0;this.readout=e}};Readout.prototype.Entry.prototype={setText:function(d){this.text=d},remove:function(){this.readout.removeEntry(this.handle)}};LevelTools={setStds:function(){this.graphs={};this.bgCol=Col(5,17,26);this.wallCol=Col(255,255,255);this.numUpdates=0;this.wallSpeed=defaultTo(1,this.wallSpeed);this.makeListenerHolders();this.auxs={};this.gravitying=this.attracting=!1;this.setUpdateRunListener();addListener(this,"data","run",this.dataRun,this)},addStoreAs:function(d){for(var f=0,e=0;e<d.length;e++)for(var h=d[e],k=0;k<h.prompts.length;k++){var l=h.prompts[k];if(l.quiz)for(var m=0;m<l.quiz.length;m++){var n=l.quiz[m];void 0===n.storeAs&&
(n.storeAs="questionAnswer"+String(f));f++}}},addImgsAndQuestionIds:function(d,f){for(var e=0;e<d.length;e++){var h=d[e];h.prompts||console.log("Section "+e+" has no prompts!  Sections must have at least one prompt.");for(var k=0;k<h.prompts.length;k++){var l=prompt.title,m=prompt.text,n=prompt.quiz;l&&(prompt.title=interpreter.interpImgs(l));m&&(prompt.text=interpreter.interpImgs(l));if(n)for(l=0;l<n.length;l++)if(m=n[l],m.storeAs||(m.storeAs="storeAs"+f),f++,m.options)for(optionIdx=0;optionIdx<
m.options.length;optionIdx++){var p=m.options[optionIdx];for(optionElement in p){var q=p[optionElement];"string"==typeof q&&(p[optionElement]=interpreter.interpImgs(q))}}}}return f},transferObjCleanUp:function(d){for(var f=0;f<d.length;f++){var e=d[f];e.sceneData&&this.transferObjDataCleanUp(e.sceneData.objs);for(var h=0;h<e.prompts.length;h++){var k=e.prompts[h];k.sceneData&&this.transferObjDataCleanUp(k.sceneData.objs)}}},transferObjDataCleanUp:function(d){if(d)for(var f=0;f<d.length;f++){var e=
d[f];e.attrs.cleanUpWith&&!e.cleanUpWith&&(e.cleanUpWith=e.attrs.cleanUpWith)}},addTriggerCleanUp:function(d){for(var f=0;f<d.length;f++){var e=d[f];e.sceneData&&this.addTriggerDataCleanUp(e.sceneData.triggers);for(var h=0;h<e.prompts.length;h++){var k=e.prompts[h];k.sceneData&&this.addTriggerDataCleanUp(k.sceneData.triggers)}}},addTriggerDataCleanUp:function(d){d=d||[];for(var f=0;f<d.length;f++){var e=d[f];!e.cleanUpWith&&(e.requiredFor&&"now"!=e.requiredFor)&&(e.cleanUpWith=e.requiredFor)}},setDefaultPromptVals:function(d){for(var f=
0;f<d.length;f++)for(var e=d[f],h=0;h<e.prompts.length;h++){var k=e.prompts[h];k.finished=!1;k.title=defaultTo("",k.title);k.text=defaultTo("",k.text)}},addUF298:function(d){for(var f=0;f<d.length;f++)d[f].uF298=d[f].hF298-298.15*R/1E3},addCp:function(d){for(var f=0;f<d.length;f++)d[f].cp=d[f].cv+R},addSpcs:function(d,f,e){for(var h=0;h<d.length;h++){var k=d[h],l=new Species(k.spcName,k.m,k.r,k.col,h,k.cv,k.hF298,k.hVap298,k.sF298,k.antoineCoeffs,k.cpLiq,k.spcVolLiq,e);f[k.spcName]=l}},move:function(){var d=
this.spcs,f;for(f in d)for(var e=d[f].dots,h=0;h<e.length;h++)e[h].x+=e[h].v.dx,e[h].y+=e[h].v.dy},cutSceneStart:function(d,f,e){this.inCutScene=!0;$("#intText").html("");d=defaultTo("",d);this.pause();$("#dashRunWrapper").hide();$("#buttonManager").hide();!0===f?($("#dashCutScene").show(),this.cutSceneText(d),$("#prompt").html("")):"intro"==f?($("#dashIntro").show(),$("#base").hide(),this.cutSceneText(d)):"outro"==f&&($("#dashOutro").show(),$("#base").hide(),this.cutSceneText(d));$("#canvasDiv").hide();
$("#display").show();this.cutSceneDivShow()},cutSceneDivShow:function(){$("#intText").show()},cutSceneText:function(d){$("#intText").html(d)},showRunDivs:function(){$("#intText").html("");$("#dashRunWrapper").show();$("#buttonManager").show();$("#dashRun").show();$("#dashOutro").hide();$("#dashIntro").hide();$("#dashCutScene").hide();$("#nextPrevDiv").show();$("#base").show();$("#canvasDiv").show();$("#display").hide();$("#intText").hide()},cutSceneEnd:function(){this.inCutScene=!1;this.resume();
this.showRunDivs();$("#intText").html("")},pause:function(){this.updateStore=this.update;this.updateDataStore=this.updateData;this.update=function(){};this.updateData=function(){}},resume:function(){this.updateStore&&(this.update=this.updateStore);this.updateDataStore&&(this.updateData=this.updateDataStore)},hideDash:function(){$("#dashIntro").hide();$("#dashRunWrapper").hide();$("#dashOutro").hide();$("#dashCutScene").hide()},update:function(){this.numUpdates++;turn++;this.updateRun();for(var d in this.updateListeners){var f=
this.updateListeners[d];f.func.apply(f.obj)}for(var e in this.wallMoveListeners)f=this.wallMoveListeners[e],f.func.apply(f.obj)},updateData:function(){for(var d in this.dataListeners){var f=this.dataListeners[d];f.func.apply(f.obj)}this.numUpdates=0},delayGraphs:function(){var d=this;window.setTimeout(function(){d.dataRunNoGraphs();addListener(curLevel,"data","run",d.dataRun,d)},50)},dataRunNoGraphs:function(){for(var d in this.recordListeners){var f=this.recordListeners[d];f.func.apply(f.obj)}},
dataRun:function(){for(var d in this.recordListeners){var f=this.recordListeners[d];f.func.apply(f.obj)}for(var e in this.graphs)this.graphs[e].active&&this.graphs[e].addLast()},setUpdateRunListener:function(){this.updateRun=this.attracting&&this.gravitying?this.updateRunAttractAndGravity:this.attracting?this.updateRunAttract:this.gravitying?this.updateRunGravity:this.updateRunBasic},gravity:function(d){this.gravitying=!0;for(d=0;d<walls.length;d++)walls[d].setHitMode("Gravity");this.setUpdateRunListener()},
gravityStop:function(){this.gravitying=!1;this.setUpdateRunListener()},doGravity:function(){for(var d in spcs)for(var f=spcs[d].dots,e=0;e<f.length;e++)f[e].v.dy+=gInternal,f[e].y+=0.5*gInternal},attract:function(d){this.attracting=!0;attractor.setup();attractor.assignELastAll();this.setUpdateRunListener()},attractStop:function(){this.attracting=!1;attractor.zeroAllEnergies();this.setUpdateRunListener()},updateRunBasic:function(){this.move();collide.check();walls.check();this.drawRun()},updateRunGravity:function(){this.move();
collide.check();this.doGravity();walls.check();this.drawRun()},updateRunAttract:function(){this.move();collide.check();attractor.attract();walls.check();this.drawRun()},updateRunAttractAndGravity:function(){this.move();collide.check();attractor.attract();this.doGravity();walls.check();this.drawRun()},drawRun:function(){draw.clear(this.bgCol);draw.dots();draw.walls(walls)},resetGraphs:function(){for(var d in this.graphs)this.graphs[d].reset()},removeGraph:function(d){this.graphs[d].remove();this.graphs[d]=
void 0},removeAllGraphs:function(){for(var d in this.graphs)this.removeGraph(d),delete this.graphs[d]},saveAllGraphs:function(){for(var d in this.graphs)this.graphs[d].save(d+"section"+sectionIdx+"prompt"+promptIdx)},disableAllGraphs:function(){for(var d in this.graphs)this.graphs[d].disable()},selectObj:function(d,f){return/^wall$/i.test(d)?walls[f]||console.log("Bad command wall handle "+f):this[this.key(d,f)]||console.log("Bad command data: Type "+d+" and handle "+f)},key:function(d,f){return d.toCamelCase()+
f.toCapitalCamelCase()},makeListenerHolders:function(){makeListenerHolder(this,"update");makeListenerHolder(this,"wallMove");makeListenerHolder(this,"data");makeListenerHolder(this,"mousedown");makeListenerHolder(this,"mouseup");makeListenerHolder(this,"mousemove");makeListenerHolder(this,"init");makeListenerHolder(this,"record");makeListenerHolder(this,"sectionCondition");makeListenerHolder(this,"promptCondition");makeListenerHolder(this,"setup")}};function LevelInstance(){this.readouts={};this.setStds()}_.extend(LevelInstance.prototype,LevelTools);function Timeline(d,f,e,h){this.parent=d;this.buttonManagerBlank=f||document.getElementById("buttonManager").outerHTML;this.isSectionsBranch=e||!1;this.isPromptsBranch=h||!1;this.sections=[];this.sectionIdx=void 0;this.curId=0;this.elems=[];this.suspended=!1}
Timeline.prototype={curSection:function(){return this.sections[this.sectionIdx]},curPrompt:function(){return this.sections[this.sectionIdx].curPrompt()},pushSection:function(d,f,e){this.sections.push(new Timeline.Section(this,d,this.buttonManagerBlank,void 0,f,e))},clearCurrentSection:function(){void 0!==this.sectionIdx&&this.sections[this.sectionIdx].clear()},now:function(){return{sectionIdx:this.sectionIdx,promptIdx:this.sections[this.sectionIdx].promptIdx}},nowTime:function(){return{sectionIdx:this.sectionIdx,
promptIdx:Math.floor(this.sections[this.sectionIdx].time)}},surface:function(d){var f=!1;d=defaultTo(!0,d);this.parent&&(this.isSectionsBranch?(f=this.curSection().cleanUpPrompt(d))||this.clearCurrentSection():this.isPromptsBranch&&(f=this.curSection().cleanUpPrompt(d)),f?this.curSection().promptIdx+=0.5:this.parent.catchSurface(this,d))},catchSurface:function(d,f){window.timeline=this;timeline.suspended=!1;this.curSection().pushToGlobal();f||(this.curSection().time-=1E-4);d.isSectionsBranch&&this.curSection().restoreHTML();
f?sceneNavigator.nextPrompt(!0,!1):sceneNavigator.prevPrompt()},findElemBoundsByHandle:function(d){var f=[],e,h,k,l,m,n;h=0;a:for(;h<this.sections.length;h++){l=this.sections[h].moments;for(k=0;k<l.length;k++){m=l[k].events;for(n=0;n<m.walls.length;n++)if(d==m.walls[n].elemDatum.handle&&(f.push(l[k].timestamp),e=h,2==f.length))break a;for(n=0;n<m.objs.length;n++)if(m.objs[n].elemDatum.handle){if(m.objs[n].elemDatum.handle==d&&(f.push(l[k].timestamp),e=h,2==f.length))break a}else if(m.objs[n].elemDatum.attrs&&
m.objs[n].elemDatum.attrs.handle==d&&(f.push(l[k].timestamp),e=h,2==f.length))break a;for(n=0;n<m.cmmds.length;n++)if(d==m.cmmds[n].elemDatum.handle&&(f.push(l[k].timestamp),e=h,2==f.length))break a}}f.push(e);return f},show:function(d,f,e,h){var k=this.sectionIdx!=d;h=k||f!=this.sections[d].promptIdx||h;k&&void 0!==this.sectionIdx&&this.sections[this.sectionIdx].cleanUpPrompt(d>this.sectionIdx);if(k||e)this.clearCurrentSection(),this.sectionIdx=d,this.sections[d].showSection();(h||e)&&this.sections[d].showPrompt(f)},
addOnce:function(d,f,e,h,k){d="now"==d?this.sectionIdx:d;this.sections[d].addOnce(f,e,h,k)},refresh:function(){var d=this.sections[this.sectionIdx],f=d.sectionData.prompts[d.promptIdx],e=d.motherSection,h=d.motherTimeline,d=new Timeline.Section(d.motherTimeline,e.sectionData,this.buttonManagerBlank,e.conditionManager);e.clear();d.copyBranchCmmds(e.moments);var k=h.sections.indexOf(e);h.sections.splice(k,1,d);d.showSection();d.deepStepTo(f,e.branches)},takeNumber:function(){return this.curId++}};
Timeline.Section=function(d,f,e,h,k,l){this.timeline=d;this.inited=!1;this.promptIdx=-1;this.time=-2;this.branches=[];this.sectionData=f;this.moments=[];this.populateMoments(d,d.elems,this.moments,this.sectionData);this.sortMoments();this.level=new LevelInstance;this.mainReadout=new Readout("mainReadout",30,myCanvas.width-125,25,"13pt calibri",Col(255,255,255),"left",this.level);this.dotManager=new DotManager;this.collide=new CollideHandler(this.dotManager);this.walls=WallHandler();this.dataHandler=
new DataHandler;this.dataDisplayer=new DataDisplayer;this.conditionManager=h?h.stripForInheritance():new ConditionManager;this.activationEnergySpcChanger=new ActivationEnergySpcChanger(this.collide);this.buttonManager=new ButtonManager("buttonManager");this.spcs={};LevelTools.addSpcs(LevelData.spcDefs,this.spcs,this.dotManager);this.sliderList=[];this.dataDisplayer.setReadouts(this.level.readouts);this.collide.setSpcs(this.spcs);this.level.spcs=this.spcs;this.level.dataHandler=this.dataHandler;this.buttonMangerClone;
this.buttonManagerBlank=e;this.dashRunId="dashRun"+window.dashRunId++;this.dashRun=$("#dashRunBlank").clone(!0).attr("id",this.dashRunId);$("#dashRunWrapper").append(this.dashRun);this.sliderManager=new SliderManager(this.dashRunId);this.motherTimeline=k||this.timeline;this.motherSection=l||this};
Timeline.Section.prototype={showSection:function(){this.dashRun.show();this.dashRun.addClass("active");this.replaceDiv($("#buttonManagerWrapper"),$("#buttonManager"),this.buttonManagerClone||this.buttonManagerBlank);this.pushToGlobal();this.inited?(this.restoreAuxs(),this.restoreGraphs()):(this.stepTo(-1),this.promptIdx=-1,this.inited=!0)},restoreHTML:function(){this.dashRun.show();this.dashRun.addClass("active");this.replaceDiv($("#buttonManagerWrapper"),$("#buttonManager"),this.buttonManagerClone||
this.buttonManagerBlank);this.restoreGraphs();this.restoreAuxs()},showPrompt:function(d){var f=this.getTimestamp(d,"headHTML");this.stepTo(f)?(this.timeline.suspended=!0,this.promptIdx=Math.floor(this.time)+0.5):this.promptIdx=d},stepTo:function(d){var f=!1,e=!1,h=this.time;if(d>this.time||d<this.time&&!/headhtml/i.test(this.getTimestampType(d))){var k=this.momentAt(this.time);k&&k.fire(this.time,d);k&&(this.time+=d>this.time?1E-4:-1E-4);for(;d!=this.time;){k=this.nextTowardsDest(this.time,d);if(!k)break;
var l=this.getTimestamp(Math.floor(k.timestamp),"branchPreClean"),m=this.getTimestamp(Math.floor(k.timestamp),"branchPostClean");this.time=k.timestamp;k.fire(h,d);if(1E-5>Math.abs(k.timestamp-l)||1E-5>Math.abs(k.timestamp-m)){f=this.branches[Math.floor(this.time)].timeline;f=f.isSectionsBranch?"sections":f.isPromptsBranch?"prompts":void 0;break}}}else if(d<this.time){(k=this.momentAt(this.time))&&k.fire(this.time,d);k&&(this.time-=1E-4);for(var n=this.getTimestamp(Math.floor(d),"branchPreClean");n!=
this.time;){k=this.nextTowardsDest(this.time,n);if(!k)break;l=this.getTimestamp(Math.floor(k.timestamp),"branchPreClean");m=this.getTimestamp(Math.floor(k.timestamp),"branchPostClean");this.time=k.timestamp;k.fire(h,d);if(1E-5>Math.abs(k.timestamp-l)||1E-5>Math.abs(k.timestamp-m)){f=this.branches[Math.floor(this.time)].timeline;f=f.isSectionsBranch?"sections":f.isPromptsBranch?"prompts":void 0;e=!0;break}}if(!e)for(this.time=this.getTimestamp(Math.floor(d+1E-4),"setup")-1E-4;d!=this.time;){k=this.nextMoment(this.time);
if(!k)break;h=this.time;this.time=k.timestamp;k.fire(h,d)}}return f},deepStepTo:function(d,f){for(var e=-1,h=this.moments.indexOf(this.nextMoment(e));h<this.moments.length-1;h++){var k=this.moments[h],l;k.events.branchCmmd&&(l=k.events.branchCmmd,k.events.branchCmmd=void 0);var m=this.moments[h].timestamp;if(this.sectionData.prompts[Math.floor(k.timestamp)]==d)return this.stepTo(this.getTimestamp(k.timestamp,"headhtml")),this.promptIdx=Math.floor(k.timestamp),!0;this.promptIdx=Math.floor(this.time);
k.fire(e,m);if(l){k.events.branchCmmd=l;var n=Math.floor(this.time),e=f[n];if(e.timeline.isSectionsBranch)this.branches[n]=e;else if(e.timeline.isPromptsBranch){var p=e.timeline.sections[0].branches,q=new Timeline.Moment(k.timestamp);q.events.branchCmmd=l;q.fire(this.time,m);n=this.branches[n];n.timeline.sections[0].copyBranchCmmds(e.timeline.sections[0].moments);e=n.timeline.sections[0].deepStepTo(d,p);this.promptIdx=Math.floor(this.time)+0.5;this.time=k.timestamp;if(e)return!0}}this.time=e=m}return!1},
copyBranchCmmds:function(d){for(var f=0;f<d.length;f++){var e=d[f],h=e.events.branchCmmd;if(h){h.section=this;var k=this.momentAt(e.timestamp);k?k.events.branchCmmd=h:(k=new Timeline.Moment(e.timestamp),k.events.branchCmmd=h,this.spliceInMoment(k))}}},nextTowardsDest:function(d,f){var e=this.momentAt(d);if(e){e=this.moments.indexOf(e);f<d?e--:e++;var h=this.moments[e];if(h&&Math.abs(h.timestamp-d)<=Math.abs(f-d))return this.moments[e]}else if(d<f)for(e=0;e<this.moments.length;e++){if(h=this.moments[e],
h.timestamp>d){if(h.timestamp<=f)return h;break}}else if(f<d)for(e=this.moments.length-1;0<=e;e--)if(h=this.moments[e],h.timestamp<d){if(h.timestamp>=f)return h;break}},nextMoment:function(d){for(var f=0;f<this.moments.length;f++)if(this.moments[f].timestamp>d)return this.moments[f]},momentAt:function(d){for(var f=0;f<this.moments.length;f++)if(1E-5>Math.abs(this.moments[f].timestamp-d))return this.moments[f]},cleanUpPrompt:function(d){d=d?this.getTimestamp(this.sectionData.prompts.length-1,"branchPostClean")+
1E-4:this.getTimestamp(0,"head")-1E-4;var f=this.stepTo(d);this.time=d;return f},spliceInMoment:function(d){for(var f=0;f<this.moments.length;f++)if(this.moments[f].timestamp>d.timestamp){this.moments.splice(f,0,d);break}},branchPromptsPreClean:function(d){var f=this.getTimestamp(Math.floor(this.time),"branchPreClean");this.branchPrompts(d,f)},branchPromptsPostClean:function(d){var f=this.getTimestamp(Math.floor(this.time),"branchPostClean");this.branchPrompts(d,f)},branchPrompts:function(d,f){this.killBranchMoments();
var e=new Timeline.Moment(f),h=new Timeline.Command("point",function(e,h){var m=Math.floor(f);if(h.branches[m]&&h.branches[m].id==d.id)window.timeline=h.branches[m].timeline,timeline.sections[0].pushToGlobal(),m=timeline.now(),timeline.show(m.sectionIdx,m.promptIdx,!1,!0);else{var n=new Timeline(e,h.buttonManagerBlank,!1,!0);h.branches[m]=new Timeline.Branch(n,d.id);n.pushSection({prompts:d},h.motherTimeline,h.motherSection);n.sections[0].inheritState(h);n.sectionIdx=0;n.inited=!0;window.timeline=
n;n.sections[0].pushToGlobal();n.show(0,0)}},void 0,!1,!1,void 0);e.events.branchCmmd=new Timeline.Event.BranchCmmd(this,this.timeline.elems,h,Timeline.stateFuncs.cmmds.spawn,this.timeline.takeNumber(),e,!1);this.spliceInMoment(e)},branchSections:function(d){this.killBranchMoments();var f=this.getTimestamp(Math.floor(this.time),"branchPostClean"),f=new Timeline.Moment(f),e=new Timeline.Command("point",function(e,f){var l=Math.floor(f.time);if(f.branches[l]&&f.branches[l].id==d.id)e.clearCurrentSection(),
window.timeline=f.branches[l].timeline,timeline.sections[timeline.sectionIdx].pushToGlobal(),timeline.sections[timeline.sectionIdx].showSection(),l=timeline.now(),timeline.show(l.sectionIdx,l.promptIdx,!1,!0);else{for(var l=new Timeline(e,e.buttonManagerBlank,!0,!1),m=0;m<d.length;m++)l.pushSection(d[m]);f.branches[f.promptIdx]=new Timeline.Branch(l,d.id);f.timeline.clearCurrentSection();window.timeline=l;l.show(0,0)}},void 0,!1,!1,void 0);f.events.branchCmmd=new Timeline.Event.BranchCmmd(this,this.timeline.elems,
e,Timeline.stateFuncs.cmmds.spawn,this.timeline.takeNumber(),f,!0);this.spliceInMoment(f)},killBranches:function(){this.killBranchMoments();this.branches[this.promptIdx]=void 0},killBranchMoments:function(){var d=this.getTimestamp(Math.floor(this.time),"branchPreClean"),f=this.getTimestamp(Math.floor(this.time),"branchPostClean"),d=this.momentAt(d),f=this.momentAt(f);d&&this.moments.splice(this.moments.indexOf(d),1);f&&this.moments.splice(this.moments.indexOf(f),1)},curPrompt:function(){return this.sectionData.prompts[this.promptIdx]},
replaceDiv:function(d,f,e){f.length&&f.remove();d.append(e)},inheritState:function(d){this.level=d.level;this.collide=d.collide;this.walls=d.walls;this.dotManager=d.dotManager;this.spcs=d.spcs;this.dataDisplayer=d.dataDisplayer;this.sliderList=d.sliderList;this.buttonManager=d.buttonManager;this.dataHandler=d.dataHandler;this.activationEnergySpcChanger=d.activationEnergySpcChanger},pushToGlobal:function(){window.curLevel=this.level;window.collide=this.collide;window.walls=this.walls;window.dotManager=
this.dotManager;window.spcs=this.spcs;window.dataDisplayer=this.dataDisplayer;window.sliderList=this.sliderList;window.buttonManager=this.buttonManager;window.sliderManager=this.sliderManager;window.dataHandler=this.dataHandler;window.activationEnergySpcChanger=this.activationEnergySpcChanger;window.conditionManager=this.conditionManager},restoreAuxs:function(){for(var d in this.level.auxs)this.level.auxs[d].restoreHTML()},restoreGraphs:function(){for(var d in this.level.graphs){var f=this.level.graphs[d];
f.setDataValid();f.restoreHTML();f.drawAllData()}},clear:function(){if(this.inited){$("#prompt").html("");this.buttonManagerClone=$("#buttonManager").clone(!0);$("#buttonManager").html("");$("#baseHeader").html("");this.dashRun.removeClass("active");this.dashRun.hide();for(var d in this.level.graphs)this.level.graphs[d].clearHTML();for(var f in this.level.auxs)this.level.auxs[f].clearHTML()}},addCmmdSpan:function(d,f){promptIdx="now"==d?this.promptIdx:d;var e=this.getTimestamp(promptIdx,"setup"),
h=this.timeline.takeNumber();cmmd="string"==typeof f||"function"==typeof f?new Timeline.Command("span",f,void 0,!0,!1):new Timeline.Command("span",f.spawn,f.remove,!1,f.once,f.cleanUpWith);this.timeline.elems[h]=cmmd;this.applyCmmdSpan(this.timeline,this.moments,this.timeline.elems,cmmd,"cmmds",cmmd.once,e,h);this.sortMoments()},addCmmdPoint:function(d,f,e,h,k){promptIdx="now"==d?this.promptIdx:d;d=this.timeline.takeNumber();f=this.getTimestamp(promptIdx,f||"setup");e=new Timeline.Command("point",
e,void 0,h,k);this.timeline.elems[d]=e;this.applyCmmdPoint(this.timeline,this.moments,this.timeline.elems,e,"cmmds",k,f,d);this.sortMoments()},populateMoments:function(d,f,e,h){e.push(new Timeline.Moment(-2));this.addSceneDataToMoments(d,f,e,{cmmds:[{type:"point",spawn:'addListener(curLevel, "data", "pareWallsData", walls.pareData, walls)',oneWay:!1}]},-1,void 0);this.addSceneDataToMoments(d,f,e,h.sceneData,-1,void 0);for(var k=h.prompts,l=0;l<k.length;l++)k[l].sceneData&&this.addSceneDataToMoments(d,
f,e,k[l].sceneData,l);this.populateHTMLMoments(d,f,e,h)},populateHTMLMoments:function(d,f,e,h){h=h.prompts;for(var k=0;k<h.length;k++){var l=h[k],m=this.getTimestamp(k,"headHTML");this.populatePromptHTML(l,m,d,f,e,k)}},populatePromptHTML:function(d,f,e,h,k,l){var m=this,n,p,q;d.cutScene?(p=e.takeNumber(),n=function(){var e=interpreter.interp(d.text);m.level.cutSceneStart(e,d.cutScene)},q=function(){m.level.cutSceneEnd()},d.quiz&&(n=extend(n,function(){$("#base").hide();m.level.quiz=quizRenderer.render(d.quiz,
$("#intText"))}),q=extend(q,function(){$("#base").show();m.level.quiz=void 0}))):(p=e.takeNumber(),n=function(){var e=interpreter.interp(d.text);$("#prompt").html(defaultTo("",templater.div({innerHTML:e})));d.quiz&&(m.level.quiz=quizRenderer.render(d.quiz,$("#prompt")))},q=function(){$("#prompt").html("");m.level.quiz=void 0});q=new Timeline.Command("span",n,q);n=this.getTimestamp(l,"tailHTML");this.pushSpan(h,q,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,p,k,f,n,!1,"cmmds");
d.quiz&&(p=e.takeNumber(),q=new Timeline.Command("span",function(){$("#nextPrevDiv").hide()},function(){$("#nextPrevDiv").show()}),n=this.getTimestamp(l,"tailHTML"),this.pushSpan(h,q,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,p,k,f,n,!1,"cmmds"));d.title&&(p=e.takeNumber(),q=new Timeline.Command("span",function(){$("#baseHeader").html(d.title)},function(){$("#baseHeader").html("")}),n=this.getTimestamp(l,"tailHTML"),this.pushSpan(h,q,Timeline.stateFuncs.cmmds.spawn,Timeline.stateFuncs.cmmds.remove,
p,k,f,n,!1,"cmmds"));l=new Timeline.Command("point",function(){interpreter.renderMath();m.buttonManager.arrangeGroupWrappers();m.buttonManager.arrangeAllGroups();m.buttonManager.setButtonWidth()},void 0,!0);this.pushPoint(k,h,e.takeNumber(),l,Timeline.stateFuncs.cmmds.spawn,!0,"cmmds",!1,f)},addSceneDataToMoments:function(d,f,e,h,k){this.getOrCreateMoment(e,k);h&&(this.applySpanToMoments(d,e,f,h.walls,"walls",k,Timeline.stateFuncs.walls.spawn,Timeline.stateFuncs.walls.remove),this.applySpanToMoments(d,
e,f,h.dots,"dots",k,Timeline.stateFuncs.dots.spawn,Timeline.stateFuncs.dots.remove),this.applySpanToMoments(d,e,f,h.objs,"objs",k,Timeline.stateFuncs.objs.spawn,Timeline.stateFuncs.objs.remove),this.applySpanToMoments(d,e,f,h.dataRecord,"objs",k,Timeline.stateFuncs.dataRecord.spawn,Timeline.stateFuncs.dataRecord.remove),this.applySpanToMoments(d,e,f,h.dataReadouts,"objs",k,Timeline.stateFuncs.dataReadouts.spawn,Timeline.stateFuncs.dataReadouts.remove),this.applySpanToMoments(d,e,f,h.triggers,"objs",
k,Timeline.stateFuncs.triggers.spawn,Timeline.stateFuncs.triggers.remove),this.applySpanToMoments(d,e,f,h.graphs,"objs",k,Timeline.stateFuncs.graphs.spawn,Timeline.stateFuncs.graphs.remove),this.applySpanToMoments(d,e,f,h.rxns,"objs",k,Timeline.stateFuncs.rxns.spawn,Timeline.stateFuncs.rxns.remove),this.applySpanToMoments(d,e,f,h.buttonGroups,"objs",k,Timeline.stateFuncs.buttonGrps.spawn,Timeline.stateFuncs.buttonGrps.remove),this.applyCmmdsToMoments(d,e,f,h.cmmds,"cmmds",k))},applySpanToMoments:function(d,
f,e,h,k,l,m,n){h=h?h:[];for(var p=0;p<h.length;p++){var q=d.takeNumber(),r=h[p],t=this.getTimestamp(r.cleanUpWith||l,"tail");this.pushSpan(e,r,m,n,q,f,l,t,!1,k)}},applyCmmdsToMoments:function(d,f,e,h,k,l){var m;h=h?h:[];for(var n=0;n<h.length;n++)m=h[n],m="string"==typeof m||"function"==typeof m?new Timeline.Command("point",m,void 0,!0,!1):new Timeline.Command(m.type,m.spawn,m.remove,defaultTo(!0,m.oneWay),m.once),/span/i.test(m.type)?this.applyCmmdSpan(d,f,e,m,k,m.once,l):/point/i.test(m.type)?this.applyCmmdPoint(d,
f,e,m,k,m.once,l):(console.log("Bad command"),console.log(m),console.log('Must be string or have type of "span" or "point"'))},applyCmmdSpan:function(d,f,e,h,k,l,m,n){n=void 0===n?d.takeNumber():n;d=Timeline.stateFuncs.cmmds.spawn;k=Timeline.stateFuncs.cmmds.remove;var p=this.getTimestamp(h.cleanUpWith||m,"tail");this.pushSpan(e,h,d,k,n,f,m,p,l,"cmmds")},applyCmmdPoint:function(d,f,e,h,k,l,m,n){n=void 0===n?d.takeNumber():n;d=Timeline.stateFuncs.cmmds.spawn;var p=defaultTo(!0,h.oneWay);this.pushPoint(f,
e,n,h,d,p,k,l,m)},pushSpan:function(d,f,e,h,k,l,m,n,p,q){m=this.getOrCreateMoment(l,m);l=this.getOrCreateMoment(l,n);n=new Timeline.Event.Span(this,d,f,e,h,k,"head",p,m);d=new Timeline.Event.Span(this,d,f,e,h,k,"tail",p,l);n.partner=d;d.partner=n;m.events[q].push(n);l.events[q].push(d)},pushPoint:function(d,f,e,h,k,l,m,n,p){d=this.getOrCreateMoment(d,p);f=new Timeline.Event.Point(this,f,h,k,e,l,n,d);d.events[m].push(f)},getTimestamp:function(d,f){var e;/tailhtml/i.test(f)?e=0.8:/tail/i.test(f)?e=
0.9:/setup/i.test(f)?e=0.1:/headhtml/i.test(f)?e=0.2:/head/i.test(f)?e=0:/branchPreClean/i.test(f)?e=0.85:/branchPostClean/i.test(f)&&(e=0.95);var h=this.parseIntegerTimeIdx(d);return-1==h&&"tail"==f?Infinity:h+e},getTimestampType:function(d){if(0.8==d%1)return"tailhtml";if(1E-5>Math.abs(d%1-0.9))return"tail";if(1E-5>Math.abs(d%1-0.1))return"setup";if(1E-5>Math.abs(d%1-0.2))return"headhtml";if(1E-5>Math.abs(d%1-0))return"head";1E-5>Math.abs(d%1-0.85)?"branchPreClean":1E-5>Math.abs(d%1-0.95)&&"branchPostClean"},
parseIntegerTimeIdx:function(d){if("string"==typeof d){if(/section/i.test(d))return-1;var f=/[0-9]+/.exec(d);if(""!==f)return Number(f);console.log("Bad time code: "+d)}else return Math.floor(d)},sortMoments:function(){this.moments=_.sortBy(this.moments,function(d){return d.timestamp})},getOrCreateMoment:function(d,f){for(var e=0;e<d.length;e++)if(d[e].timestamp==f)return d[e];d.push(new Timeline.Moment(f));return d[d.length-1]}};
Timeline.stateFuncs={walls:{spawn:function(d,f,e,h){f[e]=d.walls.addWall(h)},remove:function(d,f,e){var h=f[e];h&&d.walls.removeWall(h.handle);f[e]=void 0}},dots:{spawn:function(d,f,e,h){d.spcs[h.spcName].populate(h.pos,h.dims,h.count,h.temp,h.tag,e,h.returnTo);f[e]="dots"},remove:function(d,f,e){d.dotManager.removeByAttr("elemId",e);f[e]=void 0}},objs:{spawn:function(d,f,e,h){(d=window[h.type])||console.log("Bad object type "+h.type);f[e]=new d(h.attrs)},remove:function(d,f,e){(d=f[e])&&d.remove();
f[e]=void 0}},dataRecord:{spawn:function(d,f,e,h){if(/collisions/i.test(h.data))d.collide.recordCollisions();else d.walls[h.wallInfo]["record"+h.data.toCapitalCamelCase()](h.attrs);f[e]=h},remove:function(d,f,e){var h=f[e];if(/collisions/i.test(h.data))d.collide.recordCollisionsStop();else d.walls[h.wallInfo]["record"+h.data.toCapitalCamelCase()+"Stop"](h.attrs);f[e]=void 0}},dataReadouts:{spawn:function(d,f,e,h){d=d.dataDisplayer.addEntry(h);f[e]=d},remove:function(d,f,e){f[e].remove();f[e]=void 0}},
triggers:{spawn:function(d,f,e,h){f[e]=new window.Trigger(h)},remove:function(d,f,e){f[e].remove();f[e]=void 0}},graphs:{spawn:function(d,f,e,h){var k;/^load$/i.test(h.type)?((k=window.storedGraphs[h.handle])?(k.initDrawLayers(),k.restoreHTML()):console.log("Tried to load graph with bad handle "+h.handle),k.setDataValid()):k=new window.Graphs[h.type](h);k.drawAllData();if(h.sets)for(var l=0;l<h.sets.length;l++)k.addSet(h.sets[l]);d.level.graphs[h.handle]=k;f[e]=k},remove:function(d,f,e){var h=f[e],
k;for(k in h.data)h.data[k].recording=!1;delete d.level.graphs[h.handle];h.remove();f[e]=void 0}},rxns:{spawn:function(d,f,e,h){d=d.collide.addReaction(h);f[e]=d},remove:function(d,f,e){f[e].remove();f[e]=void 0}},buttonGrps:{spawn:function(d,f,e,h){d.buttonManager.addGroup(h.handle,h.label,h.prefIdx,h.isRadio,h.isToggle);if(h.buttons)for(var k=0;k<h.buttons.length;k++){var l=h.buttons[k];d.buttonManager.addButton(h.handle,l.handle,l.label,l.exprs,l.prefIdx,l.isDown)}else console.log("Button group "+
h.handle+" has no buttons.  Just thought you should know.  This object is logged below."),console.log(h);f[e]=h},remove:function(d,f,e){d.buttonManager.removeGroup(f[e].handle);f[e]=void 0}},cmmds:{spawn:function(d,f,e,h){var k=h.spawn;f[e]=h;if(k)with(DataGetFuncs)"function"==typeof k?k(d.timeline,d):"string"==typeof k?eval("("+k+")"):k instanceof Array&&(d=k.join(";")+";",eval("("+d+")"))},remove:function(d,f,e){d=f[e];f[e]=void 0;if(f=d.remove)with(DataGetFuncs)"function"==typeof f?f():"string"==
typeof f?eval("("+f+")"):f instanceof Array&&(f=f.join(";")+";",eval("("+f+")"))}}};Timeline.Moment=function(d){this.timestamp=d;this.events=new Timeline.EventClassHolder};
Timeline.Moment.prototype={fire:function(d,f){this.fireSpans(this.events.dots,d,f);this.fireSpans(this.events.walls,d,f);this.fireSpans(this.events.objs,d,f);this.fireCmmds(this.events.cmmds,d,f);this.fireCmmds([this.events.branchCmmd],d,f)},fireSpans:function(d,f,e){for(var h=0;h<d.length;h++)this.fireSpan(d[h],f,e)},fireSpan:function(d,f,e){if(d.active){var h=getAndEval(d.elemDatum);"head"==d.boundType?f<e&&f<this.timestamp&&e<d.partner.moment.timestamp?d.spawn(d.section,d.timelineElems,d.id,h):
e<f&&(e<this.timestamp&&f<=d.partner.moment.timestamp)&&(d.remove(d.section,d.timelineElems,d.id),d.once&&(d.active=!1,d.partner.active=!1)):"tail"==d.boundType&&(e>f&&f>=d.partner.moment.timestamp&&f<this.timestamp?(d.remove(d.section,d.timelineElems,d.id),d.once&&(d.active=!1)):e<f&&e>=d.partner.moment.timestamp&&d.spawn(d.section,d.timelineElems,d.id,h))}},fireCmmds:function(d,f,e){for(var h,k=0;k<d.length;k++){var l=d[k];if(l instanceof Timeline.Event.Span)this.fireSpans([l],f,e);else if(l instanceof
Timeline.Event.Point||l instanceof Timeline.Event.BranchCmmd)if((f<this.timestamp&&this.timestamp<=e||e<=this.timestamp&&this.timestamp<f)&&(l.elemDatum.oneWay?f<e:1)&&l.active)h=getAndEval(l.elemDatum),l.spawn(l.section,l.timelineElems,l.id,h),l.once&&(l.active=!1)}}};Timeline.Command=function(d,f,e,h,k,l){this.type=d;this.spawn=f;this.remove=e;this.oneWay=h;this.once=k;this.cleanUpWith=l};
Timeline.EventClassHolder=function(){this.walls=[];this.dots=[];this.objs=[];this.cmmds=[];this.branchCmmd=void 0};
Timeline.Event={Span:function(d,f,e,h,k,l,m,n,p){this.section=d;this.timelineElems=f;this.elemDatum=e;this.spawn=h;this.remove=k;this.id=l;this.boundType=m;this.moment=p;this.once=n;this.active=!0;this.parnter},Point:function(d,f,e,h,k,l,m,n){this.section=d;this.timelineElems=f;this.elemDatum=e;this.spawn=h;this.id=k;this.oneWay=l;this.moment=n;this.once=m;this.active=!0},BranchCmmd:function(d,f,e,h,k,l,m){this.section=this.section=d;this.timelineElems=f;this.elemDatum=e;this.spawn=h;this.id=k;this.oneWay=
!1;this.moment=l;this.once=!1;this.active=!0;this.isSectionsBranch=m;this.isPromptsBranch=!m}};Timeline.Branch=function(d,f){this.timeline=d;this.id=f};window.R=8.314;
$(function(){window.IMGPATHPREFIX="";window.simHost=window.simHost||"";"CW"==window.simHost&&(window.IMGPATHPREFIX="content/sims/levels/");$("#resetExp").append("<img src='"+IMGPATHPREFIX+"img/refresh.gif'></img>");MathJax.Hub.Config({tex2jax:{inlineMath:[["##","##"],["\\(","\\)"]],displayMath:[["$$","$$"]]}});_.extend(Array.prototype,toInherit.ArrayExtenders);_.extend(Math,toInherit.MathExtenders);_.extend(String.prototype,toInherit.StringExtenders);templater=new Templater;globalHTMLClass="sim";
dotManager=new DotManager;turn=0;window.Graphs={Scatter:GraphScatter,Hist:GraphHist,PhaseTwoComp:GraphPhaseTwoComp};$("#mainHeader").html(LevelData.levelTitle);$("#canvasDiv").hide();$("#base").hide();$("#dashIntro").hide();$("#dashOutro").hide();$("#dashCutScene").hide();$("#display").hide();$("#intText").hide();canvas=document.getElementById("myCanvas");c=canvas.getContext("2d");N=1E3;R=8.314;KB=R/N;extraIntervals={};vConst=1E-4;pConst=16.3562;tConst=20;LtoM3=0.001;ATMtoPA=101325;PUNITTOPA=BARTOPA=
1E5;MMHGTOBAR=0.0013332237;JtoKJ=0.001;pxToE=Math.sqrt(tConst);ACTUALN=6.022E23;g=1.75;gInternal=0.01;updateInterval=30;dataInterval=1250;borderCol=Col(155,155,155);pxToMS=19.33821;auxHolderDivs=["aux1","aux2"];stored={};storedGraphs={};addJQueryElems($("button"),"button");draw=new DrawingTools;turnUpdater=setInterval("curLevel.update()",updateInterval);dataUpdater=setInterval("curLevel.updateData()",dataInterval);attractor=new Attractor;animText=new AnimText(c);phaseEquilGenerator=new PhaseEquilGenerator;
dotMigrator=new DotMigrator;quizRenderer=new QuizRenderer;sceneNavigator=new SceneNavigator;interpreter=new ExpressionInterpreter;$("#resetExp").click(function(){sceneNavigator.refresh()});$("#toSim").click(function(){sceneNavigator.nextPrompt()});$("#toLastStep").click(function(){sceneNavigator.prevPrompt()});$("#previous").click(function(){sceneNavigator.prevPrompt()});$("#next").click(function(){sceneNavigator.nextPrompt()});window.dashRunId=0;timeline=new Timeline;canvasHeight=450;myCanvas.width=
$("#main").width();myCanvas.height=canvasHeight;var d=0;LevelTools.addUF298(LevelData.spcDefs);LevelTools.addCp(LevelData.spcDefs);d=LevelTools.addImgsAndQuestionIds(LevelData.mainSequence,d);LevelTools.setDefaultPromptVals(LevelData.mainSequence);LevelTools.addTriggerCleanUp(LevelData.mainSequence);LevelTools.addStoreAs(LevelData.mainSequence);LevelTools.transferObjCleanUp(LevelData.mainSequence);LevelTools.showRunDivs();var f=0,e;for(e in LevelData.auxSections){var h=LevelData.auxSections[e],h=
h instanceof Array?h:[h],d=LevelTools.addImgsAndQuestionIds(h,d);h.id=f;f++;LevelTools.setDefaultPromptVals(h);LevelTools.addTriggerCleanUp(h);LevelTools.addStoreAs(h);LevelTools.transferObjCleanUp(h)}for(var k in LevelData.auxPrompts)e=LevelData.auxPrompts[k],e=e instanceof Array?e:[e],h={prompts:e},d=LevelTools.addImgsAndQuestionIds(h,d),e.id=f,f++,LevelTools.setDefaultPromptVals(h),LevelTools.addTriggerCleanUp(h),LevelTools.addStoreAs(h),LevelTools.transferObjCleanUp(h);for(d=0;d<LevelData.mainSequence.length;d++)timeline.pushSection(LevelData.mainSequence[d]);
timeline.show(0,0)});
